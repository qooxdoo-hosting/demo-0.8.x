qx={Bootstrap:{genericToString:function(){return "[Class "+this.classname+"]";},createNamespace:function(name,object){var splits=name.split(".");var parent=window;var part=splits[0];for(var i=0,len=splits.length-1;i<len;i++,part=splits[i]){if(!parent[part]){parent=parent[part]={};}else{parent=parent[part];}}parent[part]=object;return part;},define:function(name,config){if(!config){var config={statics:{}};}var clazz;var proto=null;if(config.members){clazz=config.construct||new Function;var statics=config.statics;for(var key in statics){clazz[key]=statics[key];}proto=clazz.prototype;var members=config.members;for(var key in members){proto[key]=members[key];}}else{clazz=config.statics||{};}var basename=this.createNamespace(name,clazz);clazz.name=clazz.classname=name;clazz.basename=basename;clazz.$$type="Class";if(!clazz.hasOwnProperty("toString")){clazz.toString=this.genericToString;}if(config.defer){config.defer(clazz,proto);}qx.Bootstrap.$$registry[name]=config.statics;}}};qx.Bootstrap.define("qx.Bootstrap",{statics:{LOADSTART:new Date,createNamespace:qx.Bootstrap.createNamespace,define:qx.Bootstrap.define,genericToString:qx.Bootstrap.genericToString,getByName:function(name){return this.$$registry[name];},$$registry:{}}});qx.Bootstrap.define("qx.core.Setting",{statics:{__settings:{},define:function(key,defaultValue){if(defaultValue===undefined){throw new Error('Default value of setting "'+key+'" must be defined!');}if(!this.__settings[key]){this.__settings[key]={};}else if(this.__settings[key].defaultValue!==undefined){throw new Error('Setting "'+key+'" is already defined!');}this.__settings[key].defaultValue=defaultValue;},get:function(key){var cache=this.__settings[key];if(cache===undefined){throw new Error('Setting "'+key+'" is not defined.');}if(cache.value!==undefined){return cache.value;}return cache.defaultValue;},__init:function(){if(window.qxsettings){for(var key in qxsettings){if((key.split(".")).length<2){throw new Error('Malformed settings key "'+key+'". Must be following the schema "namespace.key".');}if(!this.__settings[key]){this.__settings[key]={};}this.__settings[key].value=qxsettings[key];}window.qxsettings=undefined;try{delete window.qxsettings;}catch(ex){}this.__loadUrlSettings();}},__loadUrlSettings:function(){if(this.get("qx.allowUrlSettings")!=true){return;}var urlSettings=document.location.search.slice(1).split("&");for(var i=0;i<urlSettings.length;i++){var setting=urlSettings[i].split(":");if(setting.length!=3||setting[0]!="qxsetting"){continue;}var key=setting[1];if(!this.__settings[key]){this.__settings[key]={};}this.__settings[key].value=decodeURIComponent(setting[2]);}}},defer:function(statics){statics.define("qx.allowUrlSettings",false);statics.define("qx.allowUrlVariants",false);statics.__init();}});qx.Bootstrap.define("qx.bom.client.Engine",{statics:{NAME:"",FULLVERSION:"0.0.0",VERSION:0.0,OPERA:false,WEBKIT:false,GECKO:false,MSHTML:false,__init:function(){var engine="unknown";var version="0.0.0";var agent=navigator.userAgent;if(window.opera){engine="opera";this.OPERA=true;if(/Opera[\s\/]([0-9\.]*)/.test(agent)){version=RegExp.$1.substring(0,3)+"."+RegExp.$1.substring(3);}else{throw new Error("Could not detect Opera version: "+agent+"!");}}else if(navigator.vendor&&(navigator.vendor==="Apple Computer, Inc."||navigator.vendor==="Adobe Systems Incorporated")){engine="webkit";this.WEBKIT=true;if(/AppleWebKit\/([^ ]+)/.test(agent)){version=RegExp.$1;var invalidCharacter=RegExp("[^\\.0-9]").exec(version);if(invalidCharacter){version=version.slice(0,invalidCharacter.index);}}else{throw new Error("Could not detect Webkit version: "+agent+"!");}}else if(window.controllers&&navigator.product==="Gecko"){engine="gecko";this.GECKO=true;if(/rv\:([^\);]+)(\)|;)/.test(agent)){version=RegExp.$1;}else{throw new Error("Could not detect Gecko version: "+agent+"!");}}else if(navigator.cpuClass&&/MSIE\s+([^\);]+)(\)|;)/.test(agent)){engine="mshtml";version=RegExp.$1;this.MSHTML=true;}else{throw new Error("Unsupported client: "+agent+"!");}this.NAME=engine;this.FULLVERSION=version;this.VERSION=parseFloat(version);}},defer:function(statics){statics.__init();}});qx.Bootstrap.define("qx.core.Variant",{statics:{__variants:{},__cache:{},compilerIsSet:function(){return true;},define:function(key,allowedValues,defaultValue){{};if(!this.__variants[key]){this.__variants[key]={};}else{}this.__variants[key].allowedValues=allowedValues;this.__variants[key].defaultValue=defaultValue;},get:function(key){var data=this.__variants[key];{};if(data.value!==undefined){return data.value;}return data.defaultValue;},__init:function(){if(window.qxvariants){for(var key in qxvariants){{};if(!this.__variants[key]){this.__variants[key]={};}this.__variants[key].value=qxvariants[key];}window.qxvariants=undefined;try{delete window.qxvariants;}catch(ex){}this.__loadUrlVariants(this.__variants);}},__loadUrlVariants:function(){if(qx.core.Setting.get("qx.allowUrlVariants")!=true){return;}var urlVariants=document.location.search.slice(1).split("&");for(var i=0;i<urlVariants.length;i++){var variant=urlVariants[i].split(":");if(variant.length!=3||variant[0]!="qxvariant"){continue;}var key=variant[1];if(!this.__variants[key]){this.__variants[key]={};}this.__variants[key].value=decodeURIComponent(variant[2]);}},select:function(key,variantFunctionMap){{};for(var variant in variantFunctionMap){if(this.isSet(key,variant)){return variantFunctionMap[variant];}}if(variantFunctionMap["default"]!==undefined){return variantFunctionMap["default"];}{};},isSet:function(key,variants){var access=key+"$"+variants;if(this.__cache[access]!==undefined){return this.__cache[access];}var retval=false;if(variants.indexOf("|")<0){retval=this.get(key)===variants;}else{var keyParts=variants.split("|");for(var i=0,l=keyParts.length;i<l;i++){if(this.get(key)===keyParts[i]){retval=true;break;}}}this.__cache[access]=retval;return retval;},__isValidArray:function(v){return typeof v==="object"&&v!==null&&v instanceof Array;},__isValidObject:function(v){return typeof v==="object"&&v!==null&&!(v instanceof Array);},__arrayContains:function(arr,obj){for(var i=0,l=arr.length;i<l;i++){if(arr[i]==obj){return true;}}return false;}},defer:function(statics){statics.define("qx.client",["gecko","mshtml","opera","webkit"],qx.bom.client.Engine.NAME);statics.define("qx.debug",["on","off"],"on");statics.define("qx.compatibility",["on","off"],"on");statics.define("qx.eventMonitorNoListeners",["on","off"],"off");statics.define("qx.aspects",["on","off"],"off");statics.define("qx.deprecationWarnings",["on","off"],"on");statics.define("qx.dynamicLocaleSwitch",["on","off"],"on");statics.__init();}});qx.Bootstrap.define("qx.lang.Object",{statics:{isEmpty:function(map){for(var key in map){return false;}return true;},hasMinLength:function(map,length){var i=0;for(var key in map){if((++i)>=length){return true;}}return false;},getLength:function(map){var i=0;for(var key in map){i++;}return i;},_shadowedKeys:["isPrototypeOf","hasOwnProperty","toLocaleString","toString","valueOf"],getKeys:qx.core.Variant.select("qx.client",{"mshtml":function(map){var arr=[];for(var key in map){arr.push(key);}for(var i=0,a=this._shadowedKeys,l=a.length;i<l;i++){if(map.hasOwnProperty(a[i])){arr.push(a[i]);}}return arr;},"default":function(map){var arr=[];for(var key in map){arr.push(key);}return arr;}}),getKeysAsString:function(map){var keys=qx.lang.Object.getKeys(map);if(keys.length==0){return "";}return '"'+keys.join('\", "')+'"';},getValues:function(map){var arr=[];for(var key in map){arr.push(map[key]);}return arr;},mergeWith:function(target,source,overwrite){if(overwrite===undefined){overwrite=true;}for(var key in source){if(overwrite||target[key]===undefined){target[key]=source[key];}}return target;},carefullyMergeWith:function(target,source){return qx.lang.Object.mergeWith(target,source,false);},merge:function(target,varargs){var len=arguments.length;for(var i=1;i<len;i++){qx.lang.Object.mergeWith(target,arguments[i]);}return target;},copy:function(source){var clone={};for(var key in source){clone[key]=source[key];}return clone;},invert:function(map){var result={};for(var key in map){result[map[key].toString()]=key;}return result;},getKeyFromValue:function(obj,value){for(var key in obj){if(obj[key]===value){return key;}}return null;},select:function(key,map){return map[key];},fromArray:function(array){var obj={};for(var i=0,l=array.length;i<l;i++){{};obj[array[i].toString()]=true;}return obj;}}});qx.Bootstrap.define("qx.core.Aspect",{statics:{__registry:[],wrap:function(fullName,fcn,type){var before=[];var after=[];var reg=this.__registry;var entry;for(var i=0;i<reg.length;i++){entry=reg[i];if((entry.type==null||type==entry.type||entry.type=="*")&&(entry.name==null||fullName.match(entry.name))){entry.pos==-1?before.push(entry.fcn):after.push(entry.fcn);}}if(before.length===0&&after.length===0){return fcn;}var wrapper=function(){for(var i=0;i<before.length;i++){before[i].call(this,fullName,fcn,type,arguments);}var ret=fcn.apply(this,arguments);for(var i=0;i<after.length;i++){after[i].call(this,fullName,fcn,type,arguments,ret);}return ret;};if(type!=="static"){wrapper.self=fcn.self;wrapper.base=fcn.base;}fcn.wrapper=wrapper;wrapper.original=fcn;return wrapper;},addAdvice:function(fcn,position,type,name){this.__registry.push({fcn:fcn,pos:position==="before"?-1:1,type:type,name:name});}}});qx.Bootstrap.define("qx.Class",{statics:{define:function(name,config){if(!config){var config={};}if(config.include&&!(config.include instanceof Array)){config.include=[config.include];}if(config.implement&&!(config.implement instanceof Array)){config.implement=[config.implement];}if(!config.hasOwnProperty("extend")&&!config.type){config.type="static";}{};var clazz=this.__createClass(name,config.type,config.extend,config.statics,config.construct,config.destruct);if(config.extend){if(config.properties){this.__addProperties(clazz,config.properties,true);}if(config.members){this.__addMembers(clazz,config.members,true,true,false);}if(config.events){this.__addEvents(clazz,config.events,true);}if(config.include){for(var i=0,l=config.include.length;i<l;i++){this.__addMixin(clazz,config.include[i],false);}}}if(config.settings){for(var key in config.settings){qx.core.Setting.define(key,config.settings[key]);}}if(config.variants){for(var key in config.variants){qx.core.Variant.define(key,config.variants[key].allowedValues,config.variants[key].defaultValue);}}if(config.implement){for(var i=0,l=config.implement.length;i<l;i++){this.__addInterface(clazz,config.implement[i]);}}{};if(config.defer){config.defer.self=clazz;config.defer(clazz,clazz.prototype,{add:function(name,config){var properties={};properties[name]=config;qx.Class.__addProperties(clazz,properties,true);}});}},isDefined:function(name){return this.getByName(name)!==undefined;},getTotalNumber:function(){return qx.lang.Object.getLength(this.$$registry);},getByName:function(name){return this.$$registry[name];},include:function(clazz,mixin){{};qx.Class.__addMixin(clazz,mixin,false);},patch:function(clazz,mixin){{};qx.Class.__addMixin(clazz,mixin,true);},isSubClassOf:function(clazz,superClass){if(!clazz){return false;}if(clazz==superClass){return true;}if(clazz.prototype instanceof superClass){return true;}return false;},getPropertyDefinition:function(clazz,name){while(clazz){if(clazz.$$properties&&clazz.$$properties[name]){return clazz.$$properties[name];}clazz=clazz.superclass;}return null;},getProperties:function(clazz){var list=[];while(clazz){if(clazz.$$properties){list.push.apply(list,qx.lang.Object.getKeys(clazz.$$properties));}clazz=clazz.superclass;}return list;},getByProperty:function(clazz,name){while(clazz){if(clazz.$$properties&&clazz.$$properties[name]){return clazz;}clazz=clazz.superclass;}return null;},hasProperty:function(clazz,name){return !!this.getPropertyDefinition(clazz,name);},getEventType:function(clazz,name){var clazz=clazz.constructor;while(clazz.superclass){if(clazz.$$events&&clazz.$$events[name]!==undefined){return clazz.$$events[name];}clazz=clazz.superclass;}return null;},supportsEvent:function(clazz,name){return !!this.getEventType(clazz,name);},hasOwnMixin:function(clazz,mixin){return clazz.$$includes&&clazz.$$includes.indexOf(mixin)!==-1;},getByMixin:function(clazz,mixin){var list,i,l;while(clazz){if(clazz.$$includes){list=clazz.$$flatIncludes;for(i=0,l=list.length;i<l;i++){if(list[i]===mixin){return clazz;}}}clazz=clazz.superclass;}return null;},getMixins:function(clazz){var list=[];while(clazz){if(clazz.$$includes){list.push.apply(list,clazz.$$flatIncludes);}clazz=clazz.superclass;}return list;},hasMixin:function(clazz,mixin){return !!this.getByMixin(clazz,mixin);},hasOwnInterface:function(clazz,iface){return clazz.$$implements&&clazz.$$implements.indexOf(iface)!==-1;},getByInterface:function(clazz,iface){var list,i,l;while(clazz){if(clazz.$$implements){list=clazz.$$flatImplements;for(i=0,l=list.length;i<l;i++){if(list[i]===iface){return clazz;}}}clazz=clazz.superclass;}return null;},getInterfaces:function(clazz){var list=[];while(clazz){if(clazz.$$implements){list.push.apply(list,clazz.$$flatImplements);}clazz=clazz.superclass;}return list;},hasInterface:function(clazz,iface){return !!this.getByInterface(clazz,iface);},implementsInterface:function(clazz,iface){if(this.hasInterface(clazz,iface)){return true;}try{qx.Interface.assert(clazz,iface,false);return true;}catch(ex){}return false;},getInstance:function(){if(!this.$$instance){this.$$allowconstruct=true;this.$$instance=new this;delete this.$$allowconstruct;}return this.$$instance;},genericToString:function(){return "[Class "+this.classname+"]";},$$registry:qx.Bootstrap.$$registry,__allowedKeys:null,__staticAllowedKeys:null,__validateConfig:function(){},__validateAbstractInterfaces:function(){},__createClass:function(name,type,extend,statics,construct,destruct){var clazz;if(!extend&&qx.core.Variant.isSet("qx.aspects","off")){clazz=statics||{};}else{clazz={};if(extend){if(!construct){construct=this.__createDefaultConstructor();}clazz=this.__wrapConstructor(construct,name,type);}if(statics){var key;for(var i=0,a=qx.lang.Object.getKeys(statics),l=a.length;i<l;i++){key=a[i];if(qx.core.Variant.isSet("qx.aspects","on")){var staticValue=statics[key];if(staticValue instanceof Function){staticValue=qx.core.Aspect.wrap(name+"."+key,staticValue,"static");}clazz[key]=staticValue;}else{clazz[key]=statics[key];}}}}var basename=qx.Bootstrap.createNamespace(name,clazz,false);clazz.name=clazz.classname=name;clazz.basename=basename;clazz.$$type="Class";if(type){clazz.$$classtype=type;}if(!clazz.hasOwnProperty("toString")){clazz.toString=this.genericToString;}if(extend){var superproto=extend.prototype;var helper=this.__createEmptyFunction();helper.prototype=superproto;var proto=new helper;clazz.prototype=proto;proto.name=proto.classname=name;proto.basename=basename;construct.base=clazz.superclass=extend;construct.self=clazz.constructor=proto.constructor=clazz;if(destruct){if(qx.core.Variant.isSet("qx.aspects","on")){destruct=qx.core.Aspect.wrap(name,destruct,"destructor");}clazz.$$destructor=destruct;}}this.$$registry[name]=clazz;return clazz;},__addEvents:function(clazz,events,patch){var key,key;if(clazz.$$events){for(var key in events){clazz.$$events[key]=events[key];}}else{clazz.$$events=events;}},__addProperties:function(clazz,properties,patch){var config;if(patch===undefined){patch=false;}var attach=!!clazz.$$propertiesAttached;for(var name in properties){config=properties[name];{};config.name=name;if(!config.refine){if(clazz.$$properties===undefined){clazz.$$properties={};}clazz.$$properties[name]=config;}if(config.init!==undefined){clazz.prototype["$$init_"+name]=config.init;}if(config.event!==undefined){var event={};event[config.event]="qx.event.type.Data";this.__addEvents(clazz,event,patch);}if(config.inheritable){qx.core.Property.$$inheritable[name]=true;}if(attach){qx.core.Property.attachMethods(clazz,name,config);}}},__validateProperty:null,__addMembers:function(clazz,members,patch,base,wrap){var proto=clazz.prototype;var key,member;for(var i=0,a=qx.lang.Object.getKeys(members),l=a.length;i<l;i++){key=a[i];member=members[key];{};if(base!==false&&member instanceof Function&&member.$$type==null){if(wrap==true){member=this.__mixinMemberWrapper(member,proto[key]);}else{if(proto[key]){member.base=proto[key];}member.self=clazz;}if(qx.core.Variant.isSet("qx.aspects","on")){member=qx.core.Aspect.wrap(clazz.classname+"."+key,member,"member");}}proto[key]=member;}},__mixinMemberWrapper:function(member,base){if(base){return function(){var oldBase=member.base;member.base=base;var retval=member.apply(this,arguments);member.base=oldBase;return retval;};}else{return member;}},__addInterface:function(clazz,iface){{};var list=qx.Interface.flatten([iface]);if(clazz.$$implements){clazz.$$implements.push(iface);clazz.$$flatImplements.push.apply(clazz.$$flatImplements,list);}else{clazz.$$implements=[iface];clazz.$$flatImplements=list;}},__addMixin:function(clazz,mixin,patch){{};if(this.hasMixin(clazz,mixin)){qx.log.Logger.warn('Mixin "'+mixin.name+'" is already included into Class "'+clazz.classname+'" by class: '+this.getByMixin(clazz,mixin).classname+'!');return;}var list=qx.Mixin.flatten([mixin]);var entry;for(var i=0,l=list.length;i<l;i++){entry=list[i];if(entry.$$events){this.__addEvents(clazz,entry.$$events,patch);}if(entry.$$properties){this.__addProperties(clazz,entry.$$properties,patch);}if(entry.$$members){this.__addMembers(clazz,entry.$$members,patch,patch,patch);}}if(clazz.$$includes){clazz.$$includes.push(mixin);clazz.$$flatIncludes.push.apply(clazz.$$flatIncludes,list);}else{clazz.$$includes=[mixin];clazz.$$flatIncludes=list;}},__createDefaultConstructor:function(){function defaultConstructor(){arguments.callee.base.apply(this,arguments);}return defaultConstructor;},__createEmptyFunction:function(){return function(){};},__wrapConstructor:function(construct,name,type){var wrapper=function(){var clazz=arguments.callee.constructor;{};if(!clazz.$$propertiesAttached){qx.core.Property.attach(clazz);}var retval=clazz.$$original.apply(this,arguments);if(clazz.$$includes){var mixins=clazz.$$flatIncludes;for(var i=0,l=mixins.length;i<l;i++){if(mixins[i].$$constructor){mixins[i].$$constructor.apply(this,arguments);}}}if(this.classname===name.classname){this.$$initialized=true;}return retval;};if(qx.core.Variant.isSet("qx.aspects","on")){var aspectWrapper=qx.core.Aspect.wrap(name,wrapper,"constructor");wrapper.$$original=construct;wrapper.constructor=aspectWrapper;wrapper=aspectWrapper;}if(type==="singleton"){wrapper.getInstance=this.getInstance;}wrapper.$$original=construct;construct.wrapper=wrapper;return wrapper;}},defer:function(statics){for(var classname in qx.Bootstrap.$$registry){var statics=qx.Bootstrap.$$registry[classname];for(var key in statics){if(statics[key] instanceof Function){statics[key]=qx.core.Aspect.wrap(classname+"."+key,statics[key],"static");}}}}});qx.Bootstrap.define("qx.bom.Event",{statics:{addNativeListener:qx.core.Variant.select("qx.client",{"mshtml":function(target,type,listener){target.attachEvent("on"+type,listener);},"default":function(target,type,listener){target.addEventListener(type,listener,false);}}),removeNativeListener:qx.core.Variant.select("qx.client",{"mshtml":function(target,type,listener){target.detachEvent("on"+type,listener);},"default":function(target,type,listener){target.removeEventListener(type,listener,false);}}),getTarget:function(e){return e.target||e.srcElement;},getRelatedTarget:qx.core.Variant.select("qx.client",{"mshtml":function(e){if(e.type==="mouseover"){return e.fromEvent;}else{return e.toElement;}},"default":function(e){return e.relatedTarget;}}),preventDefault:qx.core.Variant.select("qx.client",{"gecko":function(e){if(qx.bom.client.Engine.VERSION>=1.9&&e.type=="mousedown"&&e.button==2){return;}e.preventDefault();try{e.keyCode=0;}catch(e){}},"mshtml":function(e){try{e.keyCode=0;}catch(e){}e.returnValue=false;},"default":function(e){e.preventDefault();}}),stopPropagation:function(e){if(e.stopPropagation){e.stopPropagation();}e.cancelBubble=true;}}});qx.Bootstrap.define("qx.event.Manager",{construct:function(win){this.__window=win;this.__disposeWrapper=qx.lang.Function.bind(this.dispose,this);qx.bom.Event.addNativeListener(win,"unload",this.__disposeWrapper);this.__listeners={};this.__handlers={};this.__dispatchers={};this.__handlerCache={};},members:{dispose:function(){qx.bom.Event.removeNativeListener(this.__window,"unload",this.__disposeWrapper);qx.event.Registration.removeManager(this);this.__listeners=this.__window=this.__handlers=this.__dispatchers=this.__disposeWrapper=this.__handlerCache=null;},getWindow:function(){return this.__window;},getHandler:function(clazz){var handler=this.__handlers[clazz.classname];if(handler){return handler;}return this.__handlers[clazz.classname]=new clazz(this);},getDispatcher:function(clazz){var dispatcher=this.__dispatchers[clazz.classname];if(dispatcher){return dispatcher;}return this.__dispatchers[clazz.classname]=new clazz(this);},getListeners:function(target,type,capture){var targetKey=qx.core.ObjectRegistry.toHashCode(target);var targetMap=this.__listeners[targetKey];if(!targetMap){return null;}var entryKey=type+(capture?"|capture":"|bubble");var entryList=targetMap[entryKey];return entryList?entryList.concat():null;},hasListener:function(target,type,capture){{};var targetKey=qx.core.ObjectRegistry.toHashCode(target);var targetMap=this.__listeners[targetKey];if(!targetMap){return false;}var entryKey=type+(capture?"|capture":"|bubble");var entryList=targetMap[entryKey];if(!entryList){return false;}return entryList.length>0;},importListeners:function(target,list){{};var targetKey=qx.core.ObjectRegistry.toHashCode(target);var targetMap=this.__listeners[targetKey]={};for(var listKey in list){var item=list[listKey];var entryKey=item.type+(item.capture?"|capture":"|bubble");var entryList=targetMap[entryKey];if(!entryList){entryList=targetMap[entryKey]=[];this.__registerAtHandler(target,item.type,item.capture);}entryList.push({handler:item.listener,context:item.self});}},addListener:function(target,type,listener,self,capture){var msg;var targetKey=qx.core.ObjectRegistry.toHashCode(target);var targetMap=this.__listeners[targetKey];if(!targetMap){targetMap=this.__listeners[targetKey]={};}var entryKey=type+(capture?"|capture":"|bubble");var entryList=targetMap[entryKey];if(!entryList){entryList=targetMap[entryKey]=[];}if(entryList.length===0){this.__registerAtHandler(target,type,capture);}entryList.push({handler:listener,context:self});},_findHandler:function(target,type){var key;var isDomNode=false;var isWindow=false;var isObject=false;if(target.nodeType===1){isDomNode=true;key="DOM_"+target.tagName.toLowerCase()+"_"+type;}else if(target==this.__window){isWindow=true;key="WIN_"+type;}else if(target.classname){isObject=true;key="QX_"+target.classname+"_"+type;}else{key="UNKNOWN_"+target+"_"+type;}var cache=this.__handlerCache;if(cache[key]){return cache[key];}var classes=qx.event.Registration.getHandlers();var instance;for(var i=0,l=classes.length;i<l;i++){var clazz=classes[i];var supportedTypes=clazz.SUPPORTED_TYPES;if(supportedTypes&&!supportedTypes[type]){continue;}var IEventHandler=qx.event.IEventHandler;var targetCheck=clazz.TARGET_CHECK;if(targetCheck){if(targetCheck===IEventHandler.TARGET_DOMNODE&&!isDomNode){continue;}else if(targetCheck===IEventHandler.TARGET_WINDOW&&!isWindow){continue;}else if(targetCheck===IEventHandler.TARGET_OBJECT&&!isObject){continue;}}instance=this.getHandler(classes[i]);if(clazz.IGNORE_CAN_HANDLE||instance.canHandleEvent(target,type)){cache[key]=instance;return instance;}}return null;},__registerAtHandler:function(target,type,capture){var handler=this._findHandler(target,type);if(handler){handler.registerEvent(target,type,capture);return;}{};},removeListener:function(target,type,listener,self,capture){var msg;var targetKey=qx.core.ObjectRegistry.toHashCode(target);var targetMap=this.__listeners[targetKey];if(!targetMap){return false;}var entryKey=type+(capture?"|capture":"|bubble");var entryList=targetMap[entryKey];if(!entryList){return false;}for(var i=0,l=entryList.length;i<l;i++){var entry=entryList[i];if(entry.handler===listener&&entry.context===self){qx.lang.Array.removeAt(entryList,i);if(entryList.length==0){this.__unregisterAtHandler(target,type,capture);}return true;}}return false;},removeAllListeners:function(target){var targetKey=qx.core.ObjectRegistry.toHashCode(target);var targetMap=this.__listeners[targetKey];if(!targetMap){return false;}var split,type,capture;for(var entryKey in targetMap){if(targetMap[entryKey].length>0){split=entryKey.split('|');type=split[0];capture=split[1]==="capture";this.__unregisterAtHandler(target,type,capture);}}delete this.__listeners[targetKey];return true;},__unregisterAtHandler:function(target,type,capture){var handler=this._findHandler(target,type);if(handler){handler.unregisterEvent(target,type,capture);return;}{};},dispatchEvent:function(target,event){var msg;var type=event.getType();if(!event.getBubbles()&&!this.hasListener(target,type)){qx.event.Pool.getInstance().poolObject(event);return true;}if(!event.getTarget()){event.setTarget(target);}var classes=qx.event.Registration.getDispatchers();var instance;var dispatched=false;for(var i=0,l=classes.length;i<l;i++){instance=this.getDispatcher(classes[i]);if(instance.canDispatchEvent(target,event,type)){instance.dispatchEvent(target,event,type);dispatched=true;break;}}if(!dispatched){qx.log.Logger.error(this,"No dispatcher can handle event of type "+type+" on "+target);return true;}var preventDefault=event.getDefaultPrevented();qx.event.Pool.getInstance().poolObject(event);return !preventDefault;}}});qx.Class.define("qx.dom.Node",{statics:{ELEMENT:1,ATTRIBUTE:2,TEXT:3,CDATA_SECTION:4,ENTITY_REFERENCE:5,ENTITY:6,PROCESSING_INSTRUCTION:7,COMMENT:8,DOCUMENT:9,DOCUMENT_TYPE:10,DOCUMENT_FRAGMENT:11,NOTATION:12,getDocument:function(node){if(this.isDocument(node)){return node;}return node.ownerDocument||node.document||null;},getWindow:qx.core.Variant.select("qx.client",{"mshtml":function(node){return this.getDocument(node).parentWindow;},"default":function(node){return this.getDocument(node).defaultView;}}),getDocumentElement:function(node){return this.getDocument(node).documentElement;},getBodyElement:function(node){return this.getDocument(node).body;},isElement:function(node){return !!(node&&node.nodeType===qx.dom.Node.ELEMENT);},isDocument:function(node){return !!(node&&node.nodeType===qx.dom.Node.DOCUMENT);},isText:function(node){return !!(node&&node.nodeType===qx.dom.Node.TEXT);},isWindow:function(obj){return !!(typeof obj==="object"&&obj&&obj.Array);},getText:function(node){if(!node||!node.nodeType){return null;}switch(node.nodeType){case 1:var i,a=[],nodes=node.childNodes,length=nodes.length;for(i=0;i<length;i++){a[i]=this.getText(nodes[i]);}return a.join("");case 2:return node.nodeValue;break;case 3:return node.nodeValue;break;}return null;}}});qx.Bootstrap.define("qx.lang.Array",{statics:{fromArguments:function(args,offset){return Array.prototype.slice.call(args,offset||0);},fromCollection:function(coll){if(qx.core.Variant.isSet("qx.client","mshtml")){if(coll.item){var arr=[];for(var i=0,l=coll.length;i<l;i++){arr[i]=coll[i];}return arr;}}return Array.prototype.slice.call(coll,0);},fromShortHand:function(input){var len=input.length;var result=qx.lang.Array.copy(input);switch(len){case 1:result[1]=result[2]=result[3]=result[0];break;case 2:result[2]=result[0];case 3:result[3]=result[1];}return result;},copy:function(arr){return arr.concat();},clone:function(arr){return arr.concat();},getLast:function(arr){return arr[arr.length-1];},getFirst:function(arr){return arr[0];},insertAt:function(arr,obj,i){arr.splice(i,0,obj);return arr;},insertBefore:function(arr,obj,obj2){var i=arr.indexOf(obj2);if(i==-1){arr.push(obj);}else{arr.splice(i,0,obj);}return arr;},insertAfter:function(arr,obj,obj2){var i=arr.indexOf(obj2);if(i==-1||i==(arr.length-1)){arr.push(obj);}else{arr.splice(i+1,0,obj);}return arr;},removeAt:function(arr,i){return arr.splice(i,1)[0];},removeAll:function(arr){return arr.length=0;},append:function(arr,a){{};Array.prototype.push.apply(arr,a);return arr;},remove:function(arr,obj){var i=arr.indexOf(obj);if(i!=-1){arr.splice(i,1);return obj;}},contains:function(arr,obj){return arr.indexOf(obj)!==-1;},equals:function(arr1,arr2){var length=arr1.length;if(length!==arr2.length){return false;}for(var i=0;i<length;i++){if(arr1[i]!==arr2[i]){return false;}}return true;},sum:function(arr){var result=0;for(var i=0,l=arr.length;i<l;i++){result+=arr[i];}return result;},max:function(arr){{};var i,len=arr.length,result=arr[0];for(i=1;i<len;i++){if(arr[i]>result){result=arr[i];}}return result===undefined?null:result;},min:function(arr){{};var i,len=arr.length,result=arr[0];for(i=1;i<len;i++){if(arr[i]<result){result=arr[i];}}return result===undefined?null:result;}}});qx.Bootstrap.define("qx.lang.Function",{statics:{getCaller:function(args){return args.caller?args.caller.callee:args.callee.caller;},getName:function(fcn){if(fcn.$$original){return fcn.classname+":constructor wrapper";}if(fcn.wrapper){return fcn.wrapper.classname+":constructor";}if(fcn.classname){return fcn.classname+":constructor";}if(fcn.mixin){for(var key in fcn.mixin.$$members){if(fcn.mixin.$$members[key]==fcn){return fcn.mixin.name+":"+key;}}for(var key in fcn.mixin){if(fcn.mixin[key]==fcn){return fcn.mixin.name+":"+key;}}}if(fcn.self){var clazz=fcn.self.constructor;if(clazz){for(var key in clazz.prototype){if(clazz.prototype[key]==fcn){return clazz.classname+":"+key;}}for(var key in clazz){if(clazz[key]==fcn){return clazz.classname+":"+key;}}}}var fcnReResult=fcn.toString().match(/(function\s*\w*\(.*?\))/);if(fcnReResult&&fcnReResult.length>=1&&fcnReResult[1]){return fcnReResult[1];}var fcnReResult=fcn.toString().match(/(function\s*\(.*?\))/);if(fcnReResult&&fcnReResult.length>=1&&fcnReResult[1]){return "anonymous: "+fcnReResult[1];}return 'anonymous';},globalEval:function(data){if(window.execScript){return window.execScript(data);}else{return eval.call(window,data);}},returnTrue:function(){return true;},returnFalse:function(){return false;},returnNull:function(){return null;},returnThis:function(){return this;},returnZero:function(){return 0;},create:function(func,options){{};if(!options){return func;}if(!(options.self||options.args||options.delay!=null||options.periodical!=null||options.attempt)){return func;}return function(event){var args=qx.lang.Array.fromArguments(arguments);if(options.args){args=options.args.concat(args);}if(options.delay||options.periodical){var returns=function(){return func.apply(options.self||this,args);};if(options.delay){return setTimeout(returns,options.delay);}if(options.periodical){return setInterval(returns,options.periodical);}}else if(options.attempt){var ret=false;try{ret=func.apply(options.self||this,args);}catch(ex){}return ret;}else{return func.apply(options.self||this,args);}};},bind:function(func,self,varargs){return this.create(func,{self:self,args:varargs!==undefined?qx.lang.Array.fromArguments(arguments,2):null});},curry:function(func,varargs){return this.create(func,{args:varargs!==undefined?qx.lang.Array.fromArguments(arguments,1):null});},listener:function(func,self,varargs){if(varargs===undefined){return function(event){return func.call(self||this,event||window.event);};}else{var optargs=qx.lang.Array.fromArguments(arguments,2);return function(event){var args=[event||window.event];args.push.apply(args,optargs);func.apply(self||this,args);};}},attempt:function(func,self,varargs){return this.create(func,{self:self,attempt:true,args:varargs!==undefined?qx.lang.Array.fromArguments(arguments,2):null})();},delay:function(func,delay,self,varargs){return this.create(func,{delay:delay,self:self,args:varargs!==undefined?qx.lang.Array.fromArguments(arguments,3):null})();},periodical:function(func,interval,self,varargs){return this.create(func,{periodical:interval,self:self,args:varargs!==undefined?qx.lang.Array.fromArguments(arguments,3):null})();}}});qx.Bootstrap.define("qx.event.Registration",{statics:{__managers:{},getManager:function(target){if(qx.dom.Node.isWindow(target)){var win=target;}else if(qx.dom.Node.isElement(target)){var win=qx.dom.Node.getWindow(target);}else{var win=window;}var id=qx.core.ObjectRegistry.toHashCode(win);var manager=this.__managers[id];if(!manager){manager=new qx.event.Manager(win);this.__managers[id]=manager;}return manager;},removeManager:function(mgr){var id=qx.core.ObjectRegistry.toHashCode(mgr.getWindow());delete this.__managers[id];},addListener:function(target,type,listener,self,capture){this.getManager(target).addListener(target,type,listener,self,capture);},removeListener:function(target,type,listener,self,capture){this.getManager(target).removeListener(target,type,listener,self,capture);},removeAllListeners:function(target){this.getManager(target).removeAllListeners(target);},hasListener:function(target,type,capture){return this.getManager(target).hasListener(target,type,capture);},createEvent:function(type,clazz,args){{};if(clazz==null){clazz=qx.event.type.Event;}var obj=qx.event.Pool.getInstance().getObject(clazz);if(!obj){return;}args?obj.init.apply(obj,args):obj.init();if(type){obj.setType(type);}return obj;},dispatchEvent:function(target,event){return this.getManager(target).dispatchEvent(target,event);},fireEvent:function(target,type,clazz,args){var msg;var evt=this.createEvent(type,clazz||null,args);return this.getManager(target).dispatchEvent(target,evt);},fireNonBubblingEvent:function(target,type,clazz,args){{};var mgr=this.getManager(target);if(!mgr.hasListener(target,type,false)){return true;}var evt=this.createEvent(type,clazz||null,args);return mgr.dispatchEvent(target,evt);},PRIORITY_FIRST:-32000,PRIORITY_NORMAL:0,PRIORITY_LAST:32000,__handlers:[],addHandler:function(handler){{};this.__handlers.push(handler);this.__handlers.sort(function(a,b){return a.PRIORITY-b.PRIORITY;});},getHandlers:function(){return this.__handlers;},__dispatchers:[],addDispatcher:function(dispatcher,priority){{};this.__dispatchers.push(dispatcher);this.__dispatchers.sort(function(a,b){return a.PRIORITY-b.PRIORITY;});},getDispatchers:function(){return this.__dispatchers;}}});qx.Class.define("qx.core.Property",{statics:{__checks:{"Boolean":'qx.core.Assert.assertBoolean(value, msg) || true',"String":'qx.core.Assert.assertString(value, msg) || true',"Number":'qx.core.Assert.assertNumber(value, msg) || true',"Integer":'qx.core.Assert.assertInteger(value, msg) || true',"PositiveNumber":'qx.core.Assert.assertPositiveNumber(value, msg) || true',"PositiveInteger":'qx.core.Assert.assertPositiveInteger(value, msg) || true',"Error":'qx.core.Assert.assertInstance(value, Error, msg) || true',"RegExp":'qx.core.Assert.assertInstance(value, RegExp, msg) || true',"Object":'qx.core.Assert.assertObject(value, msg) || true',"Array":'qx.core.Assert.assertArray(value, msg) || true',"Map":'qx.core.Assert.assertMap(value, msg) || true',"Function":'qx.core.Assert.assertFunction(value, msg) || true',"Date":'qx.core.Assert.assertInstance(value, Date, msg) || true',"Node":'value !== null && value.nodeType !== undefined',"Element":'value !== null && value.nodeType === 1 && value.attributes',"Document":'value !== null && value.nodeType === 9 && value.documentElement',"Window":'value !== null && value.document',"Event":'value !== null && value.type !== undefined',"Class":'value !== null && value.$$type === "Class"',"Mixin":'value !== null && value.$$type === "Mixin"',"Interface":'value !== null && value.$$type === "Interface"',"Theme":'value !== null && value.$$type === "Theme"',"Color":'(typeof value === "string" || value instanceof String) && qx.util.ColorUtil.isValidPropertyValue(value)',"Decorator":'value !== null && qx.theme.manager.Decoration.getInstance().isValidPropertyValue(value)',"Font":'value !== null && qx.theme.manager.Font.getInstance().isDynamic(value)'},__dispose:{"Object":true,"Array":true,"Map":true,"Function":true,"Date":true,"Node":true,"Element":true,"Document":true,"Window":true,"Event":true,"Class":true,"Mixin":true,"Interface":true,"Theme":true,"Font":true,"Decorator":true},$$inherit:"inherit",$$store:{runtime:{},user:{},theme:{},inherit:{},init:{},useinit:{}},$$method:{get:{},set:{},reset:{},init:{},refresh:{},setRuntime:{},resetRuntime:{},setThemed:{},resetThemed:{}},$$allowedKeys:{name:"string",dispose:"boolean",inheritable:"boolean",nullable:"boolean",themeable:"boolean",refine:"boolean",init:null,apply:"string",event:"string",check:null,transform:"string",deferredInit:"boolean"},$$allowedGroupKeys:{name:"string",group:"object",mode:"string",themeable:"boolean"},$$inheritable:{},refresh:function(widget){var parent=widget.getLayoutParent();if(parent){var clazz=widget.constructor;var inherit=this.$$store.inherit;var init=this.$$store.init;var refresh=this.$$method.refresh;var properties;var value;{};while(clazz){properties=clazz.$$properties;if(properties){for(var name in this.$$inheritable){if(properties[name]&&widget[refresh[name]]){value=parent[inherit[name]];if(value===undefined){value=parent[init[name]];}{};widget[refresh[name]](value);}}}clazz=clazz.superclass;}}},attach:function(clazz){var properties=clazz.$$properties;if(properties){for(var name in properties){this.attachMethods(clazz,name,properties[name]);}}clazz.$$propertiesAttached=true;},attachMethods:function(clazz,name,config){config.group?this.__attachGroupMethods(clazz,config,name):this.__attachPropertyMethods(clazz,config,name);},__attachGroupMethods:function(clazz,config,name){var upname=qx.lang.String.firstUp(name);var members=clazz.prototype;var themeable=config.themeable===true;{};var setter=[];var resetter=[];if(themeable){var styler=[];var unstyler=[];}var argHandler="var a=arguments[0] instanceof Array?arguments[0]:arguments;";setter.push(argHandler);if(themeable){styler.push(argHandler);}if(config.mode=="shorthand"){var shorthand="a=qx.lang.Array.fromShortHand(qx.lang.Array.fromArguments(a));";setter.push(shorthand);if(themeable){styler.push(shorthand);}}for(var i=0,a=config.group,l=a.length;i<l;i++){{};setter.push("this.",this.$$method.set[a[i]],"(a[",i,"]);");resetter.push("this.",this.$$method.reset[a[i]],"();");if(themeable){{};styler.push("this.",this.$$method.setThemed[a[i]],"(a[",i,"]);");unstyler.push("this.",this.$$method.resetThemed[a[i]],"();");}}this.$$method.set[name]="set"+upname;members[this.$$method.set[name]]=new Function(setter.join(""));this.$$method.reset[name]="reset"+upname;members[this.$$method.reset[name]]=new Function(resetter.join(""));if(themeable){this.$$method.setThemed[name]="setThemed"+upname;members[this.$$method.setThemed[name]]=new Function(styler.join(""));this.$$method.resetThemed[name]="resetThemed"+upname;members[this.$$method.resetThemed[name]]=new Function(unstyler.join(""));}},__attachPropertyMethods:function(clazz,config,name){var upname=qx.lang.String.firstUp(name);var members=clazz.prototype;{};if(config.dispose===undefined&&typeof config.check==="string"){config.dispose=this.__dispose[config.check]||qx.Class.isDefined(config.check)||qx.Interface.isDefined(config.check);}var method=this.$$method;var store=this.$$store;store.runtime[name]="$$runtime_"+name;store.user[name]="$$user_"+name;store.theme[name]="$$theme_"+name;store.init[name]="$$init_"+name;store.inherit[name]="$$inherit_"+name;store.useinit[name]="$$useinit_"+name;method.get[name]="get"+upname;members[method.get[name]]=function(){return qx.core.Property.executeOptimizedGetter(this,clazz,name,"get");};method.set[name]="set"+upname;members[method.set[name]]=function(value){return qx.core.Property.executeOptimizedSetter(this,clazz,name,"set",arguments);};method.reset[name]="reset"+upname;members[method.reset[name]]=function(){return qx.core.Property.executeOptimizedSetter(this,clazz,name,"reset");};if(config.inheritable||config.apply||config.event||config.deferredInit){method.init[name]="init"+upname;members[method.init[name]]=function(value){return qx.core.Property.executeOptimizedSetter(this,clazz,name,"init",arguments);};}if(config.inheritable){method.refresh[name]="refresh"+upname;members[method.refresh[name]]=function(value){return qx.core.Property.executeOptimizedSetter(this,clazz,name,"refresh",arguments);};}method.setRuntime[name]="setRuntime"+upname;members[method.setRuntime[name]]=function(value){return qx.core.Property.executeOptimizedSetter(this,clazz,name,"setRuntime",arguments);};method.resetRuntime[name]="resetRuntime"+upname;members[method.resetRuntime[name]]=function(){return qx.core.Property.executeOptimizedSetter(this,clazz,name,"resetRuntime");};if(config.themeable){method.setThemed[name]="setThemed"+upname;members[method.setThemed[name]]=function(value){return qx.core.Property.executeOptimizedSetter(this,clazz,name,"setThemed",arguments);};method.resetThemed[name]="resetThemed"+upname;members[method.resetThemed[name]]=function(){return qx.core.Property.executeOptimizedSetter(this,clazz,name,"resetThemed");};}if(config.check==="Boolean"){members["toggle"+upname]=new Function("return this."+method.set[name]+"(!this."+method.get[name]+"())");members["is"+upname]=new Function("return this."+method.get[name]+"()");}},__errors:{0:'Could not change or apply init value after constructing phase!',1:'Requires exactly one argument!',2:'Undefined value is not allowed!',3:'Does not allow any arguments!',4:'Null value is not allowed!',5:'Is invalid!'},error:function(obj,id,property,variant,value){var classname=obj.constructor.classname;var msg="Error in property "+property+" of class "+classname+" in method "+this.$$method[variant][property]+" with incoming value '"+value+"': ";throw new Error(msg+(this.__errors[id]||"Unknown reason: "+id));},__unwrapFunctionFromCode:function(instance,members,name,variant,code,args){var store=this.$$method[variant][name];{members[store]=new Function("value",code.join(""));};if(qx.core.Variant.isSet("qx.aspects","on")){members[store]=qx.core.Aspect.wrap(instance.classname+"."+store,members[store],"property");}if(args===undefined){return instance[store]();}else{return instance[store](args[0]);}},executeOptimizedGetter:function(instance,clazz,name,variant){var config=clazz.$$properties[name];var members=clazz.prototype;var code=[];var store=this.$$store;code.push('if(this.',store.runtime[name],'!==undefined)');code.push('return this.',store.runtime[name],';');if(config.inheritable){code.push('else if(this.',store.inherit[name],'!==undefined)');code.push('return this.',store.inherit[name],';');code.push('else ');}code.push('if(this.',store.user[name],'!==undefined)');code.push('return this.',store.user[name],';');if(config.themeable){code.push('else if(this.',store.theme[name],'!==undefined)');code.push('return this.',store.theme[name],';');}if(config.deferredInit&&config.init===undefined){code.push('else if(this.',store.init[name],'!==undefined)');code.push('return this.',store.init[name],';');}code.push('else ');if(config.init!==undefined){if(config.inheritable){code.push('var init=this.',store.init[name],';');if(config.nullable){code.push('if(init==qx.core.Property.$$inherit)init=null;');}else if(config.init!==undefined){code.push('return this.',store.init[name],';');}else{code.push('if(init==qx.core.Property.$$inherit)throw new Error("Inheritable property ',name,' of an instance of ',clazz.classname,' is not (yet) ready!");');}code.push('return init;');}else{code.push('return this.',store.init[name],';');}}else if(config.inheritable||config.nullable){code.push('return null;');}else{code.push('throw new Error("Property ',name,' of an instance of ',clazz.classname,' is not (yet) ready!");');}return this.__unwrapFunctionFromCode(instance,members,name,variant,code);},executeOptimizedSetter:function(instance,clazz,name,variant,args){var config=clazz.$$properties[name];var members=clazz.prototype;var code=[];var incomingValue=variant==="set"||variant==="setThemed"||variant==="setRuntime"||(variant==="init"&&config.init===undefined);var resetValue=variant==="reset"||variant==="resetThemed"||variant==="resetRuntime";var hasCallback=config.apply||config.event||config.inheritable;if(variant==="setRuntime"||variant==="resetRuntime"){var store=this.$$store.runtime[name];}else if(variant==="setThemed"||variant==="resetThemed"){var store=this.$$store.theme[name];}else if(variant==="init"){var store=this.$$store.init[name];}else{var store=this.$$store.user[name];}{if(!config.nullable||config.check||config.inheritable){code.push('var prop=qx.core.Property;');}if(variant==="set"){code.push('if(value===undefined)prop.error(this,2,"',name,'","',variant,'",value);');}};if(incomingValue){if(config.transform){code.push('value=this.',config.transform,'(value);');}}if(hasCallback){if(incomingValue){code.push('if(this.',store,'===value)return value;');}else if(resetValue){code.push('if(this.',store,'===undefined)return;');}}if(config.inheritable){code.push('var inherit=prop.$$inherit;');}{};if(!hasCallback){if(variant==="setRuntime"){code.push('this.',this.$$store.runtime[name],'=value;');}else if(variant==="resetRuntime"){code.push('if(this.',this.$$store.runtime[name],'!==undefined)');code.push('delete this.',this.$$store.runtime[name],';');}else if(variant==="set"){code.push('this.',this.$$store.user[name],'=value;');}else if(variant==="reset"){code.push('if(this.',this.$$store.user[name],'!==undefined)');code.push('delete this.',this.$$store.user[name],';');}else if(variant==="setThemed"){code.push('this.',this.$$store.theme[name],'=value;');}else if(variant==="resetThemed"){code.push('if(this.',this.$$store.theme[name],'!==undefined)');code.push('delete this.',this.$$store.theme[name],';');}else if(variant==="init"&&incomingValue){code.push('this.',this.$$store.init[name],'=value;');}}else{if(config.inheritable){code.push('var computed, old=this.',this.$$store.inherit[name],';');}else{code.push('var computed, old;');}code.push('if(this.',this.$$store.runtime[name],'!==undefined){');if(variant==="setRuntime"){code.push('computed=this.',this.$$store.runtime[name],'=value;');}else if(variant==="resetRuntime"){code.push('delete this.',this.$$store.runtime[name],';');code.push('if(this.',this.$$store.user[name],'!==undefined)');code.push('computed=this.',this.$$store.user[name],';');code.push('else if(this.',this.$$store.theme[name],'!==undefined)');code.push('computed=this.',this.$$store.theme[name],';');code.push('else if(this.',this.$$store.init[name],'!==undefined){');code.push('computed=this.',this.$$store.init[name],';');code.push('this.',this.$$store.useinit[name],'=true;');code.push('}');}else{code.push('old=computed=this.',this.$$store.runtime[name],';');if(variant==="set"){code.push('this.',this.$$store.user[name],'=value;');}else if(variant==="reset"){code.push('delete this.',this.$$store.user[name],';');}else if(variant==="setThemed"){code.push('this.',this.$$store.theme[name],'=value;');}else if(variant==="resetThemed"){code.push('delete this.',this.$$store.theme[name],';');}else if(variant==="init"&&incomingValue){code.push('this.',this.$$store.init[name],'=value;');}}code.push('}');code.push('else if(this.',this.$$store.user[name],'!==undefined){');if(variant==="set"){if(!config.inheritable){code.push('old=this.',this.$$store.user[name],';');}code.push('computed=this.',this.$$store.user[name],'=value;');}else if(variant==="reset"){if(!config.inheritable){code.push('old=this.',this.$$store.user[name],';');}code.push('delete this.',this.$$store.user[name],';');code.push('if(this.',this.$$store.runtime[name],'!==undefined)');code.push('computed=this.',this.$$store.runtime[name],';');code.push('if(this.',this.$$store.theme[name],'!==undefined)');code.push('computed=this.',this.$$store.theme[name],';');code.push('else if(this.',this.$$store.init[name],'!==undefined){');code.push('computed=this.',this.$$store.init[name],';');code.push('this.',this.$$store.useinit[name],'=true;');code.push('}');}else{if(variant==="setRuntime"){code.push('computed=this.',this.$$store.runtime[name],'=value;');}else if(config.inheritable){code.push('computed=this.',this.$$store.user[name],';');}else{code.push('old=computed=this.',this.$$store.user[name],';');}if(variant==="setThemed"){code.push('this.',this.$$store.theme[name],'=value;');}else if(variant==="resetThemed"){code.push('delete this.',this.$$store.theme[name],';');}else if(variant==="init"&&incomingValue){code.push('this.',this.$$store.init[name],'=value;');}}code.push('}');if(config.themeable){code.push('else if(this.',this.$$store.theme[name],'!==undefined){');if(!config.inheritable){code.push('old=this.',this.$$store.theme[name],';');}if(variant==="setRuntime"){code.push('computed=this.',this.$$store.runtime[name],'=value;');}else if(variant==="set"){code.push('computed=this.',this.$$store.user[name],'=value;');}else if(variant==="setThemed"){code.push('computed=this.',this.$$store.theme[name],'=value;');}else if(variant==="resetThemed"){code.push('delete this.',this.$$store.theme[name],';');code.push('if(this.',this.$$store.init[name],'!==undefined){');code.push('computed=this.',this.$$store.init[name],';');code.push('this.',this.$$store.useinit[name],'=true;');code.push('}');}else if(variant==="init"){if(incomingValue){code.push('this.',this.$$store.init[name],'=value;');}code.push('computed=this.',this.$$store.theme[name],';');}else if(variant==="refresh"){code.push('computed=this.',this.$$store.theme[name],';');}code.push('}');}code.push('else if(this.',this.$$store.useinit[name],'){');if(!config.inheritable){code.push('old=this.',this.$$store.init[name],';');}if(variant==="init"){if(incomingValue){code.push('computed=this.',this.$$store.init[name],'=value;');}else{code.push('computed=this.',this.$$store.init[name],';');}}else if(variant==="set"||variant==="setRuntime"||variant==="setThemed"||variant==="refresh"){code.push('delete this.',this.$$store.useinit[name],';');if(variant==="setRuntime"){code.push('computed=this.',this.$$store.runtime[name],'=value;');}else if(variant==="set"){code.push('computed=this.',this.$$store.user[name],'=value;');}else if(variant==="setThemed"){code.push('computed=this.',this.$$store.theme[name],'=value;');}else if(variant==="refresh"){code.push('computed=this.',this.$$store.init[name],';');}}code.push('}');if(variant==="set"||variant==="setRuntime"||variant==="setThemed"||variant==="init"){code.push('else{');if(variant==="setRuntime"){code.push('computed=this.',this.$$store.runtime[name],'=value;');}else if(variant==="set"){code.push('computed=this.',this.$$store.user[name],'=value;');}else if(variant==="setThemed"){code.push('computed=this.',this.$$store.theme[name],'=value;');}else if(variant==="init"){if(incomingValue){code.push('computed=this.',this.$$store.init[name],'=value;');}else{code.push('computed=this.',this.$$store.init[name],';');}code.push('this.',this.$$store.useinit[name],'=true;');}code.push('}');}}if(config.inheritable){code.push('if(computed===undefined||computed===inherit){');if(variant==="refresh"){code.push('computed=value;');}else{code.push('var pa=this.getLayoutParent();if(pa)computed=pa.',this.$$store.inherit[name],';');}code.push('if((computed===undefined||computed===inherit)&&');code.push('this.',this.$$store.init[name],'!==undefined&&');code.push('this.',this.$$store.init[name],'!==inherit){');code.push('computed=this.',this.$$store.init[name],';');code.push('this.',this.$$store.useinit[name],'=true;');code.push('}else{');code.push('delete this.',this.$$store.useinit[name],';}');code.push('}');code.push('if(old===computed)return value;');code.push('if(computed===inherit){');code.push('computed=undefined;delete this.',this.$$store.inherit[name],';');code.push('}');code.push('else if(computed===undefined)');code.push('delete this.',this.$$store.inherit[name],';');code.push('else this.',this.$$store.inherit[name],'=computed;');code.push('var backup=computed;');code.push('if(old===undefined)old=null;');code.push('if(computed===undefined||computed==inherit)computed=null;');}else if(hasCallback){if(variant!=="set"&&variant!=="setRuntime"&&variant!=="setThemed"){code.push('if(computed===undefined)computed=null;');}code.push('if(old===computed)return value;');code.push('if(old===undefined)old=null;');}if(hasCallback){if(config.apply){code.push('this.',config.apply,'(computed, old, "',name,'");');}if(config.event){code.push("var reg=qx.event.Registration;","if(reg.hasListener(this, '",config.event,"')){","reg.fireEvent(this, '",config.event,"', qx.event.type.Data, [computed, old]",")}");}if(config.inheritable&&members._getChildren){code.push('var a=this._getChildren();if(a)for(var i=0,l=a.length;i<l;i++){');code.push('if(a[i].',this.$$method.refresh[name],')a[i].',this.$$method.refresh[name],'(backup);');code.push('}');}}if(incomingValue){code.push('return value;');}return this.__unwrapFunctionFromCode(instance,members,name,variant,code,args);}},settings:{"qx.propertyDebugLevel":0}});qx.Bootstrap.define("qx.core.ObjectRegistry",{statics:{__registry:{},__nextHash:0,inShutDown:false,__freeHashes:[],register:function(obj){var registry=this.__registry;if(!registry){return;}var hash=obj.$$hash;if(hash==null){var cache=this.__freeHashes;if(cache.length>0){hash=cache.pop();}else{hash=(this.__nextHash++).toString(36);}obj.$$hash=hash;}{};registry[hash]=obj;},unregister:function(obj){var hash=obj.$$hash;if(hash==null){return;}var registry=this.__registry;if(registry&&registry[hash]){delete registry[hash];this.__freeHashes.push(hash);}},toHashCode:function(obj){{};var hash=obj.$$hash;if(hash!=null){return hash;}var cache=this.__freeHashes;if(cache.length>0){hash=cache.pop();}else{hash=(this.__nextHash++).toString(36);}return obj.$$hash=hash;},fromHashCode:function(hash){return this.__registry[hash]||null;},shutdown:function(){this.inShutDown=true;var registry=this.__registry;var hashes=[];for(var hash in registry){hashes.push(hash);}hashes.sort(function(a,b){return parseInt(b,36)-parseInt(a,36);});var obj,i=0,l=hashes.length;while(true){try{for(;i<l;i++){hash=hashes[i];obj=registry[hash];if(obj&&obj.dispose){obj.dispose();}}}catch(ex){qx.log.Logger.error(this,"Could not dispose object "+obj.toString()+": "+ex);if(i!==0){continue;}}break;}qx.log.Logger.debug(this,"Disposed "+l+" objects");delete this.__registry;},getRegistry:function(){return this.__registry;}}});qx.Bootstrap.define("qx.log.Logger",{statics:{__treshold:50,__level:"debug",setLevel:function(value){this.__level=value;},getLevel:function(){return this.__level;},setTreshold:function(value){this.__treshold=value;},getTreshold:function(){return this.__treshold;},__appender:{},__id:0,register:function(appender){if(appender.$$id){return;}var id=this.__id++;this.__appender[id]=appender;appender.$$id=id;var buffer=this.__buffer;for(var i=0,l=buffer.length;i<l;i++){appender.process(buffer[i]);}},unregister:function(appender){var id=appender.$$id;if(id==null){return;}delete this.__appender[id];delete appender.$$id;},debug:function(object,message){this.__log("debug",arguments);},info:function(object,message){this.__log("info",arguments);},warn:function(object,message){this.__log("warn",arguments);},error:function(object,message){this.__log("error",arguments);},trace:function(object){this.__log("info",[object,qx.dev.StackTrace.getStackTrace().join("\n")]);},deprecatedMethodWarning:function(fcn,msg){if(qx.core.Variant.isSet("qx.deprecationWarnings","on")){var functionName=qx.lang.Function.getName(fcn);var className=fcn.self?fcn.self.classname:"unknown";this.warn("The method '"+functionName+"' of class '"+className+"' is deprecated: "+msg||"Please consult the API documentation of this method for alternatives.");this.trace();}},deprecatedClassWarning:function(clazz,msg){if(qx.core.Variant.isSet("qx.deprecationWarnings","on")){var className=clazz.self?clazz.self.classname:"unknown";this.warn("The method class '"+className+"' is deprecated: "+msg||"Please consult the API documentation of this class for alternatives.");this.trace();}},clear:function(){this.__buffer=[];},__buffer:[],__levels:{debug:0,info:1,warn:2,error:3},__log:function(level,args){var levels=this.__levels;if(levels[level]<levels[this.__level]){return;}var object=args.length<2?null:args[0];var start=object?1:0;var items=[];for(var i=start,l=args.length;i<l;i++){items.push(this.__serialize(args[i],true));}var time=new Date;var entry={time:time,offset:time-qx.Bootstrap.LOADSTART,level:level,items:items};if(object){if(object instanceof qx.core.Object){entry.object=object.$$hash;}else if(object.$$type){entry.clazz=object;}}var buffer=this.__buffer;buffer.push(entry);if(buffer.length>(this.__treshold+10)){buffer.splice(this.__treshold,buffer.length);}var appender=this.__appender;for(var id in appender){appender[id].process(entry);}},__detect:function(value){if(value===undefined){return "undefined";}else if(value===null){return "null";}if(value.$$type){return "class";}var type=typeof value;if(type==="function"||type=="string"||type==="number"||type==="boolean"){return type;}else if(type==="object"){if(value.nodeType){return "node";}else if(value.classname){return "instance";}else if(value instanceof Array){return "array";}else if(value instanceof Error){return "error";}else{return "map";}}if(value.toString){return "stringify";}return "unknown";},__serialize:function(value,deep){var type=this.__detect(value);var text="unknown";switch(type){case "null":case "undefined":text=type;break;case "string":case "number":case "boolean":text=value;break;case "node":if(value.nodeType===9){text="document";}else if(value.nodeType===3){text="text["+value.nodeValue+"]";}else if(value.nodeType===1){text=value.nodeName.toLowerCase();if(value.id){text+="#"+value.id;}}else{text="node";}break;case "function":text=qx.lang.Function.getName(value)||type;break;case "instance":text=value.basename+"["+value.$$hash+"]";break;case "class":case "stringify":case "error":text=value.toString();break;case "array":if(deep){text=[];for(var i=0,l=value.length;i<l;i++){if(text.length>20){text.push("...(+"+(l-i)+")");break;}text.push(this.__serialize(value[i],false));}}else{text="[...("+value.length+")]";}break;case "map":if(deep){var temp;var sorted=[];for(var key in value){sorted.push(key);}sorted.sort();text=[];for(var i=0,l=sorted.length;i<l;i++){if(text.length>20){text.push("...(+"+(l-i)+")");break;}key=sorted[i];temp=this.__serialize(value[key],false);temp.key=key;text.push(temp);}}else{var number=0;for(var key in value){number++;}text="{...("+number+")}";}break;}return {type:type,text:text};}}});qx.Class.define("qx.core.Object",{extend:Object,construct:function(){qx.core.ObjectRegistry.register(this);},statics:{$$type:"Object"},members:{toHashCode:function(){return this.$$hash;},toString:function(){return this.classname+"["+this.$$hash+"]";},base:function(args,varags){if(arguments.length===1){return args.callee.base.call(this);}else{return args.callee.base.apply(this,Array.prototype.slice.call(arguments,1));}},self:function(args){return args.callee.self;},clone:function(){var clazz=this.constructor;var clone=new clazz;var props=qx.Class.getProperties(clazz);var user=qx.core.Property.$$store.user;var setter=qx.core.Property.$$method.set;var name;for(var i=0,l=props.length;i<l;i++){name=props[i];if(this.hasOwnProperty(user[name])){clone[setter[name]](this[user[name]]);}}return clone;},serialize:function(){var clazz=this.constructor;var props=qx.Class.getProperties(clazz);var user=qx.core.Property.$$store.user;var setter=qx.core.Property.$$method.set;var name;var result={classname:clazz.classname,properties:{}};for(var i=0,l=props.length;i<l;i++){name=props[i];if(this.hasOwnProperty(user[name])){value=this[user[name]];if(value instanceof qx.core.Object){result.properties[name]={$$hash:value.$$hash};}else{result.properties[name]=value;}}}return result;},set:function(data,value){var setter=qx.core.Property.$$method.set;if(typeof data==="string"){{};return this[setter[data]](value);}else{for(var prop in data){{};this[setter[prop]](data[prop]);}return this;}},get:function(prop){var getter=qx.core.Property.$$method.get;{};return this[getter[prop]]();},reset:function(prop){var resetter=qx.core.Property.$$method.reset;{};this[resetter[prop]]();},__Registration:qx.event.Registration,addListener:function(type,listener,self,capture){if(!this.$$disposed){this.__Registration.addListener(this,type,listener,self,capture);}},addListenerOnce:function(type,listener,self,capture){var callback=function(e){listener.call(self||this,e);this.removeListener(type,callback,this,capture);};this.addListener(type,callback,this,capture);},removeListener:function(type,listener,self,capture){if(!this.$$disposed){this.__Registration.removeListener(this,type,listener,self,capture);}},hasListener:function(type,capture){return this.__Registration.hasListener(this,type,capture);},dispatchEvent:function(evt){if(!this.$$disposed){return this.__Registration.dispatchEvent(this,evt);}return true;},fireEvent:function(type,clazz,args){if(!this.$$disposed){return this.__Registration.fireEvent(this,type,clazz,args);}return true;},fireNonBubblingEvent:function(type,clazz,args){if(!this.$$disposed){return this.__Registration.fireNonBubblingEvent(this,type,clazz,args);}return true;},fireDataEvent:function(type,data,oldData,cancelable){if(!this.$$disposed){return this.__Registration.fireNonBubblingEvent(this,type,qx.event.type.Data,[data,oldData||null,!!cancelable]);}return true;},__userData:null,setUserData:function(key,value){if(!this.__userData){this.__userData={};}this.__userData[key]=value;},getUserData:function(key){if(!this.__userData){return null;}return this.__userData[key];},__Logger:qx.log.Logger,debug:function(msg){this.__Logger.debug(this,msg);},info:function(msg){this.__Logger.info(this,msg);},warn:function(msg){this.__Logger.warn(this,msg);},error:function(msg){this.__Logger.error(this,msg);},trace:function(){this.__Logger.trace(this);},isDisposed:function(){return this.$$disposed||false;},dispose:function(){if(this.$$disposed){return;}this.$$disposed=true;{};var clazz=this.constructor;var mixins;while(clazz.superclass){if(clazz.$$destructor){clazz.$$destructor.call(this);}if(clazz.$$includes){mixins=clazz.$$flatIncludes;for(var i=0,l=mixins.length;i<l;i++){if(mixins[i].$$destructor){mixins[i].$$destructor.call(this);}}}clazz=clazz.superclass;}var key,value;},_disposeFields:function(varargs){qx.util.DisposeUtil.disposeFields(this,arguments);},_disposeObjects:function(varargs){qx.util.DisposeUtil.disposeObjects(this,arguments);},_disposeArray:function(field){qx.util.DisposeUtil.disposeArray(this,field);},_disposeMap:function(field){qx.util.DisposeUtil.disposeMap(this,field);}},settings:{"qx.disposerDebugLevel":0},defer:function(statics){{};},destruct:function(){qx.event.Registration.removeAllListeners(this);qx.core.ObjectRegistry.unregister(this);this._disposeFields("__userData");var clazz=this.constructor;var properties;var store=qx.core.Property.$$store;var storeUser=store.user;var storeTheme=store.theme;var storeInherit=store.inherit;var storeUseinit=store.useinit;var storeInit=store.init;while(clazz){properties=clazz.$$properties;if(properties){for(var name in properties){if(properties[name].dispose){this[storeUser[name]]=this[storeTheme[name]]=this[storeInherit[name]]=this[storeUseinit[name]]=this[storeInit[name]]=undefined;}}}clazz=clazz.superclass;}}});qx.Bootstrap.define("qx.lang.String",{statics:{camelCase:function(str){return str.replace(/\-([a-z])/g,function(match,chr){return chr.toUpperCase();});},hyphenate:function(str){return str.replace(/[A-Z]/g,function(match){return ('-'+match.charAt(0).toLowerCase());});},capitalize:function(str){return str.replace(/\b[a-z]/g,function(match){return match.toUpperCase();});},trimLeft:function(str){return str.replace(/^\s+/,"");},trimRight:function(str){return str.replace(/\s+$/,"");},trim:function(str){return str.replace(/^\s+|\s+$/g,"");},startsWith:function(fullstr,substr){return fullstr.substring(0,substr.length)===substr;},endsWith:function(fullstr,substr){return fullstr.substring(fullstr.length-substr.length,fullstr.length)===substr;},pad:function(str,length,ch){if(typeof ch==="undefined"){ch="0";}var temp="";for(var i=str.length;i<length;i++){temp+=ch;}return temp+str;},firstUp:function(str){return str.charAt(0).toUpperCase()+str.substr(1);},firstLow:function(str){return str.charAt(0).toLowerCase()+str.substr(1);},contains:function(str,substring){return str.indexOf(substring)!=-1;},format:function(pattern,args){var str=pattern;for(var i=0;i<args.length;i++){str=str.replace(new RegExp("%"+(i+1),"g"),args[i]);}return str;},escapeRegexpChars:function(str){return str.replace(/([.*+?^${}()|[\]\/\\])/g,'\\$1');},toArray:function(str){return str.split(/\B|\b/g);},stripTags:function(str){return str.replace(/<\/?[^>]+>/gi,"");}}});qx.Class.define("qx.Interface",{statics:{define:function(name,config){if(config){if(config.extend&&!(config.extend instanceof Array)){config.extend=[config.extend];}{};var iface=config.statics?config.statics:{};if(config.extend){iface.$$extends=config.extend;}if(config.properties){iface.$$properties=config.properties;}if(config.members){iface.$$members=config.members;}if(config.events){iface.$$events=config.events;}}else{var iface={};}iface.$$type="Interface";iface.name=name;iface.toString=this.genericToString;iface.basename=qx.Bootstrap.createNamespace(name,iface);qx.Interface.$$registry[name]=iface;return iface;},getByName:function(name){return this.$$registry[name];},isDefined:function(name){return this.getByName(name)!==undefined;},getTotalNumber:function(){return qx.lang.Object.getLength(this.$$registry);},flatten:function(ifaces){if(!ifaces){return [];}var list=ifaces.concat();for(var i=0,l=ifaces.length;i<l;i++){if(ifaces[i].$$extends){list.push.apply(list,this.flatten(ifaces[i].$$extends));}}return list;},assert:function(clazz,iface,wrap){var members=iface.$$members;if(members){var proto=clazz.prototype;for(var key in members){if(typeof members[key]==="function"){if(typeof proto[key]==="function"){if(wrap===true&&!qx.Class.hasInterface(clazz,iface)){proto[key]=this.__wrapInterfaceMember(iface,proto[key],key,members[key]);}}else{var match=key.match(/^(get|set|reset)(.*)$/);if(!match||!qx.Class.hasProperty(clazz,qx.lang.String.firstLow(match[2]))){throw new Error('Implementation of method "'+key+'" is missing in class "'+clazz.classname+'" required by interface "'+iface.name+'"');}}}else{if(typeof proto[key]===undefined){if(typeof proto[key]!=="function"){throw new Error('Implementation of member "'+key+'" is missing in class "'+clazz.classname+'" required by interface "'+iface.name+'"');}}}}}if(iface.$$properties){for(var key in iface.$$properties){if(!qx.Class.hasProperty(clazz,key)){throw new Error('The property "'+key+'" is not supported by Class "'+clazz.classname+'"!');}}}if(iface.$$events){for(var key in iface.$$events){if(!qx.Class.supportsEvent(clazz,key)){throw new Error('The event "'+key+'" is not supported by Class "'+clazz.classname+'"!');}}}var extend=iface.$$extends;if(extend){for(var i=0,l=extend.length;i<l;i++){this.assert(clazz,extend[i],wrap);}}},genericToString:function(){return "[Interface "+this.name+"]";},$$registry:{},__wrapInterfaceMember:function(){},__allowedKeys:null,__validateConfig:function(){}}});qx.Interface.define("qx.event.IEventHandler",{statics:{TARGET_DOMNODE:1,TARGET_WINDOW:2,TARGET_OBJECT:3},members:{canHandleEvent:function(target,type){},registerEvent:function(target,type,capture){},unregisterEvent:function(target,type,capture){}}});qx.Class.define("qx.event.handler.Application",{extend:qx.core.Object,implement:qx.event.IEventHandler,construct:function(manager){this.base(arguments);this._window=manager.getWindow();this._initObserver();qx.event.handler.Application.$$instance=this;},statics:{PRIORITY:qx.event.Registration.PRIORITY_NORMAL,SUPPORTED_TYPES:{ready:1,shutdown:1},TARGET_CHECK:qx.event.IEventHandler.TARGET_WINDOW,IGNORE_CAN_HANDLE:true,ready:function(){var inst=qx.event.handler.Application.$$instance;if(inst){inst.__fireReady();}}},members:{canHandleEvent:function(target,type){},registerEvent:function(target,type,capture){},unregisterEvent:function(target,type,capture){},__fireReady:function(){if(!this.__isReady){this.__isReady=true;qx.event.Registration.fireEvent(window,"ready");}},_initObserver:function(){this._onNativeLoadWrapped=qx.lang.Function.bind(this._onNativeLoad,this);this._onNativeUnloadWrapped=qx.lang.Function.bind(this._onNativeUnload,this);qx.bom.Event.addNativeListener(window,"load",this._onNativeLoadWrapped);qx.bom.Event.addNativeListener(window,"unload",this._onNativeUnloadWrapped);},_stopObserver:function(){qx.bom.Event.removeNativeListener(window,"load",this._onNativeLoadWrapped);qx.bom.Event.removeNativeListener(window,"unload",this._onNativeUnloadWrapped);this._onNativeLoadWrapped=null;this._onNativeUnloadWrapped=null;},_onNativeLoad:function(e){if(!window.qxloader){this.__fireReady();}},_onNativeUnload:function(e){if(!this.__isUnloaded){this.__isUnloaded=true;qx.event.Registration.fireEvent(window,"shutdown");qx.core.ObjectRegistry.shutdown();}}},destruct:function(){this._stopObserver();this._disposeFields("_window");},defer:function(statics){qx.event.Registration.addHandler(statics);}});qx.Interface.define("qx.event.IEventDispatcher",{members:{canDispatchEvent:function(target,event,type){this.assertInstance(event,qx.event.type.Event);this.assertString(type);},dispatchEvent:function(target,event,type){this.assertInstance(event,qx.event.type.Event);this.assertString(type);}}});qx.Class.define("qx.event.dispatch.Direct",{extend:qx.core.Object,implement:qx.event.IEventDispatcher,construct:function(manager){this._manager=manager;},statics:{PRIORITY:qx.event.Registration.PRIORITY_LAST},members:{canDispatchEvent:function(target,event,type){return !event.getBubbles();},dispatchEvent:function(target,event,type){event.setEventPhase(qx.event.type.Event.AT_TARGET);var listeners=this._manager.getListeners(target,type,false);if(listeners){for(var i=0,l=listeners.length;i<l;i++){var context=listeners[i].context||target;listeners[i].handler.call(context,event);}}}},defer:function(statics){qx.event.Registration.addDispatcher(statics);}});qx.Class.define("qx.core.Init",{statics:{getApplication:function(){return this.__application||null;},__ready:function(){qx.log.Logger.debug(this,"Load runtime: "+(new Date-qx.Bootstrap.LOADSTART)+"ms");var app=qx.core.Setting.get("qx.application");var clazz=qx.Class.getByName(app);if(clazz){this.__application=new clazz;var start=new Date;this.__application.main();qx.log.Logger.debug(this,"Main runtime: "+(new Date-start)+"ms");var start=new Date;this.__application.finalize();qx.log.Logger.debug(this,"Finalize runtime: "+(new Date-start)+"ms");}else{qx.log.Logger.warn("Missing application class: "+app);}},__shutdown:function(){var app=this.__application;if(app){app.terminate();}}},defer:function(statics){qx.event.Registration.addListener(window,"ready",statics.__ready,statics);qx.event.Registration.addListener(window,"shutdown",statics.__shutdown,statics);}});qx.Interface.define("qx.application.IApplication",{members:{main:function(){},finalize:function(){},terminate:function(){}}});qx.Class.define("qx.application.Native",{extend:qx.core.Object,implement:[qx.application.IApplication],members:{main:function(){},finalize:function(){},terminate:function(){}}});qx.Class.define("qx.dev.unit.TestLoader",{extend:qx.application.Native,properties:{suite:{check:"qx.dev.unit.TestSuite",nullable:true}},members:{main:function(){this.base(arguments);this.setTestNamespace(this.__getClassNameFromUrl());if(window.top.jsUnitTestSuite){this.runJsUnit();return;}if(window==window.top){this.runStandAlone();return;}},__getClassNameFromUrl:function(){var params=window.location.search;var className=params.match(/[\?&]testclass=([A-Za-z0-9_\.]+)/);if(className){className=className[1];}else{className="__unknown_class__";}return className;},setTestNamespace:function(namespace){var suite=new qx.dev.unit.TestSuite();suite.add(namespace);this.setSuite(suite);},runJsUnit:function(){var testResult=new qx.dev.unit.JsUnitTestResult();this.getSuite().run(testResult);testResult.exportToJsUnit();},runStandAlone:function(){this.warn(this.getTestDescriptions());var testResult=new qx.dev.unit.TestResult();testResult.addListener("failure",function(e){var ex=e.getData().exception;var test=e.getData().test;this.error("Test '"+test.getFullName()+"' failed: "+ex.getMessage()+" - "+ex.getComment());this.error("Stack trace: "+ex.getStackTrace().join("\n"));});testResult.addListener("error",function(e){var ex=e.getData().exception;this.error("The test '"+e.getData().test.getFullName()+"' had an error: "+ex,ex);});this.getSuite().run(testResult);},getTestDescriptions:function(){var desc=[];var classes=this.getSuite().getTestClasses();for(var i=0;i<classes.length;i++){var cls=classes[i];var clsDesc={};clsDesc.classname=cls.getName();clsDesc.tests=[];var methods=cls.getTestMethods();for(var j=0;j<methods.length;j++){clsDesc.tests.push(methods[j].getName());}desc.push(clsDesc);}return qx.util.Json.stringify(desc);},runTests:function(testResult,className,methodName){var classes=this.getSuite().getTestClasses();for(var i=0;i<classes.length;i++){if(className==classes[i].getName()){var methods=classes[i].getTestMethods();for(var j=0;j<methods.length;j++){if(methodName&&methods[j].getName()!=methodName){continue;}methods[j].run(testResult);}return;}}},runTestsFromNamespace:function(testResult,namespaceName){var classes=this.getSuite().getTestClasses();for(var i=0;i<classes.length;i++){if(classes[i].getName().indexOf(namespaceName)==0){classes[i].run(testResult);}}}}});qx.Class.define("testrunner.TestLoader",{extend:qx.dev.unit.TestLoader,statics:{getInstance:function(){return this.instance;}},members:{main:function(){testrunner.TestLoader.instance=this;this.base(arguments);}}});qx.Bootstrap.define("qx.lang.Core");if(!Error.prototype.toString||Error.prototype.toString()=="[object Error]"){Error.prototype.toString=function(){return this.message;};}if(!Array.prototype.indexOf){Array.prototype.indexOf=function(searchElement,fromIndex){if(fromIndex==null){fromIndex=0;}else if(fromIndex<0){fromIndex=Math.max(0,this.length+fromIndex);}for(var i=fromIndex;i<this.length;i++){if(this[i]===searchElement){return i;}}return -1;};}if(!Array.prototype.lastIndexOf){Array.prototype.lastIndexOf=function(searchElement,fromIndex){if(fromIndex==null){fromIndex=this.length-1;}else if(fromIndex<0){fromIndex=Math.max(0,this.length+fromIndex);}for(var i=fromIndex;i>=0;i--){if(this[i]===searchElement){return i;}}return -1;};}if(!Array.prototype.forEach){Array.prototype.forEach=function(callback,obj){var l=this.length;for(var i=0;i<l;i++){callback.call(obj,this[i],i,this);}};}if(!Array.prototype.filter){Array.prototype.filter=function(callback,obj){var l=this.length;var res=[];for(var i=0;i<l;i++){if(callback.call(obj,this[i],i,this)){res.push(this[i]);}}return res;};}if(!Array.prototype.map){Array.prototype.map=function(callback,obj){var l=this.length;var res=[];for(var i=0;i<l;i++){res.push(callback.call(obj,this[i],i,this));}return res;};}if(!Array.prototype.some){Array.prototype.some=function(callback,obj){var l=this.length;for(var i=0;i<l;i++){if(callback.call(obj,this[i],i,this)){return true;}}return false;};}if(!Array.prototype.every){Array.prototype.every=function(callback,obj){var l=this.length;for(var i=0;i<l;i++){if(!callback.call(obj,this[i],i,this)){return false;}}return true;};}if(!String.prototype.quote){String.prototype.quote=function(){return '"'+this.replace(/\\/g,"\\\\").replace(/\"/g,"\\\"")+'"';};}qx.Bootstrap.define("qx.lang.Generics",{statics:{__map:{"Array":["join","reverse","sort","push","pop","shift","unshift","splice","concat","slice","indexOf","lastIndexOf","forEach","map","filter","some","every"],"String":["quote","substring","toLowerCase","toUpperCase","charAt","charCodeAt","indexOf","lastIndexOf","toLocaleLowerCase","toLocaleUpperCase","localeCompare","match","search","replace","split","substr","concat","slice"]},__wrap:function(obj,func){return function(s){return obj.prototype[func].apply(s,Array.prototype.slice.call(arguments,1));};},__init:function(){var map=qx.lang.Generics.__map;for(var key in map){var obj=window[key];var arr=map[key];for(var i=0,l=arr.length;i<l;i++){var func=arr[i];if(!obj[func]){obj[func]=qx.lang.Generics.__wrap(obj,func);}}}}},defer:function(statics){statics.__init();}});qx.Class.define("qx.dev.StackTrace",{statics:{getStackTrace:qx.core.Variant.select("qx.client",{"gecko":function(){try{throw new Error();}catch(e){var errorTrace=this.getStackTraceFromError(e);qx.lang.Array.removeAt(errorTrace,0);var callerTrace=this.getStackTraceFromCaller(arguments);var trace=callerTrace.length>errorTrace.length?callerTrace:errorTrace;for(var i=0;i<Math.min(callerTrace.length,errorTrace.length);i++){var callerCall=callerTrace[i];if(callerCall.indexOf("anonymous")>=0){continue;}var callerArr=callerCall.split(":");if(callerArr.length!=2){continue;}var callerClassName=callerArr[0];var methodName=callerArr[1];var errorCall=errorTrace[i];var errorArr=errorCall.split(":");var errorClassName=errorArr[0];var lineNumber=errorArr[1];if(qx.Class.getByName(errorClassName)){var className=errorClassName;}else{className=callerClassName;}var line=className+":";if(methodName){line+=methodName+":";}line+=lineNumber;trace[i]=line;}return trace;}},"mshtml|webkit":function(){return this.getStackTraceFromCaller(arguments);},"opera":function(){var foo;try{foo.bar();}catch(e){var trace=this.getStackTraceFromError(e);qx.lang.Array.removeAt(trace,0);return trace;}return [];}}),getStackTraceFromCaller:qx.core.Variant.select("qx.client",{"opera":function(args){return [];},"default":function(args){var trace=[];var fcn=qx.lang.Function.getCaller(args);var knownFunction={};while(fcn){var fcnName=qx.lang.Function.getName(fcn);trace.push(fcnName);try{fcn=fcn.caller;}catch(e){break;}if(!fcn){break;}var hash=qx.core.ObjectRegistry.toHashCode(fcn);if(knownFunction[hash]){trace.push("...");break;}knownFunction[hash]=fcn;}return trace;}}),getStackTraceFromError:qx.core.Variant.select("qx.client",{"gecko":function(error){if(!error.stack){return [];}var lineRe=/@(.+):(\d+)$/gm;var hit;var trace=[];while((hit=lineRe.exec(error.stack))!=null){var url=hit[1];var lineNumber=hit[2];var className=this.__fileNameToClassName(url);trace.push(className+":"+lineNumber);}return trace;},"webkit":function(error){if(error.sourceURL&&error.line){return [this.__fileNameToClassName(error.sourceURL)+":"+error.line];}else{return [];}},"opera":function(error){if(error.message.indexOf("Backtrace:")<0){return [];}var trace=[];var traceString=qx.lang.String.trim(error.message.split("Backtrace:")[1]);var lines=traceString.split("\n");for(var i=0;i<lines.length;i++){var reResult=lines[i].match(/\s*Line ([0-9]+) of.* (\S.*)/);if(reResult&&reResult.length>=2){var lineNumber=reResult[1];var fileName=this.__fileNameToClassName(reResult[2]);trace.push(fileName+":"+lineNumber);}}return trace;},"default":function(){return [];}}),__fileNameToClassName:function(fileName){var scriptDir="/source/class/";var jsPos=fileName.indexOf(scriptDir);var className=(jsPos==-1)?fileName:fileName.substring(jsPos+scriptDir.length).replace(/\//g,".").replace(/\.js$/,"");return className;}}});qx.Class.define("qx.util.ObjectPool",{extend:qx.core.Object,construct:function(size){this.base(arguments);this.__pool={};if(size!==undefined){this.setSize(size);}},properties:{size:{check:"Integer",init:null,nullable:true}},members:{getObject:function(clazz){if(this.$$disposed){return;}if(!clazz){throw new Error("Class needs to be defined!");}var obj=null;var pool=this.__pool[clazz.classname];if(pool){obj=pool.pop();}if(obj){obj.$$pooled=false;}else{obj=new clazz;}return obj;},poolObject:function(obj){if(!this.__pool){return;}var classname=obj.classname;var pool=this.__pool[classname];if(obj.$$pooled){throw new Error("Object is already pooled: "+obj);}if(!pool){this.__pool[classname]=pool=[];}var size=this.getSize()||Infinity;if(pool.length>size){this.warn("Cannot pool "+obj+" because the pool is already full.");obj.dispose();return;}obj.$$pooled=true;pool.push(obj);}},destruct:function(){var pool=this.__pool;var classname,list,i,l;for(classname in pool){list=pool[classname];for(i=0,l=list.length;i<l;i++){list[i].dispose();}}delete this.__pool;}});qx.Class.define("qx.event.Pool",{extend:qx.util.ObjectPool,type:"singleton",construct:function(){this.base(arguments,30);},members:{__filter:{"qx.legacy.event.type.DragEvent":1,"qx.legacy.event.type.MouseEvent":1,"qx.legacy.event.type.KeyEvent":1},poolObject:function(obj){if(this.__filter[obj.classname]){return;}this.base(arguments,obj);}}});qx.Class.define("qx.event.type.Event",{extend:qx.core.Object,statics:{CAPTURING_PHASE:1,AT_TARGET:2,BUBBLING_PHASE:3},members:{init:function(canBubble,cancelable){{};this._type=null;this._target=null;this._currentTarget=null;this._relatedTarget=null;this._originalTarget=null;this._stopPropagation=false;this._preventDefault=false;this._bubbles=!!canBubble;this._cancelable=!!cancelable;this._timeStamp=(new Date()).getTime();this._eventPhase=null;return this;},clone:function(embryo){if(embryo){var clone=embryo;}else{var clone=qx.event.Pool.getInstance().getObject(this.constructor);}clone._type=this._type;clone._target=this._target;clone._currentTarget=this._currentTarget;clone._relatedTarget=this._relatedTarget;clone._originalTarget=this._originalTarget;clone._stopPropagation=this._stopPropagation;clone._bubbles=this._bubbles;clone._preventDefault=this._preventDefault;clone._cancelable=this._cancelable;return clone;},stopPropagation:function(){{};this._stopPropagation=true;},getPropagationStopped:function(){return !!this._stopPropagation;},preventDefault:function(){{};this._preventDefault=true;},getDefaultPrevented:function(){return !!this._preventDefault;},getType:function(){return this._type;},setType:function(type){this._type=type;},getEventPhase:function(){return this._eventPhase;},setEventPhase:function(eventPhase){this._eventPhase=eventPhase;},getTimeStamp:function(){return this._timeStamp;},getTarget:function(){return this._target;},setTarget:function(target){this._target=target;},getCurrentTarget:function(){return this._currentTarget||this._target;},setCurrentTarget:function(currentTarget){this._currentTarget=currentTarget;},getRelatedTarget:function(){return this._relatedTarget;},setRelatedTarget:function(relatedTarget){this._relatedTarget=relatedTarget;},getOriginalTarget:function(){return this._originalTarget;},setOriginalTarget:function(originalTarget){this._originalTarget=originalTarget;},getBubbles:function(){return this._bubbles;},setBubbles:function(bubbles){this._bubbles=bubbles;},isCancelable:function(){return this._cancelable;},setCancelable:function(cancelable){this._cancelable=cancelable;}},destruct:function(){this._disposeFields("_target","_currentTarget","_relatedTarget","_originalTarget");}});qx.Class.define("qx.event.type.Data",{extend:qx.event.type.Event,members:{init:function(data,old,cancelable){this.base(arguments,false,cancelable);this.__data=data;this.__old=old;return this;},clone:function(embryo){var clone=this.base(arguments,embryo);clone.__data=this.__data;clone.__old=this.__old;return clone;},getData:function(){return this.__data;},getOldData:function(){return this.__old;},getValue:function(){qx.log.Logger.deprecatedMethodWarning(arguments.callee,"Better use 'getData'");return this.__data;},getOldValue:function(){qx.log.Logger.deprecatedMethodWarning(arguments.callee,"Better use 'getOldData'");return this.__old;}},destruct:function(){this._disposeFields("__data","__old");}});qx.Class.define("qx.event.handler.Object",{extend:qx.core.Object,implement:qx.event.IEventHandler,statics:{PRIORITY:qx.event.Registration.PRIORITY_LAST,SUPPORTED_TYPES:null,TARGET_CHECK:qx.event.IEventHandler.TARGET_OBJECT,IGNORE_CAN_HANDLE:false},members:{canHandleEvent:function(target,type){return qx.Class.supportsEvent(target.constructor,type);},registerEvent:function(target,type,capture){},unregisterEvent:function(target,type,capture){}},defer:function(statics){qx.event.Registration.addHandler(statics);}});qx.Class.define("qx.util.DisposeUtil",{statics:{disposeFields:function(obj,arr){var name;for(var i=0,l=arr.length;i<l;i++){var name=arr[i];if(obj[name]==null||!obj.hasOwnProperty(name)){continue;}obj[name]=null;}},disposeObjects:function(obj,arr){var name;for(var i=0,l=arr.length;i<l;i++){name=arr[i];if(obj[name]==null||!obj.hasOwnProperty(name)){continue;}if(!qx.core.ObjectRegistry.inShutDown){if(obj[name].dispose){obj[name].dispose();}else{throw new Error("Has no disposable object under key: "+name+"!");}}obj[name]=null;}},disposeArray:function(obj,field){var data=obj[field];if(!data){return;}if(qx.core.ObjectRegistry.inShutDown){obj[field]=null;return;}try{var entry;for(var i=data.length-1;i>=0;i--){entry=data[i];if(entry){entry.dispose();}}}catch(ex){throw new Error("The array field: "+field+" of object: "+obj+" has non disposable entries: "+ex);}data.length=0;obj[field]=null;},disposeMap:function(obj,field){var data=obj[field];if(!data){return;}if(qx.core.ObjectRegistry.inShutDown){obj[field]=null;return;}try{for(var key in data){if(data.hasOwnProperty(key)){data[key].dispose();}}}catch(ex){throw new Error("The map field: "+field+" of object: "+obj+" has non disposable entries: "+ex);}obj[field]=null;}}});qx.Class.define("qx.dev.unit.TestSuite",{extend:qx.core.Object,construct:function(testClassOrNamespace){this.base(arguments);this.__tests=[];if(testClassOrNamespace){this.add(testClassOrNamespace);}},members:{add:function(testClassOrNamespace){if(typeof (testClassOrNamespace)=="string"){var evalTestClassOrNamespace=eval(testClassOrNamespace);if(!evalTestClassOrNamespace){this.addFail(testClassOrNamespace,"The class/namespace '"+testClassOrNamespace+"' is undefined!");}testClassOrNamespace=evalTestClassOrNamespace;}if(typeof (testClassOrNamespace)=="function"){this.addTestClass(testClassOrNamespace);}else if(typeof (testClassOrNamespace)=="object"){this.addTestNamespace(testClassOrNamespace);}else{this.addFail("exsitsCheck","Unkown test class '"+testClassOrNamespace+"'!");return;}},addTestNamespace:function(namespace){if(typeof (namespace)=="function"&&namespace.classname){if(qx.Class.isSubClassOf(namespace,qx.dev.unit.TestCase)){this.addTestClass(namespace);return;}}else if(typeof (namespace)=="object"&&!(namespace instanceof Array)){for(var key in namespace){this.addTestNamespace(namespace[key]);}}},addTestFunction:function(name,fcn){this.__tests.push(new qx.dev.unit.TestFunction(null,name,fcn));},addTestMethod:function(clazz,functionName){this.__tests.push(new qx.dev.unit.TestFunction(clazz,functionName));},addTestClass:function(clazz){this.__tests.push(new qx.dev.unit.TestClass(clazz));},addFail:function(functionName,message){this.addTestFunction(functionName,function(){this.fail(message);});},run:function(testResult){for(var i=0;i<this.__tests.length;i++){(this.__tests[i]).run(testResult);}},getTestClasses:function(){var classes=[];for(var i=0;i<this.__tests.length;i++){var test=this.__tests[i];if(test instanceof qx.dev.unit.TestClass){classes.push(test);}}return classes;},getTestMethods:function(){var methods=[];for(var i=0;i<this.__tests.length;i++){var test=this.__tests[i];if(test instanceof qx.dev.unit.TestFunction){methods.push(test);}}return methods;}}});qx.Class.define("qx.core.Assert",{statics:{__assert:function(condition,comment,msg){if(!condition){var errorMsg="Assertion error! "+comment+": "+msg;qx.log.Logger.error(errorMsg);if(qx.Class.isDefined("qx.core.AssertionError")){var err=new qx.core.AssertionError(comment,msg);qx.log.Logger.error("Stack trace: \n"+err.getStackTrace());throw err;}else{throw new Error(errorMsg);}}},assert:function(condition,msg){this.__assert(condition==true,msg||"","Called assert with 'false'");},fail:function(msg){this.__assert(false,msg||"","Called fail().");},assertTrue:function(value,msg){this.__assert(value===true,msg||"","Called assertTrue with 'false'");},assertFalse:function(value,msg){this.__assert(value===false,msg||"","Called assertFalse with 'true'");},assertEquals:function(expected,found,msg){this.__assert(expected==found,msg||"","Expected '"+expected+"' but found '"+found+"'!");},assertIdentical:function(expected,found,msg){this.__assert(expected===found,msg||"","Expected '"+expected+"' (identical) but found '"+found+"'!");},assertNotIdentical:function(expected,found,msg){this.__assert(expected!==found,msg||"","Expected '"+expected+"' to be not identical with '"+found+"'!");},assertNotUndefined:function(value,msg){this.__assert(value!==undefined,msg||"","Expected value not to be undefined but found "+value+"!");},assertUndefined:function(value,msg){this.__assert(value===undefined,msg||"","Expected value to be undefined but found "+value+"!");},assertNotNull:function(value,msg){this.__assert(value!==null,msg||"","Expected value not to be null but found "+value+"!");},assertNull:function(value,msg){this.__assert(value===null,msg||"","Expected value to be null but found "+value+"!");},assertJsonEquals:function(expected,found,msg){this.assertEquals(qx.util.Json.stringify(expected),qx.util.Json.stringify(found),msg);},assertMatch:function(str,re,msg){this.assertString(str);this.__assert(str.search(re)>=0?true:false,msg||"","The String '"+str+"' does not match the regular expression '"+re.toString()+"'!");},assertArgumentsCount:function(args,minCount,maxCount,msg){var argCount=args.length;this.__assert((argCount>=minCount&&argCount<=maxCount),msg||"","Wrong number of arguments given. Expected '"+minCount+"' to '"+maxCount+"' arguments but found '"+arguments.length+"' arguments.");},assertException:function(callback,exception,re,msg){var exception=exception||Error;var error;qx.log.Logger.warn("This exception is expected:");try{callback();}catch(e){error=e;}if(error==null){this.__assert(false,msg||"","The function did not raise an exception!");}this.__assert(error instanceof exception,msg||"","The raised exception does not have the expected type!");if(re){this.assertMatch(error.toString(),re,msg);}},assertInArray:function(value,array,msg){this.__assert(array.indexOf(value)!==-1,msg||"","The value '"+value+"' must have any of the values defined in the array '"+array.join(", ")+"'");},assertKeyInMap:function(value,map,msg){this.__assert(map[value]!==undefined,msg||"","The value '"+value+"' must must be a key of the map '"+qx.util.Json.stringify(map)+"'");},assertFunction:function(value,msg){this.__assert(typeof value==="function",msg||"","Expected value to be typeof function but found "+value+"!");},assertString:function(value,msg){this.__assert(typeof value==="string"||value instanceof String,msg||"","Expected value to be a string but found "+value+"!");},assertBoolean:function(value,msg){this.__assert(typeof value==="boolean"||value instanceof Boolean,msg||"","Expected value to be a boolean but found "+value+"!");},assertNumber:function(value,msg){this.__assert((typeof value==="number"||value instanceof Number)&&isFinite(value),msg||"","Expected value to be a number but found "+value+"!");},assertPositiveNumber:function(value,msg){this.__assert((typeof value==="number"||value instanceof Number)&&isFinite(value)&&value>=0,msg||"","Expected value to be a number >= 0 but found "+value+"!");},assertInteger:function(value,msg){this.__assert(((typeof value==="number"||value instanceof Number)&&isFinite(value)&&value%1===0),msg||"","Expected value to be an integer but found "+value+"!");},assertPositiveInteger:function(value,msg){this.__assert(((typeof value==="number"||value instanceof Number)&&isFinite(value)&&value%1===0&&value>=0),msg||"","Expected value to be an integer >= 0 but found "+value+"!");},assertInRange:function(value,min,max,msg){this.__assert(value>=min&&value<=max,msg||"",qx.lang.String.format("Expected value '%1' to be in the range '%2'..'%3'!",[value,min,max]));},assertObject:function(value,msg){this.__assert(typeof value==="object"&&value!==null,msg||"","Expected value to be typeof object but found "+value+"!");},assertArray:function(value,msg){this.__assert(value instanceof Array,msg||"","Expected value to be an array but found "+value+"!");},assertMap:function(value,msg){var objConstructor=({}).constructor;this.__assert(value&&value.constructor===objConstructor,msg||"","Expected value to be a map but found "+value+"!");},assertType:function(value,type,msg){this.__assert(typeof (value)===type,msg||"","Expected value to be typeof '"+type+"' but found "+value+"!");},assertInstance:function(value,clazz,msg){var className=clazz.classname||clazz+"";this.__assert(value instanceof clazz,msg||"","Expected value to be instanceof '"+className+"' but found "+value+"!");},assertInterface:function(value,iface,msg){this.__assert(qx.Class.implementsInterface(value.constructor,iface),msg||"","Expected object '"+value+"' to implement the interface '"+iface+"'!");},assertCssColor:function(expected,value,msg){var ColorUtil=qx.util.ColorUtil;var expectedRgb=ColorUtil.stringToRgb(expected);try{var valueRgb=ColorUtil.stringToRgb(value);}catch(e){this.__assert(false,msg||"",qx.lang.String.format("Expected value to be the CSS color '%1' (rgb(%2)), but found value '%3', which cannot be converted to a CSS color!",[expected,expectedRgb.join(","),value]));}this.__assert(expectedRgb[0]==valueRgb[0]&&expectedRgb[1]==valueRgb[1]&&expectedRgb[2]==valueRgb[2],msg||"",qx.lang.String.format("Expected value to be the CSS color '%1' (rgb(%2)), but found value '%3' (rgb(%4))!",[expected,expectedRgb.join(","),value,valueRgb.join(",")]));},assertElement:function(value,msg){this.__assert(qx.dom.Node.isElement(value),msg||"",qx.lang.String.format("Expected value to be a DOM element but found  '%1'!",[value]));},assertQxObject:function(value,msg){this.__assert(value instanceof qx.core.Object,msg||"","Expected value to be a qooxdoo object but found "+value+"!");},assertQxWidget:function(value,msg){this.__assert(value instanceof qx.ui.core.Widget,msg||"","Expected value to be a qooxdoo widget but found "+value+"!");}}});qx.Class.define("qx.Mixin",{statics:{define:function(name,config){if(config){if(config.include&&!(config.include instanceof Array)){config.include=[config.include];}{};var mixin=config.statics?config.statics:{};for(var key in mixin){mixin[key].mixin=mixin;}if(config.construct){mixin.$$constructor=config.construct;}if(config.include){mixin.$$includes=config.include;}if(config.properties){mixin.$$properties=config.properties;}if(config.members){mixin.$$members=config.members;}for(var key in mixin.$$members){if(mixin.$$members[key] instanceof Function){mixin.$$members[key].mixin=mixin;}}if(config.events){mixin.$$events=config.events;}if(config.destruct){mixin.$$destructor=config.destruct;}}else{var mixin={};}mixin.$$type="Mixin";mixin.name=name;mixin.toString=this.genericToString;mixin.basename=qx.Bootstrap.createNamespace(name,mixin);this.$$registry[name]=mixin;return mixin;},checkCompatibility:function(mixins){var list=this.flatten(mixins);var len=list.length;if(len<2){return true;}var properties={};var members={};var events={};var mixin;for(var i=0;i<len;i++){mixin=list[i];for(var key in mixin.events){if(events[key]){throw new Error('Conflict between mixin "'+mixin.name+'" and "'+events[key]+'" in member "'+key+'"!');}events[key]=mixin.name;}for(var key in mixin.properties){if(properties[key]){throw new Error('Conflict between mixin "'+mixin.name+'" and "'+properties[key]+'" in property "'+key+'"!');}properties[key]=mixin.name;}for(var key in mixin.members){if(members[key]){throw new Error('Conflict between mixin "'+mixin.name+'" and "'+members[key]+'" in member "'+key+'"!');}members[key]=mixin.name;}}return true;},isCompatible:function(mixin,clazz){var list=qx.Class.getMixins(clazz);list.push(mixin);return qx.Mixin.checkCompatibility(list);},getByName:function(name){return this.$$registry[name];},isDefined:function(name){return this.getByName(name)!==undefined;},getTotalNumber:function(){return qx.lang.Object.getLength(this.$$registry);},flatten:function(mixins){if(!mixins){return [];}var list=mixins.concat();for(var i=0,l=mixins.length;i<l;i++){if(mixins[i].$$includes){list.push.apply(list,this.flatten(mixins[i].$$includes));}}return list;},genericToString:function(){return "[Mixin "+this.name+"]";},$$registry:{},__allowedKeys:null,__validateConfig:function(){}}});qx.Mixin.define("qx.core.MAssert",{members:{assert:function(condition,msg){qx.core.Assert.assert(condition,msg);},fail:function(msg){qx.core.Assert.fail(msg);},assertTrue:function(value,msg){qx.core.Assert.assertTrue(value,msg);},assertFalse:function(value,msg){qx.core.Assert.assertFalse(value,msg);},assertEquals:function(expected,found,msg){qx.core.Assert.assertEquals(expected,found,msg);},assertIdentical:function(expected,found,msg){qx.core.Assert.assertIdentical(expected,found,msg);},assertNotIdentical:function(expected,found,msg){qx.core.Assert.assertNotIdentical(expected,found,msg);},assertNotUndefined:function(value,msg){qx.core.Assert.assertNotUndefined(value,msg);},assertUndefined:function(value,msg){qx.core.Assert.assertUndefined(value,msg);},assertNotNull:function(value,msg){qx.core.Assert.assertNotNull(value,msg);},assertNull:function(value,msg){qx.core.Assert.assertNull(value,msg);},assertJsonEquals:function(expected,found,msg){qx.core.Assert.assertJsonEquals(expected,found,msg);},assertMatch:function(str,re,msg){qx.core.Assert.assertMatch(str,re,msg);},assertArgumentsCount:function(args,minCount,maxCount,msg){qx.core.Assert.assertArgumentsCount(args,minCount,maxCount,msg);},assertException:function(callback,exception,re,msg){qx.core.Assert.assertException(callback,exception,re,msg);},assertInArray:function(value,array,msg){qx.core.Assert.assertInArray(value,array,msg);},assertKeyInMap:function(value,map,msg){qx.core.Assert.assertKeyInMap(value,map,msg);},assertFunction:function(value,msg){qx.core.Assert.assertFunction(value,msg);},assertString:function(value,msg){qx.core.Assert.assertString(value,msg);},assertBoolean:function(value,msg){qx.core.Assert.assertBoolean(value,msg);},assertNumber:function(value,msg){qx.core.Assert.assertNumber(value,msg);},assertPositiveNumber:function(value,msg){qx.core.Assert.assertPositiveNumber(value,msg);},assertInteger:function(value,msg){qx.core.Assert.assertInteger(value,msg);},assertPositiveInteger:function(value,msg){qx.core.Assert.assertPositiveInteger(value,msg);},assertInRange:function(value,min,max,msg){qx.core.Assert.assertInRange(value,min,max,msg);},assertObject:function(value,msg){qx.core.Assert.assertObject(value,msg);},assertArray:function(value,msg){qx.core.Assert.assertArray(value,msg);},assertMap:function(value,msg){qx.core.Assert.assertMap(value,msg);},assertType:function(value,type,msg){qx.core.Assert.assertType(value,type,msg);},assertInstance:function(value,clazz,msg){qx.core.Assert.assertInstance(value,clazz,msg);},assertInterface:function(value,iface,msg){qx.core.Assert.assertInterface(value,iface,msg);},assertCssColor:function(expected,value,msg){qx.core.Assert.assertCssColor(expected,value,msg);},assertElement:function(value,msg){qx.core.Assert.assertElement(value,msg);},assertQxObject:function(value,msg){qx.core.Assert.assertQxObject(value,msg);},assertQxWidget:function(value,msg){qx.core.Assert.assertQxWidget(value,msg);}}});qx.Class.define("qx.dev.unit.TestCase",{extend:qx.core.Object,include:[qx.core.MAssert],members:{isDebugOn:function(){return false;}}});qx.Class.define("qx.core.AssertionError",{extend:Error,construct:function(comment,failMessage){Error.call(this,failMessage);this.__comment=comment||"";this.__msg=failMessage||"";this.__trace=qx.dev.StackTrace.getStackTrace();},members:{__comment:null,__msg:null,__trace:null,getComment:function(){return this.__comment;},message:function(){return this.__msg;},toString:function(){return this.__comment+": "+this.__msg;},getStackTrace:function(){return this.__trace;}}});qx.Class.define("qx.util.Json",{statics:{BEAUTIFYING_INDENT:"  ",BEAUTIFYING_LINE_END:"\n",__map:{"function":"__convertFunction","boolean":"__convertBoolean","number":"__convertNumber","string":"__convertString","object":"__convertObject","undefined":"__convertUndefined"},__convertFunction:function(incoming){return String(incoming);},__convertBoolean:function(incoming){return String(incoming);},__convertNumber:function(incoming){return isFinite(incoming)?String(incoming):"null";},__convertString:function(incoming){var result;if(/["\\\x00-\x1f]/.test(incoming)){result=incoming.replace(/([\x00-\x1f\\"])/g,qx.util.Json.__convertStringHelper);}else{result=incoming;}return '"'+result+'"';},__convertStringEscape:{'\b':'\\b','\t':'\\t','\n':'\\n','\f':'\\f','\r':'\\r','"':'\\"','\\':'\\\\'},__convertStringHelper:function(a,b){var result=qx.util.Json.__convertStringEscape[b];if(result){return result;}result=b.charCodeAt();return '\\u00'+Math.floor(result/16).toString(16)+(result%16).toString(16);},__convertArray:function(incoming){var stringBuilder=[],first=true,func,obj;var beautify=qx.util.Json.__beautify;stringBuilder.push("[");if(beautify){qx.util.Json.__indent+=qx.util.Json.BEAUTIFYING_INDENT;stringBuilder.push(qx.util.Json.__indent);}for(var i=0,l=incoming.length;i<l;i++){obj=incoming[i];func=this.__map[typeof obj];if(func){obj=this[func](obj);if(typeof obj=="string"){if(!first){stringBuilder.push(",");if(beautify){stringBuilder.push(qx.util.Json.__indent);}}stringBuilder.push(obj);first=false;}}}if(beautify){qx.util.Json.__indent=qx.util.Json.__indent.substring(0,qx.util.Json.__indent.length-qx.util.Json.BEAUTIFYING_INDENT.length);stringBuilder.push(qx.util.Json.__indent);}stringBuilder.push("]");return stringBuilder.join("");},__convertDate:function(incoming){var dateParams=incoming.getUTCFullYear()+","+incoming.getUTCMonth()+","+incoming.getUTCDate()+","+incoming.getUTCHours()+","+incoming.getUTCMinutes()+","+incoming.getUTCSeconds()+","+incoming.getUTCMilliseconds();return "new Date(Date.UTC("+dateParams+"))";},__convertMap:function(incoming){var stringBuilder=[],first=true,func,obj;var beautify=qx.util.Json.__beautify;stringBuilder.push("{");if(beautify){qx.util.Json.__indent+=qx.util.Json.BEAUTIFYING_INDENT;stringBuilder.push(qx.util.Json.__indent);}for(var key in incoming){obj=incoming[key];func=this.__map[typeof obj];if(func){obj=this[func](obj);if(typeof obj=="string"){if(!first){stringBuilder.push(",");if(beautify){stringBuilder.push(qx.util.Json.__indent);}}stringBuilder.push(this.__convertString(key),":",obj);first=false;}}}if(beautify){qx.util.Json.__indent=qx.util.Json.__indent.substring(0,qx.util.Json.__indent.length-qx.util.Json.BEAUTIFYING_INDENT.length);stringBuilder.push(qx.util.Json.__indent);}stringBuilder.push("}");return stringBuilder.join("");},__convertObject:function(incoming){if(incoming){var constructorName=incoming.constructor.name;if(incoming instanceof Array||constructorName=="Array"){return this.__convertArray(incoming);}else if(incoming instanceof Date||constructorName=="Date"){return this.__convertDate(incoming);}else if(incoming instanceof Object||constructorName=="Object"){return this.__convertMap(incoming);}return "";}return "null";},__convertUndefined:function(incoming){if(qx.core.Setting.get("qx.jsonEncodeUndefined")){return "null";}},stringify:function(obj,beautify){this.__beautify=beautify;this.__indent=this.BEAUTIFYING_LINE_END;var result=this[this.__map[typeof obj]](obj);if(typeof result!="string"){result=null;}if(qx.core.Setting.get("qx.jsonDebugging")){qx.log.Logger.debug(this,"JSON request: "+result);}return result;},parse:function(text){if(/[^,:{}\[\]0-9.\-+Eaeflnr-u \n\r\t]/.test(text.replace(/"(\\.|[^"\\])*"/g,""))){throw new Error("Could not parse JSON string!");}try{return eval("("+text+")");}catch(ex){throw new Error("Could not evaluate JSON string: "+ex.message);}},parseQx:function(text){if(qx.core.Setting.get("qx.jsonDebugging")){qx.log.Logger.debug(this,"JSON response: "+text);}var obj=(text&&text.length>0)?eval('('+text+')'):null;return obj;}},settings:{"qx.jsonEncodeUndefined":true,"qx.jsonDebugging":false}});qx.Class.define("qx.util.ColorUtil",{statics:{REGEXP:{hex3:/^#([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})$/,hex6:/^#([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})$/,rgb:/^rgb\(\s*([0-9]{1,3}\.{0,1}[0-9]*)\s*,\s*([0-9]{1,3}\.{0,1}[0-9]*)\s*,\s*([0-9]{1,3}\.{0,1}[0-9]*)\s*\)$/},SYSTEM:{activeborder:true,activecaption:true,appworkspace:true,background:true,buttonface:true,buttonhighlight:true,buttonshadow:true,buttontext:true,captiontext:true,graytext:true,highlight:true,highlighttext:true,inactiveborder:true,inactivecaption:true,inactivecaptiontext:true,infobackground:true,infotext:true,menu:true,menutext:true,scrollbar:true,threeddarkshadow:true,threedface:true,threedhighlight:true,threedlightshadow:true,threedshadow:true,window:true,windowframe:true,windowtext:true},NAMED:{black:[0,0,0],silver:[192,192,192],gray:[128,128,128],white:[255,255,255],maroon:[128,0,0],red:[255,0,0],purple:[128,0,128],fuchsia:[255,0,255],green:[0,128,0],lime:[0,255,0],olive:[128,128,0],yellow:[255,255,0],navy:[0,0,128],blue:[0,0,255],teal:[0,128,128],aqua:[0,255,255],transparent:[-1,-1,-1],magenta:[255,0,255],orange:[255,165,0],brown:[165,42,42]},isNamedColor:function(value){return this.NAMED[value]!==undefined;},isSystemColor:function(value){return this.SYSTEM[value]!==undefined;},supportsThemes:function(){return qx.Class.isDefined("qx.theme.manager.Color");},isThemedColor:function(value){if(!this.supportsThemes()){return false;}return qx.theme.manager.Color.getInstance().isDynamic(value);},stringToRgb:function(str){if(this.supportsThemes()&&this.isThemedColor(str)){var str=qx.theme.manager.Color.getInstance().resolveDynamic(str);}if(this.isNamedColor(str)){return this.NAMED[str];}else if(this.isSystemColor(str)){throw new Error("Could not convert system colors to RGB: "+str);}else if(this.isRgbString(str)){return this.__rgbStringToRgb();}else if(this.isHex3String(str)){return this.__hex3StringToRgb();}else if(this.isHex6String(str)){return this.__hex6StringToRgb();}throw new Error("Could not parse color: "+str);},cssStringToRgb:function(str){if(this.isNamedColor(str)){return this.NAMED[str];}else if(this.isSystemColor(str)){throw new Error("Could not convert system colors to RGB: "+str);}else if(this.isRgbString(str)){return this.__rgbStringToRgb();}else if(this.isHex3String(str)){return this.__hex3StringToRgb();}else if(this.isHex6String(str)){return this.__hex6StringToRgb();}throw new Error("Could not parse color: "+str);},stringToRgbString:function(str){return this.rgbToRgbString(this.stringToRgb(str));},rgbToRgbString:function(rgb){return "rgb("+rgb[0]+","+rgb[1]+","+rgb[2]+")";},rgbToHexString:function(rgb){return (qx.lang.String.pad(rgb[0].toString(16).toUpperCase(),2)+qx.lang.String.pad(rgb[1].toString(16).toUpperCase(),2)+qx.lang.String.pad(rgb[2].toString(16).toUpperCase(),2));},isValidPropertyValue:function(str){return this.isThemedColor(str)||this.isNamedColor(str)||this.isHex3String(str)||this.isHex6String(str)||this.isRgbString(str);},isCssString:function(str){return this.isSystemColor(str)||this.isNamedColor(str)||this.isHex3String(str)||this.isHex6String(str)||this.isRgbString(str);},isHex3String:function(str){return this.REGEXP.hex3.test(str);},isHex6String:function(str){return this.REGEXP.hex6.test(str);},isRgbString:function(str){return this.REGEXP.rgb.test(str);},__rgbStringToRgb:function(){var red=parseInt(RegExp.$1,10);var green=parseInt(RegExp.$2,10);var blue=parseInt(RegExp.$3,10);return [red,green,blue];},__hex3StringToRgb:function(){var red=parseInt(RegExp.$1,16)*17;var green=parseInt(RegExp.$2,16)*17;var blue=parseInt(RegExp.$3,16)*17;return [red,green,blue];},__hex6StringToRgb:function(){var red=(parseInt(RegExp.$1,16)*16)+parseInt(RegExp.$2,16);var green=(parseInt(RegExp.$3,16)*16)+parseInt(RegExp.$4,16);var blue=(parseInt(RegExp.$5,16)*16)+parseInt(RegExp.$6,16);return [red,green,blue];},hex3StringToRgb:function(value){if(this.isHex3String(value)){return this.__hex3StringToRgb(value);}throw new Error("Invalid hex3 value: "+value);},hex6StringToRgb:function(value){if(this.isHex6String(value)){return this.__hex6StringToRgb(value);}throw new Error("Invalid hex6 value: "+value);},hexStringToRgb:function(value){if(this.isHex3String(value)){return this.__hex3StringToRgb(value);}if(this.isHex6String(value)){return this.__hex6StringToRgb(value);}throw new Error("Invalid hex value: "+value);},rgbToHsb:function(rgb){var hue,saturation,brightness;var red=rgb[0];var green=rgb[1];var blue=rgb[2];var cmax=(red>green)?red:green;if(blue>cmax){cmax=blue;}var cmin=(red<green)?red:green;if(blue<cmin){cmin=blue;}brightness=cmax/255.0;if(cmax!=0){saturation=(cmax-cmin)/cmax;}else{saturation=0;}if(saturation==0){hue=0;}else{var redc=(cmax-red)/(cmax-cmin);var greenc=(cmax-green)/(cmax-cmin);var bluec=(cmax-blue)/(cmax-cmin);if(red==cmax){hue=bluec-greenc;}else if(green==cmax){hue=2.0+redc-bluec;}else{hue=4.0+greenc-redc;}hue=hue/6.0;if(hue<0){hue=hue+1.0;}}return [Math.round(hue*360),Math.round(saturation*100),Math.round(brightness*100)];},hsbToRgb:function(hsb){var i,f,p,q,t;var hue=hsb[0]/360;var saturation=hsb[1]/100;var brightness=hsb[2]/100;if(hue>=1.0){hue%=1.0;}if(saturation>1.0){saturation=1.0;}if(brightness>1.0){brightness=1.0;}var tov=Math.floor(255*brightness);var rgb={};if(saturation==0.0){rgb.red=rgb.green=rgb.blue=tov;}else{hue*=6.0;i=Math.floor(hue);f=hue-i;p=Math.floor(tov*(1.0-saturation));q=Math.floor(tov*(1.0-(saturation*f)));t=Math.floor(tov*(1.0-(saturation*(1.0-f))));switch(i){case 0:rgb.red=tov;rgb.green=t;rgb.blue=p;break;case 1:rgb.red=q;rgb.green=tov;rgb.blue=p;break;case 2:rgb.red=p;rgb.green=tov;rgb.blue=t;break;case 3:rgb.red=p;rgb.green=q;rgb.blue=tov;break;case 4:rgb.red=t;rgb.green=p;rgb.blue=tov;break;case 5:rgb.red=tov;rgb.green=p;rgb.blue=q;break;}}return rgb;},randomColor:function(){var r=Math.round(Math.random()*255);var g=Math.round(Math.random()*255);var b=Math.round(Math.random()*255);return this.rgbToRgbString([r,g,b]);}}});qx.Class.define("qx.dev.unit.TestFunction",{extend:qx.core.Object,construct:function(clazz,methodName,testFunction){if(testFunction){this.setTestFunction(testFunction);}else{this.setTestFunction(function(){var cls=new clazz;if(typeof (cls.setUp)=="function"){cls.setUp();}try{cls[methodName]();}catch(e){throw e;}finally{if(typeof (cls.tearDown)=="function"){cls.tearDown();}}});}if(clazz){this.setClassName(clazz.classname);}this.setName(methodName);},properties:{testFunction:{check:"Function"},name:{check:"String"},className:{check:"String",init:""}},members:{run:function(testResult){testResult.run(this,this.getTestFunction());},getFullName:function(){return [this.getClassName(),this.getName()].join(":");}}});qx.Class.define("qx.dev.unit.TestClass",{extend:qx.dev.unit.TestSuite,construct:function(clazz){this.base(arguments);if(!clazz){this.addFail("exsitsCheck"+this.__testClassNames.length,"Unkown test class!");return;}if(!qx.Class.isSubClassOf(clazz,qx.dev.unit.TestCase)){this.addFail("Sub class check.","The test class '"+clazz.classname+"'is not a sub class of 'qx.dev.unit.TestCase'");return;}var proto=clazz.prototype;for(var test in proto){if(proto.hasOwnProperty(test)){if(typeof (proto[test])=="function"&&test.indexOf("test")==0){this.addTestMethod(clazz,test);}}}this.setName(clazz.classname);},properties:{name:{check:"String"}}});qx.Class.define("qx.dev.unit.TestResult",{extend:qx.core.Object,events:{startTest:"qx.event.type.Data",endTest:"qx.event.type.Data",error:"qx.event.type.Data",failure:"qx.event.type.Data"},statics:{run:function(testResult,test,testFunction){testResult.run(test,testFunction);}},members:{run:function(test,testFunction){this.fireDataEvent("startTest",test);try{testFunction();}catch(e){var error=true;if(e.classname=="qx.core.AssertionError"){this.__createError("failure",e,test);}else{this.__createError("error",e,test);}}if(!error){this.fireDataEvent("endTest",test);}},__createError:function(eventName,exception,test){var error={exception:exception,test:test};this.fireDataEvent(eventName,error);this.fireDataEvent("endTest",test);}}});qx.Class.define("qx.dev.unit.JsUnitTestResult",{extend:qx.dev.unit.TestResult,construct:function(){this.base(arguments);this._testFunctionNames=[];},members:{run:function(test,testFunction){var testFunctionName="$test_"+test.getFullName().replace(/\W/g,"_");this._testFunctionNames.push(testFunctionName);window[testFunctionName]=testFunction;},exportToJsUnit:function(){var self=this;window.exposeTestFunctionNames=function(){return self._testFunctionNames;};window.isTestPageLoaded=true;}}});qx.Class.define("qx.test.event.MockBubblingHandler",{extend:qx.core.Object,implement:qx.event.IEventHandler,statics:{PRIORITY:qx.event.Registration.PRIORITY_LAST},members:{canHandleEvent:function(target,type){return target.nodeType!==undefined;},registerEvent:function(target,type,capture){},unregisterEvent:function(target,type,capture){}},defer:function(statics){qx.event.Registration.addHandler(statics);}});qx.Class.define("qx.test.event.Bubbling",{extend:qx.dev.unit.TestCase,events:{"nonBubble":"qx.event.type.Event"},members:{setUp:function(){var root=qx.bom.Element.create("div",{id:"root"});document.body.appendChild(root);root.innerHTML="<div id='c_1'>"+"<div id='c_1_1'></div>"+"</div>"+"<div id='c_2'>";this.c_1=document.getElementById("c_1");this.c_1_1=document.getElementById("c_1_1");this.c_2=document.getElementById("c_2");},tearDown:function(){var Reg=qx.event.Registration;Reg.removeAllListeners(this.c_1);Reg.removeAllListeners(this.c_1_1);Reg.removeAllListeners(this.c_2);document.body.removeChild(document.getElementById("root"));},testBubbling:function(){var Reg=qx.event.Registration;var called;Reg.addListener(this.c_1,"bubble",function(){called.push("c_1a");},this);Reg.addListener(this.c_1,"bubble",function(){called.push("c_1b");},this);Reg.addListener(this.c_1_1,"bubble",function(){called.push("c_1_1a");},this);Reg.addListener(this.c_1_1,"bubble",function(){called.push("c_1_1b");},this);Reg.addListener(this.c_2,"bubble",function(){called.push("c_2a");},this);Reg.addListener(this.c_2,"bubble",function(){called.push("c_2b");},this);called=[];Reg.fireEvent(this.c_1,"bubble",qx.event.type.Event,[true,true]);this.assertJsonEquals(["c_1a","c_1b"],called);called=[];Reg.fireEvent(this.c_1_1,"bubble",qx.event.type.Event,[true,true]);this.assertJsonEquals(["c_1_1a","c_1_1b","c_1a","c_1b"],called);called=[];Reg.fireEvent(this.c_2,"bubble",qx.event.type.Event,[true,true]);this.assertJsonEquals(["c_2a","c_2b"],called);},testContext:function(){var Reg=qx.event.Registration;var called;var contexts;Reg.addListener(this.c_1,"bubble",function(){called.push("c_1");contexts.push(this);});Reg.addListener(this.c_1_1,"bubble",function(){called.push("c_1_1a");contexts.push(this);});Reg.addListener(this.c_1_1,"bubble",function(){called.push("c_1_1b");contexts.push(this);},this);called=[];contexts=[];Reg.fireEvent(this.c_1_1,"bubble",qx.event.type.Event,[true,true]);this.assertJsonEquals(["c_1_1a","c_1_1b","c_1"],called);this.assertEquals(3,contexts.length);this.assertEquals(this.c_1_1,contexts[0]);this.assertEquals(this,contexts[1]);this.assertEquals(this.c_1,contexts[2]);},testCapture:function(){var Reg=qx.event.Registration;var called;Reg.addListener(this.c_1,"bubble",function(){called.push("c_1a");},this,true);Reg.addListener(this.c_1,"bubble",function(){called.push("c_1b");},this);Reg.addListener(this.c_1_1,"bubble",function(){called.push("c_1_1a");},this,true);Reg.addListener(this.c_1_1,"bubble",function(){called.push("c_1_1b");},this);Reg.addListener(this.c_2,"bubble",function(){called.push("c_2a");},this,true);Reg.addListener(this.c_2,"bubble",function(){called.push("c_2b");},this);called=[];Reg.fireEvent(this.c_1,"bubble",qx.event.type.Event,[true,true]);this.assertJsonEquals(["c_1a","c_1b"],called);called=[];Reg.fireEvent(this.c_1_1,"bubble",qx.event.type.Event,[true,true]);this.assertJsonEquals(["c_1a","c_1_1a","c_1_1b","c_1b"],called);called=[];Reg.fireEvent(this.c_2,"bubble",qx.event.type.Event,[true,true]);this.assertJsonEquals(["c_2a","c_2b"],called);},_stopPropagation:function(e){e.stopPropagation();},testStopPropagation:function(){var Reg=qx.event.Registration;var called;Reg.addListener(this.c_1,"bubble",this._stopPropagation,this,true);Reg.addListener(this.c_1,"bubble",function(){called.push("c_1a");},this,true);Reg.addListener(this.c_1,"bubble",function(){called.push("c_1b");},this);Reg.addListener(this.c_1_1,"bubble",function(){called.push("c_1_1a");},this,true);Reg.addListener(this.c_1_1,"bubble",function(){called.push("c_1_1b");},this);Reg.addListener(this.c_2,"bubble",function(){called.push("c_2a");},this,true);Reg.addListener(this.c_2,"bubble",function(){called.push("c_2b");},this);called=[];Reg.fireEvent(this.c_1,"bubble",qx.event.type.Event,[true,true]);this.assertJsonEquals(["c_1a"],called);called=[];Reg.fireEvent(this.c_1_1,"bubble",qx.event.type.Event,[true,true]);this.assertJsonEquals(["c_1a"],called);called=[];Reg.fireEvent(this.c_2,"bubble",qx.event.type.Event,[true,true]);this.assertJsonEquals(["c_2a","c_2b"],called);Reg.removeListener(this.c_1,"bubble",this._stopPropagation,this,true);Reg.addListener(this.c_1_1,"bubble",this._stopPropagation,this,true);called=[];Reg.fireEvent(this.c_1,"bubble",qx.event.type.Event,[true,true]);this.assertJsonEquals(["c_1a","c_1b"],called);called=[];Reg.fireEvent(this.c_1_1,"bubble",qx.event.type.Event,[true,true]);this.assertJsonEquals(["c_1a","c_1_1a"],called);called=[];Reg.fireEvent(this.c_2,"bubble",qx.event.type.Event,[true,true]);this.assertJsonEquals(["c_2a","c_2b"],called);Reg.removeListener(this.c_1_1,"bubble",this._stopPropagation,this,true);Reg.addListener(this.c_1_1,"bubble",this._stopPropagation,this,false);called=[];Reg.fireEvent(this.c_1,"bubble",qx.event.type.Event,[true,true]);this.assertJsonEquals(["c_1a","c_1b"],called);called=[];Reg.fireEvent(this.c_1_1,"bubble",qx.event.type.Event,[true,true]);this.assertJsonEquals(["c_1a","c_1_1a","c_1_1b"],called);called=[];Reg.fireEvent(this.c_2,"bubble",qx.event.type.Event,[true,true]);this.assertJsonEquals(["c_2a","c_2b"],called);},_preventDefault:function(e){e.preventDefault();},testPreventDefault:function(){var Reg=qx.event.Registration;var called;Reg.addListener(this.c_1,"bubble",function(){called.push("c_1a");},this);Reg.addListener(this.c_1_1,"bubble",function(){called.push("c_1_1a");},this);called=[];var prevent=Reg.fireEvent(this.c_1_1,"bubble",qx.event.type.Event,[true,true]);this.assertTrue(prevent);this.assertJsonEquals(["c_1_1a","c_1a"],called);Reg.addListener(this.c_1,"bubble",this._preventDefault,this);called=[];var prevent=Reg.fireEvent(this.c_1_1,"bubble",qx.event.type.Event,[true,true]);this.assertFalse(prevent);this.assertJsonEquals(["c_1_1a","c_1a"],called);Reg.addListener(this.c_1_1,"bubble",this._stopPropagation,this);called=[];var prevent=Reg.fireEvent(this.c_1_1,"bubble",qx.event.type.Event,[true,true]);this.assertTrue(prevent);this.assertJsonEquals(["c_1_1a"],called);Reg.removeListener(this.c_1_1,"bubble",this._stopPropagation,this);Reg.removeListener(this.c_1,"bubble",this._preventDefault,this);Reg.addListener(this.c_1_1,"bubble",this._preventDefault,this);called=[];var prevent=Reg.fireEvent(this.c_1_1,"bubble",qx.event.type.Event,[true,true]);this.assertFalse(prevent);this.assertJsonEquals(["c_1_1a","c_1a"],called);this.addListener("nonBubble",this._preventDefault,this);var prevent=Reg.fireEvent(this,"nonBubble",qx.event.type.Event,[false,true]);this.assertFalse(prevent);this.removeListener("nonBubble",this._preventDefault,this);this.addListener("nonBubble",this._preventDefault,this);var self=this;if(this.isDebugOn()){this.assertException(function(){Reg.fireEvent(self,"nonBubble",qx.event.type.Event,[false,false]);},qx.core.AssertionError,"Cannot prevent default action on a non cancelable event");}this.removeListener("nonBubble",this._preventDefault,this);var prevent=Reg.fireEvent(this,"nonBubble",qx.event.type.Event,[false,true]);this.assertTrue(prevent);}}});qx.Class.define("qx.event.dispatch.AbstractBubbling",{extend:qx.core.Object,implement:qx.event.IEventDispatcher,type:"abstract",construct:function(manager){this._manager=manager;},members:{_getParent:function(target){throw new Error("Missing implementation");},canDispatchEvent:function(target,event,type){return event.getBubbles();},dispatchEvent:function(target,event,type){var parent=target;var manager=this._manager;var captureListeners,bubbleListeners;var localList;var listener,context;var currentTarget;var targetList=[];captureListeners=manager.getListeners(target,type,true);bubbleListeners=manager.getListeners(target,type,false);if(captureListeners){targetList.push(captureListeners);}if(bubbleListeners){targetList.push(bubbleListeners);}var parent=this._getParent(target);var bubbleList=[];var bubbleTargets=[];var captureList=[];var captureTargets=[];while(parent!=null){captureListeners=manager.getListeners(parent,type,true);if(captureListeners){captureList.push(captureListeners);captureTargets.push(parent);}bubbleListeners=manager.getListeners(parent,type,false);if(bubbleListeners){bubbleList.push(bubbleListeners);bubbleTargets.push(parent);}parent=this._getParent(parent);}event.setEventPhase(qx.event.type.Event.CAPTURING_PHASE);for(var i=captureList.length-1;i>=0;i--){currentTarget=captureTargets[i];event.setCurrentTarget(currentTarget);localList=captureList[i];for(var j=0,jl=localList.length;j<jl;j++){listener=localList[j];context=listener.context||currentTarget;listener.handler.call(context,event);}if(event.getPropagationStopped()){return;}}event.setEventPhase(qx.event.type.Event.AT_TARGET);event.setCurrentTarget(target);for(var i=0,il=targetList.length;i<il;i++){localList=targetList[i];for(var j=0,jl=localList.length;j<jl;j++){listener=localList[j];context=listener.context||target;listener.handler.call(context,event);}if(event.getPropagationStopped()){return;}}event.setEventPhase(qx.event.type.Event.BUBBLING_PHASE);for(var i=0,il=bubbleList.length;i<il;i++){currentTarget=bubbleTargets[i];event.setCurrentTarget(currentTarget);localList=bubbleList[i];for(var j=0,jl=localList.length;j<jl;j++){listener=localList[j];context=listener.context||currentTarget;listener.handler.call(context,event);}if(event.getPropagationStopped()){return;}}}}});qx.Class.define("qx.event.dispatch.DomBubbling",{extend:qx.event.dispatch.AbstractBubbling,statics:{PRIORITY:qx.event.Registration.PRIORITY_NORMAL},members:{_getParent:function(target){return target.parentNode;},canDispatchEvent:function(target,event,type){return target.nodeType!==undefined&&event.getBubbles();}},defer:function(statics){qx.event.Registration.addDispatcher(statics);}});qx.Class.define("qx.event.handler.UserAction",{extend:qx.core.Object,implement:qx.event.IEventHandler,construct:function(manager){this.base(arguments);this.__manager=manager;this.__window=manager.getWindow();},statics:{PRIORITY:qx.event.Registration.PRIORITY_NORMAL,SUPPORTED_TYPES:{useraction:1},TARGET_CHECK:qx.event.IEventHandler.TARGET_WINDOW,IGNORE_CAN_HANDLE:true},members:{canHandleEvent:function(target,type){},registerEvent:function(target,type,capture){},unregisterEvent:function(target,type,capture){}},destruct:function(){this._disposeFields("__manager","__window");},defer:function(statics){qx.event.Registration.addHandler(statics);}});qx.Class.define("qx.event.handler.Keyboard",{extend:qx.core.Object,implement:qx.event.IEventHandler,construct:function(manager){this.base(arguments);this.__manager=manager;this.__window=manager.getWindow();if(qx.core.Variant.isSet("qx.client","gecko")){this.__root=this.__window;}else{this.__root=this.__window.document.documentElement;}this.__lastUpDownType={};this._initKeyObserver();},statics:{PRIORITY:qx.event.Registration.PRIORITY_NORMAL,SUPPORTED_TYPES:{keyup:1,keydown:1,keypress:1,keyinput:1},TARGET_CHECK:qx.event.IEventHandler.TARGET_DOMNODE,IGNORE_CAN_HANDLE:true,isValidKeyIdentifier:function(keyIdentifier){if(this._identifierToKeyCodeMap[keyIdentifier]){return true;}if(keyIdentifier.length!=1){return false;}if(keyIdentifier>="0"&&keyIdentifier<="9"){return true;}if(keyIdentifier>="A"&&keyIdentifier<="Z"){return true;}switch(keyIdentifier){case "+":case "-":case "*":case "/":return true;default:return false;}}},members:{__onKeyUpDownWrapper:null,__manager:null,__window:null,__root:null,__lastUpDownType:null,canHandleEvent:function(target,type){},registerEvent:function(target,type,capture){},unregisterEvent:function(target,type,capture){},_fireInputEvent:function(domEvent,charCode){var focusHandler=this.__manager.getHandler(qx.event.handler.Focus);var target=focusHandler.getActive();if(!target||target.offsetWidth==0){target=focusHandler.getFocus();}if(target&&target.offsetWidth!=0){var event=qx.event.Registration.createEvent("keyinput",qx.event.type.KeyInput,[domEvent,target,charCode]);this.__manager.dispatchEvent(target,event);}if(this.__window){qx.event.Registration.fireEvent(this.__window,"useraction",qx.event.type.Data,["keyinput"]);}},_fireSequenceEvent:function(domEvent,type,keyIdentifier){var focusHandler=this.__manager.getHandler(qx.event.handler.Focus);var target=focusHandler.getActive();if(!target||target.offsetWidth==0){target=focusHandler.getFocus();}if(!target||target.offsetWidth==0){target=this.__manager.getWindow().document.body;}var event=qx.event.Registration.createEvent(type,qx.event.type.KeySequence,[domEvent,target,keyIdentifier]);this.__manager.dispatchEvent(target,event);if(qx.core.Variant.isSet("qx.client","mshtml|webkit")){if(type=="keydown"&&event.getDefaultPrevented()){var keyCode=domEvent.keyCode;if(!(this._isNonPrintableKeyCode(keyCode)||keyCode==8||keyCode==9)){this._fireSequenceEvent(domEvent,"keypress",keyIdentifier);}}}if(this.__window){qx.event.Registration.fireEvent(this.__window,"useraction",qx.event.type.Data,[type]);}},_initKeyObserver:function(){this.__onKeyUpDownWrapper=qx.lang.Function.listener(this._onKeyUpDown,this);this._onKeyPressWrapper=qx.lang.Function.listener(this._onKeyPress,this);var Event=qx.bom.Event;Event.addNativeListener(this.__root,"keyup",this.__onKeyUpDownWrapper);Event.addNativeListener(this.__root,"keydown",this.__onKeyUpDownWrapper);Event.addNativeListener(this.__root,"keypress",this._onKeyPressWrapper);},_stopKeyObserver:function(){var Event=qx.bom.Event;Event.removeNativeListener(this.__root,"keyup",this.__onKeyUpDownWrapper);Event.removeNativeListener(this.__root,"keydown",this.__onKeyUpDownWrapper);Event.removeNativeListener(this.__root,"keypress",this._onKeyPressWrapper);},_onKeyUpDown:qx.core.Variant.select("qx.client",{"mshtml":function(domEvent){domEvent=window.event||domEvent;var keyCode=domEvent.keyCode;var charCode=0;var type=domEvent.type;if(!(this.__lastUpDownType[keyCode]=="keydown"&&type=="keydown")){this._idealKeyHandler(keyCode,charCode,type,domEvent);}if(type=="keydown"){if(this._isNonPrintableKeyCode(keyCode)||keyCode==8||keyCode==9){this._idealKeyHandler(keyCode,charCode,"keypress",domEvent);}}this.__lastUpDownType[keyCode]=type;},"gecko":function(domEvent){var keyCode=this._keyCodeFix[domEvent.keyCode]||domEvent.keyCode;var charCode=domEvent.charCode;var type=domEvent.type;if(qx.bom.client.Platform.WIN){var keyIdentifier=keyCode?this._keyCodeToIdentifier(keyCode):this._charCodeToIdentifier(charCode);if(!(this.__lastUpDownType[keyIdentifier]=="keydown"&&type=="keydown")){this._idealKeyHandler(keyCode,charCode,type,domEvent);}this.__lastUpDownType[keyIdentifier]=type;}else{this._idealKeyHandler(keyCode,charCode,type,domEvent);}},"webkit":function(domEvent){var keyCode=0;var charCode=0;var type=domEvent.type;if(qx.bom.client.Engine.VERSION<525.13){if(type=="keyup"||type=="keydown"){keyCode=this._charCode2KeyCode[domEvent.charCode]||domEvent.keyCode;}else{if(this._charCode2KeyCode[domEvent.charCode]){keyCode=this._charCode2KeyCode[domEvent.charCode];}else{charCode=domEvent.charCode;}}this._idealKeyHandler(keyCode,charCode,type,domEvent);}else{keyCode=domEvent.keyCode;if(!(this.__lastUpDownType[keyCode]=="keydown"&&type=="keydown")){this._idealKeyHandler(keyCode,charCode,type,domEvent);}if(type=="keydown"){if(this._isNonPrintableKeyCode(keyCode)||keyCode==8||keyCode==9){this._idealKeyHandler(keyCode,charCode,"keypress",domEvent);}}this.__lastUpDownType[keyCode]=type;}},"opera":function(domEvent){this._idealKeyHandler(domEvent.keyCode,0,domEvent.type,domEvent);}}),_onKeyPress:qx.core.Variant.select("qx.client",{"mshtml":function(domEvent){domEvent=window.event||domEvent;if(this._charCode2KeyCode[domEvent.keyCode]){this._idealKeyHandler(this._charCode2KeyCode[domEvent.keyCode],0,domEvent.type,domEvent);}else{this._idealKeyHandler(0,domEvent.keyCode,domEvent.type,domEvent);}},"gecko":function(domEvent){var keyCode=this._keyCodeFix[domEvent.keyCode]||domEvent.keyCode;var charCode=domEvent.charCode;var type=domEvent.type;this._idealKeyHandler(keyCode,charCode,type,domEvent);},"webkit":function(domEvent){if(qx.bom.client.Engine.VERSION<525.13){var keyCode=0;var charCode=0;var type=domEvent.type;if(type=="keyup"||type=="keydown"){keyCode=this._charCode2KeyCode[domEvent.charCode]||domEvent.keyCode;}else{if(this._charCode2KeyCode[domEvent.charCode]){keyCode=this._charCode2KeyCode[domEvent.charCode];}else{charCode=domEvent.charCode;}}this._idealKeyHandler(keyCode,charCode,type,domEvent);}else{if(this._charCode2KeyCode[domEvent.keyCode]){this._idealKeyHandler(this._charCode2KeyCode[domEvent.keyCode],0,domEvent.type,domEvent);}else{this._idealKeyHandler(0,domEvent.keyCode,domEvent.type,domEvent);}}},"opera":function(domEvent){if(this._keyCodeToIdentifierMap[domEvent.keyCode]){this._idealKeyHandler(domEvent.keyCode,0,domEvent.type,domEvent);}else{this._idealKeyHandler(0,domEvent.keyCode,domEvent.type,domEvent);}}}),_idealKeyHandler:function(keyCode,charCode,eventType,domEvent){if(!keyCode&&!charCode){return;}var keyIdentifier;if(keyCode){keyIdentifier=this._keyCodeToIdentifier(keyCode);this._fireSequenceEvent(domEvent,eventType,keyIdentifier);}else{keyIdentifier=this._charCodeToIdentifier(charCode);this._fireSequenceEvent(domEvent,"keypress",keyIdentifier);this._fireInputEvent(domEvent,charCode);}},_specialCharCodeMap:{8:"Backspace",9:"Tab",13:"Enter",27:"Escape",32:"Space"},_keyCodeToIdentifierMap:{16:"Shift",17:"Control",18:"Alt",20:"CapsLock",224:"Meta",37:"Left",38:"Up",39:"Right",40:"Down",33:"PageUp",34:"PageDown",35:"End",36:"Home",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",44:"PrintScreen",145:"Scroll",19:"Pause",91:"Win",93:"Apps"},_numpadToCharCode:{96:"0".charCodeAt(0),97:"1".charCodeAt(0),98:"2".charCodeAt(0),99:"3".charCodeAt(0),100:"4".charCodeAt(0),101:"5".charCodeAt(0),102:"6".charCodeAt(0),103:"7".charCodeAt(0),104:"8".charCodeAt(0),105:"9".charCodeAt(0),106:"*".charCodeAt(0),107:"+".charCodeAt(0),109:"-".charCodeAt(0),110:",".charCodeAt(0),111:"/".charCodeAt(0)},_charCodeA:"A".charCodeAt(0),_charCodeZ:"Z".charCodeAt(0),_charCode0:"0".charCodeAt(0),_charCode9:"9".charCodeAt(0),_isNonPrintableKeyCode:function(keyCode){return this._keyCodeToIdentifierMap[keyCode]?true:false;},_isIdentifiableKeyCode:function(keyCode){if(keyCode>=this._charCodeA&&keyCode<=this._charCodeZ){return true;}if(keyCode>=this._charCode0&&keyCode<=this._charCode9){return true;}if(this._specialCharCodeMap[keyCode]){return true;}if(this._numpadToCharCode[keyCode]){return true;}if(this._isNonPrintableKeyCode(keyCode)){return true;}return false;},_keyCodeToIdentifier:function(keyCode){if(this._isIdentifiableKeyCode(keyCode)){var numPadKeyCode=this._numpadToCharCode[keyCode];if(numPadKeyCode){return String.fromCharCode(numPadKeyCode);}return (this._keyCodeToIdentifierMap[keyCode]||this._specialCharCodeMap[keyCode]||String.fromCharCode(keyCode));}else{return "Unidentified";}},_charCodeToIdentifier:function(charCode){return this._specialCharCodeMap[charCode]||String.fromCharCode(charCode).toUpperCase();},_identifierToKeyCode:function(keyIdentifier){return qx.event.handler.Keyboard._identifierToKeyCodeMap[keyIdentifier]||keyIdentifier.charCodeAt(0);}},destruct:function(){this._stopKeyObserver();this._disposeFields("__manager","__window","__root","__lastUpDownType");},defer:function(statics,members,properties){qx.event.Registration.addHandler(statics);if(!statics._identifierToKeyCodeMap){statics._identifierToKeyCodeMap={};for(var key in members._keyCodeToIdentifierMap){statics._identifierToKeyCodeMap[members._keyCodeToIdentifierMap[key]]=parseInt(key,10);}for(var key in members._specialCharCodeMap){statics._identifierToKeyCodeMap[members._specialCharCodeMap[key]]=parseInt(key,10);}}if(qx.core.Variant.isSet("qx.client","mshtml")){members._charCode2KeyCode={13:13,27:27};}else if(qx.core.Variant.isSet("qx.client","gecko")){members._keyCodeFix={12:members._identifierToKeyCode("NumLock")};}else if(qx.core.Variant.isSet("qx.client","webkit")){if(qx.bom.client.Engine.VERSION<525.13){members._charCode2KeyCode={63289:members._identifierToKeyCode("NumLock"),63276:members._identifierToKeyCode("PageUp"),63277:members._identifierToKeyCode("PageDown"),63275:members._identifierToKeyCode("End"),63273:members._identifierToKeyCode("Home"),63234:members._identifierToKeyCode("Left"),63232:members._identifierToKeyCode("Up"),63235:members._identifierToKeyCode("Right"),63233:members._identifierToKeyCode("Down"),63272:members._identifierToKeyCode("Delete"),63302:members._identifierToKeyCode("Insert"),63236:members._identifierToKeyCode("F1"),63237:members._identifierToKeyCode("F2"),63238:members._identifierToKeyCode("F3"),63239:members._identifierToKeyCode("F4"),63240:members._identifierToKeyCode("F5"),63241:members._identifierToKeyCode("F6"),63242:members._identifierToKeyCode("F7"),63243:members._identifierToKeyCode("F8"),63244:members._identifierToKeyCode("F9"),63245:members._identifierToKeyCode("F10"),63246:members._identifierToKeyCode("F11"),63247:members._identifierToKeyCode("F12"),63248:members._identifierToKeyCode("PrintScreen"),3:members._identifierToKeyCode("Enter"),12:members._identifierToKeyCode("NumLock"),13:members._identifierToKeyCode("Enter")};}else{members._charCode2KeyCode={13:13,27:27};}}}});qx.Class.define("qx.event.handler.Mouse",{extend:qx.core.Object,implement:qx.event.IEventHandler,construct:function(manager){this.base(arguments);this.__manager=manager;this.__window=manager.getWindow();this.__root=this.__window.document.documentElement;this._initButtonObserver();this._initMoveObserver();this._initWheelObserver();},statics:{PRIORITY:qx.event.Registration.PRIORITY_NORMAL,SUPPORTED_TYPES:{mousemove:1,mouseover:1,mouseout:1,mousedown:1,mouseup:1,click:1,dblclick:1,contextmenu:1,mousewheel:1},TARGET_CHECK:qx.event.IEventHandler.TARGET_DOMNODE,IGNORE_CAN_HANDLE:true},members:{__onButtonEventWrapper:null,__onMoveEventWrapper:null,__onWheelEventWrapper:null,__lastEventType:null,__lastMouseDownTarget:null,__manager:null,__window:null,__root:null,canHandleEvent:function(target,type){},registerEvent:function(target,type,capture){},unregisterEvent:function(target,type,capture){},__fireEvent:function(domEvent,type,target){if(!target){target=domEvent.target||domEvent.srcElement;}qx.event.Registration.fireEvent(target,type||domEvent.type,qx.event.type.Mouse,[domEvent,target,null,true,true]);qx.event.Registration.fireEvent(this.__window,"useraction",qx.event.type.Data,[type||domEvent.type]);},_initButtonObserver:function(){this.__onButtonEventWrapper=qx.lang.Function.listener(this._onButtonEvent,this);var Event=qx.bom.Event;Event.addNativeListener(this.__root,"mousedown",this.__onButtonEventWrapper);Event.addNativeListener(this.__root,"mouseup",this.__onButtonEventWrapper);Event.addNativeListener(this.__root,"click",this.__onButtonEventWrapper);Event.addNativeListener(this.__root,"dblclick",this.__onButtonEventWrapper);Event.addNativeListener(this.__root,"contextmenu",this.__onButtonEventWrapper);},_initMoveObserver:function(){this.__onMoveEventWrapper=qx.lang.Function.listener(this._onMoveEvent,this);var Event=qx.bom.Event;Event.addNativeListener(this.__root,"mousemove",this.__onMoveEventWrapper);Event.addNativeListener(this.__root,"mouseover",this.__onMoveEventWrapper);Event.addNativeListener(this.__root,"mouseout",this.__onMoveEventWrapper);},_initWheelObserver:function(){this.__onWheelEventWrapper=qx.lang.Function.listener(this._onWheelEvent,this);var Event=qx.bom.Event;var type=qx.core.Variant.isSet("qx.client","mshtml|webkit|opera")?"mousewheel":"DOMMouseScroll";Event.addNativeListener(this.__root,type,this.__onWheelEventWrapper);},_stopButtonObserver:function(){var Event=qx.bom.Event;Event.removeNativeListener(this.__root,"mousedown",this.__onButtonEventWrapper);Event.removeNativeListener(this.__root,"mouseup",this.__onButtonEventWrapper);Event.removeNativeListener(this.__root,"click",this.__onButtonEventWrapper);Event.removeNativeListener(this.__root,"dblclick",this.__onButtonEventWrapper);Event.removeNativeListener(this.__root,"contextmenu",this.__onButtonEventWrapper);},_stopMoveObserver:function(){var Event=qx.bom.Event;Event.removeNativeListener(this.__root,"mousemove",this.__onMoveEventWrapper);Event.removeNativeListener(this.__root,"mouseover",this.__onMoveEventWrapper);Event.removeNativeListener(this.__root,"mouseout",this.__onMoveEventWrapper);},_stopWheelObserver:function(){var Event=qx.bom.Event;var type=qx.core.Variant.isSet("qx.client","mshtml|webkit|opera")?"mousewheel":"DOMMouseScroll";Event.removeNativeListener(this.__root,type,this.__onWheelEventWrapper);},_onMoveEvent:function(domEvent){this.__fireEvent(domEvent);},_onButtonEvent:function(domEvent){var type=domEvent.type;var target=domEvent.target||domEvent.srcElement;if(qx.core.Variant.isSet("qx.client","gecko|webkit")){if(target&&target.nodeType==3){target=target.parentNode;}}if(this.__rightClickFixPre){this.__rightClickFixPre(domEvent,type,target);}if(this.__doubleClickFixPre){this.__doubleClickFixPre(domEvent,type,target);}this.__fireEvent(domEvent,type,target);if(this.__rightClickFixPost){this.__rightClickFixPost(domEvent,type,target);}if(this.__differentTargetClickFixPost){this.__differentTargetClickFixPost(domEvent,type,target);}this.__lastEventType=type;},_onWheelEvent:function(domEvent){this.__fireEvent(domEvent,"mousewheel");},__rightClickFixPre:qx.core.Variant.select("qx.client",{"webkit":function(domEvent,type,target){if(type=="contextmenu"){this.__fireEvent(domEvent,"mousedown",target);this.__fireEvent(domEvent,"mouseup",target);}},"default":null}),__rightClickFixPost:qx.core.Variant.select("qx.client",{"opera":function(domEvent,type,target){if(type=="mouseup"&&domEvent.button==2){this.__fireEvent(domEvent,"contextmenu",target);}},"default":null}),__doubleClickFixPre:qx.core.Variant.select("qx.client",{"mshtml":function(domEvent,type,target){if(type=="mouseup"&&this.__lastEventType=="click"){this.__fireEvent(domEvent,"mousedown",target);}else if(type=="dblclick"){this.__fireEvent(domEvent,"click",target);}},"default":null}),__differentTargetClickFixPost:qx.core.Variant.select("qx.client",{"mshtml":null,"default":function(domEvent,type,target){switch(type){case "mousedown":this.__lastMouseDownTarget=target;break;case "mouseup":if(target!==this.__lastMouseDownTarget){var commonParent=qx.dom.Hierarchy.getCommonParent(target,this.__lastMouseDownTarget);this.__fireEvent(domEvent,"click",commonParent);}}}})},destruct:function(){this._stopButtonObserver();this._stopMoveObserver();this._stopWheelObserver();this._disposeFields("__manager","__window","__root","__lastMouseDownTarget");},defer:function(statics){qx.event.Registration.addHandler(statics);}});qx.Class.define("qx.event.handler.Capture",{extend:qx.core.Object,implement:qx.event.IEventHandler,statics:{PRIORITY:qx.event.Registration.PRIORITY_NORMAL,SUPPORTED_TYPES:{capture:true,losecapture:true},TARGET_CHECK:qx.event.IEventHandler.TARGET_DOMNODE,IGNORE_CAN_HANDLE:true},members:{canHandleEvent:function(target,type){},registerEvent:function(target,type,capture){},unregisterEvent:function(target,type,capture){}},defer:function(statics){qx.event.Registration.addHandler(statics);}});qx.Class.define("qx.event.handler.DragDrop",{extend:qx.core.Object,implement:qx.event.IEventHandler,construct:function(manager){this.base(arguments);this.__manager=manager;this.__root=manager.getWindow().document.documentElement;this.__manager.addListener(this.__root,"mousedown",this._onMouseDown,this);this.__rebuildStructures();},statics:{PRIORITY:qx.event.Registration.PRIORITY_NORMAL,SUPPORTED_TYPES:{dragstart:1,dragend:1,dragover:1,dragleave:1,drop:1,drag:1,dragchange:1,droprequest:1},IGNORE_CAN_HANDLE:true},members:{canHandleEvent:function(target,type){},registerEvent:function(target,type,capture){},unregisterEvent:function(target,type,capture){},addType:function(type){this.__types[type]=true;},addAction:function(action){this.__actions[action]=true;},supportsType:function(type){return !!this.__types[type];},supportsAction:function(type){return !!this.__actions[type];},getData:function(type){if(!this.__validDrop||!this.__dropTarget){throw new Error("This method must not be used outside the drop event listener!");}if(!this.__types[type]){throw new Error("Unsupported data type: "+type+"!");}if(!this.__cache[type]){this.__currentType=type;this.__fireEvent("droprequest",this.__dragTarget,false);}if(!this.__cache[type]){throw new Error("Please use a dragrequest listener to the drag target to fill the manager with data!");}return this.__cache[type]||null;},getCurrentAction:function(){return this.__currentAction;},addData:function(type,data){this.__cache[type]=data;},getCurrentType:function(){return this.__currentType;},__rebuildStructures:function(){this.__types={};this.__actions={};this.__keys={};this.__cache={};},__detectAction:function(){var actions=this.__actions;var keys=this.__keys;var current=null;if(this.__validDrop){if(keys.Shift&&keys.Ctrl&&actions.alias){current="alias";}else if(keys.Shift&&keys.Alt&&actions.copy){current="copy";}else if(keys.Shift&&actions.move){current="move";}else if(keys.Alt&&actions.alias){current="alias";}else if(keys.Ctrl&&actions.copy){current="copy";}else if(actions.move){current="move";}else if(actions.copy){current="copy";}else if(actions.alias){current="alias";}}if(current!=this.__currentAction){this.__currentAction=current;this.__fireEvent("dragchange",this.__dragTarget,false);}},__fireEvent:function(type,target,cancelable,original){var Registration=qx.event.Registration;var dragEvent=Registration.createEvent(type,qx.event.type.Drag,[cancelable,original]);if(this.__dragTarget!==this.__dropTarget){if(target==this.__dragTarget){dragEvent.setRelatedTarget(this.__dropTarget);}else{dragEvent.setRelatedTarget(this.__dragTarget);}}return Registration.dispatchEvent(target,dragEvent);},__findDraggable:function(elem){while(elem&&elem.nodeType==1){if(elem.getAttribute("qxDraggable")=="on"){return elem;}elem=elem.parentNode;}return null;},__findDroppable:function(elem){while(elem&&elem.nodeType==1){if(elem.getAttribute("qxDroppable")=="on"){return elem;}elem=elem.parentNode;}return null;},__clearInit:function(){this.__dragTarget=null;this.__manager.removeListener(this.__root,"mousemove",this._onMouseMove,this,true);this.__manager.removeListener(this.__root,"mouseup",this._onMouseUp,this,true);qx.event.Registration.removeListener(window,"blur",this._onWindowBlur,this);this.__rebuildStructures();},__clearSession:function(){if(this.__sessionActive){this.__manager.removeListener(this.__root,"mouseover",this._onMouseOver,this,true);this.__manager.removeListener(this.__root,"mouseout",this._onMouseOut,this,true);this.__manager.removeListener(this.__root,"keydown",this._onKeyDown,this,true);this.__manager.removeListener(this.__root,"keyup",this._onKeyUp,this,true);this.__fireEvent("dragend",this.__dragTarget,false);this.__sessionActive=false;}this.__validDrop=false;this.__dropTarget=null;this.__clearInit();},__validDrop:false,_onWindowBlur:function(e){this.__clearSession();},_onKeyDown:function(e){var iden=e.getKeyIdentifier();switch(iden){case "Alt":case "Ctrl":case "Shift":if(!this.__keys[iden]){this.__keys[iden]=true;this.__detectAction();}}},_onKeyUp:function(e){var iden=e.getKeyIdentifier();switch(iden){case "Alt":case "Ctrl":case "Shift":if(this.__keys[iden]){this.__keys[iden]=false;this.__detectAction();}}},_onMouseDown:function(e){if(this.__sessionActive){return;}var dragable=this.__findDraggable(e.getTarget());if(dragable){this.__startLeft=e.getDocumentLeft();this.__startTop=e.getDocumentTop();this.__dragTarget=dragable;this.__manager.addListener(this.__root,"mousemove",this._onMouseMove,this,true);this.__manager.addListener(this.__root,"mouseup",this._onMouseUp,this,true);qx.event.Registration.addListener(window,"blur",this._onWindowBlur,this);}},_onMouseUp:function(e){if(this.__validDrop){this.__fireEvent("drop",this.__dropTarget,false,e);}if(this.__sessionActive){e.stopPropagation();}this.__clearSession();},_onMouseMove:function(e){if(this.__sessionActive){if(!this.__fireEvent("drag",this.__dragTarget,true,e)){this.__clearSession();}}else{if(Math.abs(e.getDocumentLeft()-this.__startLeft)>3||Math.abs(e.getDocumentTop()-this.__startTop)>3){if(this.__fireEvent("dragstart",this.__dragTarget,true,e)){this.__sessionActive=true;this.__manager.addListener(this.__root,"mouseover",this._onMouseOver,this,true);this.__manager.addListener(this.__root,"mouseout",this._onMouseOut,this,true);this.__manager.addListener(this.__root,"keydown",this._onKeyDown,this,true);this.__manager.addListener(this.__root,"keyup",this._onKeyUp,this,true);var keys=this.__keys;keys.Ctrl=e.isCtrlPressed();keys.Shift=e.isShiftPressed();keys.Alt=e.isAltPressed();this.__detectAction();}else{this.__fireEvent("dragend",this.__dragTarget,false);this.__clearInit();}}}},_onMouseOver:function(e){var target=e.getTarget();var dropable=this.__findDroppable(target);if(dropable&&dropable!=this.__dropTarget){this.__validDrop=this.__fireEvent("dragover",dropable,true,e);this.__dropTarget=dropable;this.__detectAction();}},_onMouseOut:function(e){var target=e.getTarget();var dropable=this.__findDroppable(target);if(dropable&&dropable==this.__dropTarget){this.__fireEvent("dragleave",this.__dropTarget,false,e);this.__dropTarget=null;this.__validDrop=false;this.__detectAction();}}},destruct:function(){this.__clearSession();this.__manager.removeListener(this.__root,"mousedown",this._onMouseDown,this);this._disposeFields("__dragTarget","__dropTarget","__manager","__root","__types","__actions","__keys","__cache");},defer:function(statics){qx.event.Registration.addHandler(statics);}});qx.Class.define("qx.event.handler.Element",{extend:qx.core.Object,implement:qx.event.IEventHandler,construct:function(manager){this.base(arguments);this._manager=manager;this._registeredEvents={};},statics:{PRIORITY:qx.event.Registration.PRIORITY_NORMAL,SUPPORTED_TYPES:{abort:true,scroll:true,select:true,reset:true,submit:true},TARGET_CHECK:qx.event.IEventHandler.TARGET_DOMNODE,IGNORE_CAN_HANDLE:true},members:{canHandleEvent:function(target,type){},registerEvent:function(target,type,capture){var elementId=qx.core.ObjectRegistry.toHashCode(target);var eventId=elementId+"-"+type;var listener=qx.lang.Function.listener(this._onNative,this,eventId);qx.bom.Event.addNativeListener(target,type,listener);this._registeredEvents[eventId]={element:target,type:type,listener:listener};},unregisterEvent:function(target,type,capture){var events=this._registeredEvents;if(!events){return;}var elementId=qx.core.ObjectRegistry.toHashCode(target);var eventId=elementId+"-"+type;var eventData=this._registeredEvents[eventId];qx.bom.Event.removeNativeListener(target,type,eventData.listener);delete this._registeredEvents[eventId];},_onNative:function(nativeEvent,eventId){var events=this._registeredEvents;if(!events){return;}var eventData=events[eventId];qx.event.Registration.fireNonBubblingEvent(eventData.element,eventData.type,qx.event.type.Native,[nativeEvent]);}},destruct:function(){var entry;var events=this._registeredEvents;for(var id in events){entry=events[id];qx.bom.Event.removeNativeListener(entry.element,entry.type,entry.listener);}this._disposeFields("_manager","_registeredEvents");},defer:function(statics){qx.event.Registration.addHandler(statics);}});qx.Class.define("qx.event.handler.Appear",{extend:qx.core.Object,implement:qx.event.IEventHandler,construct:function(manager){this.base(arguments);this.__manager=manager;this.__targets={};qx.event.handler.Appear.__instances[this.$$hash]=this;},statics:{PRIORITY:qx.event.Registration.PRIORITY_NORMAL,SUPPORTED_TYPES:{appear:true,disappear:true},TARGET_CHECK:qx.event.IEventHandler.TARGET_DOMNODE,IGNORE_CAN_HANDLE:true,__instances:{},refresh:function(){var all=this.__instances;for(var hash in all){all[hash].refresh();}}},members:{canHandleEvent:function(target,type){},registerEvent:function(target,type,capture){var hash=qx.core.ObjectRegistry.toHashCode(target);var targets=this.__targets;if(targets&&!targets[hash]){targets[hash]=target;target.$$displayed=target.offsetWidth>0;}},unregisterEvent:function(target,type,capture){var hash=qx.core.ObjectRegistry.toHashCode(target);var targets=this.__targets;if(!targets){return;}if(targets[hash]){delete targets[hash];target.$$displayed=null;}},refresh:function(){var targets=this.__targets;var elem;for(var hash in targets){elem=targets[hash];var displayed=elem.offsetWidth>0;if((!!elem.$$displayed)!==displayed){elem.$$displayed=displayed;var evt=qx.event.Registration.createEvent(displayed?"appear":"disappear");this.__manager.dispatchEvent(elem,evt);}}}},destruct:function(){this._disposeFields("__manager","__targets");delete qx.event.handler.Appear.__instances[this.$$hash];},defer:function(statics){qx.event.Registration.addHandler(statics);}});qx.Class.define("qx.bom.Element",{statics:{__initialAttributes:{"onload":true,"onpropertychange":true,"oninput":true,"onchange":true,"name":true,"type":true,"checked":true,"disabled":true},create:function(name,attributes,win,ns){if(!win){win=window;}if(!name){throw new Error("The tag name is missing!");}var initial=this.__initialAttributes;var attributesHtml="";for(var key in attributes){if(initial[key]){attributesHtml+=key+"='"+attributes[key]+"' ";}}var element;if(attributesHtml!=""){if(qx.bom.client.Engine.MSHTML){element=win.document.createElement("<"+name+" "+attributesHtml+">");}else{var helper=win.document.createElement("div");helper.innerHTML="<"+name+" "+attributesHtml+"></"+name+">";element=helper.firstChild;}}else{if(win.document.createElementNS){element=win.document.createElementNS("http://www.w3.org/1999/xhtml",name);}else{element=win.document.createElement(name);}}for(var key in attributes){if(!initial[key]){qx.bom.element.Attribute.set(element,key,attributes[key]);}}return element;},empty:function(element){return element.innerHTML="";},addListener:function(element,type,listener,self,capture){return qx.event.Registration.addListener(element,type,listener,self,capture);},removeListener:function(element,type,listener,self,capture){return qx.event.Registration.removeListener(element,type,listener,self,capture);},hasListener:function(element,type,capture){return qx.event.Registration.hasListener(element,type,capture);},focus:function(element){qx.event.Registration.getManager(element).getHandler(qx.event.handler.Focus).focus(element);},blur:function(element){qx.event.Registration.getManager(element).getHandler(qx.event.handler.Focus).blur(element);},activate:function(element){qx.event.Registration.getManager(element).getHandler(qx.event.handler.Focus).activate(element);},deactivate:function(element){qx.event.Registration.getManager(element).getHandler(qx.event.handler.Focus).deactivate(element);},capture:function(element){qx.event.Registration.getManager(element).getDispatcher(qx.event.dispatch.MouseCapture).activateCapture(element);},releaseCapture:function(element){qx.event.Registration.getManager(element).getDispatcher(qx.event.dispatch.MouseCapture).releaseCapture(element);}}});qx.Class.define("qx.event.handler.Focus",{extend:qx.core.Object,implement:qx.event.IEventHandler,construct:function(manager){this.base(arguments);this._manager=manager;this._window=manager.getWindow();this._document=this._window.document;this._root=this._document.documentElement;this._body=this._document.body;this._initObserver();},properties:{active:{apply:"_applyActive",nullable:true},focus:{apply:"_applyFocus",nullable:true}},statics:{PRIORITY:qx.event.Registration.PRIORITY_NORMAL,SUPPORTED_TYPES:{focus:1,blur:1,focusin:1,focusout:1,activate:1,deactivate:1},IGNORE_CAN_HANDLE:true,FOCUSABLE_ELEMENTS:qx.core.Variant.select("qx.client",{"mshtml|gecko":{a:1,body:1,button:1,frame:1,iframe:1,img:1,input:1,object:1,select:1,textarea:1},"opera|webkit":{button:1,input:1,select:1,textarea:1}})},members:{canHandleEvent:function(target,type){},registerEvent:function(target,type,capture){},unregisterEvent:function(target,type,capture){},focus:function(element){try{element.focus();}catch(ex){}this.setFocus(element);this.setActive(element);},activate:function(element){this.setActive(element);},blur:function(element){try{element.blur();}catch(ex){}if(this.getActive()===element){this.resetActive();}if(this.getFocus()===element){this.resetFocus();}},deactivate:function(element){if(this.getActive()===element){this.resetActive();}},tryActivate:function(element){var active=this.__findActivatableElement(element);if(active){this.setActive(active);}},__fireEvent:function(target,related,type,bubbles){var Registration=qx.event.Registration;var evt=Registration.createEvent(type,qx.event.type.Focus,[target,related,bubbles]);Registration.dispatchEvent(target,evt);},_windowFocused:true,__doWindowBlur:function(){if(this._windowFocused){this._windowFocused=false;this.__fireEvent(this._window,null,"blur",false);}},__doWindowFocus:function(){if(!this._windowFocused){this._windowFocused=true;this.__fireEvent(this._window,null,"focus",false);}},_initObserver:qx.core.Variant.select("qx.client",{"gecko":function(){this.__onNativeMouseDownWrapper=qx.lang.Function.listener(this.__onNativeMouseDown,this);this.__onNativeMouseUpWrapper=qx.lang.Function.listener(this.__onNativeMouseUp,this);this.__onNativeFocusWrapper=qx.lang.Function.listener(this.__onNativeFocus,this);this.__onNativeBlurWrapper=qx.lang.Function.listener(this.__onNativeBlur,this);this.__onNativeDragGestureWrapper=qx.lang.Function.listener(this.__onNativeDragGesture,this);this._document.addEventListener("mousedown",this.__onNativeMouseDownWrapper,true);this._document.addEventListener("mouseup",this.__onNativeMouseUpWrapper,true);this._window.addEventListener("focus",this.__onNativeFocusWrapper,true);this._window.addEventListener("blur",this.__onNativeBlurWrapper,true);this._window.addEventListener("draggesture",this.__onNativeDragGestureWrapper,true);},"mshtml":function(){this.__onNativeMouseDownWrapper=qx.lang.Function.listener(this.__onNativeMouseDown,this);this.__onNativeMouseUpWrapper=qx.lang.Function.listener(this.__onNativeMouseUp,this);this.__onNativeFocusInWrapper=qx.lang.Function.listener(this.__onNativeFocusIn,this);this.__onNativeFocusOutWrapper=qx.lang.Function.listener(this.__onNativeFocusOut,this);this.__onNativeSelectStartWrapper=qx.lang.Function.listener(this.__onNativeSelectStart,this);this._document.attachEvent("onmousedown",this.__onNativeMouseDownWrapper);this._document.attachEvent("onmouseup",this.__onNativeMouseUpWrapper);this._document.attachEvent("onfocusin",this.__onNativeFocusInWrapper);this._document.attachEvent("onfocusout",this.__onNativeFocusOutWrapper);this._document.attachEvent("onselectstart",this.__onNativeSelectStartWrapper);},"webkit":function(){this.__onNativeMouseDownWrapper=qx.lang.Function.listener(this.__onNativeMouseDown,this);this.__onNativeMouseUpWrapper=qx.lang.Function.listener(this.__onNativeMouseUp,this);this.__onNativeFocusOutWrapper=qx.lang.Function.listener(this.__onNativeFocusOut,this);this.__onNativeFocusWrapper=qx.lang.Function.listener(this.__onNativeFocus,this);this.__onNativeBlurWrapper=qx.lang.Function.listener(this.__onNativeBlur,this);this.__onNativeSelectStartWrapper=qx.lang.Function.listener(this.__onNativeSelectStart,this);this._document.addEventListener("mousedown",this.__onNativeMouseDownWrapper,true);this._document.addEventListener("mouseup",this.__onNativeMouseUpWrapper,true);this._document.addEventListener("selectstart",this.__onNativeSelectStartWrapper,false);this._window.addEventListener("DOMFocusOut",this.__onNativeFocusOutWrapper,true);this._window.addEventListener("focus",this.__onNativeFocusWrapper,true);this._window.addEventListener("blur",this.__onNativeBlurWrapper,true);},"opera":function(){this.__onNativeMouseDownWrapper=qx.lang.Function.listener(this.__onNativeMouseDown,this);this.__onNativeMouseUpWrapper=qx.lang.Function.listener(this.__onNativeMouseUp,this);this.__onNativeFocusInWrapper=qx.lang.Function.listener(this.__onNativeFocusIn,this);this.__onNativeFocusOutWrapper=qx.lang.Function.listener(this.__onNativeFocusOut,this);this._document.addEventListener("mousedown",this.__onNativeMouseDownWrapper,true);this._document.addEventListener("mouseup",this.__onNativeMouseUpWrapper,true);this._window.addEventListener("DOMFocusIn",this.__onNativeFocusInWrapper,true);this._window.addEventListener("DOMFocusOut",this.__onNativeFocusOutWrapper,true);}}),_stopObserver:qx.core.Variant.select("qx.client",{"gecko":function(){this._document.removeEventListener("mousedown",this.__onNativeMouseDownWrapper,true);this._document.removeEventListener("mouseup",this.__onNativeMouseUpWrapper,true);this._window.removeEventListener("focus",this.__onNativeFocusWrapper,true);this._window.removeEventListener("blur",this.__onNativeBlurWrapper,true);this._window.removeEventListener("draggesture",this.__onNativeDragGestureWrapper,true);},"mshtml":function(){this._document.detachEvent("onmousedown",this.__onNativeMouseDownWrapper);this._document.detachEvent("onmouseup",this.__onNativeMouseUpWrapper);this._document.detachEvent("onfocusin",this.__onNativeFocusInWrapper);this._document.detachEvent("onfocusout",this.__onNativeFocusOutWrapper);this._document.detachEvent("onselectstart",this.__onNativeSelectStartWrapper);},"webkit":function(){this._document.removeEventListener("mousedown",this.__onNativeMouseDownWrapper,true);this._document.removeEventListener("selectstart",this.__onNativeSelectStartWrapper,false);this._window.removeEventListener("DOMFocusIn",this.__onNativeFocusInWrapper,true);this._window.removeEventListener("DOMFocusOut",this.__onNativeFocusOutWrapper,true);this._window.removeEventListener("focus",this.__onNativeFocusWrapper,true);this._window.removeEventListener("blur",this.__onNativeBlurWrapper,true);},"opera":function(){this._document.removeEventListener("mousedown",this.__onNativeMouseDownWrapper,true);this._window.removeEventListener("DOMFocusIn",this.__onNativeFocusInWrapper,true);this._window.removeEventListener("DOMFocusOut",this.__onNativeFocusOutWrapper,true);this._window.removeEventListener("focus",this.__onNativeFocusWrapper,true);this._window.removeEventListener("blur",this.__onNativeBlurWrapper,true);}}),__onNativeDragGesture:qx.core.Variant.select("qx.client",{"gecko":function(e){if(!this.__isSelectable(e.target)){qx.bom.Event.preventDefault(e);}},"default":null}),__onNativeFocusIn:qx.core.Variant.select("qx.client",{"mshtml":function(e){this.__doWindowFocus();var target=e.srcElement;var focusTarget=this.__findFocusableElement(target);if(focusTarget){this.setFocus(focusTarget);}this.tryActivate(target);},"opera":function(e){var target=e.target;if(target==this._document||target==this._window){this.__doWindowFocus();if(this.__previousFocus){this.setFocus(this.__previousFocus);delete this.__previousFocus;}if(this.__previousActive){this.setActive(this.__previousActive);delete this.__previousActive;}}else{this.setFocus(target);this.tryActivate(target);if(!this.__isSelectable(target)){target.selectionStart=0;target.selectionEnd=0;}}},"default":null}),__onNativeFocusOut:qx.core.Variant.select("qx.client",{"mshtml":function(e){if(!e.toElement){this.__doWindowBlur();this.resetFocus();this.resetActive();}},"webkit":function(e){var target=e.target;if(target===this.getFocus()){this.resetFocus();}if(target===this.getActive()){this.resetActive();}},"opera":function(e){var target=e.target;if(target==this._document){this.__doWindowBlur();this.__previousFocus=this.getFocus();this.__previousActive=this.getActive();this.resetFocus();this.resetActive();}else{if(target===this.getFocus()){this.resetFocus();}if(target===this.getActive()){this.resetActive();}}},"default":null}),__onNativeBlur:qx.core.Variant.select("qx.client",{"gecko":function(e){if(e.target===this._window||e.target===this._document){this.__doWindowBlur();this.resetActive();this.resetFocus();}},"webkit":function(e){if(e.target===this._window||e.target===this._document){this.__doWindowBlur();this.__previousFocus=this.getFocus();this.__previousActive=this.getActive();this.resetActive();this.resetFocus();}},"default":null}),__onNativeFocus:qx.core.Variant.select("qx.client",{"gecko":function(e){var target=e.target;if(target===this._window||target===this._document){this.__doWindowFocus();target=this._body;}this.setFocus(target);this.tryActivate(target);},"webkit":function(e){var target=e.target;if(target===this._window||target===this._document){this.__doWindowFocus();if(this.__previousFocus){this.setFocus(this.__previousFocus);delete this.__previousFocus;}if(this.__previousActive){this.setActive(this.__previousActive);delete this.__previousActive;}}else{this.setFocus(target);this.tryActivate(target);}},"default":null}),__onNativeMouseDown:qx.core.Variant.select("qx.client",{"gecko":function(e){var target=e.target;var focusTarget=this.__findFocusableElement(target);var selectable=this.__isSelectable(target);if(!selectable){qx.bom.Event.preventDefault(e);if(focusTarget){focusTarget.focus();}}else if(!focusTarget){qx.bom.Event.preventDefault(e);}},"mshtml":function(e){var target=e.srcElement;var focusTarget=this.__findFocusableElement(target);if(focusTarget){if(!this.__isSelectable(target)){target.unselectable="on";document.selection.empty();focusTarget.focus();}}else{qx.bom.Event.preventDefault(e);if(!this.__isSelectable(target)){target.unselectable="on";}}},"webkit":function(e){var target=e.target;var focusTarget=this.__findFocusableElement(target);if(focusTarget){this.setFocus(focusTarget);}else{qx.bom.Event.preventDefault(e);}},"opera":function(e){var target=e.target;var focusTarget=this.__findFocusableElement(target);if(!this.__isSelectable(target)){qx.bom.Event.preventDefault(e);if(focusTarget){var current=this.getFocus();if(current&&current.selectionEnd){current.selectionStart=0;current.selectionEnd=0;current.blur();}if(focusTarget){this.setFocus(focusTarget);}}}else if(focusTarget){this.setFocus(focusTarget);}},"default":null}),__onNativeMouseUp:qx.core.Variant.select("qx.client",{"mshtml":function(e){var target=e.srcElement;if(target.unselectable){target.unselectable="off";}this.tryActivate(target);},"gecko":function(e){var target=e.target;while(target&&target.offsetWidth===undefined){target=target.parentNode;}if(target){this.tryActivate(target);}if(this.__lastUserSelectBlocked){this.__lastUserSelectBlocked.style.MozUserSelect="";this.__lastUserSelectBlocked=null;}},"webkit|opera":function(e){this.tryActivate(e.target);},"default":null}),__onNativeSelectStart:qx.core.Variant.select("qx.client",{"mshtml|webkit":function(e){if(!this.__isSelectable(e.srcElement)){qx.bom.Event.preventDefault(e);}},"default":null}),__isFocusable:function(el){var index=qx.bom.element.Attribute.get(el,"tabIndex");if(index>=1){return true;}var focusable=qx.event.handler.Focus.FOCUSABLE_ELEMENTS;if(index>=0&&focusable[el.tagName]){return true;}return false;},__findFocusableElement:function(el){while(el&&el.nodeType===1){if(el.getAttribute("qxKeepFocus")=="on"){return null;}if(this.__isFocusable(el)){return el;}el=el.parentNode;}return this._body;},__findActivatableElement:function(el){var orig=el;while(el&&el.nodeType===1){if(el.getAttribute("qxKeepActive")=="on"){return null;}el=el.parentNode;}return orig;},__isSelectable:function(node){while(node&&node.nodeType===1){var attr=node.getAttribute("qxSelectable");if(attr!=null){return attr==="on";}node=node.parentNode;}return true;},_applyActive:function(value,old){if(old){this.__fireEvent(old,value,"deactivate",true);}if(value){this.__fireEvent(value,old,"activate",true);}},_applyFocus:function(value,old){if(old){this.__fireEvent(old,value,"focusout",true);}if(value){this.__fireEvent(value,old,"focusin",true);}if(old){this.__fireEvent(old,value,"blur",false);}if(value){this.__fireEvent(value,old,"focus",false);}}},destruct:function(){this._stopObserver();this._disposeFields("_manager","_window","_document","_root","_body","__mouseActive");},defer:function(statics){qx.event.Registration.addHandler(statics);var focusable=statics.FOCUSABLE_ELEMENTS;for(var entry in focusable){focusable[entry.toUpperCase()]=1;}}});qx.Class.define("qx.event.type.Focus",{extend:qx.event.type.Event,members:{init:function(target,relatedTarget,canBubble){this.base(arguments,canBubble,false);this._target=target;this._relatedTarget=relatedTarget;return this;}}});qx.Class.define("qx.bom.element.Attribute",{statics:{__hints:{names:{"class":"className","for":"htmlFor",html:"innerHTML",text:qx.core.Variant.isSet("qx.client","mshtml")?"innerText":"textContent",colspan:"colSpan",rowspan:"rowSpan",valign:"vAlign",datetime:"dateTime",accesskey:"accessKey",tabindex:"tabIndex",maxlength:"maxLength",readonly:"readOnly",longdesc:"longDesc",cellpadding:"cellPadding",cellspacing:"cellSpacing",frameborder:"frameBorder",usemap:"useMap"},runtime:{"html":1,"text":1},bools:{compact:1,nowrap:1,ismap:1,declare:1,noshade:1,checked:1,disabled:1,readonly:1,multiple:1,selected:1,noresize:1,defer:1},property:{$$html:1,$$widget:1,disabled:1,checked:1,readOnly:1,multiple:1,selected:1,value:1,maxLength:1,className:1,innerHTML:1,innerText:1,textContent:1,htmlFor:1,tabIndex:1},original:{href:1,src:1,type:1}},compile:function(map){var html=[];var runtime=this.__hints.runtime;for(var key in map){if(!runtime[key]){html.push(key,"='",map[key],"'");}}return html.join("");},get:qx.core.Variant.select("qx.client",{"mshtml":function(element,name){var hints=this.__hints;var value;name=hints.names[name]||name;if(hints.original[name]){value=element.getAttribute(name,2);}else if(hints.property[name]){value=element[name];}else{value=element.getAttribute(name);}if(hints.bools[name]){return !!value;}return value;},"default":function(element,name){var hints=this.__hints;var value;name=hints.names[name]||name;if(hints.property[name]){value=element[name];if(value==null){value=element.getAttribute(name);}}else{value=element.getAttribute(name);}if(hints.bools[name]){return !!value;}return value;}}),set:function(element,name,value){var hints=this.__hints;name=hints.names[name]||name;if(hints.bools[name]){value=!!value;}if(hints.property[name]){element[name]=value;}else if(value===true){element.setAttribute(name,name);}else if(value===false||value===null){element.removeAttribute(name);}else{element.setAttribute(name,value);}},reset:function(element,name){this.set(element,name,null);}}});qx.Class.define("qx.event.type.Native",{extend:qx.event.type.Event,members:{init:function(nativeEvent,target,relatedTarget,canBubble,cancelable){this.base(arguments,canBubble,cancelable);this._target=target||qx.bom.Event.getTarget(nativeEvent);this._relatedTarget=relatedTarget||qx.bom.Event.getRelatedTarget(nativeEvent);if(nativeEvent.timeStamp){this._timeStamp=nativeEvent.timeStamp;}this._native=nativeEvent;return this;},clone:function(embryo){var clone=this.base(arguments,embryo);clone._native=this._native;return clone;},preventDefault:function(){this.base(arguments);qx.bom.Event.preventDefault(this._native);},stop:function(){this.stopPropagation();this.preventDefault();},getNativeEvent:function(){return this._native;}},destruct:function(){this._disposeFields("_native");}});qx.Class.define("qx.event.type.Dom",{extend:qx.event.type.Native,statics:{SHIFT_MASK:1,CTRL_MASK:2,ALT_MASK:4,META_MASK:8},members:{getModifiers:function(){if(!this.__modifiers){var mask=0;var evt=this._native;if(evt.shiftKey){mask|=qx.event.type.Dom.SHIFT_MASK;}if(evt.ctrlKey){mask|=qx.event.type.Dom.CTRL_MASK;}if(evt.altKey){mask|=qx.event.type.Dom.ALT_MASK;}if(evt.metaKey){mask|=qx.event.type.Dom.META_MASK;}return mask;}return this.__modifiers;},isCtrlPressed:function(){return this._native.ctrlKey;},isShiftPressed:function(){return this._native.shiftKey;},isAltPressed:function(){return this._native.altKey;},isMetaPressed:function(){return this._native.metaKey;},isCtrlOrCommandPressed:function(){if(qx.bom.client.Platform.MAC){return this._native.metaKey;}else{return this._native.ctrlKey;}}}});qx.Class.define("qx.event.type.KeyInput",{extend:qx.event.type.Dom,members:{init:function(domEvent,target,charCode){this.base(arguments,domEvent,target,null,true,true);this._charCode=charCode;return this;},clone:function(embryo){var clone=this.base(arguments,embryo);clone._charCode=this._charCode;return clone;},getCharCode:function(){return this._charCode;},getChar:function(){return String.fromCharCode(this._charCode);}}});qx.Bootstrap.define("qx.bom.client.Platform",{statics:{NAME:"",WIN:false,MAC:false,UNIX:false,__init:function(){var input=navigator.platform;if(input==null||input===""){input=navigator.userAgent;}if(input.indexOf("Windows")!=-1||input.indexOf("Win32")!=-1||input.indexOf("Win64")!=-1){this.WIN=true;this.NAME="win";}else if(input.indexOf("Macintosh")!=-1||input.indexOf("MacPPC")!=-1||input.indexOf("MacIntel")!=-1||input.indexOf("iPod")!=-1||input.indexOf("iPhone")!=-1){this.MAC=true;this.NAME="mac";}else if(input.indexOf("X11")!=-1||input.indexOf("Linux")!=-1||input.indexOf("BSD")!=-1){this.UNIX=true;this.NAME="unix";}else{throw new Error("Unable to detect platform: "+input);}}},defer:function(statics){statics.__init();}});qx.Class.define("qx.event.type.KeySequence",{extend:qx.event.type.Dom,members:{init:function(domEvent,target,identifier){this.base(arguments,domEvent,target,null,true,true);this._identifier=identifier;return this;},clone:function(embryo){var clone=this.base(arguments,embryo);clone._identifier=this._identifier;return clone;},getKeyIdentifier:function(){return this._identifier;}}});qx.Class.define("qx.event.type.Mouse",{extend:qx.event.type.Dom,members:{init:function(nativeEvent,target,relatedTarget,canBubble,cancelable){this.base(arguments,nativeEvent,target,relatedTarget,canBubble,cancelable);if(!relatedTarget){this._relatedTarget=qx.bom.Event.getRelatedTarget(nativeEvent);}return this;},__buttons:qx.core.Variant.select("qx.client",{"mshtml":{1:"left",2:"right",4:"middle"},"default":{0:"left",2:"right",1:"middle"}}),stop:function(){this.stopPropagation();},getButton:function(){switch(this._type){case "click":case "dblclick":return "left";case "contextmenu":return "right";default:return this.__buttons[this._native.button]||"none";}},isLeftPressed:function(){return this.getButton()==="left";},isMiddlePressed:function(){return this.getButton()==="middle";},isRightPressed:function(){return this.getButton()==="right";},getRelatedTarget:function(){return this._relatedTarget;},getViewportLeft:function(){return this._native.clientX;},getViewportTop:function(){return this._native.clientY;},getDocumentLeft:qx.core.Variant.select("qx.client",{"mshtml":function(){var win=qx.dom.Node.getWindow(this._native.srcElement);return this._native.clientX+qx.bom.Viewport.getScrollLeft(win);},"default":function(){return this._native.pageX;}}),getDocumentTop:qx.core.Variant.select("qx.client",{"mshtml":function(){var win=qx.dom.Node.getWindow(this._native.srcElement);return this._native.clientY+qx.bom.Viewport.getScrollTop(win);},"default":function(){return this._native.pageY;}}),getScreenLeft:function(){return this._native.screenX;},getScreenTop:function(){return this._native.screenY;},getWheelDelta:qx.core.Variant.select("qx.client",{"default":function(){return -(this._native.wheelDelta/40);},"gecko":function(){return this._native.detail;}})}});qx.Class.define("qx.bom.Viewport",{statics:{getWidth:qx.core.Variant.select("qx.client",{"opera":function(win){return (win||window).document.body.clientWidth;},"webkit":function(win){return (win||window).innerWidth;},"default":function(win){var doc=(win||window).document;return doc.compatMode==="CSS1Compat"?doc.documentElement.clientWidth:doc.body.clientWidth;}}),getHeight:qx.core.Variant.select("qx.client",{"opera":function(win){return (win||window).document.body.clientHeight;},"webkit":function(win){return (win||window).innerHeight;},"default":function(win){var doc=(win||window).document;return doc.compatMode==="CSS1Compat"?doc.documentElement.clientHeight:doc.body.clientHeight;}}),getScrollLeft:qx.core.Variant.select("qx.client",{"mshtml":function(win){var doc=(win||window).document;return doc.documentElement.scrollLeft||doc.body.scrollLeft;},"default":function(win){return (win||window).pageXOffset;}}),getScrollTop:qx.core.Variant.select("qx.client",{"mshtml":function(win){var doc=(win||window).document;return doc.documentElement.scrollTop||doc.body.scrollTop;},"default":function(win){return (win||window).pageYOffset;}})}});qx.Class.define("qx.dom.Hierarchy",{statics:{getNodeIndex:function(node){var index=0;while(node&&(node=node.previousSibling)){index++;}return index;},getElementIndex:function(element){var index=0;var type=qx.dom.Node.ELEMENT;while(element&&(element=element.previousSibling)){if(element.nodeType==type){index++;}}return index;},getNextElementSibling:function(element){while(element&&(element=element.nextSibling)&&!qx.dom.Node.isElement(element)){continue;}return element||null;},getPreviousElementSibling:function(element){while(element&&(element=element.previousSibling)&&!qx.dom.Node.isElement(element)){continue;}return element||null;},contains:qx.core.Variant.select("qx.client",{"webkit|mshtml|opera":function(element,target){if(qx.dom.Node.isDocument(element)){var doc=qx.dom.Node.getDocument(target);return element&&doc==element;}else if(qx.dom.Node.isDocument(target)){return false;}else{return element.contains(target);}},"gecko":function(element,target){return !!(element.compareDocumentPosition(target)&16);},"default":function(element,target){while(target){if(element==target){return true;}target=target.parentNode;}return false;}}),isRendered:function(element){if(!element.offsetParent){return false;}var doc=element.ownerDocument||element.document;if(doc.body.contains){return doc.body.contains(element);}if(doc.compareDocumentPosition){return !!(doc.compareDocumentPosition(element)&16);}throw new Error("Missing support for isRendered()!");},isDescendantOf:function(element,ancestor){return this.contains(ancestor,element);},getCommonParent:qx.core.Variant.select("qx.client",{"mshtml|opera":function(element1,element2){if(element1===element2){return element1;}while(element1){if(element1.contains(element2)){return element1;}element1=element1.parentNode;}return null;},"default":function(element1,element2){if(element1===element2){return element1;}var known={};var obj=qx.core.ObjectRegistry;var h1,h2;while(element1||element2){if(element1){h1=obj.toHashCode(element1);if(known[h1]){return known[h1];}known[h1]=element1;element1=element1.parentNode;}if(element2){h2=obj.toHashCode(element2);if(known[h2]){return known[h2];}known[h2]=element2;element2=element2.parentNode;}}return null;}}),getAncestors:function(element){return this._recursivelyCollect(element,"parentNode");},getChildElements:function(element){element=element.firstChild;if(!element){return [];}var arr=this.getNextSiblings(element);arr.unshift(element);return arr;},getDescendants:function(element){return qx.lang.Array.fromCollection(element.getElementsByTagName("*"));},getFirstDescendant:function(element){element=element.firstChild;while(element&&element.nodeType!=1){element=element.nextSibling;}return element;},getLastDescendant:function(element){element=element.lastChild;while(element&&element.nodeType!=1){element=element.previousSibling;}return element;},getPreviousSiblings:function(element){return this._recursivelyCollect(element,"previousSibling");},getNextSiblings:function(element){return this._recursivelyCollect(element,"nextSibling");},_recursivelyCollect:function(element,property){var list=[];while(element=element[property]){if(element.nodeType==1){list.push(element);}}return list;},getSiblings:function(element){return this.getPreviousSiblings(element).reverse().concat(this.getNextSiblings(element));},isEmpty:function(element){element=element.firstChild;while(element){if(element.nodeType===qx.dom.Node.ELEMENT||element.nodeType===qx.dom.Node.TEXT){return false;}element=element.nextSibling;}return true;},cleanWhitespace:function(element){var node=element.firstChild;while(node){var nextNode=node.nextSibling;if(node.nodeType==3&&!/\S/.test(node.nodeValue)){element.removeChild(node);}node=nextNode;}}}});qx.Class.define("qx.event.type.Drag",{extend:qx.event.type.Event,members:{init:function(cancelable,originalEvent){this.base(arguments,false,cancelable);if(originalEvent){this._native=originalEvent.getNativeEvent()||null;this._originalTarget=originalEvent.getTarget()||null;}else{this._native=null;this._originalTarget=null;}return this;},clone:function(embryo){var clone=this.base(arguments,embryo);clone._native=this._native;return clone;},getDocumentLeft:qx.core.Variant.select("qx.client",{"mshtml":function(){if(this._native==null){return 0;}var win=qx.dom.Node.getWindow(this._native.srcElement);return this._native.clientX+qx.bom.Viewport.getScrollLeft(win);},"default":function(){if(this._native==null){return 0;}return this._native.pageX;}}),getDocumentTop:qx.core.Variant.select("qx.client",{"mshtml":function(){if(this._native==null){return 0;}var win=qx.dom.Node.getWindow(this._native.srcElement);return this._native.clientY+qx.bom.Viewport.getScrollTop(win);},"default":function(){if(this._native==null){return 0;}return this._native.pageY;}}),getManager:function(){return qx.event.Registration.getManager(this.getTarget()).getHandler(qx.event.handler.DragDrop);},addType:function(type){this.getManager().addType(type);},addAction:function(action){this.getManager().addAction(action);},supportsType:function(type){return this.getManager().supportsType(type);},supportsAction:function(action){return this.getManager().supportsAction(action);},addData:function(type,data){this.getManager().addData(type,data);},getData:function(type){return this.getManager().getData(type);},getCurrentType:function(){return this.getManager().getCurrentType();},getCurrentAction:function(){return this.getManager().getCurrentAction();}}});qx.Class.define("qx.event.dispatch.MouseCapture",{extend:qx.core.Object,implement:qx.event.IEventDispatcher,construct:function(manager){this.base(arguments);this.__manager=manager;this.__window=manager.getWindow();manager.addListener(this.__window,"blur",this.releaseCapture,this);manager.addListener(this.__window,"focus",this.releaseCapture,this);manager.addListener(this.__window,"scroll",this.releaseCapture,this);},statics:{PRIORITY:qx.event.Registration.PRIORITY_FIRST},members:{__captureElement:null,__manager:null,__window:null,canDispatchEvent:function(target,event,type){return this.__captureElement&&this.__captureEvents[type];},dispatchEvent:function(target,event,type){if(type=="click"){event.stopPropagation();this.releaseCapture();return;}var listeners=this.__manager.getListeners(this.__captureElement,type,false);if(listeners){event.setCurrentTarget(this.__captureElement);event.setEventPhase(qx.event.type.Event.AT_TARGET);for(var i=0,l=listeners.length;i<l;i++){var context=listeners[i].context||event.getCurrentTarget();listeners[i].handler.call(context,event);}}},__captureEvents:{"mouseup":1,"mousedown":1,"click":1,"dblclick":1,"mousemove":1,"mouseout":1,"mouseover":1},activateCapture:function(element){if(this.__captureElement===element){return;}if(this.__captureElement){this.releaseCapture();}this.__captureElement=element;qx.event.Registration.fireEvent(element,"capture",qx.event.type.Event,[true,false]);},releaseCapture:function(){var element=this.__captureElement;if(!element){return;}this.__captureElement=null;qx.event.Registration.fireEvent(element,"losecapture",qx.event.type.Event,[true,false]);}},destruct:function(){this._disposeFields("__captureElement","__manager","__window");},defer:function(statics){qx.event.Registration.addDispatcher(statics);}});qx.Class.define("qx.event.handler.Window",{extend:qx.core.Object,implement:qx.event.IEventHandler,construct:function(manager){this.base(arguments);this._manager=manager;this._window=manager.getWindow();this._initWindowObserver();},statics:{PRIORITY:qx.event.Registration.PRIORITY_NORMAL,SUPPORTED_TYPES:{error:1,load:1,beforeunload:1,unload:1,resize:1,scroll:1},TARGET_CHECK:qx.event.IEventHandler.TARGET_WINDOW,IGNORE_CAN_HANDLE:true},members:{canHandleEvent:function(target,type){},registerEvent:function(target,type,capture){},unregisterEvent:function(target,type,capture){},_initWindowObserver:function(){this._onNativeWrapper=qx.lang.Function.listener(this._onNative,this);var types=qx.event.handler.Window.SUPPORTED_TYPES;for(var key in types){qx.bom.Event.addNativeListener(this._window,key,this._onNativeWrapper);}},_stopWindowObserver:function(){var types=qx.event.handler.Window.SUPPORTED_TYPES;for(var key in types){qx.bom.Event.removeNativeListener(this._window,key,this._onNativeWrapper);}},_onNative:function(e){if(this.isDisposed()){return;}var win=this._window;var doc=win.document;var html=doc.documentElement;var target=e.target||e.srcElement;if(target==null||target===win||target===doc||target===html){qx.event.Registration.fireEvent(this._window,e.type);}}},destruct:function(){this._stopWindowObserver();this._disposeFields("_manager","_window");},defer:function(statics){qx.event.Registration.addHandler(statics);}});qx.Class.define("qx.test.Xml",{extend:qx.dev.unit.TestCase,members:{serializeArray:function(arr){var ser=[];for(var i=0;i<arr.length;i++){ser[i]=qx.xml.Element.serialize(arr[i]);}return ser.join(", ");},testParseSerializeXml:function(){var doc=qx.xml.Document.create();this.assertTrue(qx.dom.Node.isDocument(doc));var div=doc.createElement("div");this.assertEquals("div",div.tagName);var xmlStr='<html>'+'<body>Juhu <em id="toll">Kinners</em>. Wie geht es <em>Euch</em>?</body>'+'</html>';var doc2=qx.xml.Document.fromString(xmlStr);this.assertTrue(qx.dom.Node.isDocument(doc2));this.assertEquals(xmlStr,qx.xml.Element.serialize(doc2));},testFromString:function(){var data="<Root><Row>test1</Row><Row>test2</Row><Row>test3</Row></Root>";var xml=qx.xml.Document.fromString(data);this.debug("Converted to XML Document "+xml);},testCreateDocument:function(){var doc=qx.xml.Document.create("","rss");this.assertEquals('rss',doc.documentElement.tagName);this.assertEquals(0,doc.documentElement.childNodes.length);var doc=qx.xml.Document.create("http://www.w3.org/1999/xhtml","html");this.assertEquals('http://www.w3.org/1999/xhtml',doc.documentElement.namespaceURI);this.assertEquals('html',doc.documentElement.tagName);this.assertEquals(0,doc.documentElement.childNodes.length);},testXPath:function(){var xmlStr='<html><body>Juhu <em id="toll">Kinners</em>. Wie geht es <em>Euch</em>?</body></html>';var doc2=qx.xml.Document.fromString(xmlStr);var em=doc2.getElementsByTagName("em")[0];this.assertEquals('<em id="toll">Kinners</em>',qx.xml.Element.serialize(em));this.assertEquals(qx.xml.Element.serialize(em),qx.xml.Element.serialize(qx.xml.Element.selectSingleNode(doc2,'//*[@id="toll"]')));this.assertEquals(qx.xml.Element.serialize(doc2.getElementsByTagName("body")[0]),qx.xml.Element.serialize(qx.xml.Element.selectSingleNode(doc2,'//body')));this.assertEquals(this.serializeArray(doc2.getElementsByTagName("em")),this.serializeArray(qx.xml.Element.selectNodes(doc2,'//em')));this.assertEquals(this.serializeArray(doc2.getElementsByTagName("em")),this.serializeArray(qx.xml.Element.selectNodes(doc2.documentElement,'//em')));},__testXHR:function(){function error(msg){return function(){failed=msg;};}var req=new qx.io.remote.Request(qx.util.ResourceManager.toUri("qx/data/qooxdoo-blog.xml"),qx.legacy.util.Http.METHOD_GET,qx.legacy.util.Mime.XML);req.setAsynchronous(false);var failed="";var xmlDocument;req.addListener("aborted",error("aborted"));req.addListener("failed",error("failed"));req.addListener("timeout",error("timeout"));req.addListener("completed",function(e){xmlDocument=e.getData().getContent();});req.send();this.assertEquals("",failed);this.assertTrue(qx.dom.Node.isDocument(xmlDocument));this.assertEquals("rss",xmlDocument.documentElement.tagName);},testGetElementsByTagNameNS:function(){var xmlStr="<?xml version='1.0' encoding='UTF-8'?>"+"<xsl:stylesheet version='1.0' xmlns:xsl='http://www.w3.org/1999/XSL/Transform'>"+"<xsl:output method='xml' version='1.0' encoding='UTF-8' indent='yes'/>"+"<xsl:template match='*'></xsl:template><xsl:template match='@*'>"+"</xsl:template></xsl:stylesheet>";var nsDoc=qx.xml.Document.fromString(xmlStr);var templates=qx.xml.Element.getElementsByTagNameNS(nsDoc,"http://www.w3.org/1999/XSL/Transform","template");this.debug(qx.xml.String.escape(this.serializeArray(templates)));this.assertEquals(2,templates.length,"getElementsByTagNameNS for XML documents failed!");this.assertEquals("xsl:template",templates[0].tagName,"getElementsByTagNameNS for XML documents failed!");var templates=qx.xml.Element.getElementsByTagNameNS(nsDoc.documentElement,"http://www.w3.org/1999/XSL/Transform","template");this.assertEquals(2,templates.length,"getElementsByTagNameNS for element nodes failed!");this.assertEquals("xsl:template",templates[0].tagName,"getElementsByTagNameNS for element nodes failed!");}}});qx.Class.define("qx.xml.Element",{statics:{serialize:function(element){if(qx.dom.Node.isDocument(element)){element=element.documentElement;}if(window.XMLSerializer){return (new XMLSerializer()).serializeToString(element);}else{return element.xml||element.outerHTML;}},selectSingleNode:qx.core.Variant.select("qx.client",{"mshtml|opera":function(element,query){return element.selectSingleNode(query);},"default":function(element,query){if(!this.__xpe){this.__xpe=new XPathEvaluator();}var xpe=this.__xpe;try{return xpe.evaluate(query,element,xpe.createNSResolver(element),XPathResult.FIRST_ORDERED_NODE_TYPE,null).singleNodeValue;}catch(err){throw new Error("selectSingleNode: query: "+query+", element: "+element+", error: "+err);}}}),selectNodes:qx.core.Variant.select("qx.client",{"mshtml|opera":function(element,query){return element.selectNodes(query);},"default":function(element,query){var xpe=this.__xpe;if(!xpe){this.__xpe=xpe=new XPathEvaluator();}try{var result=xpe.evaluate(query,element,xpe.createNSResolver(element),XPathResult.ORDERED_NODE_SNAPSHOT_TYPE,null);}catch(err){throw new Error("selectNodes: query: "+query+", element: "+element+", error: "+err);}var nodes=[];for(var i=0;i<result.snapshotLength;i++){nodes[i]=result.snapshotItem(i);}return nodes;}}),getElementsByTagNameNS:qx.core.Variant.select("qx.client",{"mshtml":function(element,namespaceURI,tagname){var doc=element.ownerDocument||element;doc.setProperty("SelectionLanguage","XPath");doc.setProperty("SelectionNamespaces","xmlns:ns='"+namespaceURI+"'");return qx.xml.Element.selectNodes(element,'descendant-or-self::ns:'+tagname);},"default":function(element,namespaceURI,tagname){return element.getElementsByTagNameNS(namespaceURI,tagname);}}),getSingleNodeText:function(element,query){var node=this.selectSingleNode(element,query);return qx.dom.Node.getText(node);}}});qx.Bootstrap.define("qx.xml.Document",{statics:{DOMDOC:null,XMLHTTP:null,create:qx.core.Variant.select("qx.client",{"mshtml":function(namespaceUri,qualifiedName){var obj=new ActiveXObject(this.DOMDOC);obj.setProperty("SelectionLanguage","XPath");if(qualifiedName){var str='<?xml version="1.0" encoding="utf-8"?>\n<';str+=qualifiedName;if(namespaceUri){str+=" xmlns='"+namespaceUri+"'";}str+=" />";obj.loadXML(str);}return obj;},"default":function(namespaceUri,qualifiedName){return document.implementation.createDocument(namespaceUri||"",qualifiedName||"",null);}}),fromString:qx.core.Variant.select("qx.client",{"mshtml":function(str){var dom=qx.xml.Document.create();dom.loadXML(str);return dom;},"default":function(str){var parser=new DOMParser();return parser.parseFromString(str,"text/xml");}})},defer:function(statics){if(qx.core.Variant.isSet("qx.client","mshtml")){var domDoc=["MSXML2.DOMDocument.6.0","MSXML2.DOMDocument.3.0"];var httpReq=["MSXML2.XMLHTTP.6.0","MSXML2.XMLHTTP.3.0"];for(var i=0,l=domDoc.length;i<l;i++){try{new ActiveXObject(domDoc[i]);new ActiveXObject(httpReq[i]);}catch(ex){continue;}statics.DOMDOC=domDoc[i];statics.XMLHTTP=httpReq[i];break;}}}});qx.Class.define("qx.io.remote.Request",{extend:qx.core.Object,construct:function(vUrl,vMethod,vResponseType){this.base(arguments);this._requestHeaders={};this._parameters={};this._formFields={};if(vUrl!==undefined){this.setUrl(vUrl);}if(vMethod!==undefined){this.setMethod(vMethod);}if(vResponseType!==undefined){this.setResponseType(vResponseType);}this.setProhibitCaching(true);this._seqNum=++qx.io.remote.Request._seqNum;},events:{"created":"qx.event.type.Event","configured":"qx.event.type.Event","sending":"qx.event.type.Event","receiving":"qx.event.type.Event","completed":"qx.io.remote.Response","aborted":"qx.io.remote.Response","failed":"qx.io.remote.Response","timeout":"qx.io.remote.Response"},statics:{_seqNum:0},properties:{url:{check:"String",init:""},method:{check:["GET","POST","PUT","HEAD","DELETE"],apply:"_applyMethod",init:"GET"},asynchronous:{check:"Boolean",init:true},data:{check:"String",nullable:true},username:{check:"String",nullable:true},password:{check:"String",nullable:true},state:{check:["configured","queued","sending","receiving","completed","aborted","timeout","failed"],init:"configured",apply:"_applyState",event:"changeState"},responseType:{check:["text/plain","text/javascript","application/json","application/xml","text/html"],init:"text/plain",apply:"_applyResponseType"},timeout:{check:"Integer",nullable:true},prohibitCaching:{check:"Boolean",init:true,apply:"_applyProhibitCaching"},crossDomain:{check:"Boolean",init:false},fileUpload:{check:"Boolean",init:false},transport:{check:"qx.io.remote.Exchange",nullable:true},useBasicHttpAuth:{check:"Boolean",init:false}},members:{send:function(){qx.io.remote.RequestQueue.getInstance().add(this);},abort:function(){qx.io.remote.RequestQueue.getInstance().abort(this);},reset:function(){switch(this.getState()){case "sending":case "receiving":this.error("Aborting already sent request!");case "queued":this.abort();break;}},isConfigured:function(){return this.getState()==="configured";},isQueued:function(){return this.getState()==="queued";},isSending:function(){return this.getState()==="sending";},isReceiving:function(){return this.getState()==="receiving";},isCompleted:function(){return this.getState()==="completed";},isAborted:function(){return this.getState()==="aborted";},isTimeout:function(){return this.getState()==="timeout";},isFailed:function(){return this.getState()==="failed";},__forwardEvent:function(e){var clonedEvent=e.clone();clonedEvent.setTarget(this);this.dispatchEvent(clonedEvent);},_onqueued:function(e){this.setState("queued");this.__forwardEvent(e);},_onsending:function(e){this.setState("sending");this.__forwardEvent(e);},_onreceiving:function(e){this.setState("receiving");this.__forwardEvent(e);},_oncompleted:function(e){this.setState("completed");this.__forwardEvent(e);this.dispose();},_onaborted:function(e){this.setState("aborted");this.__forwardEvent(e);this.dispose();},_ontimeout:function(e){this.setState("timeout");this.__forwardEvent(e);this.dispose();},_onfailed:function(e){this.setState("failed");this.__forwardEvent(e);this.dispose();},_applyState:function(value,old){{};},_applyProhibitCaching:function(value,old){if(value){this.setParameter("nocache",new Date().valueOf());this.setRequestHeader("Pragma","no-cache");this.setRequestHeader("Cache-Control","no-cache");}else{this.removeParameter("nocache");this.removeRequestHeader("Pragma");this.removeRequestHeader("Cache-Control");}},_applyMethod:function(value,old){if(value==="POST"){this.setRequestHeader("Content-Type","application/x-www-form-urlencoded");}else{this.removeRequestHeader("Content-Type");}},_applyResponseType:function(value,old){this.setRequestHeader("X-Qooxdoo-Response-Type",value);},setRequestHeader:function(vId,vValue){this._requestHeaders[vId]=vValue;},removeRequestHeader:function(vId){delete this._requestHeaders[vId];},getRequestHeader:function(vId){return this._requestHeaders[vId]||null;},getRequestHeaders:function(){return this._requestHeaders;},setParameter:function(vId,vValue){this._parameters[vId]=vValue;},removeParameter:function(vId){delete this._parameters[vId];},getParameter:function(vId){return this._parameters[vId]||null;},getParameters:function(){return this._parameters;},setFormField:function(vId,vValue){this._formFields[vId]=vValue;},removeFormField:function(vId){delete this._formFields[vId];},getFormField:function(vId){return this._formFields[vId]||null;},getFormFields:function(){return this._formFields;},getSequenceNumber:function(){return this._seqNum;}},destruct:function(){this.setTransport(null);this._disposeFields("_requestHeaders","_parameters","_formFields");}});qx.Class.define("qx.io.remote.RequestQueue",{type:"singleton",extend:qx.core.Object,construct:function(){this.base(arguments);this._queue=[];this._active=[];this._totalRequests=0;this._timer=new qx.event.Timer(500);this._timer.addListener("interval",this._oninterval,this);},properties:{enabled:{init:true,check:"Boolean",apply:"_applyEnabled"},maxTotalRequests:{check:"Integer",nullable:true},maxConcurrentRequests:{check:"Integer",init:3},defaultTimeout:{check:"Integer",init:5000}},members:{_debug:function(){var vText;},_check:function(){this._debug();if(this._active.length==0&&this._queue.length==0){this._timer.stop();}if(!this.getEnabled()){return;}if(this._active.length>=this.getMaxConcurrentRequests()||this._queue.length==0){return;}if(this.getMaxTotalRequests()!=null&&this._totalRequests>=this.getMaxTotalRequests()){return;}var vRequest=this._queue.shift();var vTransport=new qx.io.remote.Exchange(vRequest);this._totalRequests++;this._active.push(vTransport);this._debug();vTransport.addListener("sending",vRequest._onsending,vRequest);vTransport.addListener("receiving",vRequest._onreceiving,vRequest);vTransport.addListener("completed",vRequest._oncompleted,vRequest);vTransport.addListener("aborted",vRequest._onaborted,vRequest);vTransport.addListener("timeout",vRequest._ontimeout,vRequest);vTransport.addListener("failed",vRequest._onfailed,vRequest);vTransport.addListener("sending",this._onsending,this);vTransport.addListener("completed",this._oncompleted,this);vTransport.addListener("aborted",this._oncompleted,this);vTransport.addListener("timeout",this._oncompleted,this);vTransport.addListener("failed",this._oncompleted,this);vTransport._start=(new Date).valueOf();vTransport.send();if(this._queue.length>0){this._check();}},_remove:function(vTransport){qx.lang.Array.remove(this._active,vTransport);vTransport.dispose();this._check();},_activeCount:0,_onsending:function(e){{};},_oncompleted:function(e){{};this._remove(e.getTarget());},_oninterval:function(e){var vActive=this._active;if(vActive.length==0){this._timer.stop();return;}var vCurrent=(new Date).valueOf();var vTransport;var vRequest;var vDefaultTimeout=this.getDefaultTimeout();var vTimeout;var vTime;for(var i=vActive.length-1;i>=0;i--){vTransport=vActive[i];vRequest=vTransport.getRequest();if(vRequest.isAsynchronous()){vTimeout=vRequest.getTimeout();if(vTimeout==0){continue;}if(vTimeout==null){vTimeout=vDefaultTimeout;}vTime=vCurrent-vTransport._start;if(vTime>vTimeout){this.warn("Timeout: transport "+vTransport.toHashCode());this.warn(vTime+"ms > "+vTimeout+"ms");vTransport.timeout();}}}},_applyEnabled:function(value,old){if(value){this._check();}this._timer.setEnabled(value);},add:function(vRequest){vRequest.setState("queued");this._queue.push(vRequest);this._check();if(this.getEnabled()){this._timer.start();}},abort:function(vRequest){var vTransport=vRequest.getTransport();if(vTransport){vTransport.abort();}else if(qx.lang.Array.contains(this._queue,vRequest)){qx.lang.Array.remove(this._queue,vRequest);}}},destruct:function(){this._disposeArray("_active");this._disposeObjects("_timer");this._disposeFields("_queue");}});qx.Class.define("qx.event.Timer",{extend:qx.core.Object,construct:function(interval){this.base(arguments);this.setEnabled(false);if(interval!=null){this.setInterval(interval);}this.__oninterval=qx.lang.Function.bind(this._oninterval,this);},events:{"interval":"qx.event.type.Event"},statics:{once:function(func,obj,timeout){var timer=new qx.event.Timer(timeout);timer.addListener("interval",function(e){func.call(obj,e);timer.dispose();obj=null;},obj);timer.start();return timer;}},properties:{enabled:{init:true,check:"Boolean",apply:"_applyEnabled"},interval:{check:"Integer",init:1000,apply:"_applyInterval"}},members:{__intervalHandler:null,_applyInterval:function(value,old){if(this.getEnabled()){this.restart();}},_applyEnabled:function(value,old){if(old){window.clearInterval(this.__intervalHandler);this.__intervalHandler=null;}else if(value){this.__intervalHandler=window.setInterval(this.__oninterval,this.getInterval());}},start:function(){this.setEnabled(true);},startWith:function(interval){this.setInterval(interval);this.start();},stop:function(){this.setEnabled(false);},restart:function(){this.stop();this.start();},restartWith:function(interval){this.stop();this.startWith(interval);},_oninterval:function(){if(this.getEnabled()){this.fireEvent("interval");}}},destruct:function(){if(this.__intervalHandler){window.clearInterval(this.__intervalHandler);}this._disposeFields("__intervalHandler","__oninterval");}});qx.Class.define("qx.io.remote.Exchange",{extend:qx.core.Object,construct:function(vRequest){this.base(arguments);this.setRequest(vRequest);vRequest.setTransport(this);},events:{"sending":"qx.event.type.Event","receiving":"qx.event.type.Event","completed":"qx.io.remote.Response","aborted":"qx.io.remote.Response","failed":"qx.io.remote.Response","timeout":"qx.io.remote.Response"},statics:{typesOrder:["qx.io.remote.transport.XmlHttp","qx.io.remote.transport.Iframe","qx.io.remote.transport.Script"],typesReady:false,typesAvailable:{},typesSupported:{},registerType:function(vClass,vId){qx.io.remote.Exchange.typesAvailable[vId]=vClass;},initTypes:function(){if(qx.io.remote.Exchange.typesReady){return;}for(var vId in qx.io.remote.Exchange.typesAvailable){var vTransporterImpl=qx.io.remote.Exchange.typesAvailable[vId];if(vTransporterImpl.isSupported()){qx.io.remote.Exchange.typesSupported[vId]=vTransporterImpl;}}qx.io.remote.Exchange.typesReady=true;if(qx.lang.Object.isEmpty(qx.io.remote.Exchange.typesSupported)){throw new Error("No supported transport types were found!");}},canHandle:function(vImpl,vNeeds,vResponseType){if(!qx.lang.Array.contains(vImpl.handles.responseTypes,vResponseType)){return false;}for(var vKey in vNeeds){if(!vImpl.handles[vKey]){return false;}}return true;},_nativeMap:{0:"created",1:"configured",2:"sending",3:"receiving",4:"completed"},wasSuccessful:function(vStatusCode,vReadyState,vIsLocal){if(vIsLocal){switch(vStatusCode){case null:case 0:return true;case -1:return vReadyState<4;default:return typeof vStatusCode==="undefined";}}else{switch(vStatusCode){case -1:{};return vReadyState<4;case 200:case 304:return true;case 201:case 202:case 203:case 204:case 205:return true;case 206:{};return vReadyState!==4;case 300:case 301:case 302:case 303:case 305:case 400:case 401:case 402:case 403:case 404:case 405:case 406:case 407:case 408:case 409:case 410:case 411:case 412:case 413:case 414:case 415:case 500:case 501:case 502:case 503:case 504:case 505:{};return false;case 12002:case 12007:case 12029:case 12030:case 12031:case 12152:case 13030:{};return false;default:if(vStatusCode>206&&vStatusCode<300){return true;}qx.log.Logger.debug(this,"Unknown status code: "+vStatusCode+" ("+vReadyState+")");return false;}}},statusCodeToString:function(vStatusCode){switch(vStatusCode){case -1:return "Not available";case 200:return "Ok";case 304:return "Not modified";case 206:return "Partial content";case 204:return "No content";case 300:return "Multiple choices";case 301:return "Moved permanently";case 302:return "Moved temporarily";case 303:return "See other";case 305:return "Use proxy";case 400:return "Bad request";case 401:return "Unauthorized";case 402:return "Payment required";case 403:return "Forbidden";case 404:return "Not found";case 405:return "Method not allowed";case 406:return "Not acceptable";case 407:return "Proxy authentication required";case 408:return "Request time-out";case 409:return "Conflict";case 410:return "Gone";case 411:return "Length required";case 412:return "Precondition failed";case 413:return "Request entity too large";case 414:return "Request-URL too large";case 415:return "Unsupported media type";case 500:return "Server error";case 501:return "Not implemented";case 502:return "Bad gateway";case 503:return "Out of resources";case 504:return "Gateway time-out";case 505:return "HTTP version not supported";case 12002:return "Server timeout";case 12029:return "Connection dropped";case 12030:return "Connection dropped";case 12031:return "Connection dropped";case 12152:return "Connection closed by server";case 13030:return "MSHTML-specific HTTP status code";default:return "Unknown status code";}}},properties:{request:{check:"qx.io.remote.Request",nullable:true},implementation:{check:"qx.io.remote.transport.Abstract",nullable:true,apply:"_applyImplementation"},state:{check:["configured","sending","receiving","completed","aborted","timeout","failed"],init:"configured",event:"changeState",apply:"_applyState"}},members:{send:function(){var vRequest=this.getRequest();if(!vRequest){return this.error("Please attach a request object first");}qx.io.remote.Exchange.initTypes();var vUsage=qx.io.remote.Exchange.typesOrder;var vSupported=qx.io.remote.Exchange.typesSupported;var vResponseType=vRequest.getResponseType();var vNeeds={};if(vRequest.getAsynchronous()){vNeeds.asynchronous=true;}else{vNeeds.synchronous=true;}if(vRequest.getCrossDomain()){vNeeds.crossDomain=true;}if(vRequest.getFileUpload()){vNeeds.fileUpload=true;}for(var field in vRequest.getFormFields()){vNeeds.programaticFormFields=true;break;}var vTransportImpl,vTransport;for(var i=0,l=vUsage.length;i<l;i++){vTransportImpl=vSupported[vUsage[i]];if(vTransportImpl){if(!qx.io.remote.Exchange.canHandle(vTransportImpl,vNeeds,vResponseType)){continue;}try{{};vTransport=new vTransportImpl;this.setImplementation(vTransport);vTransport.setUseBasicHttpAuth(vRequest.getUseBasicHttpAuth());vTransport.send();return true;}catch(ex){this.error("Request handler throws error");this.error(ex);return;}}}this.error("There is no transport implementation available to handle this request: "+vRequest);},abort:function(){var vImplementation=this.getImplementation();if(vImplementation){{};vImplementation.abort();}else{{};this.setState("aborted");}},timeout:function(){var vImplementation=this.getImplementation();if(vImplementation){this.warn("Timeout: implementation "+vImplementation.toHashCode());vImplementation.timeout();}else{this.warn("Timeout: forcing state to timeout");this.setState("timeout");}if(this.getRequest()){this.getRequest().setTimeout(0);}},_onsending:function(e){this.setState("sending");},_onreceiving:function(e){this.setState("receiving");},_oncompleted:function(e){this.setState("completed");},_onabort:function(e){this.setState("aborted");},_onfailed:function(e){this.setState("failed");},_ontimeout:function(e){this.setState("timeout");},_applyImplementation:function(value,old){if(old){old.removeListener("sending",this._onsending,this);old.removeListener("receiving",this._onreceiving,this);old.removeListener("completed",this._oncompleted,this);old.removeListener("aborted",this._onabort,this);old.removeListener("timeout",this._ontimeout,this);old.removeListener("failed",this._onfailed,this);}if(value){var vRequest=this.getRequest();value.setUrl(vRequest.getUrl());value.setMethod(vRequest.getMethod());value.setAsynchronous(vRequest.getAsynchronous());value.setUsername(vRequest.getUsername());value.setPassword(vRequest.getPassword());value.setParameters(vRequest.getParameters());value.setFormFields(vRequest.getFormFields());value.setRequestHeaders(vRequest.getRequestHeaders());value.setData(vRequest.getData());value.setResponseType(vRequest.getResponseType());value.addListener("sending",this._onsending,this);value.addListener("receiving",this._onreceiving,this);value.addListener("completed",this._oncompleted,this);value.addListener("aborted",this._onabort,this);value.addListener("timeout",this._ontimeout,this);value.addListener("failed",this._onfailed,this);}},_applyState:function(value,old){{};switch(value){case "sending":this.fireEvent("sending");break;case "receiving":this.fireEvent("receiving");break;case "completed":case "aborted":case "timeout":case "failed":var vImpl=this.getImplementation();if(!vImpl){break;}if(this.hasListener(value)){var vResponse=qx.event.Registration.createEvent(value,qx.io.remote.Response);if(value=="completed"){var vContent=vImpl.getResponseContent();vResponse.setContent(vContent);if(vContent===null){{};value="failed";}}vResponse.setStatusCode(vImpl.getStatusCode());vResponse.setResponseHeaders(vImpl.getResponseHeaders());this.dispatchEvent(vResponse);}this.setImplementation(null);vImpl.dispose();break;}}},settings:{"qx.ioRemoteDebug":false,"qx.ioRemoteDebugData":false},destruct:function(){var vImpl=this.getImplementation();if(vImpl){this.setImplementation(null);vImpl.dispose();}this.setRequest(null);}});qx.Class.define("qx.io.remote.transport.Abstract",{type:"abstract",extend:qx.core.Object,construct:function(){this.base(arguments);},events:{"created":"qx.event.type.Event","configured":"qx.event.type.Event","sending":"qx.event.type.Event","receiving":"qx.event.type.Event","completed":"qx.event.type.Event","aborted":"qx.event.type.Event","failed":"qx.event.type.Event","timeout":"qx.event.type.Event"},properties:{url:{check:"String",nullable:true},method:{check:"String",nullable:true},asynchronous:{check:"Boolean",nullable:true},data:{check:"String",nullable:true},username:{check:"String",nullable:true},password:{check:"String",nullable:true},state:{check:["created","configured","sending","receiving","completed","aborted","timeout","failed"],init:"created",event:"changeState",apply:"_applyState"},requestHeaders:{check:"Object",nullable:true},parameters:{check:"Object",nullable:true},formFields:{check:"Object",nullable:true},responseType:{check:"String",nullable:true},useBasicHttpAuth:{check:"Boolean",nullable:true}},members:{send:function(){throw new Error("send is abstract");},abort:function(){{};this.setState("aborted");},timeout:function(){{};this.setState("timeout");},failed:function(){{};this.setState("failed");},setRequestHeader:function(vLabel,vValue){throw new Error("setRequestHeader is abstract");},getResponseHeader:function(vLabel){throw new Error("getResponseHeader is abstract");},getResponseHeaders:function(){throw new Error("getResponseHeaders is abstract");},getStatusCode:function(){throw new Error("getStatusCode is abstract");},getStatusText:function(){throw new Error("getStatusText is abstract");},getResponseText:function(){throw new Error("getResponseText is abstract");},getResponseXml:function(){throw new Error("getResponseXml is abstract");},getFetchedLength:function(){throw new Error("getFetchedLength is abstract");},_applyState:function(value,old){{};switch(value){case "created":this.fireEvent("created");break;case "configured":this.fireEvent("configured");break;case "sending":this.fireEvent("sending");break;case "receiving":this.fireEvent("receiving");break;case "completed":this.fireEvent("completed");break;case "aborted":this.fireEvent("aborted");break;case "failed":this.fireEvent("failed");break;case "timeout":this.fireEvent("timeout");break;}return true;}}});qx.Class.define("qx.io.remote.transport.XmlHttp",{extend:qx.io.remote.transport.Abstract,construct:function(){this.base(arguments);this._req=qx.io.remote.transport.XmlHttp.createRequestObject();this._req.onreadystatechange=qx.lang.Function.bind(this._onreadystatechange,this);},events:{"created":"qx.event.type.Event","configured":"qx.event.type.Event","sending":"qx.event.type.Event","receiving":"qx.event.type.Event","completed":"qx.event.type.Event","aborted":"qx.event.type.Event","failed":"qx.event.type.Event","timeout":"qx.event.type.Event"},statics:{handles:{synchronous:true,asynchronous:true,crossDomain:false,fileUpload:false,programaticFormFields:false,responseTypes:["text/plain","text/javascript","application/json","application/xml","text/html"]},requestObjects:[],requestObjectCount:0,createRequestObject:qx.core.Variant.select("qx.client",{"default":function(){return new XMLHttpRequest;},"mshtml":function(){if(window.ActiveXObject&&qx.xml.Document.XMLHTTP){return new ActiveXObject(qx.xml.Document.XMLHTTP);}if(window.XMLHttpRequest){return new XMLHttpRequest;}}}),isSupported:function(){return !!this.createRequestObject();},__dummy:function(){}},members:{_localRequest:false,_lastReadyState:0,getRequest:function(){return this._req;},send:function(){this._lastReadyState=0;var vRequest=this.getRequest();var vMethod=this.getMethod();var vAsynchronous=this.getAsynchronous();var vUrl=this.getUrl();var vLocalRequest=(window.location.protocol==="file:"&&!(/^http(s){0,1}\:/.test(vUrl)));this._localRequest=vLocalRequest;var vParameters=this.getParameters();var vParametersList=[];for(var vId in vParameters){var value=vParameters[vId];if(value instanceof Array){for(var i=0;i<value.length;i++){vParametersList.push(encodeURIComponent(vId)+"="+encodeURIComponent(value[i]));}}else{vParametersList.push(encodeURIComponent(vId)+"="+encodeURIComponent(value));}}if(vParametersList.length>0){vUrl+=(vUrl.indexOf("?")>=0?"&":"?")+vParametersList.join("&");}var encode64=function(input){var keyStr="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";var output="";var chr1,chr2,chr3;var enc1,enc2,enc3,enc4;var i=0;do{chr1=input.charCodeAt(i++);chr2=input.charCodeAt(i++);chr3=input.charCodeAt(i++);enc1=chr1>>2;enc2=((chr1&3)<<4)|(chr2>>4);enc3=((chr2&15)<<2)|(chr3>>6);enc4=chr3&63;if(isNaN(chr2)){enc3=enc4=64;}else if(isNaN(chr3)){enc4=64;}output+=keyStr.charAt(enc1)+keyStr.charAt(enc2)+keyStr.charAt(enc3)+keyStr.charAt(enc4);}while(i<input.length);return output;};vRequest.onreadystatechange=qx.lang.Function.bind(this._onreadystatechange,this);try{if(this.getUsername()){if(this.getUseBasicHttpAuth()){vRequest.open(vMethod,vUrl,vAsynchronous);vRequest.setRequestHeader('Authorization','Basic '+encode64(this.getUsername()+':'+this.getPassword()));}else{vRequest.open(vMethod,vUrl,vAsynchronous,this.getUsername(),this.getPassword());}}else{vRequest.open(vMethod,vUrl,vAsynchronous);}}catch(ex){this.error("Failed with exception: "+ex);this.failed();return;}if(!qx.core.Variant.isSet("qx.client","webkit")){vRequest.setRequestHeader('Referer',window.location.href);}var vRequestHeaders=this.getRequestHeaders();for(var vId in vRequestHeaders){vRequest.setRequestHeader(vId,vRequestHeaders[vId]);}try{{};vRequest.send(this.getData());}catch(ex){if(vLocalRequest){this.failedLocally();}else{this.error("Failed to send data: "+ex,"send");this.failed();}return;}if(!vAsynchronous){this._onreadystatechange();}},failedLocally:function(){if(this.getState()==="failed"){return;}this.warn("Could not load from file: "+this.getUrl());this.failed();},_onreadystatechange:function(e){switch(this.getState()){case "completed":case "aborted":case "failed":case "timeout":{};return;}var vReadyState=this.getReadyState();if(vReadyState==4){if(!qx.io.remote.Exchange.wasSuccessful(this.getStatusCode(),vReadyState,this._localRequest)){return this.failed();}}while(this._lastReadyState<vReadyState){this.setState(qx.io.remote.Exchange._nativeMap[++this._lastReadyState]);}},getReadyState:function(){var vReadyState=null;try{vReadyState=this._req.readyState;}catch(ex){}return vReadyState;},setRequestHeader:function(vLabel,vValue){this._req.setRequestHeader(vLabel,vValue);},getResponseHeader:function(vLabel){var vResponseHeader=null;try{this.getRequest().getResponseHeader(vLabel)||null;}catch(ex){}return vResponseHeader;},getStringResponseHeaders:function(){var vSourceHeader=null;try{var vLoadHeader=this._req.getAllResponseHeaders();if(vLoadHeader){vSourceHeader=vLoadHeader;}}catch(ex){}return vSourceHeader;},getResponseHeaders:function(){var vSourceHeader=this.getStringResponseHeaders();var vHeader={};if(vSourceHeader){var vValues=vSourceHeader.split(/[\r\n]+/g);for(var i=0,l=vValues.length;i<l;i++){var vPair=vValues[i].match(/^([^:]+)\s*:\s*(.+)$/i);if(vPair){vHeader[vPair[1]]=vPair[2];}}}return vHeader;},getStatusCode:function(){var vStatusCode=-1;try{vStatusCode=this.getRequest().status;}catch(ex){}return vStatusCode;},getStatusText:function(){var vStatusText="";try{vStatusText=this.getRequest().statusText;}catch(ex){}return vStatusText;},getResponseText:function(){var vResponseText=null;var vStatus=this.getStatusCode();var vReadyState=this.getReadyState();if(qx.io.remote.Exchange.wasSuccessful(vStatus,vReadyState,this._localRequest)){try{vResponseText=this.getRequest().responseText;}catch(ex){}}return vResponseText;},getResponseXml:function(){var vResponseXML=null;var vStatus=this.getStatusCode();var vReadyState=this.getReadyState();if(qx.io.remote.Exchange.wasSuccessful(vStatus,vReadyState,this._localRequest)){try{vResponseXML=this.getRequest().responseXML;}catch(ex){}}if(typeof vResponseXML=="object"&&vResponseXML!=null){if(!vResponseXML.documentElement){var s=String(this.getRequest().responseText).replace(/<\?xml[^\?]*\?>/,"");vResponseXML.loadXML(s);}if(!vResponseXML.documentElement){throw new Error("Missing Document Element!");}if(vResponseXML.documentElement.tagName=="parseerror"){throw new Error("XML-File is not well-formed!");}}else{throw new Error("Response was not a valid xml document ["+this.getRequest().responseText+"]");}return vResponseXML;},getFetchedLength:function(){var vText=this.getResponseText();return typeof vText=="string"?vText.length:0;},getResponseContent:function(){if(this.getState()!=="completed"){{};return null;}{};var vText=this.getResponseText();switch(this.getResponseType()){case "text/plain":case "text/html":{};return vText;case "application/json":{};try{if(vText&&vText.length>0){return qx.util.Json.parseQx(vText)||null;}else{return null;}}catch(ex){this.error("Could not execute json: ["+vText+"]",ex);return "<pre>Could not execute json: \n"+vText+"\n</pre>";}case "text/javascript":{};try{if(vText&&vText.length>0){return window.eval(vText)||null;}else{return null;}}catch(ex){this.error("Could not execute javascript: ["+vText+"]",ex);return null;}case "application/xml":vText=this.getResponseXml();{};return vText||null;default:this.warn("No valid responseType specified ("+this.getResponseType()+")!");return null;}},_applyState:function(value,old){{};switch(value){case "created":this.fireEvent("created");break;case "configured":this.fireEvent("configured");break;case "sending":this.fireEvent("sending");break;case "receiving":this.fireEvent("receiving");break;case "completed":this.fireEvent("completed");break;case "failed":this.fireEvent("failed");break;case "aborted":this.getRequest().abort();this.fireEvent("aborted");break;case "timeout":this.getRequest().abort();this.fireEvent("timeout");break;}}},defer:function(statics,members){qx.io.remote.Exchange.registerType(qx.io.remote.transport.XmlHttp,"qx.io.remote.transport.XmlHttp");},destruct:function(){var vRequest=this.getRequest();if(vRequest){vRequest.onreadystatechange=qx.io.remote.transport.XmlHttp.__dummy;switch(vRequest.readyState){case 1:case 2:case 3:vRequest.abort();}}this._disposeFields("_req");}});qx.Class.define("qx.io.remote.transport.Iframe",{extend:qx.io.remote.transport.Abstract,construct:function(){this.base(arguments);var vUniqueId=(new Date).valueOf();var vFrameName="frame_"+vUniqueId;var vFormName="form_"+vUniqueId;if(qx.core.Variant.isSet("qx.client","mshtml")){this.__frame=document.createElement('<iframe name="'+vFrameName+'"></iframe>');}else{this.__frame=document.createElement("iframe");}this.__frame.src="javascript:void(0)";this.__frame.id=this.__frame.name=vFrameName;this.__frame.onload=qx.lang.Function.bind(this._onload,this);this.__frame.style.display="none";document.body.appendChild(this.__frame);this.__form=document.createElement("form");this.__form.target=vFrameName;this.__form.id=this.__form.name=vFormName;this.__form.style.display="none";document.body.appendChild(this.__form);this._data=document.createElement("textarea");this._data.id=this._data.name="_data_";this.__form.appendChild(this._data);this.__frame.onreadystatechange=qx.lang.Function.bind(this._onreadystatechange,this);},statics:{handles:{synchronous:false,asynchronous:true,crossDomain:false,fileUpload:true,programaticFormFields:true,responseTypes:["text/plain","text/javascript","application/json","application/xml","text/html"]},isSupported:function(){return true;},_numericMap:{"uninitialized":1,"loading":2,"loaded":2,"interactive":3,"complete":4}},members:{__lastReadyState:0,__form:null,__frame:null,send:function(){var vMethod=this.getMethod();var vUrl=this.getUrl();var vParameters=this.getParameters();var vParametersList=[];for(var vId in vParameters){var value=vParameters[vId];if(value instanceof Array){for(var i=0;i<value.length;i++){vParametersList.push(encodeURIComponent(vId)+"="+encodeURIComponent(value[i]));}}else{vParametersList.push(encodeURIComponent(vId)+"="+encodeURIComponent(value));}}if(vParametersList.length>0){vUrl+=(vUrl.indexOf("?")>=0?"&":"?")+vParametersList.join("&");}var vFormFields=this.getFormFields();for(var vId in vFormFields){var vField=document.createElement("textarea");vField.name=vId;vField.appendChild(document.createTextNode(vFormFields[vId]));this.__form.appendChild(vField);}this.__form.action=vUrl;this.__form.method=vMethod;this._data.appendChild(document.createTextNode(this.getData()));this.__form.submit();this.setState("sending");},_onload:function(e){if(this.__form.src){return;}this._switchReadyState(qx.io.remote.transport.Iframe._numericMap.complete);},_onreadystatechange:function(e){this._switchReadyState(qx.io.remote.transport.Iframe._numericMap[this.__frame.readyState]);},_switchReadyState:function(vReadyState){switch(this.getState()){case "completed":case "aborted":case "failed":case "timeout":this.warn("Ignore Ready State Change");return;}while(this.__lastReadyState<vReadyState){this.setState(qx.io.remote.Exchange._nativeMap[++this.__lastReadyState]);}},setRequestHeader:function(vLabel,vValue){},getResponseHeader:function(vLabel){return null;},getResponseHeaders:function(){return {};},getStatusCode:function(){return 200;},getStatusText:function(){return "";},getIframeWindow:function(){return qx.bom.Iframe.getWindow(this.__frame);},getIframeDocument:function(){return qx.bom.Iframe.getDocument(this.__frame);},getIframeBody:function(){return qx.bom.Iframe.getBody(this.__frame);},getIframeTextContent:function(){var vBody=this.getIframeBody();if(!vBody){return null;}if(!vBody.firstChild){return "";}if(vBody.firstChild.tagName&&vBody.firstChild.tagName.toLowerCase()=="pre"){return vBody.firstChild.innerHTML;}else{return vBody.innerHTML;}},getIframeHtmlContent:function(){var vBody=this.getIframeBody();return vBody?vBody.innerHTML:null;},getFetchedLength:function(){return 0;},getResponseContent:function(){if(this.getState()!=="completed"){{};return null;}{};var vText=this.getIframeTextContent();switch(this.getResponseType()){case "text/plain":{};return vText;break;case "text/html":vText=this.getIframeHtmlContent();{};return vText;break;case "application/json":vText=this.getIframeHtmlContent();{};try{return vText&&vText.length>0?qx.util.Json.parseQx(vText):null;}catch(ex){return this.error("Could not execute json: ("+vText+")",ex);}case "text/javascript":vText=this.getIframeHtmlContent();{};try{return vText&&vText.length>0?window.eval(vText):null;}catch(ex){return this.error("Could not execute javascript: ("+vText+")",ex);}case "application/xml":vText=this.getIframeDocument();{};return vText;default:this.warn("No valid responseType specified ("+this.getResponseType()+")!");return null;}}},defer:function(statics,members,properties){qx.io.remote.Exchange.registerType(qx.io.remote.transport.Iframe,"qx.io.remote.transport.Iframe");},destruct:function(){if(this.__frame){this.__frame.onload=null;this.__frame.onreadystatechange=null;if(qx.core.Variant.isSet("qx.client","gecko")){this.__frame.src=qx.util.ResourceManager.toUri("qx/static/blank.gif");}document.body.removeChild(this.__frame);}if(this.__form){document.body.removeChild(this.__form);}this._disposeFields("__frame","__form");}});qx.Class.define("qx.event.handler.Iframe",{extend:qx.core.Object,implement:qx.event.IEventHandler,statics:{PRIORITY:qx.event.Registration.PRIORITY_NORMAL,SUPPORTED_TYPES:{load:1},TARGET_CHECK:qx.event.IEventHandler.TARGET_DOMNODE,IGNORE_CAN_HANDLE:false,onevent:function(target){qx.event.Registration.fireEvent(target,"load");}},members:{canHandleEvent:function(target,type){return target.tagName.toLowerCase()==="iframe";},registerEvent:function(target,type,capture){},unregisterEvent:function(target,type,capture){}},defer:function(statics){qx.event.Registration.addHandler(statics);}});qx.Class.define("qx.bom.Iframe",{statics:{create:function(attributes,win){var attributes=attributes?qx.lang.Object.copy(attributes):{};attributes.onload="qx.event.handler.Iframe.onevent(this)";attributes.frameBorder="0";attributes.frameSpacing="0";attributes.marginWidth="0";attributes.marginHeight="0";attributes.hspace="0";attributes.vspace="0";attributes.border="0";attributes.allowTransparency="true";return qx.bom.Element.create("iframe",attributes,win);},getWindow:qx.core.Variant.select("qx.client",{"mshtml|gecko":function(iframe){try{return iframe.contentWindow;}catch(ex){return null;}},"default":function(iframe){try{var doc=this.getDocument(iframe);return doc?doc.defaultView:null;}catch(ex){return null;}}}),getDocument:qx.core.Variant.select("qx.client",{"mshtml":function(iframe){try{var win=this.getWindow(iframe);return win?win.document:null;}catch(ex){return null;}},"default":function(iframe){try{return iframe.contentDocument;}catch(ex){return null;}}}),getBody:function(iframe){var doc=this.getDocument(iframe);return doc?doc.getElementsByTagName("body")[0]:null;},setSource:function(iframe,source){try{if(this.getWindow(iframe)){try{this.getWindow(iframe).location.replace(source);}catch(ex){iframe.src=source;}}else{iframe.src=source;}}catch(ex){qx.log.Logger.warn("Iframe source could not be set!");}},queryCurrentUrl:function(iframe){var doc=this.getDocument(iframe);try{if(doc&&doc.location){return doc.location.href;}}catch(ex){}return null;}}});qx.Bootstrap.define("qx.util.ResourceManager",{statics:{__registry:window.qxresources||{},has:function(id){return !!this.__registry[id];},getData:function(id){return this.__registry[id]||null;},getImageWidth:function(id){var entry=this.__registry[id];return entry?entry[0]:null;},getImageHeight:function(id){var entry=this.__registry[id];return entry?entry[1]:null;},getImageFormat:function(id){var entry=this.__registry[id];return entry?entry[2]:null;},isClippedImage:function(id){var entry=this.__registry[id];return entry&&entry.length>4;},toUri:function(id){if(id==null){return id;}var entry=this.__registry[id];if(!entry){return id;}if(typeof entry==="string"){var lib=entry;}else{var lib=entry[3];if(!lib){return id;}}return window.qxlibraries[lib].resourceUri+"/"+id;}}});qx.Class.define("qx.io.remote.transport.Script",{extend:qx.io.remote.transport.Abstract,construct:function(){this.base(arguments);var vUniqueId=++qx.io.remote.transport.Script._uniqueId;if(vUniqueId>=2000000000){qx.io.remote.transport.Script._uniqueId=vUniqueId=1;}this._element=null;this._uniqueId=vUniqueId;},statics:{_uniqueId:0,_instanceRegistry:{},ScriptTransport_PREFIX:"_ScriptTransport_",ScriptTransport_ID_PARAM:"_ScriptTransport_id",ScriptTransport_DATA_PARAM:"_ScriptTransport_data",handles:{synchronous:false,asynchronous:true,crossDomain:true,fileUpload:false,programaticFormFields:false,responseTypes:["text/plain","text/javascript","application/json"]},isSupported:function(){return true;},_numericMap:{"uninitialized":1,"loading":2,"loaded":2,"interactive":3,"complete":4},_requestFinished:function(id,content){var vInstance=qx.io.remote.transport.Script._instanceRegistry[id];if(vInstance==null){{};}else{vInstance._responseContent=content;vInstance._switchReadyState(qx.io.remote.transport.Script._numericMap.complete);}}},members:{_lastReadyState:0,send:function(){var vUrl=this.getUrl();vUrl+=(vUrl.indexOf("?")>=0?"&":"?")+qx.io.remote.transport.Script.ScriptTransport_ID_PARAM+"="+this._uniqueId;var vParameters=this.getParameters();var vParametersList=[];for(var vId in vParameters){if(vId.indexOf(qx.io.remote.transport.Script.ScriptTransport_PREFIX)==0){this.error("Illegal parameter name. The following prefix is used internally by qooxdoo): "+qx.io.remote.transport.Script.ScriptTransport_PREFIX);}var value=vParameters[vId];if(value instanceof Array){for(var i=0;i<value.length;i++){vParametersList.push(encodeURIComponent(vId)+"="+encodeURIComponent(value[i]));}}else{vParametersList.push(encodeURIComponent(vId)+"="+encodeURIComponent(value));}}if(vParametersList.length>0){vUrl+="&"+vParametersList.join("&");}var vData=this.getData();if(vData!=null){vUrl+="&"+qx.io.remote.transport.Script.ScriptTransport_DATA_PARAM+"="+encodeURIComponent(vData);}qx.io.remote.transport.Script._instanceRegistry[this._uniqueId]=this;this._element=document.createElement("script");this._element.charset="utf-8";this._element.src=vUrl;{};document.body.appendChild(this._element);},_switchReadyState:function(vReadyState){switch(this.getState()){case "completed":case "aborted":case "failed":case "timeout":this.warn("Ignore Ready State Change");return;}while(this._lastReadyState<vReadyState){this.setState(qx.io.remote.Exchange._nativeMap[++this._lastReadyState]);}},setRequestHeader:function(vLabel,vValue){},getResponseHeader:function(vLabel){return null;},getResponseHeaders:function(){return {};},getStatusCode:function(){return 200;},getStatusText:function(){return "";},getFetchedLength:function(){return 0;},getResponseContent:function(){if(this.getState()!=="completed"){{};return null;}{};switch(this.getResponseType()){case "text/plain":case "application/json":case "text/javascript":{};return this._responseContent||null;default:this.warn("No valid responseType specified ("+this.getResponseType()+")!");return null;}}},defer:function(statics,members,properties){qx.io.remote.Exchange.registerType(qx.io.remote.transport.Script,"qx.io.remote.transport.Script");qx.io.remote.ScriptTransport=statics;},destruct:function(){if(this._element){delete qx.io.remote.transport.Script._instanceRegistry[this._uniqueId];document.body.removeChild(this._element);}this._disposeFields("_element","_responseContent");}});qx.Class.define("qx.io.remote.Response",{extend:qx.event.type.Event,properties:{state:{check:"Integer",nullable:true},statusCode:{check:"Integer",nullable:true},content:{nullable:true},responseHeaders:{check:"Object",nullable:true}},members:{clone:function(embryo){var clone=this.base(arguments,embryo);clone.setType(this.getType());clone.setState(this.getState());clone.setStatusCode(this.getStatusCode());clone.setContent(this.getContent());clone.setResponseHeaders(this.getResponseHeaders());return clone;},getResponseHeader:function(){var vAll=this.getResponseHeaders();if(vAll){return vAll[vHeader]||null;}return null;}}});qx.Class.define("qx.legacy.util.Http",{statics:{METHOD_GET:"GET",METHOD_POST:"POST",METHOD_PUT:"PUT",METHOD_HEAD:"HEAD",METHOD_DELETE:"DELETE"}});qx.Class.define("qx.legacy.util.Mime",{statics:{JAVASCRIPT:"text/javascript",JSON:"application/json",XML:"application/xml",TEXT:"text/plain",HTML:"text/html"}});qx.Bootstrap.define("qx.xml.String",{statics:{TO_CHARCODE:{"quot":34,"amp":38,"lt":60,"gt":62,"apos":39},FROM_CHARCODE:{34:"quot",38:"amp",60:"lt",62:"gt",39:"apos"},escape:function(str){return qx.util.StringEscape.escape(str,this.FROM_CHARCODE);},unescape:function(str){return qx.util.StringEscape.unescape(str,this.TO_CHARCODE);}}});qx.Bootstrap.define("qx.util.StringEscape",{statics:{escape:qx.core.Variant.select("qx.client",{"mshtml":function(str,charCodeToEntities){var entity,result=[];for(var i=0,l=str.length;i<l;i++){var chr=str.charAt(i);var code=chr.charCodeAt(0);if(charCodeToEntities[code]){entity="&"+charCodeToEntities[code]+";";}else{if(code>0x7F){entity="&#"+code+";";}else{entity=chr;}}result[result.length]=entity;}return result.join("");},"default":function(str,charCodeToEntities){var entity,result="";for(var i=0,l=str.length;i<l;i++){var chr=str.charAt(i);var code=chr.charCodeAt(0);if(charCodeToEntities[code]){entity="&"+charCodeToEntities[code]+";";}else{if(code>0x7F){entity="&#"+code+";";}else{entity=chr;}}result+=entity;}return result;}}),unescape:function(str,entitiesToCharCode){return str.replace(/&[#\w]+;/gi,function(entity){var chr=entity;var entity=entity.substring(1,entity.length-1);var code=entitiesToCharCode[entity];if(code){chr=String.fromCharCode(code);}else{if(entity.charAt(0)=='#'){if(entity.charAt(1).toUpperCase()=='X'){code=entity.substring(2);if(code.match(/^[0-9A-Fa-f]+$/gi)){chr=String.fromCharCode(parseInt(code,16));}}else{code=entity.substring(1);if(code.match(/^\d+$/gi)){chr=String.fromCharCode(parseInt(code,10));}}}}return chr;});}}});qx.Class.define("qx.test.ui.LayoutTestCase",{extend:qx.dev.unit.TestCase,members:{setUp:function(){this.getRoot();},tearDown:function(){this.getRoot().removeAll();},getRoot:function(){var cls=qx.test.ui.LayoutTestCase;qx.theme.manager.Meta.getInstance().initialize();if(!cls._root){cls._root=new qx.ui.root.Application(document);qx.core.Init.getApplication=function(){return {getRoot:function(){return cls._root;}};};}return cls._root;},assertDestroy:function(fcn,context,msg){fcn.call(context);qx.ui.core.queue.Manager.flush();qx.ui.core.queue.Manager.flush();var regCopy=qx.lang.Object.copy(qx.core.ObjectRegistry.getRegistry());var eventMgr=qx.event.Registration.getManager(window);var listeners=eventMgr.__listeners;var listenersCopy={};for(var hash in listeners){listenersCopy[hash]={};for(var key in listeners[hash]){listenersCopy[hash][key]=qx.lang.Array.copy(listeners[hash][key]);}}fcn.call(context);qx.ui.core.queue.Manager.flush();qx.ui.core.queue.Manager.flush();var reg=qx.core.ObjectRegistry.getRegistry();for(key in reg){var obj=reg[key];this.assertNotUndefined(regCopy[key],msg+": The object '"+obj+"' has not been disposed!");}listeners=eventMgr.__listeners;for(var hash in listeners){if(!listenersCopy[hash]){listenersCopy[hash]={};}for(key in listeners[hash]){if(!listenersCopy[hash][key]){listenersCopy[hash][key]=[];}for(var i=0;i<listeners[hash][key].length;i++){if(listenersCopy[hash][key].indexOf(listeners[hash][key][i])==-1){this.fail(msg+": The event listener '"+key+":"+listeners[hash][key][i]+"'for the object '"+hash+":"+qx.core.ObjectRegistry.fromHashCode(hash)+"' has not been removed.");}}}}this.assertIdentical(0,this.getRoot().getChildren().length,msg+": The root Children array must be empty but found: "+this.getRoot().getChildren().join(", "));},assertWidgetDispose:function(clazz,args,msg){this.assertDestroy(function(){var argStr=[];for(var i=0;i<args.length;i++){argStr.push("args["+i+"]");}var widget;var str="var widget = new clazz("+argStr.join(", ")+");";eval(str);this.getRoot().add(widget);qx.ui.core.queue.Manager.flush();widget.destroy();},this,msg);},_getFixedWidget:function(){var widget=new qx.ui.core.Widget();widget.set({width:200,height:100,maxWidth:"pref",minWidth:"pref",maxHeight:"pref",minHeight:"pref"});return widget;},assertSize:function(widget,width,height,msg){qx.ui.core.queue.Manager.flush();var el=widget.getContainerElement().getDomElement();var elHeight=parseInt(el.style.height);var elWidth=parseInt(el.style.width);this.assertEquals(width,elWidth,msg);this.assertEquals(height,elHeight,msg);},assertPadding:function(widget,top,right,bottom,left,msg){qx.ui.core.queue.Manager.flush();this.assertNotNull(widget.getContainerElement());this.assertNotNull(widget.getContainerElement().getDomElement());var container=widget.getContainerElement().getDomElement();var width=parseInt(container.style.width)||0;var height=parseInt(container.style.height)||0;var content=widget.getContentElement().getDomElement();var innerWidth=parseInt(content.style.width)||0;var innerHeight=parseInt(content.style.height)||0;var innerTop=parseInt(content.style.top)||0;var innerLeft=parseInt(content.style.left)||0;this.assertEquals(top,innerTop,msg);this.assertEquals(right,width-innerWidth-left,msg);this.assertEquals(bottom,height-innerHeight-top,msg);this.assertEquals(left,innerLeft,msg);},assertStyle:function(widget,style,value,msg){qx.ui.core.queue.Manager.flush();var widgetStyle=widget.getContainerElement().getDomElement().style[style];if(value&&style.match(/color/i)){this.assertCssColor(value,widgetStyle,msg);}else{this.assertEquals(value,widgetStyle,msg);}},assertContentStyle:function(widget,style,value,msg){qx.ui.core.queue.Manager.flush();var widgetStyle=widget.getContainerElement().getDomElement().style[style];if(value&&style.match(/color/i)){this.assertCssColor(value,widgetStyle,msg);}else{this.assertEquals(value,widgetStyle,msg);}},assertDecoratorStyle:function(widget,style,value,msg){qx.ui.core.queue.Manager.flush();if(!value&&!widget.getDecoratorElement()){return;}this.assertNotNull(widget.getDecoratorElement(),msg);var widgetStyle=widget.getDecoratorElement().getDomElement().style[style];if(value&&style.match(/color/i)){this.assertCssColor(value,widgetStyle,msg);}else{this.assertEquals(value,widgetStyle,msg);}}}});qx.Mixin.define("qx.locale.MTranslation",{members:{tr:function(messageId,varargs){var nlsManager=qx.locale.Manager;if(nlsManager){return nlsManager.tr.apply(nlsManager,arguments);}throw new Error("To enable localization please include qx.locale.Manager into your build!");},trn:function(singularMessageId,pluralMessageId,count,varargs){var nlsManager=qx.locale.Manager;if(nlsManager){return nlsManager.trn.apply(nlsManager,arguments);}throw new Error("To enable localization please include qx.locale.Manager into your build!");},marktr:function(messageId){var nlsManager=qx.locale.Manager;if(nlsManager){return nlsManager.marktr.apply(nlsManager,arguments);}throw new Error("To enable localization please include qx.locale.Manager into your build!");}}});qx.Class.define("qx.test.ui.LocaleSwitch",{extend:qx.test.ui.LayoutTestCase,include:qx.locale.MTranslation,construct:function(){var manager=qx.locale.Manager.getInstance();manager.addTranslation("en_QX",{"test one":"test one","test two":"test two","test Hello %1!":"test Hello %1!","test Jonny":"test Jonny","test One car":"test One car","test %1 cars":"test %1 cars"});manager.addTranslation("de_QX",{"test one":"Eins","test two":"Zwei","test Hello %1!":"Servus %1!","test Jonny":"Jonathan","test One car":"Ein Auto","test %1 cars":"%1 Autos"});manager.setLocale("en_QX");},members:{testLabel:function(){var manager=qx.locale.Manager.getInstance();var label=new qx.ui.basic.Label(this.tr("test one"));this.getRoot().add(label);this.assertEquals("test one",label.getContent());manager.setLocale("de_QX");this.assertEquals("Eins",label.getContent());manager.setLocale("en_QX");label.setContent(this.tr("test Hello %1!",this.tr("test Jonny")));this.assertEquals("test Hello test Jonny!",label.getContent());manager.setLocale("de_QX");this.assertEquals("Servus Jonathan!",label.getContent());label.setContent(this.tr("test two"));this.assertEquals("Zwei",label.getContent());manager.setLocale("en_QX");this.assertEquals("test two",label.getContent());this.getRoot().remove(label);label.dispose();}}});qx.Class.define("qx.Theme",{statics:{define:function(name,config){if(!config){var config={};}if(config.include&&!(config.include instanceof Array)){config.include=[config.include];}{};var theme={$$type:"Theme",name:name,title:config.title,toString:this.genericToString};if(config.extend){theme.supertheme=config.extend;}if(config.resource){theme.resource=config.resource;}theme.basename=qx.Bootstrap.createNamespace(name,theme);this.__convert(theme,config);this.$$registry[name]=theme;if(config.include){for(var i=0,a=config.include,l=a.length;i<l;i++){this.include(theme,a[i]);}}},getAll:function(){return this.$$registry;},getByName:function(name){return this.$$registry[name];},isDefined:function(name){return this.getByName(name)!==undefined;},getTotalNumber:function(){return qx.lang.Object.getLength(this.$$registry);},genericToString:function(){return "[Theme "+this.name+"]";},__extractType:function(config){for(var i=0,keys=this.__inheritableKeys,l=keys.length;i<l;i++){if(config[keys[i]]){return keys[i];}}},__convert:function(theme,config){var type=this.__extractType(config);if(config.extend&&!type){type=config.extend.type;}theme.type=type||"other";if(!type){return;}var clazz=function(){};if(config.extend){clazz.prototype=new config.extend.$$clazz;}var target=clazz.prototype;var source=config[type];for(var id in source){target[id]=source[id];if(target[id].base){{};target[id].base=config.extend;}}theme.$$clazz=clazz;theme[type]=new clazz;},$$registry:{},__inheritableKeys:["colors","borders","decorations","fonts","icons","widgets","appearances","meta"],__allowedKeys:null,__metaKeys:null,__validateConfig:function(){},patch:function(theme,mixinTheme){var type=this.__extractType(mixinTheme);if(type!==this.__extractType(theme)){throw new Error("The mixins '"+theme.name+"' are not compatible '"+mixinTheme.name+"'!");}var source=mixinTheme[type];var target=theme[type];for(var key in source){target[key]=source[key];}},include:function(theme,mixinTheme){var type=mixinTheme.type;if(type!==theme.type){throw new Error("The mixins '"+theme.name+"' are not compatible '"+mixinTheme.name+"'!");}var source=mixinTheme[type];var target=theme[type];for(var key in source){if(target[key]!==undefined){throw new Error("It is not allowed to overwrite the key '"+key+"' of theme '"+theme.name+"' by mixin theme '"+mixinTheme.name+"'.");}target[key]=source[key];}}}});qx.Theme.define("qx.theme.classic.Color",{colors:{"background":"#EBE9ED","background-light":"#F3F0F5","background-focused":"#F3F8FD","background-focused-inner":"#DBEAF9","background-disabled":"#F4F4F4","background-selected":"#3E6CA8","background-field":"white","background-pane":"#FAFBFE","border-lead":"#888888","border-light":"white","border-light-shadow":"#DCDFE4","border-dark-shadow":"#A7A6AA","border-dark":"#85878C","border-focused-light":"#BCCEE5","border-focused-light-shadow":"#A5BDDE","border-focused-dark-shadow":"#7CA0CF","border-focused-dark":"#3E6CA8","border-separator":"#808080","text":"black","text-disabled":"#A7A6AA","text-selected":"white","text-focused":"#3E5B97","tooltip":"#FFFFE1","tooltip-text":"black","button":"#EBE9ED","button-hovered":"#F6F5F7","button-abandoned":"#F9F8E9","button-checked":"#F3F0F5","window-active-caption-text":[255,255,255],"window-inactive-caption-text":[255,255,255],"window-active-caption":[51,94,168],"window-inactive-caption":[111,161,217],"date-chooser":"white","date-chooser-title":[116,116,116],"date-chooser-selected":[52,52,52],"effect":[254,200,60],"table-pane":"white","table-header":[242,242,242],"table-header-border":[214,213,217],"table-header-cell":[235,234,219],"table-header-cell-hover":[255,255,255],"table-focus-indicator":[179,217,255],"table-row-background-focused-selected":[90,138,211],"table-row-background-focused":[221,238,255],"table-row-background-selected":[51,94,168],"table-row-background-even":[250,248,243],"table-row-background-odd":[255,255,255],"table-row-selected":[255,255,255],"table-row":[0,0,0],"table-row-line":"#EEE","table-column-line":"#EEE","progressive-table-header":"#AAAAAA","progressive-table-row-background-even":[250,248,243],"progressive-table-row-background-odd":[255,255,255],"progressive-progressbar-background":"gray","progressive-progressbar-indicator-done":"#CCCCCC","progressive-progressbar-indicator-undone":"white","progressive-progressbar-percent-background":"gray","progressive-progressbar-percent-text":"white"}});qx.Interface.define("qx.ui.decoration.IDecorator",{members:{init:function(element){},resize:function(element,width,height){},tint:function(element,bgcolor){},getMarkup:function(){},getInsets:function(){}}});qx.Class.define("qx.ui.decoration.Uniform",{extend:qx.core.Object,implement:[qx.ui.decoration.IDecorator],construct:function(width,style,color){this.base(arguments);if(width!=null){this.setWidth(width);}if(style!=null){this.setStyle(style);}if(color!=null){this.setColor(color);}},properties:{width:{check:"PositiveInteger",init:0,apply:"_applyWidth"},style:{nullable:true,check:["solid","dotted","dashed","double"],init:"solid",apply:"_applyStyle"},color:{nullable:true,check:"Color",apply:"_applyStyle"},backgroundImage:{check:"String",nullable:true,apply:"_applyStyle"},backgroundRepeat:{check:["repeat","repeat-x","repeat-y","no-repeat","scale"],init:"repeat",apply:"_applyStyle"},backgroundColor:{check:"Color",nullable:true,apply:"_applyStyle"}},members:{init:function(element){element.useMarkup(this.getMarkup());},getMarkup:function(){if(this.__markup){return this.__markup;}var styles="position:absolute;top:0;left:0;";var width=this.getWidth();{};var Color=qx.theme.manager.Color.getInstance();styles+="border:"+width+"px "+this.getStyle()+" "+Color.resolve(this.getColor())+";";var html=qx.ui.decoration.Util.generateBackgroundMarkup(this.getBackgroundImage(),this.getBackgroundRepeat(),styles);return this.__markup=html;},resize:function(element,width,height){var scaledImage=this.getBackgroundImage()&&this.getBackgroundRepeat()=="scale";if(scaledImage||qx.bom.client.Feature.CONTENT_BOX){var inset=this.getWidth()*2;width-=inset;height-=inset;if(width<0){width=0;}if(height<0){height=0;}}var dom=element.getDomElement();dom.style.width=width+"px";dom.style.height=height+"px";},tint:function(element,bgcolor){var Color=qx.theme.manager.Color.getInstance();var dom=element.getDomElement();if(bgcolor==null){bgcolor=this.getBackgroundColor();}dom.style.backgroundColor=Color.resolve(bgcolor)||"";},getInsets:function(){if(this.__insets){return this.__insets;}var width=this.getWidth();this.__insets={top:width,right:width,bottom:width,left:width};return this.__insets;},_applyWidth:function(){{};this.__insets=null;},_applyStyle:function(){{};}},destruct:function(){this._disposeFields("__markup","__insets");}});qx.Class.define("qx.ui.decoration.Single",{extend:qx.core.Object,implement:[qx.ui.decoration.IDecorator],construct:function(width,style,color){this.base(arguments);if(width!=null){this.setWidth(width);}if(style!=null){this.setStyle(style);}if(color!=null){this.setColor(color);}},properties:{widthTop:{check:"Number",init:0,apply:"_applyWidth"},widthRight:{check:"Number",init:0,apply:"_applyWidth"},widthBottom:{check:"Number",init:0,apply:"_applyWidth"},widthLeft:{check:"Number",init:0,apply:"_applyWidth"},styleTop:{nullable:true,check:["solid","dotted","dashed","double"],init:"solid",apply:"_applyStyle"},styleRight:{nullable:true,check:["solid","dotted","dashed","double"],init:"solid",apply:"_applyStyle"},styleBottom:{nullable:true,check:["solid","dotted","dashed","double"],init:"solid",apply:"_applyStyle"},styleLeft:{nullable:true,check:["solid","dotted","dashed","double"],init:"solid",apply:"_applyStyle"},colorTop:{nullable:true,check:"Color",apply:"_applyStyle"},colorRight:{nullable:true,check:"Color",apply:"_applyStyle"},colorBottom:{nullable:true,check:"Color",apply:"_applyStyle"},colorLeft:{nullable:true,check:"Color",apply:"_applyStyle"},backgroundImage:{check:"String",nullable:true,apply:"_applyStyle"},backgroundRepeat:{check:["repeat","repeat-x","repeat-y","no-repeat","scale"],init:"repeat",apply:"_applyStyle"},backgroundColor:{check:"Color",nullable:true,apply:"_applyStyle"},left:{group:["widthLeft","styleLeft","colorLeft"]},right:{group:["widthRight","styleRight","colorRight"]},top:{group:["widthTop","styleTop","colorTop"]},bottom:{group:["widthBottom","styleBottom","colorBottom"]},width:{group:["widthTop","widthRight","widthBottom","widthLeft"],mode:"shorthand"},style:{group:["styleTop","styleRight","styleBottom","styleLeft"],mode:"shorthand"},color:{group:["colorTop","colorRight","colorBottom","colorLeft"],mode:"shorthand"}},members:{init:function(element){element.useMarkup(this.getMarkup());},getMarkup:function(element){if(this.__markup){return this.__markup;}var Color=qx.theme.manager.Color.getInstance();var styles="";var width=this.getWidthTop();if(width>0){styles+="border-top:"+width+"px "+this.getStyleTop()+" "+Color.resolve(this.getColorTop())+";";}var width=this.getWidthRight();if(width>0){styles+="border-right:"+width+"px "+this.getStyleRight()+" "+Color.resolve(this.getColorRight())+";";}var width=this.getWidthBottom();if(width>0){styles+="border-bottom:"+width+"px "+this.getStyleBottom()+" "+Color.resolve(this.getColorBottom())+";";}var width=this.getWidthLeft();if(width>0){styles+="border-left:"+width+"px "+this.getStyleLeft()+" "+Color.resolve(this.getColorLeft())+";";}{};styles+="position:absolute;top:0;left:0;";var html=qx.ui.decoration.Util.generateBackgroundMarkup(this.getBackgroundImage(),this.getBackgroundRepeat(),styles);return this.__markup=html;},resize:function(element,width,height){var scaledImage=this.getBackgroundImage()&&this.getBackgroundRepeat()=="scale";if(scaledImage||qx.bom.client.Feature.CONTENT_BOX){var insets=this.getInsets();width-=insets.left+insets.right;height-=insets.top+insets.bottom;if(width<0){width=0;}if(height<0){height=0;}}var dom=element.getDomElement();dom.style.width=width+"px";dom.style.height=height+"px";},tint:function(element,bgcolor){var Color=qx.theme.manager.Color.getInstance();var dom=element.getDomElement();if(bgcolor==null){bgcolor=this.getBackgroundColor();}dom.style.backgroundColor=Color.resolve(bgcolor)||"";},getInsets:function(){if(this.__insets){return this.__insets;}this.__insets={top:this.getWidthTop(),right:this.getWidthRight(),bottom:this.getWidthBottom(),left:this.getWidthLeft()};return this.__insets;},_applyWidth:function(){{};this.__insets=null;},_applyStyle:function(){{};}},destruct:function(){this._disposeFields("__markup","__insets");}});qx.Class.define("qx.ui.decoration.Double",{extend:qx.ui.decoration.Single,construct:function(width,style,color,innerWidth,innerColor){this.base(arguments,width,style,color,innerWidth,innerColor);if(innerWidth!=null){this.setInnerWidth(innerWidth);}if(innerColor!=null){this.setInnerColor(innerColor);}},properties:{innerWidthTop:{check:"Number",init:0},innerWidthRight:{check:"Number",init:0},innerWidthBottom:{check:"Number",init:0},innerWidthLeft:{check:"Number",init:0},innerWidth:{group:["innerWidthTop","innerWidthRight","innerWidthBottom","innerWidthLeft"],mode:"shorthand"},innerColorTop:{nullable:true,check:"Color"},innerColorRight:{nullable:true,check:"Color"},innerColorBottom:{nullable:true,check:"Color"},innerColorLeft:{nullable:true,check:"Color"},innerColor:{group:["innerColorTop","innerColorRight","innerColorBottom","innerColorLeft"],mode:"shorthand"}},members:{__markup:null,__insets:null,getMarkup:function(){if(this.__markup){return this.__markup;}var Color=qx.theme.manager.Color.getInstance();var innerStyles="";var width=this.getInnerWidthTop();if(width>0){innerStyles+="border-top:"+width+"px "+this.getStyleTop()+" "+Color.resolve(this.getInnerColorTop())+";";}var width=this.getInnerWidthRight();if(width>0){innerStyles+="border-right:"+width+"px "+this.getStyleRight()+" "+Color.resolve(this.getInnerColorRight())+";";}var width=this.getInnerWidthBottom();if(width>0){innerStyles+="border-bottom:"+width+"px "+this.getStyleBottom()+" "+Color.resolve(this.getInnerColorBottom())+";";}var width=this.getInnerWidthLeft();if(width>0){innerStyles+="border-left:"+width+"px "+this.getStyleLeft()+" "+Color.resolve(this.getInnerColorLeft())+";";}{};var innerHtml=qx.ui.decoration.Util.generateBackgroundMarkup(this.getBackgroundImage(),this.getBackgroundRepeat(),innerStyles);var outerStyles='';var width=this.getWidthTop();if(width>0){outerStyles+="border-top:"+width+"px "+this.getStyleTop()+" "+Color.resolve(this.getColorTop())+";";}var width=this.getWidthRight();if(width>0){outerStyles+="border-right:"+width+"px "+this.getStyleRight()+" "+Color.resolve(this.getColorRight())+";";}var width=this.getWidthBottom();if(width>0){outerStyles+="border-bottom:"+width+"px "+this.getStyleBottom()+" "+Color.resolve(this.getColorBottom())+";";}var width=this.getWidthLeft();if(width>0){outerStyles+="border-left:"+width+"px "+this.getStyleLeft()+" "+Color.resolve(this.getColorLeft())+";";}{};return this.__markup='<div style="position:absolute;top:0;left:0;'+outerStyles+'">'+innerHtml+'</div>';},resize:function(element,width,height){var scaledImage=this.getBackgroundImage()&&this.getBackgroundRepeat()=="scale";if(scaledImage||qx.bom.client.Feature.CONTENT_BOX){var insets=this.getInsets();var innerWidth=width-insets.left-insets.right;var innerHeight=height-insets.top-insets.bottom;}else{var innerWidth=width-this.getWidthLeft()-this.getWidthRight();var innerHeight=height-this.getWidthTop()-this.getWidthBottom();}if(innerWidth<0){innerWidth=0;}if(innerHeight<0){innerHeight=0;}var dom=element.getDomElement();dom.firstChild.style.width=innerWidth+"px";dom.firstChild.style.height=innerHeight+"px";},getInsets:function(){if(this.__insets){return this.__insets;}this.__insets={top:this.getWidthTop()+this.getInnerWidthTop(),right:this.getWidthRight()+this.getInnerWidthRight(),bottom:this.getWidthBottom()+this.getInnerWidthBottom(),left:this.getWidthLeft()+this.getInnerWidthLeft()};return this.__insets;}},destruct:function(){this._disposeFields("__markup","__insets");}});qx.Class.define("qx.ui.decoration.Grid",{extend:qx.core.Object,implement:[qx.ui.decoration.IDecorator],construct:function(baseImage,insets){this.base(arguments);if(baseImage!=null){this.setBaseImage(baseImage);}if(insets!=null){this.setInsets(insets);}},properties:{baseImage:{check:"String",nullable:true,apply:"_applyBaseImage"},insetLeft:{check:"Number",init:0,apply:"_applyInsets"},insetRight:{check:"Number",init:0,apply:"_applyInsets"},insetBottom:{check:"Number",init:0,apply:"_applyInsets"},insetTop:{check:"Number",init:0,apply:"_applyInsets"},insets:{group:["insetTop","insetRight","insetBottom","insetLeft"],mode:"shorthand"}},members:{__markup:null,__insets:null,__images:null,__edges:null,init:function(element){element.useMarkup(this.getMarkup());},getMarkup:function(){if(this.__markup){return this.__markup;}var Decoration=qx.bom.element.Decoration;var images=this.__images;var edges=this.__edges;var html=[];html.push('<div style="position:absolute;top:0;left:0;overflow:hidden;font-size:0;line-height:0;">');html.push(Decoration.create(images.tl,"no-repeat",{top:0,left:0}));html.push(Decoration.create(images.t,"scale-x",{top:0,left:edges.left+"px"}));html.push(Decoration.create(images.tr,"no-repeat",{top:0,right:0}));html.push(Decoration.create(images.bl,"no-repeat",{bottom:0,left:0}));html.push(Decoration.create(images.b,"scale-x",{bottom:0,left:edges.left+"px"}));html.push(Decoration.create(images.br,"no-repeat",{bottom:0,right:0}));html.push(Decoration.create(images.l,"scale-y",{top:edges.top+"px",left:0}));html.push(Decoration.create(images.c,"scale",{top:edges.top+"px",left:edges.left+"px"}));html.push(Decoration.create(images.r,"scale-y",{top:edges.top+"px",right:0}));html.push('</div>');return this.__markup=html.join("");},resize:function(element,width,height){var edges=this.__edges;var innerWidth=width-edges.left-edges.right;var innerHeight=height-edges.top-edges.bottom;var frame=element.getDomElement();frame.style.width=width+"px";frame.style.height=height+"px";frame.childNodes[1].style.width=innerWidth+"px";frame.childNodes[4].style.width=innerWidth+"px";frame.childNodes[7].style.width=innerWidth+"px";frame.childNodes[6].style.height=innerHeight+"px";frame.childNodes[7].style.height=innerHeight+"px";frame.childNodes[8].style.height=innerHeight+"px";},tint:function(element,bgcolor){},getInsets:function(){if(this.__insets){return this.__insets;}return this.__insets={left:this.getInsetLeft(),right:this.getInsetRight(),bottom:this.getInsetBottom(),top:this.getInsetTop()};},_applyInsets:function(){{};this.__insets=null;},_applyBaseImage:function(value,old){{};var ResourceManager=qx.util.ResourceManager;if(value){var Alias=qx.util.AliasManager.getInstance();var base=Alias.resolve(value);var split=/(.*)(\.[a-z]+)$/.exec(base);var prefix=split[1];var ext=split[2];var images=this.__images={tl:prefix+"-tl"+ext,t:prefix+"-t"+ext,tr:prefix+"-tr"+ext,bl:prefix+"-bl"+ext,b:prefix+"-b"+ext,br:prefix+"-br"+ext,l:prefix+"-l"+ext,c:prefix+"-c"+ext,r:prefix+"-r"+ext};this.__edges={top:ResourceManager.getImageHeight(images.t),bottom:ResourceManager.getImageHeight(images.b),left:ResourceManager.getImageWidth(images.l),right:ResourceManager.getImageWidth(images.r)};}}},destruct:function(){this._disposeFields("__markup","__insets","__images","__edges");}});qx.Theme.define("qx.theme.classic.Decoration",{resource:"qx/decoration/Classic",decorations:{"main":{decorator:qx.ui.decoration.Uniform,style:{width:1,color:"border-dark"}},"inset":{decorator:qx.ui.decoration.Double,style:{width:1,innerWidth:1,color:["border-dark-shadow","border-light","border-light","border-dark-shadow"],innerColor:["border-dark","border-light-shadow","border-light-shadow","border-dark"]}},"outset":{decorator:qx.ui.decoration.Double,style:{width:1,innerWidth:1,color:["border-light-shadow","border-dark","border-dark","border-light-shadow"],innerColor:["border-light","border-dark-shadow","border-dark-shadow","border-light"]}},"groove":{decorator:qx.ui.decoration.Double,style:{width:1,innerWidth:1,color:["border-dark-shadow","border-light","border-light","border-dark-shadow"],innerColor:["border-light","border-dark-shadow","border-dark-shadow","border-light"]}},"ridge":{decorator:qx.ui.decoration.Double,style:{width:1,innerWidth:1,color:["border-light","border-dark-shadow","border-dark-shadow","border-light"],innerColor:["border-dark-shadow","border-light","border-light","border-dark-shadow"]}},"inset-thin":{decorator:qx.ui.decoration.Single,style:{width:1,color:["border-dark-shadow","border-light","border-light","border-dark-shadow"]}},"outset-thin":{decorator:qx.ui.decoration.Single,style:{width:1,color:["border-light","border-dark-shadow","border-dark-shadow","border-light"]}},"focused-inset":{decorator:qx.ui.decoration.Double,style:{width:1,innerWidth:1,color:["border-focused-dark-shadow","border-focused-light","border-focused-light","border-focused-dark-shadow"],innerColor:["border-focused-dark","border-focused-light-shadow","border-focused-light-shadow","border-focused-dark"]}},"focused-outset":{decorator:qx.ui.decoration.Double,style:{width:1,innerWidth:1,color:["border-focused-light-shadow","border-focused-dark","border-focused-dark","border-focused-light-shadow"],innerColor:["border-focused-light","border-focused-dark-shadow","border-focused-dark-shadow","border-focused-light"]}},"separator-horizontal":{decorator:qx.ui.decoration.Single,style:{widthLeft:1,colorLeft:"border-separator"}},"separator-vertical":{decorator:qx.ui.decoration.Single,style:{widthTop:1,colorTop:"border-separator"}},"shadow":{decorator:qx.ui.decoration.Grid,style:{baseImage:"decoration/shadow/shadow.png",insets:[4,8,8,4]}},"shadow-small":{decorator:qx.ui.decoration.Grid,style:{baseImage:"decoration/shadow/shadow-small.png",insets:[0,3,3,0]}},"lead-item":{decorator:qx.ui.decoration.Uniform,style:{width:1,style:"dotted",color:"border-lead"}},"tooltip":{decorator:qx.ui.decoration.Uniform,style:{width:1,color:"tooltip-text"}},"toolbar-separator":{decorator:qx.ui.decoration.Single,style:{widthLeft:1,colorLeft:"border-dark-shadow"}},"toolbar-part-handle":{decorator:qx.ui.decoration.Single,style:{width:1,style:"solid",colorTop:"#ffffff",colorLeft:"#ffffff",colorRight:"#a7a6aa",colorBottom:"#a7a6aa"}},"menu-separator":{decorator:qx.ui.decoration.Single,style:{widthTop:1,widthBottom:1,colorTop:"border-dark",colorBottom:"border-light"}},"datechooser-date-pane":{decorator:qx.ui.decoration.Single,style:{widthTop:1,colorTop:"gray",style:"solid"}},"datechooser-weekday":{decorator:qx.ui.decoration.Single,style:{widthBottom:1,colorBottom:"gray",style:"solid"}},"datechooser-week":{decorator:qx.ui.decoration.Single,style:{widthRight:1,colorRight:"gray",style:"solid"}},"datechooser-week-header":{decorator:qx.ui.decoration.Single,style:{widthBottom:1,colorBottom:"gray",widthRight:1,colorRight:"gray",style:"solid"}},"tabview-page-button-top":{decorator:qx.ui.decoration.Double,style:{width:1,color:["border-light-shadow","border-dark","border-dark","border-light-shadow"],innerWidth:1,innerColor:["border-light","border-dark-shadow","border-dark-shadow","border-light"],widthBottom:0,innerWidthBottom:0}},"tabview-page-button-bottom":{decorator:qx.ui.decoration.Double,style:{width:1,color:["border-light-shadow","border-dark","border-dark","border-light-shadow"],innerWidth:1,innerColor:["border-light","border-dark-shadow","border-dark-shadow","border-light"],widthTop:0,innerWidthTop:0}},"tabview-page-button-left":{decorator:qx.ui.decoration.Double,style:{width:1,color:["border-light-shadow","border-dark","border-dark","border-light-shadow"],innerWidth:1,innerColor:["border-light","border-dark-shadow","border-dark-shadow","border-light"],widthRight:0,innerWidthRight:0}},"tabview-page-button-right":{decorator:qx.ui.decoration.Double,style:{width:1,color:["border-light-shadow","border-dark","border-dark","border-light-shadow"],innerWidth:1,innerColor:["border-light","border-dark-shadow","border-dark-shadow","border-light"],widthLeft:0,innerWidthLeft:0}},"table-statusbar":{decorator:qx.ui.decoration.Single,style:{widthTop:1,colorTop:"border-dark-shadow",styleTop:"solid"}},"table-scroller-header":{decorator:qx.ui.decoration.Single,style:{widthBottom:1,colorBottom:"table-header-border",styleBottom:"solid"}},"table-scroller-focus-indicator":{decorator:qx.ui.decoration.Single,style:{width:2,color:"table-focus-indicator",style:"solid"}},"table-header-cell":{decorator:qx.ui.decoration.Single,style:{widthRight:1,colorRight:"table-header-border",styleRight:"solid"}},"table-header-cell-hovered":{decorator:qx.ui.decoration.Single,style:{widthRight:1,colorRight:"table-header-border",styleRight:"solid",widthBottom:2,colorBottom:"effect",styleBottom:"solid"}}}});qx.Theme.define("qx.theme.classic.Font",{fonts:{"default":{size:11,lineHeight:1.4,family:["Lucida Grande","Tahoma","Verdana","Bitstream Vera Sans","Liberation Sans"]},"bold":{size:11,lineHeight:1.4,family:["Lucida Grande","Tahoma","Verdana","Bitstream Vera Sans","Liberation Sans"],bold:true},"small":{size:10,lineHeight:1.4,family:["Lucida Grande","Tahoma","Verdana","Bitstream Vera Sans","Liberation Sans"]},"monospace":{size:11,lineHeight:1.4,family:["DejaVu Sans Mono","Courier New","monospace"]}}});qx.Theme.define("qx.theme.classic.Appearance",{appearances:{"widget":{},"label":{style:function(states){return {textColor:states.disabled?"text-disabled":"undefined"};}},"image":{style:function(states){return {opacity:!states.replacement&&states.disabled?0.3:"undefined"};}},"atom":{},"atom/label":"label","atom/icon":"image","root":{style:function(states){return {backgroundColor:"background",textColor:"text",font:"default"};}},"popup":{style:function(states){return {decorator:"main",backgroundColor:"background-pane",shadow:"shadow-small"};}},"tooltip":{include:"popup",style:function(states){return {backgroundColor:"tooltip",textColor:"tooltip-text",decorator:"tooltip",shadow:"shadow-small",padding:[1,3,2,3],offset:[1,1,20,1]};}},"tooltip/atom":"atom","iframe":{style:function(states){return {backgroundColor:"white",decorator:"inset"};}},"move-frame":{style:function(states){return {decorator:"main"};}},"resize-frame":"move-frame","dragdrop-cursor":{style:function(states){var icon="nodrop";if(states.copy){icon="copy";}else if(states.move){icon="move";}else if(states.alias){icon="alias";}return {source:"decoration/cursors/"+icon+".gif",position:"right-top",offset:[2,16,2,6]};}},"button":{alias:"atom",style:function(states){if(states.pressed||states.abandoned||states.checked){var decorator=!states.inner&&states.focused?"focused-inset":"inset";}else{var decorator=!states.inner&&states.focused?"focused-outset":"outset";}if(states.pressed||states.abandoned||states.checked){var padding=[4,3,2,5];}else{var padding=[3,4];}return {backgroundColor:states.abandoned?"button-abandoned":states.hovered?"button-hovered":states.checked?"button-checked":"button",decorator:decorator,padding:padding};}},"splitbutton":{},"splitbutton/button":"button","splitbutton/arrow":{alias:"button",include:"button",style:function(states){return {icon:"decoration/arrows/down.gif"};}},"scrollarea/corner":{style:function(){return {backgroundColor:"background",width:0,height:0};}},"scrollarea":"widget","scrollarea/pane":"widget","scrollarea/scrollbar-x":"scrollbar","scrollarea/scrollbar-y":"scrollbar","list":{alias:"scrollarea",style:function(states){return {decorator:states.focused?"focused-inset":"inset",backgroundColor:states.focused?"background-focused":"white"};}},"listitem":{alias:"atom",style:function(states){return {gap:4,padding:states.lead?[2,4]:[3,5],backgroundColor:states.selected?"background-selected":"undefined",textColor:states.selected?"text-selected":"undefined",decorator:states.lead?"lead-item":"undefined"};}},"textfield":{style:function(states){return {decorator:states.focused?"focused-inset":"inset",padding:[2,3],textColor:states.disabled?"text-disabled":"undefined",backgroundColor:states.disabled?"background-disabled":states.focused?"background-focused":"background-field"};}},"textarea":"textfield","checkbox":{alias:"atom",style:function(states){var icon;if(states.checked&&states.focused){icon="checkbox-checked-focused";}else if(states.checked&&states.disabled){icon="checkbox-checked-disabled";}else if(states.checked&&states.pressed){icon="checkbox-checked-pressed";}else if(states.checked&&states.hovered){icon="checkbox-checked-hovered";}else if(states.checked){icon="checkbox-checked";}else if(states.disabled){icon="checkbox-disabled";}else if(states.focused){icon="checkbox-focused";}else if(states.pressed){icon="checkbox-pressed";}else if(states.hovered){icon="checkbox-hovered";}else{icon="checkbox";}return {icon:"decoration/form/"+icon+".png",gap:6};}},"radiobutton":{alias:"checkbox",include:"checkbox",style:function(states){var icon;if(states.checked&&states.focused){icon="radiobutton-checked-focused";}else if(states.checked&&states.disabled){icon="radiobutton-checked-disabled";}else if(states.checked&&states.pressed){icon="radiobutton-checked-pressed";}else if(states.checked&&states.hovered){icon="radiobutton-checked-hovered";}else if(states.checked){icon="radiobutton-checked";}else if(states.disabled){icon="radiobutton-disabled";}else if(states.focused){icon="radiobutton-focused";}else if(states.pressed){icon="radiobutton-pressed";}else if(states.hovered){icon="radiobutton-hovered";}else{icon="radiobutton";}return {icon:"decoration/form/"+icon+".png"};}},"spinner":{style:function(states){return {decorator:states.focused?"focused-inset":"inset",textColor:states.disabled?"text-disabled":"undefined"};}},"spinner/textfield":{include:"textfield",style:function(states){return {decorator:"undefined",padding:[2,3]};}},"spinner/upbutton":{alias:"button",include:"button",style:function(states){return {icon:"decoration/arrows/up-small.gif",padding:states.pressed?[2,2,0,4]:[1,3,1,3],backgroundColor:states.hovered?"button-hovered":"button"};}},"spinner/downbutton":{alias:"button",include:"button",style:function(states){return {icon:"decoration/arrows/down-small.gif",padding:states.pressed?[2,2,0,4]:[1,3,1,3],backgroundColor:states.hovered?"button-hovered":"button"};}},"datefield":"combobox","datefield/button":{alias:"combobox/button",include:"combobox/button",style:function(states){return {icon:"icon/16/apps/office-calendar.png",padding:[0,3],backgroundColor:states.disabled?"background-disabled":states.focused?"background-focused":"background-field",decorator:"undefined"};}},"datefield/list":{alias:"datechooser",include:"datechooser",style:function(states){return {decorator:states.focused?"focused-inset":"inset"};}},"groupbox":{style:function(states){return {backgroundColor:"background"};}},"groupbox/legend":{alias:"atom",style:function(states){return {backgroundColor:"background",paddingRight:4,paddingLeft:4,marginRight:10,marginLeft:10};}},"groupbox/frame":{style:function(states){return {padding:[12,9],decorator:"groove"};}},"check-groupbox":"groupbox","check-groupbox/legend":{alias:"checkbox",include:"checkbox",style:function(states){return {backgroundColor:"background",paddingRight:3,paddingLeft:3,marginRight:10,marginLeft:10};}},"radio-groupbox":"groupbox","radio-groupbox/legend":{alias:"radiobutton",include:"radiobutton",style:function(states){return {backgroundColor:"background",paddingRight:3,paddingLeft:3,marginRight:10,marginLeft:10};}},"toolbar":{style:function(states){return {decorator:"outset-thin",backgroundColor:"background"};}},"toolbar/part":{},"toolbar/part/container":{},"toolbar/part/handle":{style:function(states){return {decorator:"toolbar-part-handle",backgroundColor:"background",width:4,margin:[3,2],allowGrowY:true};}},"toolbar-separator":{style:function(states){return {width:1,margin:[3,2],decorator:"toolbar-separator"};}},"toolbar-button":{alias:"atom",style:function(states){if(states.pressed||states.checked||states.abandoned){var border="inset-thin";var padding=[3,2,1,4];}else if(states.hovered){var border="outset-thin";var padding=[2,3];}else{var border="undefined";var padding=[3,4];}return {cursor:"default",decorator:border,padding:padding,backgroundColor:states.abandoned?"button-abandoned":states.checked?"background-light":"button"};}},"toolbar-splitbutton":{},"toolbar-splitbutton/button":"toolbar-button","toolbar-splitbutton/arrow":{alias:"toolbar-button",include:"toolbar-button",style:function(states){return {icon:"decoration/arrows/down.gif"};}},"slidebar":{},"slidebar/scrollpane":{},"slidebar/content":{},"slidebar/button-forward":{alias:"button",include:"button",style:function(states){return {icon:"decoration/arrows/next.gif"};}},"slidebar/button-backward":{alias:"button",include:"button",style:function(states){return {icon:"decoration/arrows/left.gif"};}},"tabview":{},"tabview/bar":{alias:"slidebar",style:function(states){var marginTop=0,marginRight=0,marginBottom=0,marginLeft=0;if(states.barTop){marginBottom=-2;}else if(states.barBottom){marginTop=-2;}else if(states.barRight){marginLeft=-2;}else{marginRight=-2;}return {marginBottom:marginBottom,marginTop:marginTop,marginLeft:marginLeft,marginRight:marginRight};}},"tabview/bar/button-forward":{include:"slidebar/button-forward",alias:"slidebar/button-forward",style:function(states){if(states.barTop||states.barBottom){return {marginTop:2,marginBottom:2};}else{return {marginLeft:2,marginRight:2};}}},"tabview/bar/button-backward":{include:"slidebar/button-backward",alias:"slidebar/button-backward",style:function(states){if(states.barTop||states.barBottom){return {marginTop:2,marginBottom:2};}else{return {marginLeft:2,marginRight:2};}}},"tabview/pane":{style:function(states){return {backgroundColor:"background",decorator:"outset",padding:10};}},"tabview-page":{},"tabview-page/button":{alias:"button",style:function(states){var decorator;var marginTop=0,marginRight=0,marginBottom=0,marginLeft=0;if(states.barTop||states.barBottom){var paddingTop=2,paddingBottom=2,paddingLeft=6,paddingRight=6;}else{var paddingTop=6,paddingBottom=6,paddingLeft=6,paddingRight=6;}if(states.barTop){decorator="tabview-page-button-top";}else if(states.barRight){decorator="tabview-page-button-right";}else if(states.barBottom){decorator="tabview-page-button-bottom";}else{decorator="tabview-page-button-left";}if(states.checked){if(states.barTop||states.barBottom){paddingLeft+=2;paddingRight+=2;}else{paddingTop+=2;paddingBottom+=2;}}else{if(states.barTop||states.barBottom){marginBottom+=2;marginTop+=2;}else if(states.barLeft||states.barRight){marginRight+=2;marginLeft+=2;}}if(states.checked){if(!states.firstTab){if(states.barTop||states.barBottom){marginLeft=-4;}else{marginTop=-4;}}if(!states.lastTab){if(states.barTop||states.barBottom){marginRight=-4;}else{marginBottom=-4;}}}return {zIndex:states.checked?10:5,decorator:decorator,backgroundColor:"background",iconPosition:states.barLeft||states.barRight?"top":"left",padding:[paddingTop,paddingRight,paddingBottom,paddingLeft],margin:[marginTop,marginRight,marginBottom,marginLeft]};}},"scrollbar":{},"scrollbar/slider":{alias:"slider",style:function(states){return {backgroundColor:"background-light"};}},"scrollbar/slider/knob":{include:"button",style:function(states){return {height:14,width:14,minHeight:states.horizontal?"undefined":14,minWidth:states.horizontal?14:"undefined"};}},"scrollbar/button":{alias:"button",include:"button",style:function(states){var padding;if(states.up||states.down){if(states.pressed||states.abandoned||states.checked){padding=[5,2,3,4];}else{padding=[4,3];}}else{if(states.pressed||states.abandoned||states.checked){padding=[4,3,2,5];}else{padding=[3,4];}}var icon="decoration/arrows/";if(states.left){icon+="left.gif";}else if(states.right){icon+="right.gif";}else if(states.up){icon+="up.gif";}else{icon+="down.gif";}return {padding:padding,icon:icon};}},"scrollbar/button-begin":"scrollbar/button","scrollbar/button-end":"scrollbar/button","slider":{style:function(states){return {backgroundColor:"background-light",decorator:states.focused?"focused-inset":"inset"};}},"slider/knob":{include:"button",style:function(states){return {width:14,height:14,decorator:"outset"};}},"tree-folder/open":{style:function(states){return {source:states.opened?"decoration/tree/minus.gif":"decoration/tree/plus.gif"};}},"tree-folder":{style:function(states){return {padding:[2,3,2,0],icon:states.opened?"icon/16/places/folder-open.png":"icon/16/places/folder.png"};}},"tree-folder/icon":{style:function(states){return {padding:[0,4,0,0]};}},"tree-folder/label":{style:function(states){return {padding:[1,2],backgroundColor:states.selected?"background-selected":"undefined",textColor:states.selected?"text-selected":"undefined"};}},"tree-file":{include:"tree-folder",alias:"tree-folder",style:function(states){return {icon:"icon/16/mimetypes/text-plain.png"};}},"tree":{include:"list",alias:"list",style:function(states){return {contentPadding:[4,4,4,4]};}},"treevirtual":{style:function(states){return {decorator:"main"};}},"treevirtual-folder":{style:function(states){return {icon:(states.opened?"icon/16/places/folder-open.png":"icon/16/places/folder.png")};}},"treevirtual-file":{include:"treevirtual-folder",alias:"treevirtual-folder",style:function(states){return {icon:"icon/16/mimetypes/text-plain.png"};}},"treevirtual-line":{style:function(states){return {icon:"decoration/treevirtual/line.gif"};}},"treevirtual-contract":{style:function(states){return {icon:"decoration/tree/minus.gif"};}},"treevirtual-expand":{style:function(states){return {icon:"decoration/tree/plus.gif"};}},"treevirtual-only-contract":{style:function(states){return {icon:"decoration/treevirtual/only_minus.gif"};}},"treevirtual-only-expand":{style:function(states){return {icon:"decoration/treevirtual/only_plus.gif"};}},"treevirtual-start-contract":{style:function(states){return {icon:"decoration/treevirtual/start_minus.gif"};}},"treevirtual-start-expand":{style:function(states){return {icon:"decoration/treevirtual/start_plus.gif"};}},"treevirtual-end-contract":{style:function(states){return {icon:"decoration/treevirtual/end_minus.gif"};}},"treevirtual-end-expand":{style:function(states){return {icon:"decoration/treevirtual/end_plus.gif"};}},"treevirtual-cross-contract":{style:function(states){return {icon:"decoration/treevirtual/cross_minus.gif"};}},"treevirtual-cross-expand":{style:function(states){return {icon:"decoration/treevirtual/cross_plus.gif"};}},"treevirtual-end":{style:function(states){return {icon:"decoration/treevirtual/end.gif"};}},"treevirtual-cross":{style:function(states){return {icon:"decoration/treevirtual/cross.gif"};}},"window":{style:function(states){return {contentPadding:[10,10,10,10],backgroundColor:"background",decorator:states.maximized?"undefined":"outset",shadow:"shadow-small"};}},"window/pane":{},"window/captionbar":{style:function(states){return {padding:1,backgroundColor:states.active?"window-active-caption":"window-inactive-caption",textColor:states.active?"window-active-caption-text":"window-inactive-caption-text"};}},"window/icon":{style:function(states){return {marginRight:4};}},"window/title":{style:function(states){return {cursor:"default",font:"bold",marginRight:20,alignY:"middle"};}},"window/minimize-button":{include:"button",alias:"button",style:function(states){return {icon:"decoration/window/minimize.gif",padding:states.pressed||states.abandoned?[2,1,0,3]:[1,2]};}},"window/restore-button":{include:"button",alias:"button",style:function(states){return {icon:"decoration/window/restore.gif",padding:states.pressed||states.abandoned?[2,1,0,3]:[1,2]};}},"window/maximize-button":{include:"button",alias:"button",style:function(states){return {icon:"decoration/window/maximize.gif",padding:states.pressed||states.abandoned?[2,1,0,3]:[1,2]};}},"window/close-button":{include:"button",alias:"button",style:function(states){return {marginLeft:2,icon:"decoration/window/close.gif",padding:states.pressed||states.abandoned?[2,1,0,3]:[1,2]};}},"window/statusbar":{style:function(states){return {decorator:"inset-thin",padding:[2,6]};}},"window/statusbar-text":"label","resizer":{style:function(states){return {decorator:"outset"};}},"splitpane":{},"splitpane/splitter":{style:function(states){return {backgroundColor:"background"};}},"splitpane/splitter/knob":{style:function(states){return {source:states.horizontal?"decoration/splitpane/knob-horizontal.png":"decoration/splitpane/knob-vertical.png",padding:2};}},"splitpane/slider":{style:function(states){return {backgroundColor:"border-dark",opacity:0.3};}},"selectbox":"button","selectbox/atom":"atom","selectbox/popup":"popup","selectbox/list":"list","selectbox/arrow":{style:function(states){return {source:"decoration/arrows/down.gif",paddingRight:4,paddingLeft:5};}},"datechooser":{style:function(states){return {decorator:"outset"};}},"datechooser/navigation-bar":{style:function(states){return {backgroundColor:"date-chooser",padding:[2,10]};}},"datechooser/last-year-button-tooltip":"tooltip","datechooser/last-month-button-tooltip":"tooltip","datechooser/next-year-button-tooltip":"tooltip","datechooser/next-month-button-tooltip":"tooltip","datechooser/last-year-button":"datechooser/button","datechooser/last-month-button":"datechooser/button","datechooser/next-year-button":"datechooser/button","datechooser/next-month-button":"datechooser/button","datechooser/button/icon":{},"datechooser/button":{style:function(states){var result={width:17,show:"icon"};if(states.lastYear){result.icon="decoration/arrows/rewind.gif";}else if(states.lastMonth){result.icon="decoration/arrows/left.gif";}else if(states.nextYear){result.icon="decoration/arrows/forward.gif";}else if(states.nextMonth){result.icon="decoration/arrows/right.gif";}if(states.pressed||states.checked||states.abandoned){result.decorator="inset-thin";}else if(states.hovered){result.decorator="outset-thin";}else{result.decorator="undefined";}if(states.pressed||states.checked||states.abandoned){result.padding=[2,0,0,2];}else if(states.hovered){result.padding=1;}else{result.padding=2;}return result;}},"datechooser/month-year-label":{style:function(states){return {font:"bold",textAlign:"center"};}},"datechooser/date-pane":{style:function(states){return {decorator:"datechooser-date-pane",backgroundColor:"date-chooser"};}},"datechooser-weekday":{style:function(states){return {decorator:"datechooser-weekday",font:"bold",textAlign:"center",textColor:states.weekend?"date-chooser-title":"date-chooser",backgroundColor:states.weekend?"date-chooser":"date-chooser-title"};}},"datechooser-day":{style:function(states){return {textAlign:"center",decorator:states.today?"main":"undefined",textColor:states.selected?"text-selected":states.otherMonth?"text-disabled":"undefined",backgroundColor:states.selected?"date-chooser-selected":"undefined",padding:[2,4]};}},"datechooser-week":{style:function(states){return {textAlign:"center",textColor:"date-chooser-title",padding:[2,4],decorator:states.header?"datechooser-week-header":"datechooser-week"};}},"combobox":{style:function(states){return {decorator:states.focused?"focused-inset":"inset",textColor:states.disabled?"text-disabled":"undefined",backgroundColor:"background-field"};}},"combobox/button":{alias:"button",include:"button",style:function(states){return {icon:"decoration/arrows/down.gif",backgroundColor:states.hovered?"button-hovered":"button"};}},"combobox/popup":"popup","combobox/list":"list","combobox/textfield":{include:"textfield",style:function(states){return {decorator:"undefined",padding:[2,3]};}},"menu":{style:function(states){var result={backgroundColor:"background",shadow:"shadow-small",decorator:"outset",spacingX:6,spacingY:1,iconColumnWidth:16,arrowColumnWidth:4,padding:1};if(states.submenu){result.position="right-top";result.offset=[-2,-3];}if(states.contextmenu){result.offset=4;}return result;}},"menu-separator":{style:function(states){return {height:0,decorator:"menu-separator",marginTop:4,marginBottom:4,marginLeft:2,marginRight:2};}},"menu-button":{alias:"atom",style:function(states){return {backgroundColor:states.selected?"background-selected":"undefined",textColor:states.selected?"text-selected":"undefined",padding:[2,6]};}},"menu-button/icon":{include:"image",style:function(states){return {alignY:"middle"};}},"menu-button/label":{include:"label",style:function(states){return {alignY:"middle",padding:1};}},"menu-button/shortcut":{include:"label",style:function(states){return {alignY:"middle",marginLeft:14,padding:1};}},"menu-button/arrow":{style:function(states){return {source:states.selected?"decoration/arrows/right-invert.gif":"decoration/arrows/right.gif",alignY:"middle"};}},"menu-checkbox":{alias:"menu-button",include:"menu-button",style:function(states){return {icon:!states.checked?"undefined":states.selected?"decoration/menu/checkbox-invert.gif":"decoration/menu/checkbox.gif"};}},"menu-radiobutton":{alias:"menu-button",include:"menu-button",style:function(states){return {icon:!states.checked?"undefined":states.selected?"decoration/menu/radiobutton-invert.gif":"decoration/menu/radiobutton.gif"};}},"menubar":{style:function(states){return {backgroundColor:"background",decorator:"outset"};}},"menubar-button":{alias:"atom",style:function(states){return {padding:[2,6],backgroundColor:states.pressed||states.hovered?"background-selected":"undefined",textColor:states.pressed||states.hovered?"text-selected":"undefined"};}},"colorselector":"widget","colorselector/control-bar":"widget","colorselector/visual-pane":"groupbox","colorselector/control-pane":"widget","colorselector/preset-grid":"widget","colorselector-colorbucket":{style:function(states){return {decorator:"inset-thin",width:16,height:16};}},"colorselector/preset-field-set":"groupbox","colorselector/input-field-set":"groupbox","colorselector/preview-field-set":"groupbox","colorselector/hex-field-composite":"widget","colorselector/hex-field":"textfield","colorselector/rgb-spinner-composite":"widget","colorselector/rgb-spinner-red":"spinner","colorselector/rgb-spinner-green":"spinner","colorselector/rgb-spinner-blue":"spinner","colorselector/hsb-spinner-composite":"widget","colorselector/hsb-spinner-hue":"spinner","colorselector/hsb-spinner-saturation":"spinner","colorselector/hsb-spinner-brightness":"spinner","colorselector/preview-content-old":{style:function(states){return {decorator:"inset-thin",width:50,height:10};}},"colorselector/preview-content-new":{style:function(states){return {decorator:"inset-thin",backgroundColor:"white",width:50,height:10};}},"colorselector/hue-saturation-field":{style:function(states){return {decorator:"inset-thin",margin:5};}},"colorselector/brightness-field":{style:function(states){return {decorator:"inset-thin",margin:[5,7]};}},"colorselector/hue-saturation-pane":"widget","colorselector/hue-saturation-handle":"widget","colorselector/brightness-pane":"widget","colorselector/brightness-handle":"widget","table":"widget","table/statusbar":{style:function(states){return {decorator:"table-statusbar",paddingLeft:2,paddingRight:2};}},"table/column-button":{alias:"button",style:function(states){var border,padding;if(states.pressed||states.checked||states.abandoned){border="inset-thin";padding=[3,2,1,4];}else if(states.hovered){border="outset-thin";padding=[2,3];}else{border="undefined";padding=[3,4];}return {decorator:border,padding:padding,backgroundColor:states.abandoned?"button-abandoned":"button",icon:"decoration/table/select-column-order.png"};}},"table-column-reset-button":{extend:"menu-button",alias:"menu-button",style:function(){return {icon:"icon/16/actions/view-refresh.png"};}},"table-scroller/scrollbar-x":"scrollbar","table-scroller/scrollbar-y":"scrollbar","table-scroller":"widget","table-scroller/header":{style:function(states){return {decorator:"table-scroller-header",backgroundColor:"table-header"};}},"table-scroller/pane":{style:function(states){return {backgroundColor:"table-pane"};}},"table-scroller/focus-indicator":{style:function(states){return {decorator:"table-scroller-focus-indicator"};}},"table-scroller/resize-line":{style:function(states){return {backgroundColor:"#D6D5D9",width:3};}},"table-header-cell":{alias:"atom",style:function(states){return {paddingLeft:2,paddingRight:2,paddingBottom:states.hovered?0:2,decorator:states.hovered?"table-header-cell-hovered":"table-header-cell",backgroundColor:states.hovered?"table-header-cell-hover":"table-header-cell",sortIcon:states.sorted?(states.sortedAscending?"decoration/table/ascending.png":"decoration/table/descending.png"):"undefined"};}},"table-header-cell/sort-icon":{style:function(states){return {alignY:"middle"};}},"table-editor-textfield":{include:"textfield",style:function(states){return {decorator:"undefined",padding:[2,2]};}},"table-editor-selectbox":{include:"selectbox",alias:"selectbox",style:function(states){return {padding:[0,2]};}},"table-editor-combobox":{include:"combobox",alias:"combobox",style:function(states){return {decorator:"undefined"};}},"colorpopup":{alias:"popup",include:"popup",style:function(states){return {decorator:"outset",padding:5,backgroundColor:"background"};}},"colorpopup/field":{style:function(states){return {decorator:"inset-thin",margin:2,width:14,height:14,backgroundColor:"background"};}},"colorpopup/selector-button":"button","colorpopup/auto-button":"button","colorpopup/preview-pane":"groupbox","colorpopup/current-preview":{style:function(state){return {height:20,padding:4,marginLeft:4,decorator:"inset-thin",allowGrowX:true};}},"colorpopup/selected-preview":{style:function(state){return {height:20,padding:4,marginRight:4,decorator:"inset-thin",allowGrowX:true};}}}});qx.Theme.define("qx.theme.icon.Oxygen",{title:"Oxygen",resource:"qx/icon/Oxygen",icons:{}});qx.Theme.define("qx.theme.Classic",{title:"Classic Windows",meta:{color:qx.theme.classic.Color,decoration:qx.theme.classic.Decoration,font:qx.theme.classic.Font,appearance:qx.theme.classic.Appearance,icon:qx.theme.icon.Oxygen}});qx.Class.define("qx.util.ValueManager",{type:"abstract",extend:qx.core.Object,construct:function(){this.base(arguments);this._dynamic={};},members:{resolveDynamic:function(value){return this._dynamic[value];},isDynamic:function(value){return !!this._dynamic[value];},resolve:function(value){if(value&&this._dynamic[value]){return this._dynamic[value];}return value;}},destruct:function(){this._disposeFields("_dynamic");}});qx.Class.define("qx.theme.manager.Color",{type:"singleton",extend:qx.util.ValueManager,properties:{theme:{check:"Theme",nullable:true,apply:"_applyTheme",event:"changeTheme"}},members:{_applyTheme:function(value){var dest=this._dynamic={};if(value){var source=value.colors;var util=qx.util.ColorUtil;var temp;for(var key in source){temp=source[key];if(typeof temp==="string"){if(!util.isCssString(temp)){throw new Error("Could not parse color: "+temp);}}else if(temp instanceof Array){temp=util.rgbToRgbString(temp);}else{throw new Error("Could not parse color: "+temp);}dest[key]=temp;}}}}});qx.Class.define("qx.ui.decoration.Util",{statics:{insetsModified:function(a,b){if(a==b){return false;}if(a==null||b==null){return true;}var manager=qx.theme.manager.Decoration.getInstance();var first=manager.resolve(a).getInsets();var second=manager.resolve(b).getInsets();if(first.top!=second.top||first.right!=second.right||first.bottom!=second.bottom||first.left!=second.left){return true;}return false;},generateBackgroundMarkup:function(image,repeat,styles){if(image){var resolved=qx.util.AliasManager.getInstance().resolve(image);if(repeat=="scale"){var uri=qx.util.ResourceManager.toUri(resolved);return '<img src="'+uri+'" style="vertical-align:top;'+styles+'"/>';}else{var back=qx.bom.element.Background.compile(resolved,repeat,0,0);return '<div style="'+back+styles+'"></div>';}}else{if(styles){return '<div style="'+styles+'"></div>';}else{return "";}}}}});qx.Class.define("qx.theme.manager.Decoration",{type:"singleton",extend:qx.core.Object,properties:{theme:{check:"Theme",nullable:true,apply:"_applyTheme"}},members:{resolve:function(value){if(!value){return null;}if(typeof value==="object"){return value;}var theme=this.getTheme();if(!theme){return null;}var theme=this.getTheme();if(!theme){return null;}var cache=this.__dynamic;if(!cache){cache=this.__dynamic={};}var resolved=cache[value];if(resolved){return resolved;}var entry=theme.decorations[value];if(!entry){return null;}var clazz=entry.decorator;if(clazz==null){throw new Error("Missing definition of which decorator to use in entry: "+value+"!");}return cache[value]=(new clazz).set(entry.style);},isValidPropertyValue:function(value){if(typeof value==="string"){return this.isDynamic(value);}else if(typeof value==="object"){var clazz=value.constructor;return qx.Class.hasInterface(clazz,qx.ui.decoration.IDecorator);}return false;},isDynamic:function(value){if(!value){return false;}var theme=this.getTheme();if(!theme){return false;}return !!theme.decorations[value];},_applyTheme:function(value){var alias=qx.util.AliasManager.getInstance();value?alias.add("decoration",value.resource):alias.remove("decoration");}},destruct:function(){this._disposeMap("__dynamic");}});qx.Class.define("qx.util.AliasManager",{type:"singleton",extend:qx.util.ValueManager,construct:function(){this.base(arguments);this._aliases={};this.add("static","qx/static");},members:{_preprocess:function(value){var dynamics=this._dynamic;if(dynamics[value]===false){return value;}else if(dynamics[value]===undefined){if(value.charAt(0)==="/"||value.charAt(0)==="."||value.indexOf("http://")===0||value.indexOf("https://")==="0"||value.indexOf("file://")===0){dynamics[value]=false;return value;}var alias=value.substring(0,value.indexOf("/"));var resolved=this._aliases[alias];if(resolved!==undefined){dynamics[value]=resolved+value.substring(alias.length);}}return value;},add:function(alias,base){this._aliases[alias]=base;var dynamics=this._dynamic;var paths={};for(var path in dynamics){if(path.substring(0,path.indexOf("/"))===alias){dynamics[path]=base+path.substring(alias.length);paths[path]=true;}}},remove:function(alias){delete this._aliases[alias];},resolve:function(path){if(path!==null){path=this._preprocess(path);}return this._dynamic[path]||path;}},destruct:function(){this._disposeFields("_aliases");}});qx.Class.define("qx.bom.element.Background",{statics:{__tmpl:["background-image:url(",null,");","background-position:",null,";","background-repeat:",null,";"],__emptyStyles:{backgroundImage:null,backgroundPosition:null,backgroundRepeat:null},compile:function(source,repeat,left,top){var Engine=qx.bom.client.Engine;if(Engine.GECKO&&Engine.VERSION<1.9&&left==top&&left!=null){top+=0.01;}if(left!=null||top!=null){var position=(left==null?"0px":left+"px")+" "+(top==null?"0px":top+"px");}else{var position="0 0";}var backgroundImageUrl=qx.util.ResourceManager.toUri(source);if(qx.core.Variant.isSet("qx.client","mshtml")){backgroundImageUrl=this.__checkImageUrl(backgroundImageUrl);}var tmpl=this.__tmpl;tmpl[1]=backgroundImageUrl;tmpl[4]=position;tmpl[7]=repeat;return tmpl.join("");},getStyles:function(source,repeat,left,top){if(!source){return this.__emptyStyles;}var Engine=qx.bom.client.Engine;if(Engine.GECKO&&Engine.VERSION<1.9&&left==top&&left!=null){top+=0.01;}if(left!=null||top!=null){var position=(left==null?"0px":left+"px")+" "+(top==null?"0px":top+"px");}var backgroundImageUrl=qx.util.ResourceManager.toUri(source);if(qx.core.Variant.isSet("qx.client","mshtml")){backgroundImageUrl=this.__checkImageUrl(backgroundImageUrl);}var map={backgroundImage:"url("+backgroundImageUrl+")"};if(position!=null){map.backgroundPosition=position;}if(repeat!=null){map.backgroundRepeat=repeat;}return map;},set:function(element,source,repeat,left,top){var styles=this.getStyles(source,repeat,left,top);for(var prop in styles){element.style[prop]=styles[prop];}},__checkImageUrl:qx.core.Variant.select("qx.client",{"mshtml":function(url){var urlPrefix="";if(window.location.protocol==="https:"){if(url.match(/^\/\//)!=null){urlPrefix=window.location.protocol;}else if(url.match(/^\.\//)!=null){url=url.substring(url.indexOf("/"));urlPrefix=document.URL.substring(0,document.URL.lastIndexOf("/"));}else{urlPrefix=window.location.href.substring(0,window.location.href.lastIndexOf("/")+1);}}return urlPrefix+url;},"default":function(){}})}});qx.Bootstrap.define("qx.bom.client.Feature",{statics:{STANDARD_MODE:false,QUIRKS_MODE:false,CONTENT_BOX:false,BORDER_BOX:false,SVG:false,CANVAS:false,VML:false,XPATH:false,__init:function(){this.STANDARD_MODE=document.compatMode==="CSS1Compat";this.QUIRKS_MODE=!this.STANDARD_MODE;this.CONTENT_BOX=!qx.bom.client.Engine.MSHTML||this.STANDARD_MODE;this.BORDER_BOX=!this.CONTENT_BOX;this.SVG=document.implementation&&document.implementation.hasFeature&&document.implementation.hasFeature("org.w3c.dom.svg","1.0");this.CANVAS=!!window.CanvasRenderingContext2D;this.VML=qx.bom.client.Engine.MSHTML;this.AIR=navigator.userAgent.indexOf("adobeair")!==-1;this.GEARS=!!(window.google&&window.google.gears);this.XPATH=!!document.evaluate;}},defer:function(statics){statics.__init();}});qx.Class.define("qx.bom.element.Decoration",{statics:{DEBUG:false,__enableAlphaFix:qx.core.Variant.isSet("qx.client","mshtml")&&qx.bom.client.Engine.VERSION<8,__alphaFixRepeats:qx.core.Variant.select("qx.client",{"mshtml":{"scale-x":true,"scale-y":true,"scale":true,"no-repeat":true},"default":null}),__repeatToTagname:{"scale-x":"img","scale-y":"img","scale":"img","repeat":"div","no-repeat":"div","repeat-x":"div","repeat-y":"div"},update:function(element,source,repeat,style){var tag=this.getTagName(repeat);if(tag!=element.tagName.toLowerCase()){throw new Error("Image modification not possible because elements could not be replaced at runtime anymore!");}var ret=this.getAttributes(source,repeat,style);if(tag==="img"){element.src=ret.src;}if(element.style.backgroundPosition!=""&&ret.style.backgroundPosition===undefined){ret.style.backgroundPosition=null;}if(element.style.clip!=""&&ret.style.clip===undefined){ret.style.clip=null;}var Style=qx.bom.element.Style;Style.setStyles(element,ret.style);},create:function(source,repeat,style){var tag=this.getTagName(repeat);var ret=this.getAttributes(source,repeat,style);var css=qx.bom.element.Style.compile(ret.style);if(tag==="img"){return '<img src="'+ret.src+'" style="'+css+'"/>';}else{return '<div style="'+css+'"></div>';}},getTagName:function(repeat){if(qx.core.Variant.isSet("qx.client","mshtml")){if(this.__enableAlphaFix&&this.__alphaFixRepeats[repeat]){return "div";}}return this.__repeatToTagname[repeat];},getAttributes:function(source,repeat,style){var ResourceManager=qx.util.ResourceManager;var ImageLoader=qx.io2.ImageLoader;var Background=qx.bom.element.Background;if(!style){style={};}if(!style.position){style.position="absolute";}if(qx.core.Variant.isSet("qx.client","mshtml")){style.fontSize=0;style.lineHeight=0;}else if(qx.core.Variant.isSet("qx.client","webkit")){style.WebkitUserDrag="none";}var width=ResourceManager.getImageWidth(source)||ImageLoader.getWidth(source);var height=ResourceManager.getImageHeight(source)||ImageLoader.getHeight(source);var format=ResourceManager.getImageFormat(source);if(this.__enableAlphaFix&&this.__alphaFixRepeats[repeat]&&format==="png"){if(style.width==null){style.width=width==null?width:width+"px";}if(style.height==null){style.height=height==null?height:height+"px";}style.filter="progid:DXImageTransform.Microsoft.AlphaImageLoader(src='"+ResourceManager.toUri(source)+"', sizingMethod='scale')";style.backgroundImage=style.backgroundRepeat="";return {style:style};}else{var clipped=ResourceManager.isClippedImage(source);if(repeat==="scale"){var uri=ResourceManager.toUri(source);if(!style.width){style.width=width==null?width:width+"px";}if(!style.height){style.height=height==null?height:height+"px";}return {src:uri,style:style};}else if(repeat==="scale-x"||repeat==="scale-y"){if(clipped){if(repeat==="scale-x"){var data=ResourceManager.getData(source);var imageHeight=ResourceManager.getImageHeight(data[4]);var uri=ResourceManager.toUri(data[4]);style.clip={top:-data[6],height:height};style.height=imageHeight+"px";if(style.top!=null){style.top=(parseInt(style.top)+data[6])+"px";}else if(style.bottom!=null){style.bottom=(parseInt(style.bottom)+height-imageHeight-data[6])+"px";}return {src:uri,style:style};}else{var data=ResourceManager.getData(source);var imageWidth=ResourceManager.getImageWidth(data[4]);var uri=ResourceManager.toUri(data[4]);style.clip={left:-data[5],width:width};style.width=imageWidth+"px";if(style.left!=null){style.left=(parseInt(style.left)+data[5])+"px";}else if(style.right!=null){style.right=(parseInt(style.right)+width-imageWidth-data[5])+"px";}return {src:uri,style:style};}}else{{};if(repeat=="scale-x"){style.height=height==null?null:height+"px";}else if(repeat=="scale-y"){style.width=width==null?null:width+"px";}var uri=ResourceManager.toUri(source);return {src:uri,style:style};}}else{if(clipped&&repeat!=="repeat"){var data=ResourceManager.getData(source);var bg=Background.getStyles(data[4],repeat,data[5],data[6]);for(var key in bg){style[key]=bg[key];}if(repeat=="repeat-y"||repeat==="no-repeat"){style.width=width==null?width:width+"px";}if(repeat=="repeat-x"||repeat==="no-repeat"){style.height=height==null?height:height+"px";}return {style:style};}else{{};var bg=Background.getStyles(source,repeat);for(var key in bg){style[key]=bg[key];}style.width=width==null?width:width+"px";style.height=height==null?height:height+"px";return {style:style};}}}}}});qx.Class.define("qx.bom.element.Style",{statics:{__hints:{styleNames:{"float":qx.core.Variant.select("qx.client",{"mshtml":"styleFloat","default":"cssFloat"}),"appearance":qx.core.Variant.select("qx.client",{"gecko":"MozAppearance","webkit":"WebkitAppearance","default":"appearance"}),"userSelect":qx.core.Variant.select("qx.client",{"gecko":"MozUserSelect","webkit":"WebkitUserSelect","default":"userSelect"})},cssNames:{"appearance":qx.core.Variant.select("qx.client",{"gecko":"-moz-appearance","webkit":"-webkit-appearance","default":"appearance"}),"userSelect":qx.core.Variant.select("qx.client",{"gecko":"-moz-user-select","webkit":"-webkit-user-select","default":"user-select"}),"textOverflow":qx.core.Variant.select("qx.client",{"opera":"-o-text-overflow","default":"text-overflow"})},mshtmlPixel:{width:"pixelWidth",height:"pixelHeight",left:"pixelLeft",right:"pixelRight",top:"pixelTop",bottom:"pixelBottom"},special:{clip:1,cursor:1,opacity:1,boxSizing:1,overflowX:1,overflowY:1}},__hyphens:{},compile:function(map){var html=[];var hints=this.__hints;var special=hints.special;var names=hints.cssNames;var hyphens=this.__hyphens;var str=qx.lang.String;var name,prop,value;for(name in map){value=map[name];if(value==null){continue;}name=names[name]||name;if(special[name]){switch(name){case "clip":html.push(qx.bom.element.Clip.compile(value));break;case "cursor":html.push(qx.bom.element.Cursor.compile(value));break;case "opacity":html.push(qx.bom.element.Opacity.compile(value));break;case "boxSizing":html.push(qx.bom.element.BoxSizing.compile(value));break;case "overflowX":html.push(qx.bom.element.Overflow.compileX(value));break;case "overflowY":html.push(qx.bom.element.Overflow.compileY(value));break;}}else{prop=hyphens[name];if(!prop){prop=hyphens[name]=str.hyphenate(name);}html.push(prop,":",value,";");}}return html.join("");},setCss:qx.core.Variant.select("qx.client",{"mshtml":function(element,value){element.style.cssText=value;},"default":function(element,value){element.setAttribute("style",value);}}),getCss:qx.core.Variant.select("qx.client",{"mshtml":function(element){return element.style.cssText.toLowerCase();},"default":function(element){return element.getAttribute("style");}}),COMPUTED_MODE:1,CASCADED_MODE:2,LOCAL_MODE:3,set:function(element,name,value,smart){{};var hints=this.__hints;name=hints.styleNames[name]||name;if(smart!==false&&hints.special[name]){switch(name){case "clip":return qx.bom.element.Clip.set(element,value);case "cursor":return qx.bom.element.Cursor.set(element,value);case "opacity":return qx.bom.element.Opacity.set(element,value);case "boxSizing":return qx.bom.element.BoxSizing.set(element,value);case "overflowX":return qx.bom.element.Overflow.setX(element,value);case "overflowY":return qx.bom.element.Overflow.setY(element,value);}}element.style[name]=value!==null?value:"";},setStyles:function(element,styles,smart){{};for(var name in styles){this.set(element,name,styles[name],smart);}},reset:function(element,name,smart){var hints=this.__hints;name=hints.styleNames[name]||name;if(smart!==false&&hints.special[name]){switch(name){case "clip":return qx.bom.element.Clip.reset(element);case "cursor":return qx.bom.element.Cursor.reset(element);case "opacity":return qx.bom.element.Opacity.reset(element);case "boxSizing":return qx.bom.element.BoxSizing.reset(element);case "overflowX":return qx.bom.element.Overflow.resetX(element);case "overflowY":return qx.bom.element.Overflow.resetY(element);}}element.style[name]="";},get:qx.core.Variant.select("qx.client",{"mshtml":function(element,name,mode,smart){var hints=this.__hints;name=hints.styleNames[name]||name;if(smart!==false&&hints.special[name]){switch(name){case "clip":return qx.bom.element.Clip.get(element,mode);case "cursor":return qx.bom.element.Cursor.get(element,mode);case "opacity":return qx.bom.element.Opacity.get(element,mode);case "boxSizing":return qx.bom.element.BoxSizing.get(element,mode);case "overflowX":return qx.bom.element.Overflow.getX(element,mode);case "overflowY":return qx.bom.element.Overflow.getY(element,mode);}}if(!element.currentStyle){return element.style[name]||"";}switch(mode){case this.LOCAL_MODE:return element.style[name]||"";case this.CASCADED_MODE:return element.currentStyle[name]||"";default:var currentStyle=element.currentStyle[name]||"";if(/^-?[\.\d]+(px)?$/i.test(currentStyle)){return currentStyle;}var pixel=hints.mshtmlPixel[name];if(pixel){var localStyle=element.style[name];element.style[name]=currentStyle||0;var value=element.style[pixel]+"px";element.style[name]=localStyle;return value;}if(/^-?[\.\d]+(em|pt|%)?$/i.test(currentStyle)){throw new Error("Untranslated computed property value: "+name+". Only pixel values work well across different clients.");}return currentStyle;}},"default":function(element,name,mode,smart){var hints=this.__hints;name=hints.styleNames[name]||name;if(smart!==false&&hints.special[name]){switch(name){case "clip":return qx.bom.element.Clip.get(element,mode);case "cursor":return qx.bom.element.Cursor.get(element,mode);case "opacity":return qx.bom.element.Opacity.get(element,mode);case "boxSizing":return qx.bom.element.BoxSizing.get(element,mode);case "overflowX":return qx.bom.element.Overflow.getX(element,mode);case "overflowY":return qx.bom.element.Overflow.getY(element,mode);}}switch(mode){case this.LOCAL_MODE:return element.style[name]||"";case this.CASCADED_MODE:if(element.currentStyle){return element.currentStyle[name]||"";}throw new Error("Cascaded styles are not supported in this browser!");default:var doc=qx.dom.Node.getDocument(element);var computed=doc.defaultView.getComputedStyle(element,null);return computed?computed[name]:"";}}})}});qx.Class.define("qx.bom.element.Clip",{statics:{compile:function(map){if(!map){return "clip:auto;";}var left=map.left;var top=map.top;var width=map.width;var height=map.height;var right,bottom;if(left==null){right=(width==null?"auto":width+"px");left="auto";}else{right=(width==null?"auto":left+width+"px");left=left+"px";}if(top==null){bottom=(height==null?"auto":height+"px");top="auto";}else{bottom=(height==null?"auto":top+height+"px");top=top+"px";}return "clip:rect("+top+","+right+","+bottom+","+left+");";},get:function(element,mode){var clip=qx.bom.element.Style.get(element,"clip",mode,false);var left,top,width,height;var right,bottom;if(typeof clip==="string"&&clip!=="auto"&&clip!==""){clip=qx.lang.String.trim(clip);if(/\((.*)\)/.test(clip)){var split=RegExp.$1.split(",");top=qx.lang.String.trim(split[0]);right=qx.lang.String.trim(split[1]);bottom=qx.lang.String.trim(split[2]);left=qx.lang.String.trim(split[3]);if(left==="auto"){left=null;}if(top==="auto"){top=null;}if(right==="auto"){right=null;}if(bottom==="auto"){bottom=null;}if(top!=null){top=parseInt(top,10);}if(right!=null){right=parseInt(right,10);}if(bottom!=null){bottom=parseInt(bottom,10);}if(left!=null){left=parseInt(left,10);}if(right!=null&&left!=null){width=right-left;}else if(right!=null){width=right;}if(bottom!=null&&top!=null){height=bottom-top;}else if(bottom!=null){height=bottom;}}else{throw new Error("Could not parse clip string: "+clip);}}return {left:left||null,top:top||null,width:width||null,height:height||null};},set:function(element,map){if(!map){element.style.clip="rect(auto,auto,auto,auto)";return;}var left=map.left;var top=map.top;var width=map.width;var height=map.height;var right,bottom;if(left==null){right=(width==null?"auto":width+"px");left="auto";}else{right=(width==null?"auto":left+width+"px");left=left+"px";}if(top==null){bottom=(height==null?"auto":height+"px");top="auto";}else{bottom=(height==null?"auto":top+height+"px");top=top+"px";}element.style.clip="rect("+top+","+right+","+bottom+","+left+")";},reset:function(element){element.style.clip="";}}});qx.Class.define("qx.bom.element.Cursor",{statics:{__map:qx.core.Variant.select("qx.client",{"mshtml":{"cursor":"hand","ew-resize":"e-resize","ns-resize":"n-resize","nesw-resize":"ne-resize","nwse-resize":"nw-resize"},"opera":{"col-resize":"e-resize","row-resize":"n-resize","ew-resize":"e-resize","ns-resize":"n-resize","nesw-resize":"ne-resize","nwse-resize":"nw-resize"},"default":{}}),compile:function(cursor){return "cursor:"+(this.__map[cursor]||cursor)+";";},get:function(element,mode){return qx.bom.element.Style.get(element,"cursor",mode,false);},set:function(element,value){element.style.cursor=this.__map[value]||value;},reset:function(element){element.style.cursor="";}}});qx.Class.define("qx.bom.element.Opacity",{statics:{compile:qx.core.Variant.select("qx.client",{"mshtml":function(opacity){if(opacity>=1){return "";}if(opacity<0.00001){opacity=0;}return "zoom:1;filter:alpha(opacity="+(opacity*100)+");";},"gecko":function(opacity){if(opacity==1){opacity=0.999999;}if(qx.bom.client.Engine.VERSION<1.7){return "-moz-opacity:"+opacity+";";}else{return "opacity:"+opacity+";";}},"default":function(opacity){if(opacity==1){return "";}return "opacity:"+opacity+";";}}),set:qx.core.Variant.select("qx.client",{"mshtml":function(element,opacity){var filter=qx.bom.element.Style.get(element,"filter",qx.bom.element.Style.COMPUTED_MODE,false);if(opacity>=1){element.style.filter=filter.replace(/alpha\([^\)]*\)/gi,"");return;}if(opacity<0.00001){opacity=0;}if(!element.currentStyle.hasLayout){element.style.zoom=1;}element.style.filter=filter.replace(/alpha\([^\)]*\)/gi,"")+"alpha(opacity="+opacity*100+")";},"gecko":function(element,opacity){if(opacity==1){opacity=0.999999;}if(qx.bom.client.Engine.VERSION<1.7){element.style.MozOpacity=opacity;}else{element.style.opacity=opacity;}},"default":function(element,opacity){if(opacity==1){opacity="";}element.style.opacity=opacity;}}),reset:qx.core.Variant.select("qx.client",{"mshtml":function(element){var filter=qx.bom.element.Style.get(element,"filter",qx.bom.element.Style.COMPUTED_MODE,false);element.style.filter=filter.replace(/alpha\([^\)]*\)/gi,"");},"gecko":function(element){if(qx.bom.client.Engine.VERSION<1.7){element.style.MozOpacity="";}else{element.style.opacity="";}},"default":function(element){element.style.opacity="";}}),get:qx.core.Variant.select("qx.client",{"mshtml":function(element,mode){var filter=qx.bom.element.Style.get(element,"filter",mode,false);if(filter){var opacity=filter.match(/alpha\(opacity=(.*)\)/);if(opacity&&opacity[1]){return parseFloat(opacity[1])/100;}}return 1.0;},"gecko":function(element,mode){var opacity=qx.bom.element.Style.get(element,qx.bom.client.Engine.VERSION<1.7?"MozOpacity":"opacity",mode,false);if(opacity==0.999999){opacity=1.0;}if(opacity!=null){return parseFloat(opacity);}return 1.0;},"default":function(element,mode){var opacity=qx.bom.element.Style.get(element,"opacity",mode,false);if(opacity!=null){return parseFloat(opacity);}return 1.0;}})}});qx.Class.define("qx.bom.element.BoxSizing",{statics:{__styleProperties:qx.core.Variant.select("qx.client",{"mshtml":null,"webkit":["boxSizing","KhtmlBoxSizing","WebkitBoxSizing"],"gecko":["MozBoxSizing"],"opera":["boxSizing"]}),__cssProperties:qx.core.Variant.select("qx.client",{"mshtml":null,"webkit":["box-sizing","-khtml-box-sizing","-webkit-box-sizing"],"gecko":["-moz-box-sizing"],"opera":["box-sizing"]}),__nativeBorderBox:{tags:{button:true,select:true},types:{search:true,button:true,submit:true,reset:true,checkbox:true,radio:true}},__usesNativeBorderBox:function(element){var map=this.__nativeBorderBox;return map.tags[element.tagName.toLowerCase()]||map.types[element.type];},compile:qx.core.Variant.select("qx.client",{"mshtml":function(value){{};},"default":function(value){var props=this.__cssProperties;var css="";if(props){for(var i=0,l=props.length;i<l;i++){css+=props[i]+":"+value+";";}}return css;}}),get:qx.core.Variant.select("qx.client",{"mshtml":function(element){if(qx.bom.Document.isStandardMode(qx.dom.Node.getDocument(element))){if(!this.__usesNativeBorderBox(element)){return "content-box";}}return "border-box";},"default":function(element){var props=this.__styleProperties;var value;if(props){for(var i=0,l=props.length;i<l;i++){value=qx.bom.element.Style.get(element,props[i],null,false);if(value!=null&&value!==""){return value;}}}return "";}}),set:qx.core.Variant.select("qx.client",{"mshtml":function(element,value){{};},"default":function(element,value){var props=this.__styleProperties;if(props){for(var i=0,l=props.length;i<l;i++){element.style[props[i]]=value;}}}}),reset:function(element){this.set(element,"");}}});qx.Class.define("qx.bom.Document",{statics:{isQuirksMode:function(win){return (win||window).document.compatMode!=="CSS1Compat";},isStandardMode:function(win){return (win||window).document.compatMode==="CSS1Compat";},getWidth:function(win){var doc=(win||window).document;var view=qx.bom.Viewport.getWidth(win);var scroll=doc.compatMode==="CSS1Compat"?doc.documentElement.scrollWidth:doc.body.scrollWidth;return Math.max(scroll,view);},getHeight:function(win){var doc=(win||window).document;var view=qx.bom.Viewport.getHeight(win);var scroll=doc.compatMode==="CSS1Compat"?doc.documentElement.scrollHeight:doc.body.scrollHeight;return Math.max(scroll,view);}}});qx.Class.define("qx.bom.element.Overflow",{statics:{__scrollbarSize:null,getScrollbarWidth:function(){if(this.__scrollbarSize!==null){return this.__scrollbarSize;}var Style=qx.bom.element.Style;var getStyleSize=function(el,propertyName){return parseInt(Style.get(el,propertyName))||0;};var getBorderRight=function(el){return (Style.get(el,"borderRightStyle")=="none"?0:getStyleSize(el,"borderRightWidth"));};var getBorderLeft=function(el){return (Style.get(el,"borderLeftStyle")=="none"?0:getStyleSize(el,"borderLeftWidth"));};var getInsetRight=qx.core.Variant.select("qx.client",{"mshtml":function(el){if(Style.get(el,"overflowY")=="hidden"||el.clientWidth==0){return getBorderRight(el);}return Math.max(0,el.offsetWidth-el.clientLeft-el.clientWidth);},"default":function(el){if(el.clientWidth==0){var ov=Style.get(el,"overflow");var sbv=(ov=="scroll"||ov=="-moz-scrollbars-vertical"?16:0);return Math.max(0,getBorderRight(el)+sbv);}return Math.max(0,(el.offsetWidth-el.clientWidth-getBorderLeft(el)));}});var getScrollBarSizeRight=function(el){return getInsetRight(el)-getBorderRight(el);};var t=document.createElement("div");var s=t.style;s.height=s.width="100px";s.overflow="scroll";document.body.appendChild(t);var c=getScrollBarSizeRight(t);this.__scrollbarSize=c?c:16;document.body.removeChild(t);return this.__scrollbarSize;},_compile:qx.core.Variant.select("qx.client",{"gecko":qx.bom.client.Engine.VERSION<1.8?function(prop,value){if(value=="hidden"){value="-moz-scrollbars-none";}return "overflow:"+value+";";}:function(prop,value){return prop+":"+value+";";},"opera":qx.bom.client.Engine.VERSION<9.5?function(prop,value){return "overflow:"+value+";";}:function(prop,value){return prop+":"+value+";";},"default":function(prop,value){return prop+":"+value+";";}}),compileX:function(value){return this._compile("overflow-x",value);},compileY:function(value){return this._compile("overflow-y",value);},getX:qx.core.Variant.select("qx.client",{"gecko":qx.bom.client.Engine.VERSION<1.8?function(element,mode){var overflow=qx.bom.element.Style.get(element,"overflow",mode,false);if(overflow==="-moz-scrollbars-none"){overflow="hidden";}return overflow;}:function(element,mode){return qx.bom.element.Style.get(element,"overflowX",mode,false);},"opera":qx.bom.client.Engine.VERSION<9.5?function(element,mode){return qx.bom.element.Style.get(element,"overflow",mode,false);}:function(element,mode){return qx.bom.element.Style.get(element,"overflowX",mode,false);},"default":function(element,mode){return qx.bom.element.Style.get(element,"overflowX",mode,false);}}),setX:qx.core.Variant.select("qx.client",{"gecko":qx.bom.client.Engine.VERSION<1.8?function(element,value){if(value=="hidden"){value="-moz-scrollbars-none";}element.style.overflow=value;}:function(element,value){element.style.overflowX=value;},"opera":qx.bom.client.Engine.VERSION<9.5?function(element,value){element.style.overflow=value;}:function(element,value){element.style.overflowX=value;},"default":function(element,value){element.style.overflowX=value;}}),resetX:qx.core.Variant.select("qx.client",{"gecko":qx.bom.client.Engine.VERSION<1.8?function(element){element.style.overflow="";}:function(element){element.style.overflowX="";},"opera":qx.bom.client.Engine.VERSION<9.5?function(element,value){element.style.overflow="";}:function(element,value){element.style.overflowX="";},"default":function(element){element.style.overflowX="";}}),getY:qx.core.Variant.select("qx.client",{"gecko":qx.bom.client.Engine.VERSION<1.8?function(element,mode){var overflow=qx.bom.element.Style.get(element,"overflow",mode,false);if(overflow==="-moz-scrollbars-none"){overflow="hidden";}return overflow;}:function(element,mode){return qx.bom.element.Style.get(element,"overflowY",mode,false);},"opera":qx.bom.client.Engine.VERSION<9.5?function(element,mode){return qx.bom.element.Style.get(element,"overflow",mode,false);}:function(element,mode){return qx.bom.element.Style.get(element,"overflowY",mode,false);},"default":function(element,mode){return qx.bom.element.Style.get(element,"overflowY",mode,false);}}),setY:qx.core.Variant.select("qx.client",{"gecko":qx.bom.client.Engine.VERSION<1.8?function(element,value){if(value==="hidden"){value="-moz-scrollbars-none";}element.style.overflow=value;}:function(element,value){element.style.overflowY=value;},"opera":qx.bom.client.Engine.VERSION<9.5?function(element,value){element.style.overflow=value;}:function(element,value){element.style.overflowY=value;},"default":function(element,value){element.style.overflowY=value;}}),resetY:qx.core.Variant.select("qx.client",{"gecko":qx.bom.client.Engine.VERSION<1.8?function(element){element.style.overflow="";}:function(element){element.style.overflowY="";},"opera":qx.bom.client.Engine.VERSION<9.5?function(element,value){element.style.overflow="";}:function(element,value){element.style.overflowY="";},"default":function(element){element.style.overflowY="";}})}});qx.Bootstrap.define("qx.io2.ImageLoader",{statics:{__data:{},__defaultSize:{width:null,height:null},isLoaded:function(source){var entry=this.__data[source];return !!(entry&&entry.loaded);},isFailed:function(source){var entry=this.__data[source];return !!(entry&&entry.failed);},isLoading:function(source){var entry=this.__data[source];return !!(entry&&entry.loading);},getSize:function(source){return this.__data[source]||this.__defaultSize;},getWidth:function(source){var entry=this.__data[source];return entry?entry.width:null;},getHeight:function(source){var entry=this.__data[source];return entry?entry.height:null;},load:function(source,callback,context){var entry=this.__data[source];if(!entry){entry=this.__data[source]={};}if(callback&&!context){context=window;}if(entry.loaded||entry.loading||entry.failed){if(callback){if(entry.loading){entry.callbacks.push(callback,context);}else{callback.call(context,source,entry);}}}else{entry.loading=true;entry.callbacks=[];if(callback){entry.callbacks.push(callback,context);}var el=new Image();var boundCallback=qx.lang.Function.listener(this.__onload,this,el,source);el.onload=boundCallback;el.onerror=boundCallback;el.src=source;}},__onload:function(event,element,source){var entry=this.__data[source];if(event.type==="load"){entry.loaded=true;entry.width=this.__getWidth(element);entry.height=this.__getHeight(element);}else{entry.failed=true;}element.onload=element.onerror=null;var callbacks=entry.callbacks;delete entry.loading;delete entry.callbacks;for(var i=0,l=callbacks.length;i<l;i+=2){callbacks[i].call(callbacks[i+1],source,entry);}},__getWidth:qx.core.Variant.select("qx.client",{"gecko":function(element){return element.naturalWidth;},"default":function(element){return element.width;}}),__getHeight:qx.core.Variant.select("qx.client",{"gecko":function(element){return element.naturalHeight;},"default":function(element){return element.height;}})}});qx.Class.define("qx.theme.manager.Meta",{type:"singleton",extend:qx.core.Object,properties:{theme:{check:"Theme",nullable:true,apply:"_applyTheme"}},members:{_applyTheme:function(value,old){var color=null;var decoration=null;var font=null;var icon=null;var appearance=null;if(value){color=value.meta.color||null;decoration=value.meta.decoration||null;font=value.meta.font||null;icon=value.meta.icon||null;appearance=value.meta.appearance||null;}var colorMgr=qx.theme.manager.Color.getInstance();var decorationMgr=qx.theme.manager.Decoration.getInstance();var fontMgr=qx.theme.manager.Font.getInstance();var iconMgr=qx.theme.manager.Icon.getInstance();var appearanceMgr=qx.theme.manager.Appearance.getInstance();colorMgr.setTheme(color);decorationMgr.setTheme(decoration);fontMgr.setTheme(font);iconMgr.setTheme(icon);appearanceMgr.setAppearanceTheme(appearance);},initialize:function(){var setting=qx.core.Setting;var theme,obj;theme=setting.get("qx.theme");if(theme){obj=qx.Theme.getByName(theme);if(!obj){throw new Error("The theme to use is not available: "+theme);}this.setTheme(obj);}}},settings:{"qx.theme":"qx.theme.Classic"}});qx.Class.define("qx.theme.manager.Font",{type:"singleton",extend:qx.util.ValueManager,properties:{theme:{check:"Theme",nullable:true,apply:"_applyTheme",event:"changeTheme"}},members:{resolveDynamic:function(value){return value instanceof qx.bom.Font?value:this._dynamic[value];},isDynamic:function(value){return value&&(value instanceof qx.bom.Font||this._dynamic[value]!==undefined);},_applyTheme:function(value){var dest=this._dynamic;for(var key in dest){if(dest[key].themed){dest[key].dispose();delete dest[key];}}if(value){var source=value.fonts;var font=qx.bom.Font;for(var key in source){dest[key]=(new font).set(source[key]);dest[key].themed=true;}}}}});qx.Class.define("qx.bom.Font",{extend:qx.core.Object,construct:function(size,family){this.base(arguments);if(size!==undefined){this.setSize(size);}if(family!==undefined){this.setFamily(family);}},statics:{fromString:function(str){var font=new qx.bom.Font();var parts=str.split(/\s+/);var name=[];var part;for(var i=0;i<parts.length;i++){switch(part=parts[i]){case "bold":font.setBold(true);break;case "italic":font.setItalic(true);break;case "underline":font.setDecoration("underline");break;default:var temp=parseInt(part,10);if(temp==part||qx.lang.String.contains(part,"px")){font.setSize(temp);}else{name.push(part);}break;}}if(name.length>0){font.setFamily(name);}return font;},fromConfig:function(config){var font=new qx.bom.Font;font.set(config);return font;},__defaultStyles:{fontFamily:"",fontSize:"",fontWeight:"",fontStyle:"",textDecoration:"",lineHeight:1.2},getDefaultStyles:function(){return this.__defaultStyles;}},properties:{size:{check:"Integer",nullable:true,apply:"_applySize"},lineHeight:{check:"Number",nullable:true,apply:"_applyLineHeight"},family:{check:"Array",nullable:true,apply:"_applyFamily"},bold:{check:"Boolean",nullable:true,apply:"_applyBold"},italic:{check:"Boolean",nullable:true,apply:"_applyItalic"},decoration:{check:["underline","line-through","overline"],nullable:true,apply:"_applyDecoration"}},members:{__size:null,__family:null,__bold:null,__italic:null,__decoration:null,__lineHeight:null,_applySize:function(value,old){this.__size=value===null?null:value+"px";},_applyLineHeight:function(value,old){this.__lineHeight=value===null?null:value;},_applyFamily:function(value,old){var family="";for(var i=0,l=value.length;i<l;i++){if(value[i].indexOf(" ")>0){family+='"'+value[i]+'"';}else{family+=value[i];}if(i!==l-1){family+=",";}}this.__family=family;},_applyBold:function(value,old){this.__bold=value===null?null:value?"bold":"normal";},_applyItalic:function(value,old){this.__italic=value===null?null:value?"italic":"normal";},_applyDecoration:function(value,old){this.__decoration=value===null?null:value;},getStyles:function(){return {fontFamily:this.__family,fontSize:this.__size,fontWeight:this.__bold,fontStyle:this.__italic,textDecoration:this.__decoration,lineHeight:this.__lineHeight};}}});qx.Class.define("qx.theme.manager.Icon",{type:"singleton",extend:qx.core.Object,properties:{theme:{check:"Theme",nullable:true,apply:"_applyTheme"}},members:{_applyTheme:function(value,old){var alias=qx.util.AliasManager.getInstance();value?alias.add("icon",value.resource):alias.remove("icon");}}});qx.Class.define("qx.theme.manager.Appearance",{type:"singleton",extend:qx.core.Object,construct:function(){this.base(arguments);this.__styleCache={};this.__aliasMap={};},properties:{appearanceTheme:{check:"Theme",nullable:true,apply:"_applyAppearanceTheme",event:"changeAppearanceTheme"}},members:{__defaultStates:{},_applyAppearanceTheme:function(value,old){},__resolveId:function(id,theme){var db=theme.appearances;var entry=db[id];if(!entry){var divider="/";var end=[];var splitted=id.split(divider);var alias;while(!entry&&splitted.length>0){end.unshift(splitted.pop());var baseid=splitted.join(divider);entry=db[baseid];if(entry){alias=entry.alias||entry;if(typeof alias==="string"){var mapped=alias+divider+end.join(divider);return this.__resolveId(mapped,theme);}}}return null;}else if(typeof entry==="string"){return this.__resolveId(entry,theme);}else if(entry.include&&!entry.style){return this.__resolveId(entry.include,theme);}return id;},styleFrom:function(id,states,theme){if(!theme){theme=this.getAppearanceTheme();}var aliasMap=this.__aliasMap;var resolved=aliasMap[id];if(!resolved){resolved=aliasMap[id]=this.__resolveId(id,theme);}var entry=theme.appearances[resolved];if(!entry){this.warn("Missing appearance: "+id);return null;}if(!entry.style){return null;}var unique=resolved;if(states){var bits=entry.$$bits;if(!bits){bits=entry.$$bits={};entry.$$length=0;}var sum=0;for(var state in states){if(bits[state]==null){bits[state]=1<<entry.$$length++;}sum+=bits[state];}if(sum>0){unique+=":"+sum;}}var cache=this.__styleCache;if(cache[unique]!==undefined){return cache[unique];}if(!states){states=this.__defaultStates;}var result;if(entry.include||entry.base){var local=entry.style(states);var incl;if(entry.include){incl=this.styleFrom(entry.include,states,theme);}result={};if(entry.base){var base=this.styleFrom(resolved,states,entry.base);if(entry.include){for(var key in base){if(incl[key]===undefined&&local[key]===undefined){result[key]=base[key];}}}else{for(var key in base){if(local[key]===undefined){result[key]=base[key];}}}}if(entry.include){for(var key in incl){if(local[key]===undefined){result[key]=incl[key];}}}for(var key in local){result[key]=local[key];}}else{result=entry.style(states);}return cache[unique]=result||null;}},destruct:function(){this._disposeFields("__styleCache","__aliasMap");}});qx.Mixin.define("qx.ui.core.MChildrenHandling",{members:{getChildren:function(){return this._getChildren();},hasChildren:function(){return this._hasChildren();},indexOf:function(child){return this._indexOf(child);},add:function(child,options){this._add(child,options);},addAt:function(child,index,options){this._addAt(child,index,options);},addBefore:function(child,before,options){this._addBefore(child,before,options);},addAfter:function(child,after,options){this._addAfter(child,after,options);},remove:function(child){this._remove(child);},removeAt:function(index){this._removeAt(index);},removeAll:function(){this._removeAll();}},statics:{remap:function(members){members.getChildren=members._getChildren;members.hasChildren=members._hasChildren;members.indexOf=members._indexOf;members.add=members._add;members.addAt=members._addAt;members.addBefore=members._addBefore;members.addAfter=members._addAfter;members.remove=members._remove;members.removeAt=members._removeAt;members.removeAll=members._removeAll;}}});qx.Class.define("qx.ui.core.LayoutItem",{type:"abstract",extend:qx.core.Object,properties:{minWidth:{check:"Integer",nullable:true,apply:"_applyDimension",init:null,themeable:true},width:{check:"Integer",nullable:true,apply:"_applyDimension",init:null,themeable:true},maxWidth:{check:"Integer",nullable:true,apply:"_applyDimension",init:null,themeable:true},minHeight:{check:"Integer",nullable:true,apply:"_applyDimension",init:null,themeable:true},height:{check:"Integer",nullable:true,apply:"_applyDimension",init:null,themeable:true},maxHeight:{check:"Integer",nullable:true,apply:"_applyDimension",init:null,themeable:true},allowGrowX:{check:"Boolean",apply:"_applyStretching",init:true,themeable:true},allowShrinkX:{check:"Boolean",apply:"_applyStretching",init:true,themeable:true},allowGrowY:{check:"Boolean",apply:"_applyStretching",init:true,themeable:true},allowShrinkY:{check:"Boolean",apply:"_applyStretching",init:true,themeable:true},allowStretchX:{group:["allowGrowX","allowShrinkX"],mode:"shorthand",themeable:true},allowStretchY:{group:["allowGrowY","allowShrinkY"],mode:"shorthand",themeable:true},marginTop:{check:"Integer",init:0,apply:"_applyMargin",themeable:true},marginRight:{check:"Integer",init:0,apply:"_applyMargin",themeable:true},marginBottom:{check:"Integer",init:0,apply:"_applyMargin",themeable:true},marginLeft:{check:"Integer",init:0,apply:"_applyMargin",themeable:true},margin:{group:["marginTop","marginRight","marginBottom","marginLeft"],mode:"shorthand",themeable:true},alignX:{check:["left","center","right"],nullable:true,apply:"_applyAlign",themeable:true},alignY:{check:["top","middle","bottom","baseline"],nullable:true,apply:"_applyAlign",themeable:true}},members:{__computedHeightForWidth:null,__computedLayout:null,__hasInvalidLayout:null,__sizeHint:null,__updateMargin:null,__userBounds:null,__layoutProperties:null,getBounds:function(){return this.__userBounds||this.__computedLayout||null;},clearSeparators:function(){},renderSeparator:function(separator,bounds){},renderLayout:function(left,top,width,height){var msg;var flowHeight=null;if(this.getHeight()==null&&this._hasHeightForWidth()){var flowHeight=this._getHeightForWidth(width);}if(flowHeight!=null&&flowHeight!==this.__computedHeightForWidth){this.__computedHeightForWidth=flowHeight;qx.ui.core.queue.Layout.add(this);return null;}var computed=this.__computedLayout;if(!computed){computed=this.__computedLayout={};}var changes={};if(left!==computed.left||top!==computed.top){changes.position=true;computed.left=left;computed.top=top;}if(width!==computed.width||height!==computed.height){changes.size=true;computed.width=width;computed.height=height;}if(this.__hasInvalidLayout){changes.local=true;delete this.__hasInvalidLayout;}if(this.__updateMargin){changes.margin=true;delete this.__updateMargin;}return changes;},shouldBeLayouted:function(){return true;},hasValidLayout:function(){return !this.__hasInvalidLayout;},scheduleLayoutUpdate:function(){qx.ui.core.queue.Layout.add(this);},invalidateLayoutCache:function(){this.__hasInvalidLayout=true;this.__sizeHint=null;},getSizeHint:function(compute){var hint=this.__sizeHint;if(hint){return hint;}if(compute===false){return null;}hint=this.__sizeHint=this._computeSizeHint();if(this.__computedHeightForWidth&&this.getHeight()==null){hint.height=this.__computedHeightForWidth;}if(!this.getAllowShrinkX()){hint.minWidth=hint.width;}else if(hint.minWidth>hint.width){hint.width=hint.minWidth;}if(!this.getAllowShrinkY()){hint.minHeight=hint.height;}else if(hint.minHeight>hint.height){hint.height=hint.minHeight;}if(!this.getAllowGrowX()){hint.maxWidth=hint.width;}else if(hint.width>hint.maxWidth){hint.width=hint.maxWidth;}if(!this.getAllowGrowY()){hint.maxHeight=hint.height;}else if(hint.height>hint.maxHeight){hint.height=hint.maxHeight;}return hint;},_computeSizeHint:function(){var minWidth=this.getMinWidth()||0;var minHeight=this.getMinHeight()||0;var width=this.getWidth()||minWidth;var height=this.getHeight()||minHeight;var maxWidth=this.getMaxWidth()||Infinity;var maxHeight=this.getMaxHeight()||Infinity;return {minWidth:minWidth,width:width,maxWidth:maxWidth,minHeight:minHeight,height:height,maxHeight:maxHeight};},_hasHeightForWidth:function(){return false;},_getHeightForWidth:function(width){return null;},_applyMargin:function(){this.__updateMargin=true;var parent=this.$$parent;if(parent){parent.updateLayoutProperties();}},_applyAlign:function(){var parent=this.$$parent;if(parent){parent.updateLayoutProperties();}},_applyDimension:function(){qx.ui.core.queue.Layout.add(this);},_applyStretching:function(){qx.ui.core.queue.Layout.add(this);},hasUserBounds:function(){return !!this.__userBounds;},setUserBounds:function(left,top,width,height){this.__userBounds={left:left,top:top,width:width,height:height};qx.ui.core.queue.Layout.add(this);},resetUserBounds:function(){delete this.__userBounds;qx.ui.core.queue.Layout.add(this);},__emptyProperties:{},setLayoutProperties:function(props){if(props==null){return;}var storage=this.__layoutProperties;if(!storage){storage=this.__layoutProperties={};}var parent=this.getLayoutParent();if(parent){parent.updateLayoutProperties(props);}for(var key in props){if(props[key]==null){delete storage[key];}else{storage[key]=props[key];}}},getLayoutProperties:function(){return this.__layoutProperties||this.__emptyProperties;},clearLayoutProperties:function(){delete this.__layoutProperties;},updateLayoutProperties:function(props){var layout=this._getLayout();if(layout){var key;layout.invalidateChildrenCache();}qx.ui.core.queue.Layout.add(this);},getApplicationRoot:function(){return qx.core.Init.getApplication().getRoot();},getLayoutParent:function(){return this.$$parent||null;},setLayoutParent:function(parent){this.$$parent=parent;},isRootWidget:function(){return false;},_getRoot:function(){var parent=this;while(parent){if(parent.isRootWidget()){return parent;}parent=parent.$$parent;}return null;},clone:function(){var clone=this.base(arguments);var props=this.__layoutProperties;if(props){clone.__layoutProperties=qx.lang.Object.copy(props);}return clone;},serialize:function(){var result=this.base(arguments);var props=this.__layoutProperties;if(props){result.layoutProperties=qx.lang.Object.copy(props);}return result;}},destruct:function(){this._disposeFields("$$parent","$$subparent","__layoutProperties","__computedLayout","__userBounds","__sizeHint");}});qx.Class.define("qx.ui.core.Widget",{extend:qx.ui.core.LayoutItem,include:[qx.locale.MTranslation],construct:function(){this.base(arguments);this.__containerElement=this._createContainerElement();this.__contentElement=this.__createContentElement();this.__containerElement.add(this.__contentElement);this.__containerElement.setAttribute("$$widget",this.toHashCode());{};qx.ui.core.queue.Appearance.add(this);this.initFocusable();this.initSelectable();this.initCursor();this.initKeepFocus();this.initKeepActive();},events:{appear:"qx.event.type.Event",disappear:"qx.event.type.Event",resize:"qx.event.type.Data",move:"qx.event.type.Data",mousemove:"qx.event.type.Mouse",mouseover:"qx.event.type.Mouse",mouseout:"qx.event.type.Mouse",mousedown:"qx.event.type.Mouse",mouseup:"qx.event.type.Mouse",click:"qx.event.type.Mouse",dblclick:"qx.event.type.Mouse",contextmenu:"qx.event.type.Mouse",mousewheel:"qx.event.type.Mouse",keyup:"qx.event.type.KeySequence",keydown:"qx.event.type.KeySequence",keypress:"qx.event.type.KeySequence",keyinput:"qx.event.type.KeyInput",focus:"qx.event.type.Focus",blur:"qx.event.type.Focus",focusin:"qx.event.type.Focus",focusout:"qx.event.type.Focus",activate:"qx.event.type.Focus",deactivate:"qx.event.type.Focus",capture:"qx.event.type.Event",losecapture:"qx.event.type.Event",drop:"qx.event.type.Drag",dragleave:"qx.event.type.Drag",dragover:"qx.event.type.Drag",drag:"qx.event.type.Drag",dragstart:"qx.event.type.Drag",dragend:"qx.event.type.Drag",dragchange:"qx.event.type.Drag",droprequest:"qx.event.type.Drag"},properties:{paddingTop:{check:"Integer",init:0,apply:"_applyPadding",themeable:true},paddingRight:{check:"Integer",init:0,apply:"_applyPadding",themeable:true},paddingBottom:{check:"Integer",init:0,apply:"_applyPadding",themeable:true},paddingLeft:{check:"Integer",init:0,apply:"_applyPadding",themeable:true},padding:{group:["paddingTop","paddingRight","paddingBottom","paddingLeft"],mode:"shorthand",themeable:true},zIndex:{nullable:true,init:null,apply:"_applyZIndex",event:"changeZIndex",check:"Integer",themeable:true},decorator:{nullable:true,init:null,apply:"_applyDecorator",event:"changeDecorator",check:"Decorator",themeable:true},shadow:{nullable:true,init:null,apply:"_applyShadow",event:"changeShadow",check:"Decorator",themeable:true},backgroundColor:{nullable:true,check:"Color",apply:"_applyBackgroundColor",event:"changeBackgroundColor",themeable:true},textColor:{nullable:true,check:"Color",apply:"_applyTextColor",event:"changeTextColor",themeable:true,inheritable:true},font:{nullable:true,apply:"_applyFont",check:"Font",event:"changeFont",themeable:true,inheritable:true},opacity:{check:"Number",apply:"_applyOpacity",themeable:true,nullable:true,init:null},cursor:{check:"String",apply:"_applyCursor",themeable:true,inheritable:true,nullable:true,init:null},toolTip:{check:"qx.ui.tooltip.ToolTip",nullable:true},visibility:{check:["visible","hidden","excluded"],init:"visible",apply:"_applyVisibility",event:"changeVisibility"},enabled:{init:true,check:"Boolean",inheritable:true,apply:"_applyEnabled",event:"changeEnabled"},anonymous:{init:false,check:"Boolean"},tabIndex:{check:"Integer",nullable:true,apply:"_applyTabIndex"},focusable:{check:"Boolean",init:false,apply:"_applyFocusable"},keepFocus:{check:"Boolean",init:false,apply:"_applyKeepFocus"},keepActive:{check:"Boolean",init:false,apply:"_applyKeepActive"},draggable:{check:"Boolean",init:false,apply:"_applyDraggable"},droppable:{check:"Boolean",init:false,apply:"_applyDroppable"},selectable:{check:"Boolean",init:false,apply:"_applySelectable"},contextMenu:{check:"qx.ui.menu.Menu",apply:"_applyContextMenu",nullable:true,event:"changeContextMenu"},appearance:{check:"String",init:"widget",apply:"_applyAppearance",event:"changeAppearance"}},statics:{DEBUG:false,getWidgetByElement:function(element){try{while(element){var widgetKey=element.$$widget;if(widgetKey!=null){return qx.core.ObjectRegistry.fromHashCode(widgetKey);}element=element.parentNode;}}catch(ex){}return null;},contains:function(parent,child){while(child){if(parent==child){return true;}child=child.getLayoutParent();}return false;},__decoratorPool:{}},members:{__containerElement:null,__contentElement:null,__decoratorElement:null,__shadowElement:null,__protectorElement:null,__layoutManager:null,_getLayout:function(){return this.__layoutManager;},_setLayout:function(layout){{};if(this.__layoutManager){this.__layoutManager.connectToWidget(null);}if(layout){layout.connectToWidget(this);}this.__layoutManager=layout;qx.ui.core.queue.Layout.add(this);},setLayoutParent:function(parent){if(this.$$parent===parent){return;}if(this.$$parent){this.$$parent.getContentElement().remove(this.__containerElement);}this.$$parent=parent||null;if(this.$$parent){this.$$parent.getContentElement().add(this.__containerElement);}qx.core.Property.refresh(this);},__updateInsets:null,renderLayout:function(left,top,width,height){var changes=this.base(arguments,left,top,width,height);if(!changes){return;}var container=this.__containerElement;var content=this.__contentElement;var inner=changes.size||this.__updateInsets;var pixel="px";if(changes.position){container.setStyle("left",left+pixel);container.setStyle("top",top+pixel);}if(changes.size){container.setStyle("width",width+pixel);container.setStyle("height",height+pixel);}if(inner||changes.local||changes.margin){var insets=this.getInsets();var innerWidth=width-insets.left-insets.right;var innerHeight=height-insets.top-insets.bottom;}if(this.__updateInsets){content.setStyle("left",insets.left+pixel);content.setStyle("top",insets.top+pixel);}if(inner){content.setStyle("width",innerWidth+pixel);content.setStyle("height",innerHeight+pixel);}if(changes.size){var protector=this.__protectorElement;if(protector){protector.setStyles({width:width+"px",height:height+"px"});}}if(changes.size||this.__updateInsets){var manager=qx.theme.manager.Decoration.getInstance();var decorator=this.getDecorator();if(decorator){var element=this.__decoratorElement;var instance=manager.resolve(decorator);instance.resize(element,width,height);}}if(changes.size){var shadow=this.getShadow();if(shadow){var element=this.__shadowElement;var instance=manager.resolve(shadow);var insets=instance.getInsets();var shadowWidth=width+insets.left+insets.right;var shadowHeight=height+insets.top+insets.bottom;instance.resize(element,shadowWidth,shadowHeight);}}if(inner||changes.local||changes.margin){if(this.__layoutManager&&this.hasLayoutChildren()){this.__layoutManager.renderLayout(innerWidth,innerHeight);}else if(this.hasLayoutChildren()){throw new Error("At least one child in control "+this._findTopControl()+" requires a layout, but no one was defined!");}}if(changes.position&&this.hasListener("move")){this.fireDataEvent("move",this.getBounds());}if(changes.size&&this.hasListener("resize")){this.fireDataEvent("resize",this.getBounds());}delete this.__updateInsets;},__separators:null,clearSeparators:function(){var reg=this.__separators;if(!reg){return;}var pool=qx.ui.core.Widget.__decoratorPool;var content=this.__contentElement;var separator,elem;for(var i=0,l=reg.length;i<l;i++){elem=reg[i];separator=elem.$$separator;if(!pool[separator]){pool[separator]=[elem];}else{pool[separator].push(elem);}content.remove(elem);}reg.length=0;},renderSeparator:function(separator,bounds){var pool=qx.ui.core.Widget.__decoratorPool;var mgr=qx.theme.manager.Decoration.getInstance();if(typeof separator=="object"){var id=separator.toHashCode();var instance=separator;}else{var id=separator;var instance=mgr.resolve(separator);}var list=pool[separator];if(list&&list.length>0){var elem=list.pop();}else{var elem=this.__createDecoratorElement(instance);}this.__contentElement.add(elem);instance.resize(elem,bounds.width,bounds.height);var style=elem.getDomElement().style;style.left=bounds.left+"px";style.top=bounds.top+"px";if(!this.__separators){this.__separators=[elem];}else{this.__separators.push(elem);}elem.$$separator=id;},_computeSizeHint:function(){var width=this.getWidth();var minWidth=this.getMinWidth();var maxWidth=this.getMaxWidth();var height=this.getHeight();var minHeight=this.getMinHeight();var maxHeight=this.getMaxHeight();var contentHint=this._getContentHint();var insets=this.getInsets();var insetX=insets.left+insets.right;var insetY=insets.top+insets.bottom;if(width==null){width=contentHint.width+insetX;}if(height==null){height=contentHint.height+insetY;}if(minWidth==null){minWidth=insetX;if(contentHint.minWidth!=null){minWidth+=contentHint.minWidth;}}if(minHeight==null){minHeight=insetY;if(contentHint.minHeight!=null){minHeight+=contentHint.minHeight;}}if(maxWidth==null){if(contentHint.maxWidth==null){maxWidth=Infinity;}else{maxWidth=contentHint.maxWidth+insetX;}}if(maxHeight==null){if(contentHint.maxHeight==null){maxHeight=Infinity;}else{maxHeight=contentHint.maxHeight+insetY;}}return {width:width,minWidth:minWidth,maxWidth:maxWidth,height:height,minHeight:minHeight,maxHeight:maxHeight};},invalidateLayoutCache:function(){this.base(arguments);if(this.__layoutManager){this.__layoutManager.invalidateLayoutCache();}},_getContentHint:function(){var layout=this.__layoutManager;if(layout){if(this.hasLayoutChildren()){var hint=layout.getSizeHint();var msg;return hint;}else{return {width:0,height:0};}}else{return {width:100,height:50};}},_getHeightForWidth:function(width){var insets=this.getInsets();var insetX=insets.left+insets.right;var insetY=insets.top+insets.bottom;var contentWidth=width-insetX;var contentHeight=this._getContentHeightForWidth(contentWidth);var height=contentHeight+insetY;return height;},_getContentHeightForWidth:function(width){throw new Error("Abstract method call: _getContentHeightForWidth()!");},getInsets:function(){var top=this.getPaddingTop();var right=this.getPaddingRight();var bottom=this.getPaddingBottom();var left=this.getPaddingLeft();var decorator=this.getDecorator();if(decorator){var manager=qx.theme.manager.Decoration.getInstance();var instance=manager.resolve(decorator);var inset=instance.getInsets();{};top+=inset.top;right+=inset.right;bottom+=inset.bottom;left+=inset.left;}return {"top":top,"right":right,"bottom":bottom,"left":left};},getInnerSize:function(){var computed=this.getBounds();if(!computed){return null;}var insets=this.getInsets();return {width:computed.width-insets.left-insets.right,height:computed.height-insets.top-insets.bottom};},show:function(){this.setVisibility("visible");},hide:function(){this.setVisibility("hidden");},exclude:function(){this.setVisibility("excluded");},isVisible:function(){return this.getVisibility()==="visible";},isHidden:function(){return this.getVisibility()!=="visible";},isExcluded:function(){return this.getVisibility()==="excluded";},_createContainerElement:function(){var el=new qx.html.Element("div");{};el.setStyle("position","absolute");el.setStyle("zIndex",0);return el;},__createContentElement:function(){var el=this._createContentElement();{};el.setStyle("position","absolute");el.setStyle("zIndex",10);return el;},_createContentElement:function(){var el=new qx.html.Element("div");el.setStyle("overflowX","hidden");el.setStyle("overflowY","hidden");return el;},getContainerElement:function(){return this.__containerElement;},getContentElement:function(){return this.__contentElement;},getDecoratorElement:function(){return this.__decoratorElement;},__widgetChildren:null,__layoutChildren:null,getLayoutChildren:function(){var children=this.__widgetChildren;if(!children){return this.__emptyChildren;}if(this.__layoutChildren){return this.__layoutChildren;}var layoutChildren=[];for(var i=0,l=children.length;i<l;i++){var child=children[i];if(!child.hasUserBounds()&&child.shouldBeLayouted()){layoutChildren.push(child);}}this.__layoutChildren=layoutChildren;return layoutChildren;},scheduleLayoutUpdate:function(){qx.ui.core.queue.Layout.add(this);},invalidateLayoutChildren:function(){var layout=this.__layoutManager;if(layout){layout.invalidateChildrenCache();}this.__layoutChildren=null;qx.ui.core.queue.Layout.add(this);},shouldBeLayouted:function(){return this.getVisibility()!=="excluded";},hasLayoutChildren:function(){var children=this.getLayoutChildren();return children&&children.length>0;},getChildrenContainer:function(){return this;},__emptyChildren:[],_getChildren:function(){return this.__widgetChildren||this.__emptyChildren;},_indexOf:function(child){var children=this.__widgetChildren;if(!children){return -1;}return children.indexOf(child);},_hasChildren:function(){var children=this.__widgetChildren;return children&&(!!children[0]);},_add:function(child,options){if(child.getLayoutParent()==this){qx.lang.Array.remove(this.__widgetChildren,child);}if(this.__widgetChildren){this.__widgetChildren.push(child);}else{this.__widgetChildren=[child];}this.__addHelper(child,options);},_addAt:function(child,index,options){if(!this.__widgetChildren){this.__widgetChildren=[];}if(child.getLayoutParent()==this){qx.lang.Array.remove(this.__widgetChildren,child);}var ref=this.__widgetChildren[index];if(ref===child){return child.setLayoutProperties(options);}if(ref){qx.lang.Array.insertBefore(this.__widgetChildren,child,ref);}else{this.__widgetChildren.push(child);}this.__addHelper(child,options);},_addBefore:function(child,before,options){{};if(child==before){return;}if(!this.__widgetChildren){this.__widgetChildren=[];}if(child.getLayoutParent()==this){qx.lang.Array.remove(this.__widgetChildren,child);}qx.lang.Array.insertBefore(this.__widgetChildren,child,before);this.__addHelper(child,options);},_addAfter:function(child,after,options){{};if(child==after){return;}if(!this.__widgetChildren){this.__widgetChildren=[];}if(child.getLayoutParent()==this){qx.lang.Array.remove(this.__widgetChildren,child);}qx.lang.Array.insertAfter(this.__widgetChildren,child,after);this.__addHelper(child,options);},_remove:function(child){if(!this.__widgetChildren){return;}qx.lang.Array.remove(this.__widgetChildren,child);this.__removeHelper(child);},_removeAt:function(index){if(!this.__widgetChildren){throw new Error("This widget has no children!");}var child=this.__widgetChildren[index];qx.lang.Array.removeAt(this.__widgetChildren,index);this.__removeHelper(child);},_removeAll:function(){if(!this.__widgetChildren){return;}var children=this.__widgetChildren.concat();this.__widgetChildren.length=0;for(var i=children.length-1;i>=0;i--){children[i].setLayoutParent(null);}qx.ui.core.queue.Layout.add(this);},_afterAddChild:null,_afterRemoveChild:null,__addHelper:function(child,options){{};var parent=child.getLayoutParent();if(parent&&parent!=this){parent._remove(child);}child.setLayoutParent(this);if(options){child.setLayoutProperties(options);}else{this.updateLayoutProperties();}this.__layoutChildren=null;if(this._afterAddChild){this._afterAddChild(child);}},__removeHelper:function(child){{};child.setLayoutParent(null);if(this.__layoutManager){this.__layoutManager.invalidateChildrenCache();}this.__layoutChildren=null;qx.ui.core.queue.Layout.add(this);if(this._afterRemoveChild){this._afterRemoveChild(child);}},capture:function(){this.__containerElement.capture();},releaseCapture:function(){this.__containerElement.releaseCapture();},_applyPadding:function(value,old,name){this.__updateInsets=true;qx.ui.core.queue.Layout.add(this);},_createProtectorElement:function(){if(this.__protectorElement){return;}var protect=this.__protectorElement=new qx.html.Element;{};protect.setStyles({position:"absolute",top:0,left:0,zIndex:7});if(qx.core.Variant.isSet("qx.client","mshtml")){protect.setStyles({backgroundImage:"url("+qx.util.ResourceManager.toUri("qx/static/blank.gif")+")",backgroundRepeat:"repeat"});}this.__containerElement.add(protect);},__createDecoratorElement:function(decorator){var element=new qx.html.Element;element.setStyles({position:"absolute",top:0,left:0});{};decorator.init(element);return element;},_applyDecorator:function(value,old){var pool=qx.ui.core.Widget.__decoratorPool;var mgr=qx.theme.manager.Decoration.getInstance();var container=this.__containerElement;var elem=this.__decoratorElement;if(!this.__protectorElement){this._createProtectorElement();}var oldId;if(old){if(typeof old==="object"){oldId=old.toHashCode();}else{oldId=old;old=mgr.resolve(old);}}var valueId;if(value){if(typeof value==="object"){valueId=value.toHashCode();{};}else{valueId=value;value=mgr.resolve(value);}}if(old){if(!pool[oldId]){pool[oldId]=[];}container.remove(elem);pool[oldId].push(elem);}if(value){if(pool[valueId]&&pool[valueId].length>0){elem=pool[valueId].pop();}else{elem=this.__createDecoratorElement(value);elem.setStyle("zIndex",5);}var bgcolor=this.getBackgroundColor();value.tint(elem,bgcolor);container.add(elem);this.__decoratorElement=elem;}else{delete this.__decoratorElement;this._applyBackgroundColor(this.getBackgroundColor());}if(value&&!old&&bgcolor){this.getContainerElement().setStyle("backgroundColor",null);}if(qx.ui.decoration.Util.insetsModified(old,value)){this.__updateInsets=true;qx.ui.core.queue.Layout.add(this);}else if(value){var bounds=this.getBounds();if(bounds){mgr.resolve(value).resize(elem,bounds.width,bounds.height);}}},_applyShadow:function(value,old){var pool=qx.ui.core.Widget.__decoratorPool;var mgr=qx.theme.manager.Decoration.getInstance();var container=this.__containerElement;var oldId;if(old){if(typeof old==="object"){oldId=old.toHashCode();}else{oldId=old;old=mgr.resolve(old);}}var valueId;if(value){if(typeof value==="object"){valueId=value.toHashCode();}else{valueId=value;value=mgr.resolve(value);}}if(old){if(!pool[oldId]){pool[oldId]=[];}container.remove(this.__shadowElement);pool[oldId].push(this.__shadowElement);}if(value){var elem;if(pool[valueId]&&pool[valueId].length>0){elem=pool[valueId].pop();}else{elem=this.__createDecoratorElement(value);}container.add(elem);this.__shadowElement=elem;var insets=value.getInsets();elem.setStyles({left:(-insets.left)+"px",top:(-insets.top)+"px"});var bounds=this.getBounds();if(bounds){var shadowWidth=bounds.width+insets.left+insets.right;var shadowHeight=bounds.height+insets.top+insets.bottom;value.resize(elem,shadowWidth,shadowHeight);}}else{delete this.__shadowElement;}},_applyTextColor:function(value,old){},_applyZIndex:function(value,old){this.__containerElement.setStyle("zIndex",value==null?0:value);},_applyVisibility:function(value,old){if(value==="visible"){this.__containerElement.show();}else{this.__containerElement.hide();}var parent=this.$$parent;if(parent&&(old==null||value==null||old==="excluded"||value==="excluded")){parent.invalidateLayoutChildren();}},_applyOpacity:function(value,old){this.__containerElement.setStyle("opacity",value);},_applyCursor:function(value,old){if(value==null&&!this.isSelectable()){value="default";}this.__containerElement.setStyle("cursor",value);},_applyBackgroundColor:function(value,old){var decorator=this.getDecorator();var shadow=this.getShadow();var color=this.getBackgroundColor();var container=this.__containerElement;if(decorator||shadow){var elem=this.__decoratorElement;if(elem){var instance=qx.theme.manager.Decoration.getInstance().resolve(decorator);instance.tint(this.__decoratorElement,color);}container.setStyle("backgroundColor",null);}else{var resolved=qx.theme.manager.Color.getInstance().resolve(color);container.setStyle("backgroundColor",resolved);}},_applyFont:function(value,old){},hasState:function(state){var states=this.__states;return states&&states[state];},__states:null,addState:function(state){var states=this.__states;if(!states){states=this.__states={};}if(states[state]){return;}this.__states[state]=true;if(state==="hovered"){this.syncAppearance();}else{qx.ui.core.queue.Appearance.add(this);}var forward=this._forwardStates;var controls=this.__childControls;if(forward&&forward[state]&&controls){var control;for(var id in controls){control=controls[id];if(control instanceof qx.ui.core.Widget){controls[id].addState(state);}}}},removeState:function(state){var states=this.__states;if(!states||!states[state]){return;}delete this.__states[state];if(state==="hovered"){this.syncAppearance();}else{qx.ui.core.queue.Appearance.add(this);}var forward=this._forwardStates;var controls=this.__childControls;if(forward&&forward[state]&&controls){for(var id in controls){var control=controls[id];if(control instanceof qx.ui.core.Widget){control.removeState(state);}}}},replaceState:function(old,value){var states=this.__states;if(!states){states=this.__states={};}if(!states[value]){states[value]=true;}if(states[old]){delete states[old];}qx.ui.core.queue.Appearance.add(this);var forward=this._forwardStates;var controls=this.__childControls;if(forward&&forward[value]&&controls){for(var id in controls){var control=controls[id];if(control instanceof qx.ui.core.Widget){control.replaceState(old,value);}}}},__appearanceSelector:null,__updateSelector:null,syncAppearance:function(){var states=this.__states;var selector=this.__appearanceSelector;var manager=qx.theme.manager.Appearance.getInstance();var styler=qx.core.Property.$$method.setThemed;var unstyler=qx.core.Property.$$method.resetThemed;if(this.__updateSelector){delete this.__updateSelector;if(selector){var oldData=manager.styleFrom(selector,states);if(oldData){selector=null;}}}if(!selector){var obj=this;var id=[];do{id.push(obj.$$subcontrol||obj.getAppearance());}while(obj=obj.$$subparent);selector=this.__appearanceSelector=id.reverse().join("/");}var newData=manager.styleFrom(selector,states);if(newData){if(oldData){for(var prop in oldData){if(newData[prop]===undefined){this[unstyler[prop]]();}}}var prop;var value;var undef="undefined";for(var prop in newData){value=newData[prop];value===undef?this[unstyler[prop]]():this[styler[prop]](value);}}else if(oldData){for(var prop in oldData){this[unstyler[prop]]();}}},_applyAppearance:function(value,old){this.updateAppearance();},updateAppearance:function(){this.__updateSelector=true;qx.ui.core.queue.Appearance.add(this);var controls=this.__childControls;if(controls){var obj;for(var id in controls){obj=controls[id];if(obj instanceof qx.ui.core.Widget){obj.updateAppearance();}}}},syncWidget:function(){},getEventTarget:function(){var target=this;while(target.getAnonymous()){target=target.getLayoutParent();if(!target){return null;}}return target;},getFocusTarget:function(){var target=this;if(!target.getEnabled()){return null;}while(target.getAnonymous()||!target.getFocusable()){target=target.getLayoutParent();if(!target||!target.getEnabled()){return null;}}return target;},getFocusElement:function(){return this.__containerElement;},isTabable:function(){return this.isFocusable();},_applyFocusable:function(value,old){var target=this.getFocusElement();if(value){var tabIndex=this.getTabIndex();if(tabIndex==null){tabIndex=1;}target.setAttribute("tabIndex",tabIndex);if(qx.core.Variant.isSet("qx.client","mshtml")){target.setAttribute("hideFocus","true");}else{target.setStyle("outline","none");}}else{if(target.isNativelyFocusable()){target.setAttribute("tabIndex",-1);}else if(old){target.setAttribute("tabIndex",null);}}},_applyKeepFocus:function(value){var target=this.getFocusElement();target.setAttribute("qxKeepFocus",value?"on":null);},_applyKeepActive:function(value){var target=this.getContainerElement();target.setAttribute("qxKeepActive",value?"on":null);},_applyTabIndex:function(value){if(value==null){value=1;}else if(value<1||value>32000){throw new Error("TabIndex property must be between 1 and 32000");}if(this.getFocusable()&&value!=null){this.getFocusElement().setAttribute("tabIndex",value);}},_applySelectable:function(value){this._applyCursor(this.getCursor());this.__containerElement.setAttribute("qxSelectable",value?"on":"off");if(qx.core.Variant.isSet("qx.client","webkit")){this.__containerElement.setStyle("userSelect",value?"normal":"none");}},_applyEnabled:function(value,old){if(value===false){this.addState("disabled");this.removeState("hovered");if(this.isFocusable()){this.removeState("focused");this._applyFocusable(false,true);}}else{this.removeState("disabled");if(this.isFocusable()){this._applyFocusable(true,false);}}},_applyContextMenu:function(value,old){if(old){old.removeState("contextmenu");if(old.getOpener()==this){old.resetOpener();}if(!value){this.removeListener("contextmenu",this._onContextMenuOpen);}}if(value){value.setOpener(this);value.addState("contextmenu");if(!old){this.addListener("contextmenu",this._onContextMenuOpen);}}},_onContextMenuOpen:function(e){var menu=this.getContextMenu();menu.placeToMouse(e);menu.show();e.preventDefault();},_onStopEvent:function(e){e.stopPropagation();},_applyDraggable:function(value,old){qx.ui.core.DragDropCursor.getInstance();if(value){this.addListener("dragstart",this._onDragStart);this.addListener("drag",this._onDrag);this.addListener("dragend",this._onDragEnd);this.addListener("dragchange",this._onDragChange);}else{this.removeListener("dragstart",this._onDragStart);this.removeListener("drag",this._onDrag);this.removeListener("dragend",this._onDragEnd);this.removeListener("dragchange",this._onDragChange);}this.__containerElement.setAttribute("qxDraggable",value?"on":null);},_applyDroppable:function(value,old){this.__containerElement.setAttribute("qxDroppable",value?"on":null);},_onDragStart:function(e){qx.ui.core.DragDropCursor.getInstance().placeToMouse(e);this.getApplicationRoot().setGlobalCursor("default");},_onDrag:function(e){qx.ui.core.DragDropCursor.getInstance().placeToMouse(e);},_onDragEnd:function(e){qx.ui.core.DragDropCursor.getInstance().moveTo(-1000,-1000);this.getApplicationRoot().resetGlobalCursor();},_onDragChange:function(e){var cursor=qx.ui.core.DragDropCursor.getInstance();var action=e.getCurrentAction();action?cursor.setAction(action):cursor.resetAction();},visualizeFocus:function(){this.addState("focused");},visualizeBlur:function(){this.removeState("focused");},scrollChildIntoView:function(child,alignX,alignY,direct){this.scrollChildIntoViewX(child,alignX,direct);this.scrollChildIntoViewY(child,alignY,direct);},scrollChildIntoViewX:function(child,align,direct){this.__contentElement.scrollChildIntoViewX(child.getContainerElement(),align,direct);},scrollChildIntoViewY:function(child,align,direct){this.__contentElement.scrollChildIntoViewY(child.getContainerElement(),align,direct);},focus:function(){if(this.isFocusable()){this.getFocusElement().focus();}else{throw new Error("Widget is not focusable!");}},blur:function(){if(this.isFocusable()){this.getFocusElement().blur();}else{throw new Error("Widget is not focusable!");}},activate:function(){this.__containerElement.activate();},deactivate:function(){this.__containerElement.deactivate();},tabFocus:function(){this.getFocusElement().focus();},_hasChildControl:function(id){if(!this.__childControls){return false;}return !!this.__childControls[id];},__childControls:null,_getChildControl:function(id,notcreate){if(!this.__childControls){if(notcreate){return null;}this.__childControls={};}var control=this.__childControls[id];if(control){return control;}if(notcreate===true){return null;}return this._createChildControl(id);},_showChildControl:function(id){var control=this._getChildControl(id);control.show();return control;},_excludeChildControl:function(id){var control=this._getChildControl(id,true);if(control){control.exclude();}},_isChildControlVisible:function(id){var control=this._getChildControl(id,true);if(control){return control.isVisible();}return false;},_createChildControl:function(id){if(!this.__childControls){this.__childControls={};}else if(this.__childControls[id]){throw new Error("Child control '"+id+"' already created!");}var control=this._createChildControlImpl(id);if(!control){throw new Error("Unsupported control: "+id);}control.$$subcontrol=id;control.$$subparent=this;var states=this.__states;var forward=this._forwardStates;if(states&&forward&&control instanceof qx.ui.core.Widget){for(var state in states){if(forward[state]){control.addState(state);}}}return this.__childControls[id]=control;},_createChildControlImpl:function(id){return null;},_disposeChildControls:function(){var controls=this.__childControls;if(!controls){return;}var Widget=qx.ui.core.Widget;for(var id in controls){var control=controls[id];if(!Widget.contains(this,control)){control.destroy();}else{control.dispose();}}delete this.__childControls;},_findTopControl:function(){var obj=this;while(obj){if(!obj.$$subparent){return obj;}obj=obj.$$subparent;}return null;},getContainerLocation:function(mode){var domEl=this.getContainerElement().getDomElement();return domEl?qx.bom.element.Location.get(domEl,mode):null;},getContentLocation:function(mode){var domEl=this.getContentElement().getDomElement();return domEl?qx.bom.element.Location.get(domEl,mode):null;},setDomLeft:function(value){var domEl=this.getContainerElement().getDomElement();if(domEl){domEl.style.left=value+"px";}else{throw new Error("DOM element is not yet created!");}},setDomTop:function(value){var domEl=this.getContainerElement().getDomElement();if(domEl){domEl.style.top=value+"px";}else{throw new Error("DOM element is not yet created!");}},setDomPosition:function(left,top){var domEl=this.getContainerElement().getDomElement();if(domEl){domEl.style.left=left+"px";domEl.style.top=top+"px";}else{throw new Error("DOM element is not yet created!");}},destroy:function(){if(this.$$disposed){return;}var parent=this.getLayoutParent();if(parent){parent._remove(this);}qx.ui.core.queue.Dispose.add(this);},clone:function(){var clone=this.base(arguments);if(this.getChildren){var children=this.getChildren();for(var i=0,l=children.length;i<l;i++){clone.add(children[i].clone());}}return clone;},serialize:function(){var result=this.base(arguments);if(this.getChildren){var children=this.getChildren();if(children.length>0){result.children=[];for(var i=0,l=children.length;i<l;i++){result.children.push(children[i].serialize());}}}if(this.getLayout){var layout=this.getLayout();if(layout){result.layout=layout.serialize();}}return result;}},destruct:function(){if(!qx.core.ObjectRegistry.inShutDown){this.__containerElement.setAttribute("$$widget",null,true);this._disposeChildControls();}this._disposeArray("__widgetChildren");this._disposeArray("__layoutChildren");this._disposeArray("__separators");this._disposeFields("__states");this._disposeObjects("__layoutManager","__containerElement","__contentElement","__decoratorElement","__shadowElement","__protectorElement");}});qx.Mixin.define("qx.ui.core.MBlocker",{properties:{blockerColor:{check:"Color",init:null,nullable:true,apply:"_applyBlockerColor",themeable:true},blockerOpacity:{check:"Number",init:1,apply:"_applyBlockerOpacity",themeable:true}},members:{__blocker:null,__isBlocked:null,__oldAnonymous:null,__contentBlocker:null,__isContentBlocked:null,_applyBlockerColor:function(value,old){var blockers=[];this.__blocker&&blockers.push(this.__blocker);this.__contentBlocker&&blockers.push(this.__contentBlocker);for(var i=0;i<blockers.length;i++){blockers[i].setStyle("backgroundColor",qx.theme.manager.Color.getInstance().resolve(value));}},_applyBlockerOpacity:function(value,old){var blockers=[];this.__blocker&&blockers.push(this.__blocker);this.__contentBlocker&&blockers.push(this.__contentBlocker);for(var i=0;i<blockers.length;i++){blockers[i].setStyle("opacity",value);}},__createBlockerElement:function(){var blocker=new qx.html.Element().setStyles({position:"absolute",width:"100%",height:"100%",opacity:this.getBlockerOpacity(),backgroundColor:qx.theme.manager.Color.getInstance().resolve(this.getBlockerColor())});return blocker;},_getBlocker:function(){if(!this.__blocker){this.__blocker=this.__createBlockerElement();this.getContentElement().add(this.__blocker);this.__blocker.exclude();}return this.__blocker;},block:function(){if(this.__isBlocked){return;}this.__isBlocked=true;this._getBlocker().include();this.__oldAnonymous=this.getAnonymous();this.setAnonymous(true);},isBlocked:function(){return !!this.__isBlocked;},unblock:function(){if(!this.__isBlocked){return;}this.__isBlocked=false;this.setAnonymous(this.__oldAnonymous);this._getBlocker().exclude();},_getContentBlocker:function(){if(!this.__contentBlocker){this.__contentBlocker=this.__createBlockerElement();this.getContentElement().add(this.__contentBlocker);this.__contentBlocker.exclude();}return this.__contentBlocker;},blockContent:function(zIndex){var blocker=this._getContentBlocker();blocker.setStyle("zIndex",zIndex);if(this.__isContentBlocked){return;}this.__isContentBlocked=true;blocker.include();},isContentBlocked:function(){return !!this.__isContentBlocked;},unblockContent:function(){if(!this.__isContentBlocked){return;}this.__isContentBlocked=false;this._getContentBlocker().exclude();}},destruct:function(){this._disposeObjects("__contentBlocker");}});qx.Mixin.define("qx.ui.window.MDesktop",{properties:{activeWindow:{check:"qx.ui.window.Window",apply:"_applyActiveWindow"}},members:{__windows:null,__manager:null,getWindowManager:function(){if(!this.__manager){this.setWindowManager(new qx.ui.window.Window.DEFAULT_MANAGER_CLASS());}return this.__manager;},supportsMaximize:function(){return true;},setWindowManager:function(manager){if(this.__manager){this.__manager.setDesktop(null);}manager.setDesktop(this);this.__manager=manager;},_onChangeActive:function(e){if(e.getData()){this.setActiveWindow(e.getTarget());}},_applyActiveWindow:function(value,old){this.getWindowManager().changeActiveWindow(value,old);value.setActive(true);if(old){old.resetActive();}},_onChangeModal:function(e){this.getWindowManager().updateStack();},_onChangeVisibility:function(){this.getWindowManager().updateStack();},_afterAddChild:function(win){if(qx.Class.isDefined("qx.ui.window.Window")&&win instanceof qx.ui.window.Window){this._addWindow(win);}},_addWindow:function(win){this.getWindows().push(win);win.addListener("changeActive",this._onChangeActive,this);win.addListener("changeModal",this._onChangeModal,this);win.addListener("changeVisibility",this._onChangeVisibility,this);if(win.getActive()){this.setActiveWindow(win);}this.getWindowManager().updateStack();},_afterRemoveChild:function(win){if(qx.Class.isDefined("qx.ui.window.Window")&&win instanceof qx.ui.window.Window){this._removeWindow(win);}},_removeWindow:function(win){qx.lang.Array.remove(this.getWindows(),win);win.removeListener("changeActive",this._onChangeActive,this);win.removeListener("changeModal",this._onChangeModal,this);win.removeListener("changeVisibility",this._onChangeVisibility,this);this.getWindowManager().updateStack();},getWindows:function(){if(!this.__windows){this.__windows=[];}return this.__windows;}},destruct:function(){this._disposeArray("__windows");this._disposeObjects("__manager");}});qx.Class.define("qx.ui.root.Abstract",{type:"abstract",extend:qx.ui.core.Widget,include:[qx.ui.core.MChildrenHandling,qx.ui.core.MBlocker,qx.ui.window.MDesktop],construct:function(){this.base(arguments);qx.ui.core.FocusHandler.getInstance().addRoot(this);},properties:{appearance:{refine:true,init:"root"},enabled:{refine:true,init:true},focusable:{refine:true,init:true},globalCursor:{check:"String",nullable:true,themeable:true,apply:"_applyGlobalCursor",event:"changeGlobalCursor"},nativeContextMenu:{check:"Boolean",nullable:true,apply:"_applyNativeContextMenu",init:true}},members:{isRootWidget:function(){return true;},getLayout:function(){return this._getLayout();},_applyGlobalCursor:qx.core.Variant.select("qx.client",{"mshtml":function(value,old){},"default":function(value,old){var Stylesheet=qx.bom.Stylesheet;var sheet=this.__globalCursorStyleSheet;if(!sheet){this.__globalCursorStyleSheet=sheet=Stylesheet.createElement();}Stylesheet.removeAllRules(sheet);if(value){Stylesheet.addRule(sheet,"*",qx.bom.element.Cursor.compile(value).replace(";","")+" !important");}}}),_applyNativeContextMenu:function(value,old){if(value){this.removeListener("contextmenu",this._onNativeContextMenu,this,true);}else{this.addListener("contextmenu",this._onNativeContextMenu,this,true);}},_onNativeContextMenu:function(e){e.preventDefault();}},destruct:function(){this._disposeFields("__globalCursorStyleSheet");},defer:function(statics,members){qx.ui.core.MChildrenHandling.remap(members);}});qx.Class.define("qx.ui.root.Application",{extend:qx.ui.root.Abstract,construct:function(doc){this._window=qx.dom.Node.getWindow(doc);this._doc=doc;this.base(arguments);qx.event.Registration.addListener(this._window,"resize",this._onResize,this);this._setLayout(new qx.ui.layout.Canvas());qx.ui.core.queue.Layout.add(this);qx.ui.core.FocusHandler.getInstance().connectTo(this);},members:{_createContainerElement:function(){var doc=this._doc;var hstyle=doc.documentElement.style;var bstyle=doc.body.style;hstyle.overflow=bstyle.overflow="hidden";hstyle.padding=hstyle.margin=bstyle.padding=bstyle.margin="0px";hstyle.width=hstyle.height=bstyle.width=bstyle.height="100%";var elem=doc.createElement("div");doc.body.appendChild(elem);var root=new qx.html.Root(elem);root.setStyle("position","absolute");return root;},_onResize:function(e){qx.ui.core.queue.Layout.add(this);},_computeSizeHint:function(){var width=qx.bom.Viewport.getWidth(this._window);var height=qx.bom.Viewport.getHeight(this._window);return {minWidth:width,width:width,maxWidth:width,minHeight:height,height:height,maxHeight:height};}},destruct:function(){this._disposeFields("_window","_doc");}});qx.Class.define("qx.ui.core.queue.Layout",{statics:{__queue:{},add:function(widget){this.__queue[widget.$$hash]=widget;qx.ui.core.queue.Manager.scheduleFlush("layout");},flush:function(){var queue=this.__getSortedQueue();for(var i=queue.length-1;i>=0;i--){var widget=queue[i];if(widget.hasValidLayout()){continue;}if(widget.isRootWidget()&&!widget.hasUserBounds()){var hint=widget.getSizeHint();widget.renderLayout(0,0,hint.width,hint.height);}else{var bounds=widget.getBounds();widget.renderLayout(bounds.left,bounds.top,bounds.width,bounds.height);}}},getNestingLevel:function(widget){var cache=this.__nesting;var level=0;var parent=widget;while(true){if(cache[parent.$$hash]!=null){level+=cache[parent.$$hash];break;}if(!parent.$$parent){break;}parent=parent.$$parent;level+=1;}var leveldown=level;while(widget&&widget!==parent){cache[widget.$$hash]=leveldown--;widget=widget.$$parent;}return level;},isWidgetVisible:function(widget){var cache=this.__visibility;var parent=widget;var value=false;while(parent){if(cache[parent.$$hash]!=null){value=cache[parent.$$hash];break;}if(parent.isRootWidget()){value=true;break;}if(!parent.shouldBeLayouted()){break;}parent=parent.$$parent;}while(widget&&widget!==parent){cache[widget.$$hash]=value;widget=widget.$$parent;}return value;},__getLevelGroupedWidgets:function(){this.__visibility={};this.__nesting={};var levels=[];var queue=this.__queue;var widget,level;for(var hash in queue){widget=queue[hash];if(this.isWidgetVisible(widget)){level=this.getNestingLevel(widget);if(!levels[level]){levels[level]={};}levels[level][hash]=widget;delete queue[hash];}}return levels;},__getSortedQueue:function(){var sortedQueue=[];var levels=this.__getLevelGroupedWidgets();for(var level=levels.length-1;level>=0;level--){if(!levels[level]){continue;}for(var hash in levels[level]){var widget=levels[level][hash];if(level==0||widget.isRootWidget()||widget.hasUserBounds()){sortedQueue.push(widget);widget.invalidateLayoutCache();continue;}var oldSizeHint=widget.getSizeHint(false);if(oldSizeHint){widget.invalidateLayoutCache();var newSizeHint=widget.getSizeHint();var hintChanged=(!widget.getBounds()||oldSizeHint.minWidth!==newSizeHint.minWidth||oldSizeHint.width!==newSizeHint.width||oldSizeHint.maxWidth!==newSizeHint.maxWidth||oldSizeHint.minHeight!==newSizeHint.minHeight||oldSizeHint.height!==newSizeHint.height||oldSizeHint.maxHeight!==newSizeHint.maxHeight);}else{hintChanged=true;}if(hintChanged){var parent=widget.getLayoutParent();if(!levels[level-1]){levels[level-1]={};}levels[level-1][parent.$$hash]=parent;}else{sortedQueue.push(widget);}}}return sortedQueue;}}});qx.Class.define("qx.util.DeferredCallManager",{extend:qx.core.Object,type:"singleton",construct:function(){this.__calls={};this.__timeoutWrapper=qx.lang.Function.bind(this.__timeout,this);this.__hasCalls=false;},members:{__timeoutId:null,__currentQueue:null,__calls:null,__hasCalls:null,schedule:function(deferredCall){if(this.__timeoutId==null){this.__timeoutId=window.setTimeout(this.__timeoutWrapper,0);}var callKey=deferredCall.toHashCode();if(this.__currentQueue&&this.__currentQueue[callKey]){return;}this.__calls[callKey]=deferredCall;this.__hasCalls=true;},cancel:function(deferredCall){var callKey=deferredCall.toHashCode();if(this.__currentQueue&&this.__currentQueue[callKey]){this.__currentQueue[callKey]=null;return;}delete this.__calls[callKey];if(qx.lang.Object.isEmpty(this.__calls)&&this.__timeoutId!=null){window.clearTimeout(this.__timeoutId);this.__timeoutId=null;}},__timeout:function(){this.__timeoutId=null;while(this.__hasCalls){this.__currentQueue=qx.lang.Object.copy(this.__calls);this.__calls={};this.__hasCalls=false;for(var key in this.__currentQueue){var call=this.__currentQueue[key];if(call){this.__currentQueue[key]=null;call.call();}}}this.__currentQueue=null;}},destruct:function(){if(this.__timeoutId!=null){window.clearTimeout(this.__timeoutId);}this._disposeFields("__timeoutWrapper","__calls");}});qx.Class.define("qx.util.DeferredCall",{extend:qx.core.Object,construct:function(callback,context){this.base(arguments);this.__callback=callback;this.__context=context||null;this.__manager=qx.util.DeferredCallManager.getInstance();},members:{__callback:null,__context:null,__manager:null,cancel:function(){this.__manager.cancel(this);},schedule:function(){this.__manager.schedule(this);},call:function(){this.__context?this.__callback.apply(this.__context):this.__callback();}},destruct:function(callback,context){this.cancel();this._disposeFields("__context","__callback","__manager");}});qx.Class.define("qx.html.Element",{extend:qx.core.Object,construct:function(tagName){this.base(arguments);this._nodeName=tagName||"div";},statics:{DEBUG:false,_modified:{},_visibility:{},_scroll:{},_actions:{},_supportedActions:["activate","focus","capture"],_scheduleFlush:function(job){qx.html.Element.__deferredCall.schedule();},_mshtmlVisibilitySort:qx.core.Variant.select("qx.client",{"mshtml":function(a,b){var al=a._element;var bl=b._element;if(al.contains(bl)){return 1;}if(bl.contains(al)){return -1;}return 0;},"default":null}),flush:function(){var obj;{};var later=[];var modified=this._modified;for(var hc in modified){obj=modified[hc];if(obj.__willBeSeeable()){if(obj._element&&qx.dom.Hierarchy.isRendered(obj._element)){later.push(obj);}else{{};obj.__flush();}delete modified[hc];}}for(var i=0,l=later.length;i<l;i++){obj=later[i];{};obj.__flush();}var visibility=this._visibility;if(qx.core.Variant.isSet("qx.client","mshtml")){var list=[];for(var hc in visibility){list.push(visibility[hc]);}if(list.length>1){list.sort(this._mshtmlVisibilitySort);visibility=this._visibility={};for(var i=0;i<list.length;i++){obj=list[i];visibility[obj.$$hash]=obj;}}}for(var hc in visibility){obj=visibility[hc];{};obj._element.style.display=obj._visible?"":"none";delete visibility[hc];}var scroll=this._scroll;for(var hc in scroll){obj=scroll[hc];var elem=obj._element;if(elem&&elem.offsetWidth){var done=true;if(obj.__lazyScrollX!=null){obj._element.scrollLeft=obj.__lazyScrollX;delete obj.__lazyScrollX;}if(obj.__lazyScrollY!=null){obj._element.scrollTop=obj.__lazyScrollY;delete obj.__lazyScrollY;}var intoViewX=obj.__lazyScrollIntoViewX;if(intoViewX!=null){var child=intoViewX.element.getDomElement();if(child&&child.offsetWidth){qx.bom.element.Scroll.intoViewX(child,elem,intoViewX.align);delete obj.__lazyScrollIntoViewX;}else{done=false;}}var intoViewY=obj.__lazyScrollIntoViewY;if(intoViewY!=null){var child=intoViewY.element.getDomElement();if(child&&child.offsetWidth){qx.bom.element.Scroll.intoViewY(child,elem,intoViewY.align);delete obj.__lazyScrollIntoViewY;}else{done=false;}}if(done){delete scroll[hc];}}}var post=this._actions;var actions=this._supportedActions;var action,element;for(var i=0,l=actions.length;i<l;i++){action=actions[i];if(post[action]){element=post[action]._element;if(element){qx.bom.Element[action](element);}delete post[action];}}qx.event.handler.Appear.refresh();}},members:{_element:null,_root:false,_included:true,_visible:true,_scheduleChildrenUpdate:function(){if(this._modifiedChildren){return;}this._modifiedChildren=true;qx.html.Element._modified[this.$$hash]=this;qx.html.Element._scheduleFlush("element");},_createDomElement:function(){return qx.bom.Element.create(this._nodeName);},__flush:function(){{};var children=this.__children;if(children){var length=children.length;var child;for(var i=0;i<length;i++){child=children[i];if(child._visible&&child._included&&!child._element){child.__flush();}}}if(!this._element){this._element=this._createDomElement();this._element.$$hash=this.$$hash;this._copyData(false);if(children&&length>0){this._insertChildren();}}else{this._syncData();if(this._modifiedChildren){this._syncChildren();}}delete this._modifiedChildren;},_insertChildren:function(){var children=this.__children;var length=children.length;var child;if(length>2){var domElement=document.createDocumentFragment();for(var i=0;i<length;i++){child=children[i];if(child._element&&child._included){domElement.appendChild(child._element);}}this._element.appendChild(domElement);}else{var domElement=this._element;for(var i=0;i<length;i++){child=children[i];if(child._element&&child._included){domElement.appendChild(child._element);}}}},_syncChildren:function(){var ObjectRegistry=qx.core.ObjectRegistry;var dataChildren=this.__children;var dataLength=dataChildren.length;var dataChild;var dataEl;var domParent=this._element;var domChildren=domParent.childNodes;var domPos=0;var domEl;var domOperations;for(var i=domChildren.length-1;i>=0;i--){domEl=domChildren[i];dataEl=ObjectRegistry.fromHashCode(domEl.$$hash);if(!dataEl||!dataEl._included||dataEl.__parent!==this){domParent.removeChild(domEl);{};}}for(var i=0;i<dataLength;i++){dataChild=dataChildren[i];if(dataChild._included){dataEl=dataChild._element;domEl=domChildren[domPos];if(!dataEl){continue;}if(dataEl!=domEl){if(domEl){domParent.insertBefore(dataEl,domEl);}else{domParent.appendChild(dataEl);}{};}domPos++;}}{};},_copyData:function(fromMarkup){var elem=this._element;var data=this.__attribValues;if(data){var Attribute=qx.bom.element.Attribute;for(var key in data){Attribute.set(elem,key,data[key]);}}var data=this.__styleValues;if(data){var Style=qx.bom.element.Style;if(fromMarkup){for(var key in data){Style.set(elem,key,data[key]);}}else{Style.setCss(elem,Style.compile(data));}}var data=this.__propertyValues;if(data){for(var key in data){this._applyProperty(key,data[key]);}}var data=this.__eventValues;if(data){qx.event.Registration.getManager(elem).importListeners(elem,data);delete this.__eventValues;}},_syncData:function(){var elem=this._element;var Attribute=qx.bom.element.Attribute;var Style=qx.bom.element.Style;var jobs=this.__attribJobs;if(jobs){var data=this.__attribValues;if(data){var value;for(var key in jobs){value=data[key];if(value!==undefined){Attribute.set(elem,key,value);}else{Attribute.reset(elem,key);}}}this.__attribJobs=null;}var jobs=this.__styleJobs;if(jobs){var data=this.__styleValues;if(data){var value;for(var key in jobs){value=data[key];if(value!==undefined){Style.set(elem,key,value);}else{Style.reset(elem,key);}}}this.__styleJobs=null;}var jobs=this.__propertyJobs;if(jobs){var data=this.__propertyValues;if(data){var value;for(var key in jobs){this._applyProperty(key,data[key]);}}this.__propertyJobs=null;}},__willBeSeeable:function(){var pa=this;while(pa){if(pa._root){return true;}if(!pa._included||!pa._visible){return false;}pa=pa.__parent;}return false;},__generateListenerId:function(type,listener,self,capture){var reg=qx.core.ObjectRegistry;var id="evt-"+type+"-"+reg.toHashCode(listener);if(self){id+="-"+reg.toHashCode(self);}if(capture){id+="-capture";}return id;},__addChildHelper:function(child){if(child.__parent===this){throw new Error("Child is already in: "+child);}if(child._root){throw new Error("Root elements could not be inserted into other ones.");}if(child.__parent){child.__parent.remove(child);}child.__parent=this;if(!this.__children){this.__children=[];}if(this._element){this._scheduleChildrenUpdate();}},__removeChildHelper:function(child){if(child.__parent!==this){throw new Error("Has no child: "+child);}if(this._element){this._scheduleChildrenUpdate();}delete child.__parent;},__moveChildHelper:function(child){if(child.__parent!==this){throw new Error("Has no child: "+child);}if(this._element){this._scheduleChildrenUpdate();}},getChildren:function(){return this.__children||null;},getChild:function(index){var children=this.__children;return children&&children[index]||null;},hasChildren:function(){var children=this.__children;return children&&children[0]!==undefined;},indexOf:function(child){var children=this.__children;return children?children.indexOf(child):-1;},hasChild:function(child){var children=this.__children;return children&&children.indexOf(child)!==-1;},add:function(varargs){if(arguments[1]){for(var i=0,l=arguments.length;i<l;i++){this.__addChildHelper(arguments[i]);}this.__children.push.apply(this.__children,arguments);}else{this.__addChildHelper(varargs);this.__children.push(varargs);}return this;},addAt:function(child,index){this.__addChildHelper(child);qx.lang.Array.insertAt(this.__children,child,index);return this;},remove:function(childs){var children=this.__children;if(!children){return;}if(arguments[1]){var child;for(var i=0,l=arguments.length;i<l;i++){child=arguments[i];this.__removeChildHelper(child);qx.lang.Array.remove(children,child);}}else{this.__removeChildHelper(childs);qx.lang.Array.remove(children,childs);}return this;},removeAt:function(index){var children=this.__children;if(!children){throw new Error("Has no children!");}var child=children[index];if(!child){throw new Error("Has no child at this position!");}this.__removeChildHelper(child);qx.lang.Array.removeAt(this.__children,index);return this;},removeAll:function(){var children=this.__children;if(children){for(var i=0,l=children.length;i<l;i++){this.__removeChildHelper(children[i]);}children.length=0;}return this;},getParent:function(){return this.__parent||null;},insertInto:function(parent,index){parent.__addChildHelper(this);if(index==null){parent.__children.push(this);}else{qx.lang.Array.insertAt(this.__children,this,index);}return this;},insertBefore:function(rel){var parent=rel.__parent;parent.__addChildHelper(this);qx.lang.Array.insertBefore(parent.__children,this,rel);return this;},insertAfter:function(rel){var parent=rel.__parent;parent.__addChildHelper(this);qx.lang.Array.insertAfter(parent.__children,this,rel);return this;},moveTo:function(index){var parent=this.__parent;parent.__moveChildHelper(this);var oldIndex=parent.__children.indexOf(this);if(oldIndex===index){throw new Error("Could not move to same index!");}else if(oldIndex<index){index--;}qx.lang.Array.removeAt(parent.__children,oldIndex);qx.lang.Array.insertAt(parent.__children,this,index);return this;},moveBefore:function(rel){var parent=this.__parent;return this.moveTo(parent.__children.indexOf(rel));},moveAfter:function(rel){var parent=this.__parent;return this.moveTo(parent.__children.indexOf(rel)+1);},free:function(){var parent=this.__parent;if(!parent){throw new Error("Has no parent to remove from.");}if(!parent.__children){return;}parent.__removeChildHelper(this);qx.lang.Array.remove(parent.__children,this);return this;},getDomElement:function(){return this._element||null;},getNodeName:function(){return this._nodeName;},useMarkup:function(html){if(this._element){throw new Error("Could not overwrite existing element!");}if(qx.core.Variant.isSet("qx.client","mshtml")){var helper=document.createElement("div");}else{var helper=qx.html.Element.__markupHelper;if(!helper){helper=qx.html.Element.__markupHelper=document.createElement("div");}}helper.innerHTML=html;this._element=helper.firstChild;this._element.$$hash=this.$$hash;this._copyData(true);return this._element;},useElement:function(elem){if(this._element){throw new Error("Could not overwrite existing element!");}this._element=elem;this._element.$$hash=this.$$hash;this._copyData(true);},isFocusable:function(){var tabIndex=this.getAttribute("tabIndex");if(tabIndex>=1){return true;}var focusable=qx.event.handler.Focus.FOCUSABLE_ELEMENTS;if(tabIndex>=0&&focusable[this._nodeName]){return true;}return false;},isNativelyFocusable:function(){return !!qx.event.handler.Focus.FOCUSABLE_ELEMENTS[this._nodeName];},include:function(){if(this._included){return;}delete this._included;if(this.__parent){this.__parent._scheduleChildrenUpdate();}return this;},exclude:function(){if(!this._included){return;}this._included=false;if(this.__parent){this.__parent._scheduleChildrenUpdate();}return this;},isIncluded:function(){return this._included===true;},show:function(){if(this._visible){return;}if(this._element){qx.html.Element._visibility[this.$$hash]=this;qx.html.Element._scheduleFlush("element");}if(this.__parent){this.__parent._scheduleChildrenUpdate();}delete this._visible;},hide:function(){if(!this._visible){return;}if(this._element){qx.html.Element._visibility[this.$$hash]=this;qx.html.Element._scheduleFlush("element");}this._visible=false;},isVisible:function(){return this._visible===true;},scrollChildIntoViewX:function(elem,align,direct){var thisEl=this._element;var childEl=elem.getDomElement();if(direct!==false&&thisEl&&thisEl.offsetWidth&&childEl&&childEl.offsetWidth){qx.bom.element.Scroll.intoViewX(childEl,thisEl,align);}else{this.__lazyScrollIntoViewX={element:elem,align:align};qx.html.Element._scroll[this.$$hash]=this;qx.html.Element._scheduleFlush("element");}delete this.__lazyScrollX;},scrollChildIntoViewY:function(elem,align,direct){var thisEl=this._element;var childEl=elem.getDomElement();if(direct!==false&&thisEl&&thisEl.offsetWidth&&childEl&&childEl.offsetWidth){qx.bom.element.Scroll.intoViewY(childEl,thisEl,align);}else{this.__lazyScrollIntoViewY={element:elem,align:align};qx.html.Element._scroll[this.$$hash]=this;qx.html.Element._scheduleFlush("element");}delete this.__lazyScrollY;},scrollToX:function(x,lazy){var thisEl=this._element;if(lazy!==true&&thisEl&&thisEl.offsetWidth){thisEl.scrollLeft=x;}else{this.__lazyScrollX=x;qx.html.Element._scroll[this.$$hash]=this;qx.html.Element._scheduleFlush("element");}delete this.__lazyScrollIntoViewX;},getScrollX:function(){var thisEl=this._element;if(thisEl){return thisEl.scrollLeft;}return this.__lazyScrollX||0;},scrollToY:function(y,lazy){var thisEl=this._element;if(lazy!==true&&thisEl&&thisEl.offsetWidth){thisEl.scrollTop=y;}else{this.__lazyScrollY=y;qx.html.Element._scroll[this.$$hash]=this;qx.html.Element._scheduleFlush("element");}delete this.__lazyScrollIntoViewY;},getScrollY:function(){var thisEl=this._element;if(thisEl){return thisEl.scrollTop;}return this.__lazyScrollY||0;},getSelection:function(){var el=this._element;if(el){return qx.bom.Selection.get(el);}return null;},getSelectionLength:function(){var el=this._element;if(el){return qx.bom.Selection.getLength(el);}return null;},setSelection:function(start,end){var el=this._element;if(el){qx.bom.Selection.set(el,start,end);}},clearSelection:function(){var el=this._element;if(el){qx.bom.Selection.clear(el);}},focus:function(){var el=this._element;if(el){return qx.bom.Element.focus(el);}qx.html.Element._actions.focus=this;qx.html.Element._scheduleFlush("element");},blur:function(){var el=this._element;if(el){qx.bom.Element.blur(el);}},activate:function(){var el=this._element;if(el){return qx.bom.Element.activate(el);}qx.html.Element._actions.activate=this;qx.html.Element._scheduleFlush("element");},deactivate:function(){var el=this._element;if(el){qx.bom.Element.deactivate(el);}},capture:function(){var el=this._element;if(el){return qx.bom.Element.capture(el);}qx.html.Element._actions.capture=this;qx.html.Element._scheduleFlush("element");},releaseCapture:function(){var el=this._element;if(el){qx.bom.Element.releaseCapture(el);}},setStyle:function(key,value,direct){if(!this.__styleValues){this.__styleValues={};}if(this.__styleValues[key]==value){return;}if(value==null){delete this.__styleValues[key];}else{this.__styleValues[key]=value;}if(this._element){if(direct){qx.bom.element.Style.set(this._element,key,value);return this;}if(!this.__styleJobs){this.__styleJobs={};}this.__styleJobs[key]=true;qx.html.Element._modified[this.$$hash]=this;qx.html.Element._scheduleFlush("element");}return this;},setStyles:function(map,direct){for(var key in map){this.setStyle(key,map[key],direct);}return this;},removeStyle:function(key,direct){this.setStyle(key,null,direct);},getStyle:function(key){return this.__styleValues?this.__styleValues[key]:null;},setAttribute:function(key,value,direct){if(!this.__attribValues){this.__attribValues={};}if(this.__attribValues[key]==value){return;}if(value==null){delete this.__attribValues[key];}else{this.__attribValues[key]=value;}if(this._element){if(direct){qx.bom.element.Attribute.set(this._element,key,value);return this;}if(!this.__attribJobs){this.__attribJobs={};}this.__attribJobs[key]=true;qx.html.Element._modified[this.$$hash]=this;qx.html.Element._scheduleFlush("element");}return this;},setAttributes:function(map,direct){for(var key in map){this.setAttribute(key,map[key],direct);}return this;},removeAttribute:function(key,direct){this.setAttribute(key,null,direct);},getAttribute:function(key){return this.__attribValues?this.__attribValues[key]:null;},_applyProperty:function(name,value){},_setProperty:function(key,value,direct){if(!this.__propertyValues){this.__propertyValues={};}if(this.__propertyValues[key]==value){return;}if(value==null){delete this.__propertyValues[key];}else{this.__propertyValues[key]=value;}if(this._element){if(direct){this._applyProperty(key,value);return this;}if(!this.__propertyJobs){this.__propertyJobs={};}this.__propertyJobs[key]=true;qx.html.Element._modified[this.$$hash]=this;qx.html.Element._scheduleFlush("element");}return this;},_removeProperty:function(key,direct){this._setProperty(key,null,direct);},_getProperty:function(key){return this.__propertyValues?this.__propertyValues[key]:null;},addListener:function(type,listener,self,capture){if(this.isDisposed()){return;}var msg;if(this._element){qx.event.Registration.addListener(this._element,type,listener,self,capture);}else{if(!this.__eventValues){this.__eventValues={};}var key=this.__generateListenerId(type,listener,self,capture);if(this.__eventValues[key]){this.warn("A listener of this configuration does already exist!");return false;}this.__eventValues[key]={type:type,listener:listener,self:self,capture:capture};}return this;},removeListener:function(type,listener,self,capture){if(this.isDisposed()){return;}var msg;if(this._element){qx.event.Registration.removeListener(this._element,type,listener,self,capture);}else{var key=this.__generateListenerId(type,listener,self,capture);if(!this.__eventValues||!this.__eventValues[key]){this.warn("A listener of this configuration does not exist!");return false;}delete this.__eventValues[key];}return this;},hasListener:function(type,capture){throw new Error("hasListener() needs implementation!");}},defer:function(statics){statics.__deferredCall=new qx.util.DeferredCall(statics.flush,statics);},destruct:function(){var el=this._element;if(el){qx.event.Registration.getManager(el).removeAllListeners(el);el.$$hash="";}if(!qx.core.ObjectRegistry.inShutDown){var parent=this.__parent;if(parent&&!parent.$$disposed){parent.remove(this);}}this._disposeArray("__children");this._disposeFields("__attribValues","__styleValues","__eventValues","__propertyValues","__attribJobs","__styleJobs","__propertyJobs","_element","__parent","__lazyScrollIntoViewX","__lazyScrollIntoViewY");}});qx.Class.define("qx.ui.core.queue.Manager",{statics:{__scheduled:false,__jobs:{},scheduleFlush:function(job){var self=qx.ui.core.queue.Manager;self.__jobs[job]=true;if(!self.__scheduled){self.__deferredCall.schedule();self.__scheduled=true;}},flush:function(){var self=qx.ui.core.queue.Manager;if(self.__inFlush){return;}self.__inFlush=true;self.__deferredCall.cancel();var jobs=self.__jobs;while(jobs.widget||jobs.appearance||jobs.decorator||jobs.layout){if(jobs.widget){delete jobs.widget;qx.ui.core.queue.Widget.flush();if(jobs.widget){continue;}}if(jobs.appearance){delete jobs.appearance;qx.ui.core.queue.Appearance.flush();if(jobs.appearance){continue;}}if(jobs.layout){delete jobs.layout;qx.ui.core.queue.Layout.flush();}}qx.ui.core.queue.Manager.__scheduled=false;if(jobs.element){delete jobs.element;qx.html.Element.flush();}if(jobs.dispose){delete jobs.dispose;qx.ui.core.queue.Dispose.flush();}self.__inFlush=false;}},defer:function(statics){statics.__deferredCall=new qx.util.DeferredCall(statics.flush);qx.html.Element._scheduleFlush=statics.scheduleFlush;qx.event.Registration.addListener(window,"useraction",statics.flush);}});qx.Class.define("qx.bom.element.Scroll",{statics:{intoViewX:function(element,stop,align){var parent=element.parentNode;var doc=qx.dom.Node.getDocument(element);var body=doc.body;var parentLocation,parentLeft,parentRight;var parentOuterWidth,parentClientWidth,parentScrollWidth;var parentLeftBorder,parentRightBorder,parentScrollBarWidth;var elementLocation,elementLeft,elementRight,elementWidth;var leftOffset,rightOffset,scrollDiff;var alignLeft=align==="left";var alignRight=align==="right";stop=stop?stop.parentNode:doc;while(parent&&parent!=stop){if(parent.scrollWidth>parent.clientWidth&&(parent===body||qx.bom.element.Overflow.getY(parent)!="visible")){if(parent===body){parentLeft=parent.scrollLeft;parentRight=parentLeft+qx.bom.Viewport.getWidth();parentOuterWidth=qx.bom.Viewport.getWidth();parentClientWidth=parent.clientWidth;parentScrollWidth=parent.scrollWidth;parentLeftBorder=0;parentRightBorder=0;parentScrollBarWidth=0;}else{parentLocation=qx.bom.element.Location.get(parent);parentLeft=parentLocation.left;parentRight=parentLocation.right;parentOuterWidth=parent.offsetWidth;parentClientWidth=parent.clientWidth;parentScrollWidth=parent.scrollWidth;parentLeftBorder=parseInt(qx.bom.element.Style.get(parent,"borderLeftWidth"),10)||0;parentRightBorder=parseInt(qx.bom.element.Style.get(parent,"borderRightWidth"),10)||0;parentScrollBarWidth=parentOuterWidth-parentClientWidth-parentLeftBorder-parentRightBorder;}elementLocation=qx.bom.element.Location.get(element);elementLeft=elementLocation.left;elementRight=elementLocation.right;elementWidth=element.offsetWidth;leftOffset=elementLeft-parentLeft-parentLeftBorder;rightOffset=elementRight-parentRight+parentRightBorder;scrollDiff=0;if(alignLeft){scrollDiff=leftOffset;}else if(alignRight){scrollDiff=rightOffset+parentScrollBarWidth;}else if(leftOffset<0||elementWidth>parentClientWidth){scrollDiff=leftOffset;}else if(rightOffset>0){scrollDiff=rightOffset+parentScrollBarWidth;}parent.scrollLeft+=scrollDiff;if(qx.bom.client.Engine.GECKO){qx.event.Registration.fireNonBubblingEvent(parent,"scroll");}}if(parent===body){break;}parent=parent.parentNode;}},intoViewY:function(element,stop,align){var parent=element.parentNode;var doc=qx.dom.Node.getDocument(element);var body=doc.body;var parentLocation,parentTop,parentBottom;var parentOuterHeight,parentClientHeight,parentScrollHeight;var parentTopBorder,parentBottomBorder,parentScrollBarHeight;var elementLocation,elementTop,elementBottom,elementHeight;var topOffset,bottomOffset,scrollDiff;var alignTop=align==="top";var alignBottom=align==="bottom";stop=stop?stop.parentNode:doc;while(parent&&parent!=stop){if(parent.scrollHeight>parent.clientHeight&&(parent===body||qx.bom.element.Overflow.getY(parent)!="visible")){if(parent===body){parentTop=parent.scrollTop;parentBottom=parentTop+qx.bom.Viewport.getHeight();parentOuterHeight=qx.bom.Viewport.getHeight();parentClientHeight=parent.clientHeight;parentScrollHeight=parent.scrollHeight;parentTopBorder=0;parentBottomBorder=0;parentScrollBarHeight=0;}else{parentLocation=qx.bom.element.Location.get(parent);parentTop=parentLocation.top;parentBottom=parentLocation.bottom;parentOuterHeight=parent.offsetHeight;parentClientHeight=parent.clientHeight;parentScrollHeight=parent.scrollHeight;parentTopBorder=parseInt(qx.bom.element.Style.get(parent,"borderTopWidth"),10)||0;parentBottomBorder=parseInt(qx.bom.element.Style.get(parent,"borderBottomWidth"),10)||0;parentScrollBarHeight=parentOuterHeight-parentClientHeight-parentTopBorder-parentBottomBorder;}elementLocation=qx.bom.element.Location.get(element);elementTop=elementLocation.top;elementBottom=elementLocation.bottom;elementHeight=element.offsetHeight;topOffset=elementTop-parentTop-parentTopBorder;bottomOffset=elementBottom-parentBottom+parentBottomBorder;scrollDiff=0;if(alignTop){scrollDiff=topOffset;}else if(alignBottom){scrollDiff=bottomOffset+parentScrollBarHeight;}else if(topOffset<0||elementHeight>parentClientHeight){scrollDiff=topOffset;}else if(bottomOffset>0){scrollDiff=bottomOffset+parentScrollBarHeight;}parent.scrollTop+=scrollDiff;if(qx.bom.client.Engine.GECKO){qx.event.Registration.fireNonBubblingEvent(parent,"scroll");}}if(parent===body){break;}parent=parent.parentNode;}},intoView:function(element,stop,alignX,alignY){this.intoViewX(element,stop,alignX);this.intoViewY(element,stop,alignY);}}});qx.Class.define("qx.bom.element.Location",{statics:{__style:function(elem,style){return qx.bom.element.Style.get(elem,style,qx.bom.element.Style.COMPUTED_MODE,false);},__num:function(elem,style){return parseInt(qx.bom.element.Style.get(elem,style,qx.bom.element.Style.COMPUTED_MODE,false),10)||0;},__computeScroll:function(elem){var left=0,top=0;if(elem.getBoundingClientRect){var win=qx.dom.Node.getWindow(elem);left-=qx.bom.Viewport.getScrollLeft(win);top-=qx.bom.Viewport.getScrollTop(win);}else{var body=qx.dom.Node.getDocument(elem).body;elem=elem.parentNode;while(elem&&elem!=body){left+=elem.scrollLeft;top+=elem.scrollTop;elem=elem.parentNode;}}return {left:left,top:top};},__computeBody:qx.core.Variant.select("qx.client",{"mshtml":function(elem){var doc=qx.dom.Node.getDocument(elem);var body=doc.body;var left=body.offsetLeft;var top=body.offsetTop;left-=body.parentNode.clientLeft;top-=body.parentNode.clientTop;if(doc.compatMode==="CSS1Compat"){left+=this.__num(body,"marginLeft");top+=this.__num(body,"marginTop");}return {left:left,top:top};},"webkit":function(elem){var doc=qx.dom.Node.getDocument(elem);var body=doc.body;var left=body.offsetLeft;var top=body.offsetTop;left+=this.__num(body,"borderLeftWidth");top+=this.__num(body,"borderTopWidth");if(doc.compatMode==="CSS1Compat"){left+=this.__num(body,"marginLeft");top+=this.__num(body,"marginTop");}return {left:left,top:top};},"gecko":function(elem){var body=qx.dom.Node.getDocument(elem).body;var left=body.offsetLeft;var top=body.offsetTop;if(qx.bom.element.BoxSizing.get(body)!=="border-box"){left+=this.__num(body,"borderLeftWidth");top+=this.__num(body,"borderTopWidth");if(!elem.getBoundingClientRect){var hasAbs;while(elem){if(this.__style(elem,"position")==="absolute"||this.__style(elem,"position")==="fixed"){hasAbs=true;break;}elem=elem.offsetParent;}if(!hasAbs){left+=this.__num(body,"borderLeftWidth");top+=this.__num(body,"borderTopWidth");}}}return {left:left,top:top};},"default":function(elem){var body=qx.dom.Node.getDocument(elem).body;var left=body.offsetLeft;var top=body.offsetTop;return {left:left,top:top};}}),__computeOffset:qx.core.Variant.select("qx.client",{"mshtml|webkit":function(elem){var doc=qx.dom.Node.getDocument(elem);if(elem.getBoundingClientRect){var rect=elem.getBoundingClientRect();var left=rect.left;var top=rect.top;if(doc.compatMode==="CSS1Compat"){left-=this.__num(elem,"borderLeftWidth");top-=this.__num(elem,"borderTopWidth");}}else{var left=elem.offsetLeft;var top=elem.offsetTop;elem=elem.offsetParent;var body=doc.body;while(elem&&elem!=body){left+=elem.offsetLeft;top+=elem.offsetTop;left+=this.__num(elem,"borderLeftWidth");top+=this.__num(elem,"borderTopWidth");elem=elem.offsetParent;}}return {left:left,top:top};},"gecko":function(elem){if(elem.getBoundingClientRect){var rect=elem.getBoundingClientRect();var left=Math.round(rect.left);var top=Math.round(rect.top);}else{var left=0;var top=0;var body=qx.dom.Node.getDocument(elem).body;var box=qx.bom.element.BoxSizing;if(box.get(elem)!=="border-box"){left-=this.__num(elem,"borderLeftWidth");top-=this.__num(elem,"borderTopWidth");}while(elem&&elem!==body){left+=elem.offsetLeft;top+=elem.offsetTop;if(box.get(elem)!=="border-box"){left+=this.__num(elem,"borderLeftWidth");top+=this.__num(elem,"borderTopWidth");}if(elem.parentNode&&this.__style(elem.parentNode,"overflow")!="visible"){left+=this.__num(elem.parentNode,"borderLeftWidth");top+=this.__num(elem.parentNode,"borderTopWidth");}elem=elem.offsetParent;}}return {left:left,top:top};},"default":function(elem){var left=0;var top=0;var body=qx.dom.Node.getDocument(elem).body;while(elem&&elem!==body){left+=elem.offsetLeft;top+=elem.offsetTop;elem=elem.offsetParent;}return {left:left,top:top};}}),get:function(elem,mode){var body=this.__computeBody(elem);if(elem.tagName=="BODY"){var left=body.left;var top=body.top;}else{var offset=this.__computeOffset(elem);var scroll=this.__computeScroll(elem);var left=offset.left+body.left-scroll.left;var top=offset.top+body.top-scroll.top;}var right=left+elem.offsetWidth;var bottom=top+elem.offsetHeight;if(mode){if(mode=="padding"||mode=="scroll"){var overX=qx.bom.element.Overflow.getX(elem);if(overX=="scroll"||overX=="auto"){right+=elem.scrollWidth-elem.offsetWidth+this.__num(elem,"borderLeftWidth")+this.__num(elem,"borderRightWidth");}var overY=qx.bom.element.Overflow.getY(elem);if(overY=="scroll"||overY=="auto"){bottom+=elem.scrollHeight-elem.offsetHeight+this.__num(elem,"borderTopWidth")+this.__num(elem,"borderBottomWidth");}}switch(mode){case "padding":left+=this.__num(elem,"paddingLeft");top+=this.__num(elem,"paddingTop");right-=this.__num(elem,"paddingRight");bottom-=this.__num(elem,"paddingBottom");case "scroll":left-=elem.scrollLeft;top-=elem.scrollTop;right-=elem.scrollLeft;bottom-=elem.scrollTop;case "border":left+=this.__num(elem,"borderLeftWidth");top+=this.__num(elem,"borderTopWidth");right-=this.__num(elem,"borderRightWidth");bottom-=this.__num(elem,"borderBottomWidth");break;case "margin":left-=this.__num(elem,"marginLeft");top-=this.__num(elem,"marginTop");right+=this.__num(elem,"marginRight");bottom+=this.__num(elem,"marginBottom");break;}}return {left:left,top:top,right:right,bottom:bottom};},getLeft:function(elem,mode){return this.get(elem,mode).left;},getTop:function(elem,mode){return this.get(elem,mode).top;},getRight:function(elem,mode){return this.get(elem,mode).right;},getBottom:function(elem,mode){return this.get(elem,mode).bottom;},getRelative:function(elem1,elem2,mode1,mode2){var loc1=this.get(elem1,mode1);var loc2=this.get(elem2,mode2);return {left:loc1.left-loc2.left,top:loc1.top-loc2.top,right:loc1.right-loc2.right,bottom:loc1.bottom-loc2.bottom};}}});qx.Class.define("qx.bom.Selection",{statics:{getSelectionObject:qx.core.Variant.select("qx.client",{"mshtml":function(documentNode){return documentNode.selection;},"default":function(documentNode){return qx.dom.Node.getWindow(documentNode).getSelection();}}),get:qx.core.Variant.select("qx.client",{"mshtml":function(node){var rng=qx.bom.Range.get(qx.dom.Node.getDocument(node));return rng.text;},"default":function(node){if(qx.dom.Node.isElement(node)&&(node.nodeName.toLowerCase()=="input"||node.nodeName.toLowerCase()=="textarea")){return node.value.substring(node.selectionStart,node.selectionEnd);}else{return qx.bom.Selection.getSelectionObject(qx.dom.Node.getDocument(node)).toString();}return null;}}),getLength:qx.core.Variant.select("qx.client",{"mshtml":function(node){var selectedValue=qx.bom.Selection.get(node);var split=qx.util.StringSplit.split(selectedValue,/\r\n/);return selectedValue.length-(split.length-1);},"opera":function(node){var selectedValue,selectedLength,split;if(qx.dom.Node.isElement(node)&&(node.nodeName.toLowerCase()=="input"||node.nodeName.toLowerCase()=="textarea")){var start=node.selectionStart;var end=node.selectionEnd;selectedValue=node.value.substring(start,end);selectedLength=end-start;}else{selectedValue=qx.bom.Selection.get(node);selectedLength=selectedValue.length;}split=qx.util.StringSplit.split(selectedValue,/\r\n/);return selectedLength-(split.length-1);},"default":function(node){if(qx.dom.Node.isElement(node)&&(node.nodeName.toLowerCase()=="input"||node.nodeName.toLowerCase()=="textarea")){return node.selectionEnd-node.selectionStart;}else{return qx.bom.Selection.get(node).length;}return null;}}),set:qx.core.Variant.select("qx.client",{"mshtml":function(node,start,end){var rng;if(qx.dom.Node.isDocument(node)){node=node.body;}if(qx.dom.Node.isElement(node)||qx.dom.Node.isText(node)){switch(node.nodeName.toLowerCase()){case "input":case "textarea":case "button":if(end===undefined){end=node.value.length;}if(start>=0&&start<=node.value.length&&end>=0&&end<=node.value.length){rng=qx.bom.Range.get(node);rng.collapse(true);rng.moveStart("character",start);rng.moveEnd("character",end);rng.select();return true;}break;case "#text":if(end===undefined){end=node.nodeValue.length;}if(start>=0&&start<=node.nodeValue.length&&end>=0&&end<=node.nodeValue.length){rng=qx.bom.Range.get(qx.dom.Node.getBodyElement(node));rng.moveToElementText(node.parentNode);rng.collapse(true);rng.moveStart("character",start);rng.moveEnd("character",end);rng.select();return true;}break;default:if(end===undefined){end=node.childNodes.length-1;}if(node.childNodes[start]&&node.childNodes[end]){rng=qx.bom.Range.get(qx.dom.Node.getBodyElement(node));rng.moveToElementText(node.childNodes[start]);rng.collapse(true);var newRng=qx.bom.Range.get(qx.dom.Node.getBodyElement(node));newRng.moveToElementText(node.childNodes[end]);rng.setEndPoint("EndToEnd",newRng);rng.select();return true;}}}return false;},"default":function(node,start,end){var nodeName=node.nodeName.toLowerCase();if(qx.dom.Node.isElement(node)&&(nodeName=="input"||nodeName=="textarea")){if(end===undefined){end=node.value.length;}if(start>=0&&start<=node.value.length&&end>=0&&end<=node.value.length){node.select();node.setSelectionRange(start,end);return true;}}else{var validBoundaries=false;var sel=qx.dom.Node.getWindow(node).getSelection();var rng=qx.bom.Range.get(node);if(qx.dom.Node.isText(node)){if(end===undefined){end=node.length;}if(start>=0&&start<node.length&&end>=0&&end<=node.length){validBoundaries=true;}}else if(qx.dom.Node.isElement(node)){if(end===undefined){end=node.childNodes.length-1;}if(start>=0&&node.childNodes[start]&&end>=0&&node.childNodes[end]){validBoundaries=true;}}else if(qx.dom.Node.isDocument(node)){node=node.body;if(end===undefined){end=node.childNodes.length-1;}if(start>=0&&node.childNodes[start]&&end>=0&&node.childNodes[end]){validBoundaries=true;}}if(validBoundaries){if(!sel.isCollapsed){sel.collapseToStart();}rng.setStart(node,start);if(qx.dom.Node.isText(node)){rng.setEnd(node,end);}else{rng.setEndAfter(node.childNodes[end]);}if(sel.rangeCount>0){sel.removeAllRanges();}sel.addRange(rng);return true;}}return false;}}),setAll:function(node){return qx.bom.Selection.set(node,0);},clear:qx.core.Variant.select("qx.client",{"mshtml":function(node){var sel=qx.bom.Selection.getSelectionObject(qx.dom.Node.getDocument(node));var rng=qx.bom.Range.get(node);var parent=rng.parentElement();var documentRange=qx.bom.Range.get(qx.dom.Node.getDocument(node));if(parent==documentRange.parentElement()&&parent==node){sel.empty();}},"default":function(node){var sel=qx.bom.Selection.getSelectionObject(qx.dom.Node.getDocument(node));var nodeName=node.nodeName.toLowerCase();if(qx.dom.Node.isElement(node)&&(nodeName=="input"||nodeName=="textarea")){node.setSelectionRange(0,0);qx.bom.Element.blur(node);}else if(qx.dom.Node.isDocument(node)||nodeName=="body"){sel.collapse(node.body?node.body:node,0);}else{var rng=qx.bom.Range.get(node);if(!rng.collapsed){var compareNode;var commonAncestor=rng.commonAncestorContainer;if(qx.dom.Node.isElement(node)&&qx.dom.Node.isText(commonAncestor)){compareNode=commonAncestor.parentNode;}else{compareNode=commonAncestor;}if(compareNode==node){sel.collapse(node,0);}}}}})}});qx.Class.define("qx.bom.Range",{statics:{get:qx.core.Variant.select("qx.client",{"mshtml":function(node){if(qx.dom.Node.isElement(node)){switch(node.nodeName.toLowerCase()){case "input":switch(node.type){case "text":case "password":case "hidden":case "button":case "reset":case "file":case "submit":return node.createTextRange();break;default:return qx.bom.Selection.getSelectionObject(qx.dom.Node.getDocument(node)).createRange();}break;case "textarea":case "body":case "button":return node.createTextRange();break;default:return qx.bom.Selection.getSelectionObject(qx.dom.Node.getDocument(node)).createRange();}}else{return qx.bom.Selection.getSelectionObject(qx.dom.Node.getDocument(node)).createRange();}},"default":function(node){var doc=qx.dom.Node.getDocument(node);var sel=qx.bom.Selection.getSelectionObject(doc);if(sel.rangeCount>0){return sel.getRangeAt(0);}else{return doc.createRange();}}})}});qx.Bootstrap.define("qx.util.StringSplit",{statics:{split:function(string,separator,limit){var flags="";if(separator===undefined){return [string.toString()];}else if(separator===null||separator.constructor!==RegExp){separator=new RegExp(String(separator).replace(/[.*+?^${}()|[\]\/\\]/g,"\\$&"),"g");}else{flags=separator.toString().replace(/^[\S\s]+\//,"");if(!separator.global){separator=new RegExp(separator.source,"g"+flags);}}var separator2=new RegExp("^"+separator.source+"$",flags);if(limit===undefined||+limit<0){limit=false;}else{limit=Math.floor(+limit);if(!limit){return [];}}var match,output=[],lastLastIndex=0,i=0;while((limit?i++<=limit:true)&&(match=separator.exec(string))){if((match[0].length===0)&&(separator.lastIndex>match.index)){separator.lastIndex--;}if(separator.lastIndex>lastLastIndex){if(match.length>1){match[0].replace(separator2,function(){for(var j=1;j<arguments.length-2;j++){if(arguments[j]===undefined){match[j]=undefined;}}});}output=output.concat(string.substring(lastLastIndex,match.index),(match.index===string.length?[]:match.slice(1)));lastLastIndex=separator.lastIndex;}if(match[0].length===0){separator.lastIndex++;}}return (lastLastIndex===string.length)?(separator.test("")?output:output.concat("")):(limit?output:output.concat(string.substring(lastLastIndex)));}}});qx.Class.define("qx.ui.core.queue.Widget",{statics:{__queue:{},add:function(widget){var queue=this.__queue;if(queue[widget.$$hash]){return;}queue[widget.$$hash]=widget;qx.ui.core.queue.Manager.scheduleFlush("widget");},flush:function(){var queue=this.__queue;var obj;for(var hash in queue){obj=queue[hash];delete queue[hash];obj.syncWidget();}for(var hash in queue){return;}this.__queue={};}}});qx.Class.define("qx.ui.core.queue.Appearance",{statics:{__queue:{},add:function(widget){var queue=this.__queue;if(queue[widget.$$hash]){return;}queue[widget.$$hash]=widget;qx.ui.core.queue.Manager.scheduleFlush("appearance");},flush:function(){var queue=this.__queue;var obj;for(var hash in queue){obj=queue[hash];delete queue[hash];obj.syncAppearance();}for(var hash in queue){return;}this.__queue={};}}});qx.Class.define("qx.ui.core.queue.Dispose",{statics:{__queue:{},add:function(widget){var queue=this.__queue;if(queue[widget.$$hash]){return;}queue[widget.$$hash]=widget;qx.ui.core.queue.Manager.scheduleFlush("dispose");},flush:function(){var queue=this.__queue;for(var hash in queue){queue[hash].dispose();delete queue[hash];}for(var hash in queue){return;}this.__queue={};}}});qx.Class.define("qx.ui.core.EventHandler",{extend:qx.core.Object,implement:qx.event.IEventHandler,construct:function(){this.base(arguments);this.__manager=qx.event.Registration.getManager();},statics:{PRIORITY:qx.event.Registration.PRIORITY_FIRST,SUPPORTED_TYPES:{mousemove:1,mouseover:1,mouseout:1,mousedown:1,mouseup:1,click:1,dblclick:1,contextmenu:1,mousewheel:1,keyup:1,keydown:1,keypress:1,keyinput:1,capture:1,losecapture:1,focusin:1,focusout:1,focus:1,blur:1,activate:1,deactivate:1,appear:1,disappear:1,dragstart:1,dragend:1,dragover:1,dragleave:1,drop:1,drag:1,dragchange:1,droprequest:1},IGNORE_CAN_HANDLE:false},members:{__manager:null,__focusEvents:{focusin:1,focusout:1,focus:1,blur:1},__ignoreDisabled:{mouseover:1,mouseout:1,appear:1,disappear:1},canHandleEvent:function(target,type){return target instanceof qx.ui.core.Widget;},_dispatchEvent:function(domEvent){var domTarget=domEvent.getTarget();var widgetTarget=qx.ui.core.Widget.getWidgetByElement(domTarget,true);while(widgetTarget&&widgetTarget.isAnonymous()){widgetTarget=widgetTarget.getLayoutParent();}if(!widgetTarget){return;}if(this.__focusEvents[domEvent.getType()]){widgetTarget=widgetTarget.getFocusTarget();if(!widgetTarget){return;}}if(domEvent.getRelatedTarget){var domRelatedTarget=domEvent.getRelatedTarget();var widgetRelatedTarget=qx.ui.core.Widget.getWidgetByElement(domRelatedTarget);while(widgetRelatedTarget&&widgetRelatedTarget.isAnonymous()){widgetRelatedTarget=widgetRelatedTarget.getLayoutParent();}if(widgetRelatedTarget){if(this.__focusEvents[domEvent.getType()]){widgetRelatedTarget=widgetRelatedTarget.getFocusTarget();}if(widgetRelatedTarget===widgetTarget){return;}}}var currentTarget=domEvent.getCurrentTarget();var currentWidget=qx.ui.core.Widget.getWidgetByElement(currentTarget);if(!currentWidget||currentWidget.isAnonymous()){return;}if(this.__focusEvents[domEvent.getType()]){currentWidget=currentWidget.getFocusTarget();}var type=domEvent.getType();if(!(currentWidget.isEnabled()||this.__ignoreDisabled[type])){return;}var capture=domEvent.getEventPhase()==qx.event.type.Event.CAPTURING_PHASE;var listeners=this.__manager.getListeners(currentWidget,type,capture);if(!listeners||listeners.length===0){return;}var widgetEvent=qx.event.Pool.getInstance().getObject(domEvent.constructor);domEvent.clone(widgetEvent);widgetEvent.setTarget(widgetTarget);widgetEvent.setRelatedTarget(widgetRelatedTarget||null);widgetEvent.setCurrentTarget(widgetTarget);var orig=domEvent.getOriginalTarget();if(orig){var widgetOriginalTarget=qx.ui.core.Widget.getWidgetByElement(orig);while(widgetOriginalTarget&&widgetOriginalTarget.isAnonymous()){widgetOriginalTarget=widgetOriginalTarget.getLayoutParent();}widgetEvent.setOriginalTarget(widgetOriginalTarget);}else{widgetEvent.setOriginalTarget(domTarget);}for(var i=0,l=listeners.length;i<l;i++){var context=listeners[i].context||currentWidget;listeners[i].handler.call(context,widgetEvent);}if(widgetEvent.getPropagationStopped()){domEvent.stopPropagation();}if(widgetEvent.getDefaultPrevented()){domEvent.preventDefault();}qx.event.Pool.getInstance().poolObject(widgetEvent);},registerEvent:function(target,type,capture){var elem;if(type==="focus"||type==="blur"){elem=target.getFocusElement();}else if(type==="load"||type==="input"){elem=target.getContentElement();}else{elem=target.getContainerElement();}if(elem){elem.addListener(type,this._dispatchEvent,this,capture);}},unregisterEvent:function(target,type,capture){var elem;if(type==="focus"||type==="blur"){elem=target.getFocusElement();}else if(type==="load"||type==="input"){elem=target.getContentElement();}else{elem=target.getContainerElement();}if(elem){elem.removeListener(type,this._dispatchEvent,this,capture);}}},destruct:function(){this._disposeFields("__manager");},defer:function(statics){qx.event.Registration.addHandler(statics);}});qx.Class.define("qx.ui.basic.Image",{extend:qx.ui.core.Widget,construct:function(source){this.base(arguments);if(source){this.setSource(source);}},properties:{source:{check:"String",init:null,nullable:true,event:"changeSource",apply:"_applySource",themeable:true},scale:{check:"Boolean",init:false,themeable:true,apply:"_applyScale"},appearance:{refine:true,init:"image"},allowShrinkX:{refine:true,init:false},allowShrinkY:{refine:true,init:false},allowGrowX:{refine:true,init:false},allowGrowY:{refine:true,init:false}},members:{__width:null,__height:null,_createContentElement:function(){return new qx.html.Image();},_getContentHint:function(){return {width:this.__width||0,height:this.__height||0};},_applyEnabled:function(value,old){this.base(arguments,value,old);if(this.getSource()){this._styleSource();}},_applySource:function(value){this._styleSource();},_applyScale:function(value){var el=this.getContentElement();el.setScale(value);},_styleSource:function(){var source=qx.util.AliasManager.getInstance().resolve(this.getSource());var el=this.getContentElement();if(!source){el.resetSource();return;}var ResourceManager=qx.util.ResourceManager;var ImageLoader=qx.io2.ImageLoader;if(ResourceManager.has(source)){if(!this.getEnabled()){var disabled=source.replace(/\.([a-z]+)$/,"-disabled.$1");if(ResourceManager.has(disabled)){source=disabled;this.addState("replacement");}else{this.removeState("replacement");}}if(el.getSource()===source){return;}el.setSource(source);this._updateSize(ResourceManager.getImageWidth(source),ResourceManager.getImageHeight(source));}else if(ImageLoader.isLoaded(source)){el.setSource(source);var width=ImageLoader.getWidth(source);var height=ImageLoader.getHeight(source);this._updateSize(width,height);}else{var self;if(!qx.io2.ImageLoader.isFailed(source)){qx.io2.ImageLoader.load(source,this.__loaderCallback,this);}}},__loaderCallback:function(source,size){if(source!==qx.util.AliasManager.getInstance().resolve(this.getSource())){return;}if(!size){this.warn("Image could not be loaded: "+source);return;}this._styleSource();},_updateSize:function(width,height){if(width!==this.__width||height!==this.__height){this.__width=width;this.__height=height;qx.ui.core.queue.Layout.add(this);}}}});qx.Mixin.define("qx.ui.core.MPlacement",{properties:{position:{check:["top-left","top-right","bottom-left","bottom-right","left-top","left-bottom","right-top","right-bottom"],init:"bottom-left",themeable:true},domMove:{check:"Boolean",init:false},smart:{check:"Boolean",init:true,themeable:true},offsetLeft:{check:"Integer",init:0,themeable:true},offsetTop:{check:"Integer",init:0,themeable:true},offsetRight:{check:"Integer",init:0,themeable:true},offsetBottom:{check:"Integer",init:0,themeable:true},offset:{group:["offsetTop","offsetRight","offsetBottom","offsetLeft"],mode:"shorthand",themeable:true}},members:{getLayoutLocation:function(widget){var insets,bounds,left,top;bounds=widget.getBounds();left=bounds.left;top=bounds.top;var size=bounds;widget=widget.getLayoutParent();while(widget&&!widget.isRootWidget()){bounds=widget.getBounds();left+=bounds.left;top+=bounds.top;insets=widget.getInsets();left+=insets.left;top+=insets.top;widget=widget.getLayoutParent();}if(widget.isRootWidget()){var rootCoords=widget.getContainerLocation();if(rootCoords){left+=rootCoords.left;top+=rootCoords.top;}}return {left:left,top:top,right:left+size.width,bottom:top+size.height};},moveTo:function(left,top){if(this.getDomMove()){this.setDomPosition(left,top);}else{this.setLayoutProperties({left:left,top:top});}},placeToWidget:function(target){var coords=target.getContainerLocation()||this.getLayoutLocation(target);this.__place(coords);},placeToMouse:function(event){var left=event.getDocumentLeft();var top=event.getDocumentTop();var coords={left:left,top:top,right:left,bottom:top};this.__place(coords);},placeToElement:function(elem){var location=qx.bom.element.Location.get(elem);var coords={left:location.left,top:location.top,right:location.left+elem.offsetWidth,bottom:location.top+elem.offsetHeight};this.__place(coords);},placeToPoint:function(point){var coords={left:point.left,top:point.top,right:point.left,bottom:point.top};this.__place(coords);},__place:function(coords){var size=this.getSizeHint();var area=this.getLayoutParent().getBounds();var position=this.getPosition();var smart=this.getSmart();var offsets={left:this.getOffsetLeft(),top:this.getOffsetTop(),right:this.getOffsetRight(),bottom:this.getOffsetBottom()};var result=qx.util.PlaceUtil.compute(size,area,coords,position,smart,offsets);this.moveTo(result.left,result.top);}}});qx.Class.define("qx.ui.core.DragDropCursor",{extend:qx.ui.basic.Image,include:qx.ui.core.MPlacement,type:"singleton",construct:function(){this.base(arguments);this.setZIndex(1e8);this.setDomMove(true);var root=this.getApplicationRoot();root.add(this,{left:-1000,top:-1000});},properties:{appearance:{refine:true,init:"dragdrop-cursor"},action:{check:["alias","copy","move"],apply:"_applyAction",nullable:true}},members:{_applyAction:function(value,old){if(old){this.removeState(old);}if(value){this.addState(value);}}}});qx.Class.define("qx.html.Image",{extend:qx.html.Element,members:{_applyProperty:function(name,value){this.base(arguments,name,value);if(name==="source"){var elem=this._element;var source=this._getProperty("source");var scale=this._getProperty("scale");var repeat=scale?"scale":"no-repeat";qx.bom.element.Decoration.update(elem,source,repeat);}},_createDomElement:function(){var scale=this._getProperty("scale");var repeat=scale?"scale":"no-repeat";this._nodeName=qx.bom.element.Decoration.getTagName(repeat);return this.base(arguments);},_copyData:function(fromMarkup){return this.base(arguments,true);},setSource:function(value){this._setProperty("source",value);return this;},getSource:function(){return this._getProperty("source");},resetSource:function(){this._removeProperty("source");return this;},setScale:function(value){this._setProperty("scale",value);return this;},getScale:function(){return this._getProperty("scale");}}});qx.Class.define("qx.util.PlaceUtil",{statics:{compute:function(size,area,target,position,smart,offsets){var left=0;var top=0;var fixedRatingX,fixedRatingY;var splitted=position.split("-");var edge=splitted[0];var align=splitted[1];var offsetLeft=0,offsetTop=0,offsetRight=0,offsetBottom=0;if(offsets){offsetLeft+=offsets.left||0;offsetTop+=offsets.top||0;offsetRight+=offsets.right||0;offsetBottom+=offsets.bottom||0;}switch(edge){case "left":left=target.left-size.width-offsetLeft;break;case "top":top=target.top-size.height-offsetTop;break;case "right":left=target.right+offsetRight;break;case "bottom":top=target.bottom+offsetBottom;break;}switch(align){case "left":left=target.left;break;case "top":top=target.top;break;case "right":left=target.right-size.width;break;case "bottom":top=target.bottom-size.height;break;}if(smart===false){return {left:left,top:top};}else{var ratingX=Math.min(left,area.width-left-size.width);if(ratingX<0){var fixedLeft=left;if(left<0){if(edge=="left"){fixedLeft=target.right+offsetRight;}else if(align=="right"){fixedLeft=target.left;}}else{if(edge=="right"){fixedLeft=target.left-size.width-offsetLeft;}else if(align=="left"){fixedLeft=target.right-size.width;}}fixedRatingX=Math.min(fixedLeft,area.width-fixedLeft-size.width);if(fixedRatingX>ratingX){left=fixedLeft;ratingX=fixedRatingX;}}var ratingY=Math.min(top,area.height-top-size.height);if(ratingY<0){var fixedTop=top;if(top<0){if(edge=="top"){fixedTop=target.bottom+offsetBottom;}else if(align=="bottom"){fixedTop=target.top;}}else{if(edge=="bottom"){fixedTop=target.top-size.height-offsetTop;}else if(align=="top"){fixedTop=target.bottom-size.height;}}fixedRatingY=Math.min(fixedTop,area.height-fixedTop-size.height);if(fixedRatingY>ratingY){top=fixedTop;ratingY=fixedRatingY;}}return {left:left,top:top,ratingX:ratingX,ratingY:ratingY};}}}});qx.Class.define("qx.ui.core.FocusHandler",{extend:qx.core.Object,type:"singleton",construct:function(){this.base(arguments);this.__roots={};},members:{__roots:null,__activeChild:null,__focusedChild:null,__currentRoot:null,connectTo:function(root){root.addListener("keypress",this.__onKeyPress,this);root.addListener("focusin",this._onFocusIn,this,true);root.addListener("focusout",this._onFocusOut,this,true);root.addListener("activate",this._onActivate,this,true);root.addListener("deactivate",this._onDeactivate,this,true);},addRoot:function(widget){this.__roots[widget.$$hash]=widget;},removeRoot:function(widget){delete this.__roots[widget.$$hash];},isActive:function(widget){return this.__activeChild==widget;},isFocused:function(widget){return this.__focusedChild==widget;},isFocusRoot:function(widget){!!this.__roots[widget.$$hash];},_onActivate:function(e){var target=e.getTarget();this.__activeChild=target;var root=this.__findFocusRoot(target);if(root!=this.__currentRoot){this.__currentRoot=root;}},_onDeactivate:function(e){var target=e.getTarget();if(this.__activeChild==target){this.__activeChild=null;}},_onFocusIn:function(e){var target=e.getTarget();if(target!=this.__focusedChild){this.__focusedChild=target;target.visualizeFocus();}},_onFocusOut:function(e){var target=e.getTarget();if(target==this.__focusedChild){this.__focusedChild=null;target.visualizeBlur();}},__onKeyPress:function(e){if(e.getKeyIdentifier()!="Tab"){return;}if(!this.__currentRoot){return;}e.stopPropagation();e.preventDefault();var current=this.__focusedChild;if(!e.isShiftPressed()){var next=current?this.__getWidgetAfter(current):this.__getFirstWidget();}else{var next=current?this.__getWidgetBefore(current):this.__getLastWidget();}if(next){next.tabFocus();}},__findFocusRoot:function(widget){var roots=this.__roots;while(widget){if(roots[widget.$$hash]){return widget;}widget=widget.getLayoutParent();}return null;},__compareTabOrder:function(widget1,widget2){if(widget1===widget2){return 0;}var tab1=widget1.getTabIndex()||0;var tab2=widget2.getTabIndex()||0;if(tab1!=tab2){return tab1-tab2;}var el1=widget1.getContainerElement().getDomElement();var el2=widget2.getContainerElement().getDomElement();var Location=qx.bom.element.Location;var loc1=Location.get(el1);var loc2=Location.get(el2);if(loc1.top!=loc2.top){return loc1.top-loc2.top;}if(loc1.left!=loc2.left){return loc1.left-loc2.left;}var z1=widget1.getZIndex();var z2=widget2.getZIndex();if(z1!=z2){return z1-z2;}return 0;},__getFirstWidget:function(){return this.__getFirst(this.__currentRoot,null);},__getLastWidget:function(){return this.__getLast(this.__currentRoot,null);},__getWidgetAfter:function(widget){var root=this.__currentRoot;if(root==widget){return this.__getFirstWidget();}while(widget&&widget.getAnonymous()){widget=widget.getLayoutParent();}if(widget==null){return [];}var result=[];this.__collectAllAfter(root,widget,result);result.sort(this.__compareTabOrder);var len=result.length;return len>0?result[0]:this.__getFirstWidget();},__getWidgetBefore:function(widget){var root=this.__currentRoot;if(root==widget){return this.__getLastWidget();}while(widget&&widget.getAnonymous()){widget=widget.getLayoutParent();}if(widget==null){return [];}var result=[];this.__collectAllBefore(root,widget,result);result.sort(this.__compareTabOrder);var len=result.length;return len>0?result[len-1]:this.__getLastWidget();},__collectAllAfter:function(parent,widget,result){var children=parent.getLayoutChildren();var child;for(var i=0,l=children.length;i<l;i++){child=children[i];if(!(child instanceof qx.ui.core.Widget)){continue;}if(!this.isFocusRoot(child)&&child.isEnabled()){if(child.isTabable()&&this.__compareTabOrder(widget,child)<0){result.push(child);}this.__collectAllAfter(child,widget,result);}}},__collectAllBefore:function(parent,widget,result){var children=parent.getLayoutChildren();var child;for(var i=0,l=children.length;i<l;i++){child=children[i];if(!(child instanceof qx.ui.core.Widget)){continue;}if(!this.isFocusRoot(child)&&child.isEnabled()){if(child.isTabable()&&this.__compareTabOrder(widget,child)>0){result.push(child);}this.__collectAllBefore(child,widget,result);}}},__getFirst:function(parent,firstWidget){var children=parent.getLayoutChildren();var child;for(var i=0,l=children.length;i<l;i++){child=children[i];if(!(child instanceof qx.ui.core.Widget)){continue;}if(!this.isFocusRoot(child)&&child.isEnabled()){if(child.isTabable()){if(firstWidget==null||this.__compareTabOrder(child,firstWidget)<0){firstWidget=child;}}firstWidget=this.__getFirst(child,firstWidget);}}return firstWidget;},__getLast:function(parent,lastWidget){var children=parent.getLayoutChildren();var child;for(var i=0,l=children.length;i<l;i++){child=children[i];if(!(child instanceof qx.ui.core.Widget)){continue;}if(!this.isFocusRoot(child)&&child.isEnabled()){if(child.isTabable()){if(lastWidget==null||this.__compareTabOrder(child,lastWidget)>0){lastWidget=child;}}lastWidget=this.__getLast(child,lastWidget);}}return lastWidget;}},destruct:function(){this._disposeMap("__roots");this._disposeFields("__focusedChild","__activeChild","__currentRoot");}});qx.Class.define("qx.bom.Stylesheet",{statics:{includeFile:function(href,doc){if(!doc){doc=document;}var el=doc.createElement("link");el.type="text/css";el.rel="stylesheet";el.href=qx.util.ResourceManager.toUri(href);var head=doc.getElementsByTagName("head")[0];head.appendChild(el);},createElement:qx.core.Variant.select("qx.client",{"mshtml":function(text){var sheet=document.createStyleSheet();if(text){sheet.cssText=text;}return sheet;},"default":function(text){var elem=document.createElement("style");elem.type="text/css";if(text){elem.appendChild(document.createTextNode(text));}document.getElementsByTagName("head")[0].appendChild(elem);return elem.sheet;}}),addRule:qx.core.Variant.select("qx.client",{"mshtml":function(sheet,selector,entry){sheet.addRule(selector,entry);},"default":function(sheet,selector,entry){sheet.insertRule(selector+"{"+entry+"}",sheet.cssRules.length);}}),removeRule:qx.core.Variant.select("qx.client",{"mshtml":function(sheet,selector){var rules=sheet.rules;var len=rules.length;for(var i=len-1;i>=0;--i){if(rules[i].selectorText==selector){sheet.removeRule(i);}}},"default":function(sheet,selector){var rules=sheet.cssRules;var len=rules.length;for(var i=len-1;i>=0;--i){if(rules[i].selectorText==selector){sheet.deleteRule(i);}}}}),removeAllRules:qx.core.Variant.select("qx.client",{"mshtml":function(sheet){var rules=sheet.rules;var len=rules.length;for(var i=len-1;i>=0;i--){sheet.removeRule(i);}},"default":function(sheet){var rules=sheet.cssRules;var len=rules.length;for(var i=len-1;i>=0;i--){sheet.deleteRule(i);}}}),addImport:qx.core.Variant.select("qx.client",{"mshtml":function(sheet,url){sheet.addImport(url);},"default":function(sheet,url){sheet.insertRule('@import "'+url+'";',sheet.cssRules.length);}}),removeImport:qx.core.Variant.select("qx.client",{"mshtml":function(sheet,url){var imports=sheet.imports;var len=imports.length;for(var i=len-1;i>=0;i--){if(imports[i].href==url){sheet.removeImport(i);}}},"default":function(sheet,url){var rules=sheet.cssRules;var len=rules.length;for(var i=len-1;i>=0;i--){if(rules[i].href==url){sheet.deleteRule(i);}}}}),removeAllImports:qx.core.Variant.select("qx.client",{"mshtml":function(sheet){var imports=sheet.imports;var len=imports.length;for(var i=len-1;i>=0;i--){sheet.removeImport(i);}},"default":function(sheet){var rules=sheet.cssRules;var len=rules.length;for(var i=len-1;i>=0;i--){if(rules[i].type==rules[i].IMPORT_RULE){sheet.deleteRule(i);}}}})}});qx.Class.define("qx.ui.layout.Abstract",{type:"abstract",extend:qx.core.Object,members:{__sizeHint:null,_invalidChildrenCache:null,__widget:null,invalidateLayoutCache:function(){this.__sizeHint=null;},renderLayout:function(availWidth,availHeight){this.warn("Missing renderLayout() implementation!");},getSizeHint:function(){if(this.__sizeHint){return this.__sizeHint;}return this.__sizeHint=this._computeSizeHint();},_computeSizeHint:function(){return null;},invalidateChildrenCache:function(){this._invalidChildrenCache=true;},verifyLayoutProperty:null,_clearSeparators:function(){var widget=this.__widget;if(widget instanceof qx.ui.core.LayoutItem){widget.clearSeparators();}},_renderSeparator:function(separator,bounds){this.__widget.renderSeparator(separator,bounds);},connectToWidget:function(widget){if(widget&&this.__widget){throw new Error("It is not possible to manually set the connected widget.");}this.__widget=widget;this.invalidateChildrenCache();},_applyLayoutChange:function(){if(this.__widget){this.__widget.scheduleLayoutUpdate();}},_getLayoutChildren:function(){return this.__widget.getLayoutChildren();}},destruct:function(){this._disposeFields("__widget","__sizeHint");}});qx.Class.define("qx.ui.layout.Canvas",{extend:qx.ui.layout.Abstract,members:{verifyLayoutProperty:null,renderLayout:function(availWidth,availHeight){var children=this._getLayoutChildren();var child,size,props;var left,top,right,bottom,width,height;var marginTop,marginRight,marginBottom,marginLeft;for(var i=0,l=children.length;i<l;i++){child=children[i];size=child.getSizeHint();props=child.getLayoutProperties();marginTop=child.getMarginTop();marginRight=child.getMarginRight();marginBottom=child.getMarginBottom();marginLeft=child.getMarginLeft();left=props.left!=null?props.left:props.edge;if(left&&typeof left==="string"){left=Math.round(parseFloat(left)*availWidth/100);}right=props.right!=null?props.right:props.edge;if(right&&typeof right==="string"){right=Math.round(parseFloat(right)*availWidth/100);}top=props.top!=null?props.top:props.edge;if(top&&typeof top==="string"){top=Math.round(parseFloat(top)*availHeight/100);}bottom=props.bottom!=null?props.bottom:props.edge;if(bottom&&typeof bottom==="string"){bottom=Math.round(parseFloat(bottom)*availHeight/100);}if(left!=null&&right!=null){width=availWidth-left-right-marginLeft-marginRight;if(width<size.minWidth){width=size.minWidth;}else if(width>size.maxWidth){width=size.maxWidth;}left+=marginLeft;}else{width=props.width;if(width==null){width=size.width;}else{width=Math.round(parseFloat(width)*availWidth/100);if(width<size.minWidth){width=size.minWidth;}else if(width>size.maxWidth){width=size.maxWidth;}}if(right!=null){left=availWidth-width-right-marginRight-marginLeft;}else if(left==null){left=marginLeft;}else{left+=marginLeft;}}if(top!=null&&bottom!=null){height=availHeight-top-bottom-marginTop-marginBottom;if(height<size.minHeight){height=size.minHeight;}else if(height>size.maxHeight){height=size.maxHeight;}top+=marginTop;}else{height=props.height;if(height==null){height=size.height;}else{height=Math.round(parseFloat(height)*availHeight/100);if(height<size.minHeight){height=size.minHeight;}else if(height>size.maxHeight){height=size.maxHeight;}}if(bottom!=null){top=availHeight-height-bottom-marginBottom-marginTop;}else if(top==null){top=marginTop;}else{top+=marginTop;}}child.renderLayout(left,top,width,height);}},_computeSizeHint:function(){var neededWidth=0,neededMinWidth=0;var neededHeight=0,neededMinHeight=0;var width,minWidth;var height,minHeight;var children=this._getLayoutChildren();var child,props,hint;var left,top,right,bottom;for(var i=0,l=children.length;i<l;i++){child=children[i];props=child.getLayoutProperties();hint=child.getSizeHint();var marginX=child.getMarginLeft()+child.getMarginRight();var marginY=child.getMarginTop()+child.getMarginBottom();width=hint.width+marginX;minWidth=hint.minWidth+marginX;left=props.left!=null?props.left:props.edge;if(left&&typeof left==="number"){width+=left;minWidth+=left;}right=props.right!=null?props.right:props.edge;if(right&&typeof right==="number"){width+=right;minWidth+=right;}neededWidth=Math.max(neededWidth,width);neededMinWidth=Math.max(neededMinWidth,minWidth);height=hint.height+marginY;minHeight=hint.minHeight+marginY;top=props.top!=null?props.top:props.edge;if(top&&typeof top==="number"){height+=top;minHeight+=top;}bottom=props.bottom!=null?props.bottom:props.edge;if(bottom&&typeof bottom==="number"){height+=bottom;minHeight+=bottom;}neededHeight=Math.max(neededHeight,height);neededMinHeight=Math.max(neededMinHeight,minHeight);}return {width:neededWidth,minWidth:neededMinWidth,height:neededHeight,minHeight:neededMinHeight};}}});qx.Class.define("qx.html.Root",{extend:qx.html.Element,construct:function(elem){this.base(arguments);if(elem!=null){this.useElement(elem);}},members:{useElement:function(elem){if(this._element){throw new Error("Elements could not be replaced!");}elem.$$hash=this.$$hash;this._element=elem;this._root=true;qx.html.Element._modified[this.$$hash]=this;}}});qx.Bootstrap.define("qx.bom.client.Locale",{statics:{LOCALE:"",VARIANT:"",__init:function(){var locale=(qx.bom.client.Engine.MSHTML?navigator.userLanguage:navigator.language).toLowerCase();var variant="";var index=locale.indexOf("-");if(index!=-1){variant=locale.substr(index+1);locale=locale.substr(0,index);}this.LOCALE=locale;this.VARIANT=variant;}},defer:function(statics){statics.__init();}});qx.Class.define("qx.core.BaseString",{extend:String,construct:function(txt){{};this._txt=txt;},members:{toString:function(){return this._txt;},valueOf:function(){return this._txt;},toHashCode:function(){return qx.core.ObjectRegistry.toHashCode(this);},base:function(args,varags){return qx.core.Object.prototype.base.apply(this,arguments);}},defer:function(statics){{};}});qx.Class.define("qx.locale.LocalizedString",{extend:qx.core.BaseString,construct:function(translation,messageId,args){this.base(arguments,translation);this.__messageId=messageId;this.__args=args;},members:{translate:function(){return qx.locale.Manager.getInstance().translate(this.__messageId,this.__args);}}});qx.Class.define("qx.locale.Manager",{type:"singleton",extend:qx.core.Object,construct:function(){this.base(arguments);this.__translations=window.qxtranslations||{};this.__locales=window.qxlocales||{};var clazz=qx.bom.client.Locale;var locale=clazz.LOCALE;var variant=clazz.VARIANT;if(variant!==""){locale+="_"+variant;}this.setLocale(locale||this._defaultLocale);},statics:{tr:function(messageId,varargs){var args=qx.lang.Array.fromArguments(arguments);args.splice(0,1);return qx.locale.Manager.getInstance().translate(messageId,args);},trn:function(singularMessageId,pluralMessageId,count,varargs){var args=qx.lang.Array.fromArguments(arguments);args.splice(0,3);if(count!=1){return qx.locale.Manager.getInstance().translate(pluralMessageId,args);}else{return qx.locale.Manager.getInstance().translate(singularMessageId,args);}},trc:function(hint,messageId,varargs){var args=qx.lang.Array.fromArguments(arguments);args.splice(0,2);return qx.locale.Manager.getInstance().translate(messageId,args);},marktr:function(messageId){return messageId;}},properties:{locale:{check:"String",nullable:true,apply:"_applyLocale",event:"changeLocale"}},members:{_defaultLocale:"C",getLanguage:function(){return this._language;},getTerritory:function(){return this.getLocale().split("_")[1]||"";},getAvailableLocales:function(){var locales=[];for(var locale in this.__locales){if(locale!=this._defaultLocale){locales.push(locale);}}return locales;},__extractLanguage:function(locale){var language;var pos=locale.indexOf("_");if(pos==-1){language=locale;}else{language=locale.substring(0,pos);}return language;},_applyLocale:function(value,old){this._locale=value;this._language=this.__extractLanguage(value);},addTranslation:function(languageCode,translationMap){var catalog=this.__translations;if(catalog[languageCode]){for(var key in translationMap){catalog[languageCode][key]=translationMap[key];}}else{catalog[languageCode]=translationMap;}},translate:function(messageId,args,locale){var txt;var catalog=this.__translations;if(!catalog){return messageId;}if(locale){var language=this.__extractLanguage(locale);}else{locale=this._locale;language=this._language;}if(!txt&&catalog[locale]){txt=catalog[locale][messageId];}if(!txt&&catalog[language]){txt=catalog[language][messageId];}if(!txt&&catalog[this._defaultLocale]){txt=catalog[this._defaultLocale][messageId];}if(!txt){txt=messageId;}if(args.length>0){var translatedArgs=[];for(var i=0;i<args.length;i++){var arg=args[i];if(arg.translate){translatedArgs[i]=arg.translate();}else{translatedArgs[i]=arg;}}txt=qx.lang.String.format(txt,translatedArgs);}if(qx.core.Variant.isSet("qx.dynamicLocaleSwitch","on")){txt=new qx.locale.LocalizedString(txt,messageId,args);}return txt;},localize:function(messageId,args,locale){var txt;var catalog=this.__locales;if(!catalog){return messageId;}if(locale){var language=this.__extractLanguage(locale);}else{locale=this._locale;language=this._language;}if(!txt&&catalog[locale]){txt=catalog[locale][messageId];}if(!txt&&catalog[language]){txt=catalog[language][messageId];}if(!txt&&catalog[this._defaultLocale]){txt=catalog[this._defaultLocale][messageId];}if(!txt){txt=messageId;}if(args.length>0){var translatedArgs=[];for(var i=0;i<args.length;i++){var arg=args[i];if(arg.translate){translatedArgs[i]=arg.translate();}else{translatedArgs[i]=arg;}}txt=qx.lang.String.format(txt,translatedArgs);}if(qx.core.Variant.isSet("qx.dynamicLocaleSwitch","on")){txt=new qx.locale.LocalizedString(txt,messageId,args);}return txt;}},destruct:function(){this._disposeFields("__translations","__locales");}});qx.Class.define("qx.ui.basic.Label",{extend:qx.ui.core.Widget,construct:function(content){this.base(arguments);if(content!=null){this.setContent(content);}if(qx.core.Variant.isSet("qx.dynamicLocaleSwitch","on")){qx.locale.Manager.getInstance().addListener("changeLocale",this._onChangeLocale,this);}},properties:{rich:{check:"Boolean",init:false,apply:"_applyRich"},content:{check:"String",apply:"_applyContent",event:"changeContent",nullable:true},textAlign:{check:["left","center","right"],nullable:true,themeable:true,apply:"_applyTextAlign"},appearance:{refine:true,init:"label"},allowGrowX:{refine:true,init:false},allowGrowY:{refine:true,init:false}},members:{__font:null,__invalidContentSize:null,_getContentHint:function(){if(this.__invalidContentSize){this.__computeContentSize();delete this.__invalidContentSize;}return {width:this.__contentSize.width,height:this.__contentSize.height};},_hasHeightForWidth:function(){return this.getRich();},_getContentHeightForWidth:function(width){if(!this.getRich()){return null;}var styles=this.__font?this.__font.getStyles():qx.bom.Font.getDefaultStyles();return qx.bom.Label.getHtmlSize(this.getContent(),styles,width).height;},_createContentElement:function(){return new qx.html.Label;},_applyTextAlign:function(value,old){this.getContentElement().setStyle("textAlign",value);},_applyTextColor:function(value,old){if(value){this.getContentElement().setStyle("color",qx.theme.manager.Color.getInstance().resolve(value));}else{this.getContentElement().removeStyle("color");}},__contentSize:{width:0,height:0},_applyFont:function(value,old){var styles;if(value){this.__font=qx.theme.manager.Font.getInstance().resolve(value);styles=this.__font.getStyles();}else{this.__font=null;styles=qx.bom.Font.getDefaultStyles();}this.getContentElement().setStyles(styles);this.__invalidContentSize=true;qx.ui.core.queue.Layout.add(this);},__computeContentSize:function(){var Label=qx.bom.Label;var font=this.getFont();var styles=font?this.__font.getStyles():qx.bom.Font.getDefaultStyles();var content=this.getContent()||"A";var rich=this.getRich();this.__contentSize=rich?Label.getHtmlSize(content,styles):Label.getTextSize(content,styles);},_applyRich:function(value){this.getContentElement().setRich(value);this.__invalidContentSize=true;qx.ui.core.queue.Layout.add(this);},_onChangeLocale:qx.core.Variant.select("qx.dynamicLocaleSwitch",{"on":function(e){var content=this.getContent();if(content.translate){this.setContent(content.translate());}},"off":null}),_applyContent:function(value){this.getContentElement().setContent(value);this.__invalidContentSize=true;qx.ui.core.queue.Layout.add(this);}},destruct:function(){if(qx.core.Variant.isSet("qx.dynamicLocaleSwitch","on")){qx.locale.Manager.getInstance().removeListener("changeLocale",this._onChangeLocale,this);}this._disposeFields("__font");}});qx.Class.define("qx.bom.Label",{statics:{__styles:{fontFamily:1,fontSize:1,fontWeight:1,fontStyle:1,lineHeight:1},__prepareText:function(){var el=document.createElement("div");var style=el.style;style.width=style.height="auto";style.left=style.top="-1000px";style.visibility="hidden";style.position="absolute";style.overflow="visible";style.whiteSpace="nowrap";if(qx.core.Variant.isSet("qx.client","gecko")){var inner=document.createElementNS("http://www.mozilla.org/keymaster/gatekeeper/there.is.only.xul","label");el.appendChild(inner);}document.body.insertBefore(el,document.body.firstChild);return this._textElement=el;},__prepareHtml:function(){var el=qx.bom.Element.create("div");var style=el.style;style.width=style.height="auto";style.left=style.top="-1000px";style.visibility="hidden";style.position="absolute";style.overflow="visible";style.whiteSpace="normal";document.body.insertBefore(el,document.body.firstChild);return this._htmlElement=el;},create:function(content,html,win){if(!win){win=window;}if(html){var el=win.document.createElement("div");el.useHtml=true;}else if(qx.core.Variant.isSet("qx.client","gecko")){var el=win.document.createElement("div");var xulel=win.document.createElementNS("http://www.mozilla.org/keymaster/gatekeeper/there.is.only.xul","label");xulel.style.cursor="inherit";xulel.style.overflow="hidden";xulel.style.maxWidth="100%";xulel.setAttribute("crop","end");el.appendChild(xulel);}else{var el=win.document.createElement("div");}if(content){this.setContent(el,content);}return el;},getStyles:function(html){var styles={};if(html){styles.whiteSpace="normal";}else if(qx.core.Variant.isSet("qx.client","gecko")){styles.display="block";}else{styles.overflow="hidden";styles.whiteSpace="nowrap";styles.textOverflow="ellipsis";if(qx.core.Variant.isSet("qx.client","opera")){styles.OTextOverflow="ellipsis";}}styles.userSelect="none";return styles;},setContent:function(element,value){value=value||"";if(element.useHtml){element.innerHTML=value;}else if(qx.core.Variant.isSet("qx.client","gecko")){element.firstChild.setAttribute("value",value);}else{qx.bom.element.Attribute.set(element,"text",value);}},getContent:function(element){if(element.useHtml){return element.innerHTML;}else if(qx.core.Variant.isSet("qx.client","gecko")){return element.firstChild.getAttribute("value")||"";}else{return qx.bom.element.Attribute.get(element,"text");}},getHtmlSize:function(content,styles,width){var element=this._htmlElement||this.__prepareHtml();var keys=this.__styles;if(!styles){styles={};}for(var key in keys){element.style[key]=styles[key]||"";}element.style.width=width!=null?width+"px":"auto";element.innerHTML=content;return {width:element.clientWidth,height:element.clientHeight};},getTextSize:function(text,styles){var element=this._textElement||this.__prepareText();var keys=this.__styles;if(!styles){styles={};}for(var key in keys){element.style[key]=styles[key]||"";}if(qx.core.Variant.isSet("qx.client","gecko")){element.firstChild.setAttribute("value",text);}else if(qx.core.Variant.isSet("qx.client","mshtml|opera")){element.innerText=text;}else{element.textContent=text;}var width=element.clientWidth;var height=element.clientHeight;if(qx.core.Variant.isSet("qx.client","gecko")){if(qx.bom.client.Platform.MAC){width++;}}return {width:width,height:height};}}});qx.Class.define("qx.html.Label",{extend:qx.html.Element,members:{_applyProperty:function(name,value){this.base(arguments,name,value);if(name=="content"){qx.bom.Label.setContent(this._element,value);}},_createDomElement:function(){var rich=this.__rich;var el=qx.bom.Label.create(this._content,rich);var styles=qx.bom.Label.getStyles(rich);for(var key in styles){this.setStyle(key,styles[key]);}return el;},setRich:function(value){if(this._element){throw new Error("The label mode cannot be modified after initial creation");}value=!!value;if(this.__rich==value){return;}this.__rich=value;return this;},setContent:function(value){this._setProperty("content",value);return this;},getContent:function(){return this._getProperty("content");}}});qx.Class.define("qx.test.util.Validation",{extend:qx.dev.unit.TestCase,members:{testUmlauts:function(){this.assertEquals("aouAOUs",qx.legacy.util.Normalization.umlautsShort("äöüÄÖÜß"));this.assertEquals("aeoeueAeOeUess",qx.legacy.util.Normalization.umlautsLong("äöüÄÖÜß"));}}});qx.Class.define("qx.legacy.util.Normalization",{statics:{__umlautsRegExp:new RegExp("[\xE4\xF6\xFC\xDF\xC4\xD6\xDC]","g"),__umlautsShortData:{"\xC4":"A","\xD6":"O","\xDC":"U","\xE4":"a","\xF6":"o","\xFC":"u","\xDF":"s"},__umlautsShort:function(vChar){return qx.legacy.util.Normalization.__umlautsShortData[vChar];},umlautsShort:function(vString){return vString.replace(qx.legacy.util.Normalization.__umlautsRegExp,qx.lang.Function.bind(this.__umlautsShort,this));},__umlautsLongData:{"\xC4":"Ae","\xD6":"Oe","\xDC":"Ue","\xE4":"ae","\xF6":"oe","\xFC":"ue","\xDF":"ss"},__umlautsLong:function(vChar){return qx.legacy.util.Normalization.__umlautsLongData[vChar];},umlautsLong:function(vString){return vString.replace(qx.legacy.util.Normalization.__umlautsRegExp,qx.lang.Function.bind(this.__umlautsLong,this));}}});qx.Class.define("qx.test.locale.Locale",{extend:qx.dev.unit.TestCase,include:qx.locale.MTranslation,members:{testTranslation:function(){this.assertNotUndefined(qx.locale.Manager);var manager=qx.locale.Manager.getInstance();manager.addTranslation("en_QX",{"test one":"test one","test two":"test two","test Hello %1!":"test Hello %1!","test Jonny":"test Jonny","test One car":"test One car","test %1 cars":"test %1 cars"});manager.addTranslation("de_QX",{"test one":"Eins","test two":"Zwei","test Hello %1!":"Servus %1!","test Jonny":"Jonathan","test One car":"Ein Auto","test %1 cars":"%1 Autos"});manager.setLocale("en_QX");this.assertEquals("en",manager.getLanguage());this.assertEquals("QX",manager.getTerritory());var one=this.tr("test one");this.assertEquals("test one",one);var hello=this.tr("test Hello %1!","Fabian");this.assertEquals("test Hello Fabian!",hello);var hiJonny=this.tr("test Hello %1!",this.tr("test Jonny"));this.assertEquals("test Hello test Jonny!",hiJonny);var car=this.trn("test One car","test %1 cars",0,0);this.assertEquals("test 0 cars",car);var car=this.trn("test One car","test %1 cars",1);this.assertEquals("test One car",car);var cars=this.trn("test One car","test %1 cars",5,5);this.assertEquals("test 5 cars",cars);var fired=false;var evtLocale="";manager.addListener("changeLocale",function(e){fired=true;evtLocale=e.getData();});manager.setLocale("de_QX");this.assertTrue(fired);this.assertEquals("de_QX",evtLocale);one=one.translate();this.assertEquals("Eins",one);hello=hello.translate();this.assertEquals("Servus Fabian!",hello);hiJonny=hiJonny.translate();this.assertEquals("Servus Jonathan!",hiJonny);car=car.translate();this.assertEquals("Ein Auto",car);cars=cars.translate();this.assertEquals("5 Autos",cars);}}});qx.Class.define("qx.test.lang.Object",{extend:qx.dev.unit.TestCase,members:{testObject:function(){this.assertNotUndefined(qx.lang.Object);},testInvert:function(){this.assertNotUndefined(qx.lang.Object.invert);var Obj=qx.lang.Object;this.assertJsonEquals({a:"1","2":"b"},Obj.invert({1:"a",b:2}));},testObjectAssertions:function(){var objConstructor=({}).constructor;this.assertIdentical(({a:12}).constructor,objConstructor);this.assertIdentical(new Object().constructor,objConstructor);this.assertNotIdentical(new qx.core.Object().constructor,objConstructor);this.assertNotIdentical((1).constructor,objConstructor);this.assertNotIdentical(("Juhu").constructor,objConstructor);this.assertNotIdentical((/abc/).constructor,objConstructor);}}});qx.Class.define("qx.test.html.Element",{extend:qx.dev.unit.TestCase,members:{setUp:function(){var helper=document.createElement("div");document.body.appendChild(helper);this._doc=new qx.html.Root(helper);this._doc.setAttribute("id","doc");},tearDown:function(){var div=document.getElementById("doc");document.body.removeChild(div);},testBasics:function(){var el1=new qx.html.Element;var el2a=new qx.html.Element;var el2b=new qx.html.Element;var el3a=new qx.html.Element;var el3b=new qx.html.Element;this.assertQxObject(el1);this.assertQxObject(el2a);el1.setAttribute("id","el1");el2a.setAttribute("id","el2a");el2b.setAttribute("id","el2b");el3a.setAttribute("id","el3a");el3b.setAttribute("id","el3b");this.assertIdentical(el1.getAttribute("id"),"el1");this.assertIdentical(el2a.getAttribute("id"),"el2a");el1.add(el2a,el2b);el2a.add(el3a,el3b);this._doc.add(el1);el3a.setAttribute("html","<b>hello</b>");this.assertIdentical(el3a.getAttribute("html"),"<b>hello</b>");el1.setStyle("color","blue");el1.setStyle("width","100px").setStyle("height","100px");this.assertCssColor("blue",el1.getStyle("color"));this.assertIdentical("100px",el1.getStyle("width"));this.assertIdentical("100px",el1.getStyle("height"));qx.html.Element.flush();var pa=document.getElementById("el1");var ch1=document.getElementById("el2a");var ch2=document.getElementById("el2b");var ch3=document.getElementById("el3a");var ch4=document.getElementById("el3b");this.assertFalse(ch1===ch2);this.assertIdentical(ch1.parentNode,pa);this.assertIdentical(ch2.parentNode,pa);this.assertIdentical(ch3.parentNode,ch1);this.assertIdentical(ch4.parentNode,ch1);this.assertIdentical(el1.getChildren()[0],el2a);this.assertIdentical(el1.getChildren()[1],el2b);this.assertIdentical(el2a.getChildren()[0],el3a);this.assertIdentical(el2a.getChildren()[1],el3b);this.assertIdentical(this._doc.getChildren()[0],el1);var before1=new qx.html.Element;before1.setAttribute("id","before1");before1.insertBefore(el1);var after1=new qx.html.Element;after1.setAttribute("id","after1");after1.insertAfter(el1);this.assertIdentical(this._doc.getChildren()[0],before1);this.assertIdentical(this._doc.getChildren()[1],el1);this.assertIdentical(this._doc.getChildren()[2],after1);qx.html.Element.flush();this.assertIdentical(this._doc.getDomElement().childNodes[0],before1.getDomElement());this.assertIdentical(this._doc.getDomElement().childNodes[1],el1.getDomElement());this.assertIdentical(this._doc.getDomElement().childNodes[2],after1.getDomElement());var before2=new qx.html.Element;before2.setAttribute("id","before2");this._doc.addAt(before2,0);var after2=new qx.html.Element;after2.setAttribute("id","after2");this._doc.addAt(after2,10);this.assertIdentical(this._doc.getChildren()[0],before2);this.assertIdentical(this._doc.getChildren()[1],before1);this.assertIdentical(this._doc.getChildren()[2],el1);this.assertIdentical(this._doc.getChildren()[3],after1);this.assertIdentical(this._doc.getChildren()[4],after2);qx.html.Element.flush();this.assertIdentical(this._doc.getDomElement().childNodes[0],before2.getDomElement());this.assertIdentical(this._doc.getDomElement().childNodes[1],before1.getDomElement());this.assertIdentical(this._doc.getDomElement().childNodes[2],el1.getDomElement());this.assertIdentical(this._doc.getDomElement().childNodes[3],after1.getDomElement());this.assertIdentical(this._doc.getDomElement().childNodes[4],after2.getDomElement());before2.moveAfter(before1);after2.moveBefore(after1);this.assertIdentical(this._doc.getChildren()[0],before1);this.assertIdentical(this._doc.getChildren()[1],before2);this.assertIdentical(this._doc.getChildren()[2],el1);this.assertIdentical(this._doc.getChildren()[3],after2);this.assertIdentical(this._doc.getChildren()[4],after1);qx.html.Element.flush();this.assertIdentical(this._doc.getDomElement().childNodes[0],before1.getDomElement());this.assertIdentical(this._doc.getDomElement().childNodes[1],before2.getDomElement());this.assertIdentical(this._doc.getDomElement().childNodes[2],el1.getDomElement());this.assertIdentical(this._doc.getDomElement().childNodes[3],after2.getDomElement());this.assertIdentical(this._doc.getDomElement().childNodes[4],after1.getDomElement());var in1=this._doc.indexOf(before2);var in2=this._doc.indexOf(after2);this.assertIdentical(in1,1);this.assertIdentical(in2,3);before2.moveTo(in2);after2.moveTo(in1);this.assertIdentical(this._doc.getChildren()[0],before1);this.assertIdentical(this._doc.getChildren()[1],after2);this.assertIdentical(this._doc.getChildren()[2],el1);this.assertIdentical(this._doc.getChildren()[3],before2);this.assertIdentical(this._doc.getChildren()[4],after1);qx.html.Element.flush();this.assertIdentical(this._doc.getDomElement().childNodes[0],before1.getDomElement());this.assertIdentical(this._doc.getDomElement().childNodes[1],after2.getDomElement());this.assertIdentical(this._doc.getDomElement().childNodes[2],el1.getDomElement());this.assertIdentical(this._doc.getDomElement().childNodes[3],before2.getDomElement());this.assertIdentical(this._doc.getDomElement().childNodes[4],after1.getDomElement());this._doc.remove(before2);this._doc.remove(after2);this.assertIdentical(this._doc.getChildren()[0],before1);this.assertIdentical(this._doc.getChildren()[1],el1);this.assertIdentical(this._doc.getChildren()[2],after1);qx.html.Element.flush();this.assertIdentical(this._doc.getDomElement().childNodes[0],before1.getDomElement());this.assertIdentical(this._doc.getDomElement().childNodes[1],el1.getDomElement());this.assertIdentical(this._doc.getDomElement().childNodes[2],after1.getDomElement());this._doc.add(before2,after2);this.assertIdentical(this._doc.getChildren()[0],before1);this.assertIdentical(this._doc.getChildren()[1],el1);this.assertIdentical(this._doc.getChildren()[2],after1);this.assertIdentical(this._doc.getChildren()[3],before2);this.assertIdentical(this._doc.getChildren()[4],after2);qx.html.Element.flush();this.assertIdentical(this._doc.getDomElement().childNodes[0],before1.getDomElement());this.assertIdentical(this._doc.getDomElement().childNodes[1],el1.getDomElement());this.assertIdentical(this._doc.getDomElement().childNodes[2],after1.getDomElement());this.assertIdentical(this._doc.getDomElement().childNodes[3],before2.getDomElement());this.assertIdentical(this._doc.getDomElement().childNodes[4],after2.getDomElement());this._doc.remove(before2,after2);this._doc.add(before2,after2);this._doc.remove(before2,after2);this._doc.add(before2,after2);this.assertIdentical(this._doc.getChildren()[0],before1);this.assertIdentical(this._doc.getChildren()[1],el1);this.assertIdentical(this._doc.getChildren()[2],after1);this.assertIdentical(this._doc.getChildren()[3],before2);this.assertIdentical(this._doc.getChildren()[4],after2);qx.html.Element.flush();this.assertIdentical(this._doc.getDomElement().childNodes[0],before1.getDomElement());this.assertIdentical(this._doc.getDomElement().childNodes[1],el1.getDomElement());this.assertIdentical(this._doc.getDomElement().childNodes[2],after1.getDomElement());this.assertIdentical(this._doc.getDomElement().childNodes[3],before2.getDomElement());this.assertIdentical(this._doc.getDomElement().childNodes[4],after2.getDomElement());this._doc.remove(before2);before1.moveAfter(after1);before2.insertBefore(before1);this.assertIdentical(this._doc.getChildren()[0],el1);this.assertIdentical(this._doc.getChildren()[1],after1);this.assertIdentical(this._doc.getChildren()[2],before2);this.assertIdentical(this._doc.getChildren()[3],before1);this.assertIdentical(this._doc.getChildren()[4],after2);qx.html.Element.flush();this.assertIdentical(this._doc.getDomElement().childNodes[0],el1.getDomElement());this.assertIdentical(this._doc.getDomElement().childNodes[1],after1.getDomElement());this.assertIdentical(this._doc.getDomElement().childNodes[2],before2.getDomElement());this.assertIdentical(this._doc.getDomElement().childNodes[3],before1.getDomElement());this.assertIdentical(this._doc.getDomElement().childNodes[4],after2.getDomElement());var a=this._doc.getChildren();for(var i=1,l=a.length;i<l;i++){a[i].moveTo(0);}this.assertIdentical(this._doc.getChildren()[0],after2);this.assertIdentical(this._doc.getChildren()[1],before1);this.assertIdentical(this._doc.getChildren()[2],before2);this.assertIdentical(this._doc.getChildren()[3],after1);this.assertIdentical(this._doc.getChildren()[4],el1);qx.html.Element.flush();this.assertIdentical(this._doc.getDomElement().childNodes[0],after2.getDomElement());this.assertIdentical(this._doc.getDomElement().childNodes[1],before1.getDomElement());this.assertIdentical(this._doc.getDomElement().childNodes[2],before2.getDomElement());this.assertIdentical(this._doc.getDomElement().childNodes[3],after1.getDomElement());this.assertIdentical(this._doc.getDomElement().childNodes[4],el1.getDomElement());before1.moveAfter(before2);this.assertIdentical(this._doc.getChildren()[0],after2);this.assertIdentical(this._doc.getChildren()[1],before2);this.assertIdentical(this._doc.getChildren()[2],before1);this.assertIdentical(this._doc.getChildren()[3],after1);this.assertIdentical(this._doc.getChildren()[4],el1);qx.html.Element.flush();this.assertIdentical(this._doc.getDomElement().childNodes[0],after2.getDomElement());this.assertIdentical(this._doc.getDomElement().childNodes[1],before2.getDomElement());this.assertIdentical(this._doc.getDomElement().childNodes[2],before1.getDomElement());this.assertIdentical(this._doc.getDomElement().childNodes[3],after1.getDomElement());this.assertIdentical(this._doc.getDomElement().childNodes[4],el1.getDomElement());},testExclude:function(){this.info("Create five elements (2 hidden)");var el1=new qx.html.Element;el1.setAttribute("id","el1");var el2=new qx.html.Element;el2.setAttribute("id","el2");var el3=new qx.html.Element;el3.setAttribute("id","el3");var el4=new qx.html.Element;el4.setAttribute("id","el4");var el5=new qx.html.Element;el5.setAttribute("id","el5");this._doc.add(el1,el2,el3,el4,el5);el2.exclude();el4.exclude();qx.html.Element.flush();this.assertIdentical(this._doc.getDomElement().childNodes[0],el1.getDomElement());this.assertIdentical(this._doc.getDomElement().childNodes[1],el3.getDomElement());this.assertIdentical(this._doc.getDomElement().childNodes[2],el5.getDomElement());this.assertIdentical(this._doc.getDomElement().childNodes[3],undefined);this.info("Make simple hidden element visible");el2.include();qx.html.Element.flush();this.assertIdentical(this._doc.getDomElement().childNodes[0],el1.getDomElement());this.assertIdentical(this._doc.getDomElement().childNodes[1],el2.getDomElement());this.assertIdentical(this._doc.getDomElement().childNodes[2],el3.getDomElement());this.assertIdentical(this._doc.getDomElement().childNodes[3],el5.getDomElement());this.assertIdentical(this._doc.getDomElement().childNodes[4],undefined);this.info("Make complex hidden element visible");var el4_1=new qx.html.Element;el4_1.setAttribute("id","el4_1");var el4_2=new qx.html.Element;el4_2.setAttribute("id","el4_2");el4_2.setStyle("color","red");el4_2.setAttribute("text","el4_2");el4_2.exclude();var el4_3=new qx.html.Element;el4_3.setAttribute("id","el4_3");el4.add(el4_1,el4_2,el4_3);el4.include();qx.html.Element.flush();this.assertIdentical(this._doc.getDomElement().childNodes[0],el1.getDomElement());this.assertIdentical(this._doc.getDomElement().childNodes[1],el2.getDomElement());this.assertIdentical(this._doc.getDomElement().childNodes[2],el3.getDomElement());this.assertIdentical(this._doc.getDomElement().childNodes[3],el4.getDomElement());this.assertIdentical(this._doc.getDomElement().childNodes[4],el5.getDomElement());this.assertIdentical(this._doc.getDomElement().childNodes[5],undefined);this.assertIdentical(this._doc.getDomElement().childNodes[3].firstChild,el4_1.getDomElement());this.assertIdentical(this._doc.getDomElement().childNodes[3].lastChild,el4_3.getDomElement());this.info("Show inner element");el4_2.include();qx.html.Element.flush();this.assertIdentical(this._doc.getDomElement().childNodes[0],el1.getDomElement());this.assertIdentical(this._doc.getDomElement().childNodes[1],el2.getDomElement());this.assertIdentical(this._doc.getDomElement().childNodes[2],el3.getDomElement());this.assertIdentical(this._doc.getDomElement().childNodes[3],el4.getDomElement());this.assertIdentical(this._doc.getDomElement().childNodes[4],el5.getDomElement());this.assertIdentical(this._doc.getDomElement().childNodes[5],undefined);this.assertIdentical(this._doc.getDomElement().childNodes[3].childNodes[0],el4_1.getDomElement());this.assertIdentical(this._doc.getDomElement().childNodes[3].childNodes[1],el4_2.getDomElement());this.assertIdentical(this._doc.getDomElement().childNodes[3].childNodes[2],el4_3.getDomElement());this.assertIdentical(this._doc.getDomElement().childNodes[3].childNodes[3],undefined);this.info("Internal move while hidden");el4.exclude();el4_3.moveTo(0);el4.remove(el4_2);el4_1.setStyle("fontSize","20px");el4_1.setAttribute("text","el4_1");el4.setStyle("backgroundColor","#ccc");qx.html.Element.flush();this.assertIdentical(this._doc.getDomElement().childNodes[0],el1.getDomElement());this.assertIdentical(this._doc.getDomElement().childNodes[1],el2.getDomElement());this.assertIdentical(this._doc.getDomElement().childNodes[2],el3.getDomElement());this.assertIdentical(this._doc.getDomElement().childNodes[3],el5.getDomElement());this.assertIdentical(this._doc.getDomElement().childNodes[4],undefined);this.info("Internal move while hidden -> show again");el4.include();qx.html.Element.flush();this.assertIdentical(this._doc.getDomElement().childNodes[0],el1.getDomElement());this.assertIdentical(this._doc.getDomElement().childNodes[1],el2.getDomElement());this.assertIdentical(this._doc.getDomElement().childNodes[2],el3.getDomElement());this.assertIdentical(this._doc.getDomElement().childNodes[3],el4.getDomElement());this.assertIdentical(this._doc.getDomElement().childNodes[4],el5.getDomElement());this.assertIdentical(this._doc.getDomElement().childNodes[5],undefined);this.assertIdentical(this._doc.getDomElement().childNodes[3].childNodes[0],el4_3.getDomElement());this.assertIdentical(this._doc.getDomElement().childNodes[3].childNodes[1],el4_1.getDomElement());this.assertIdentical(this._doc.getDomElement().childNodes[3].childNodes[2],undefined);},testVisibility:function(){this.info("Create five elements (2 hidden)");var el1=new qx.html.Element;el1.setAttribute("id","el1");var el2=new qx.html.Element;el2.setAttribute("id","el2");var el3=new qx.html.Element;el3.setAttribute("id","el3");var el4=new qx.html.Element;el4.setAttribute("id","el4");var el5=new qx.html.Element;el5.setAttribute("id","el5");this._doc.add(el1,el2,el3,el4,el5);el2.hide();el4.hide();qx.html.Element.flush();this.assertIdentical(this._doc.getDomElement().childNodes[0],el1.getDomElement());this.assertIdentical(this._doc.getDomElement().childNodes[1],el3.getDomElement());this.assertIdentical(this._doc.getDomElement().childNodes[2],el5.getDomElement());this.assertIdentical(this._doc.getDomElement().childNodes[3],undefined);this.info("Show one of the two hidden elements");el2.show();qx.html.Element.flush();this.assertIdentical(this._doc.getDomElement().childNodes[0],el1.getDomElement());this.assertIdentical(this._doc.getDomElement().childNodes[1],el2.getDomElement());this.assertIdentical(this._doc.getDomElement().childNodes[2],el3.getDomElement());this.assertIdentical(this._doc.getDomElement().childNodes[3],el5.getDomElement());this.assertIdentical(this._doc.getDomElement().childNodes[4],undefined);this.info("Hide a rendered element");el3.hide();qx.html.Element.flush();this.assertIdentical(this._doc.getDomElement().childNodes[0],el1.getDomElement());this.assertIdentical(this._doc.getDomElement().childNodes[1],el2.getDomElement());this.assertIdentical(this._doc.getDomElement().childNodes[2],el3.getDomElement());this.assertIdentical(this._doc.getDomElement().childNodes[3],el5.getDomElement());this.assertIdentical(this._doc.getDomElement().childNodes[4],undefined);this.assertIdentical(el3.getDomElement().style.display,"none");this.info("Exclude & show together");el3.exclude();el3.show();qx.html.Element.flush();this.assertIdentical(this._doc.getDomElement().childNodes[0],el1.getDomElement());this.assertIdentical(this._doc.getDomElement().childNodes[1],el2.getDomElement());this.assertIdentical(this._doc.getDomElement().childNodes[2],el5.getDomElement());this.assertIdentical(this._doc.getDomElement().childNodes[3],undefined);this.assertIdentical(el3.getDomElement().style.display,"");this.info("Include one and hide another element");el3.include();el2.hide();qx.html.Element.flush();this.assertIdentical(this._doc.getDomElement().childNodes[0],el1.getDomElement());this.assertIdentical(this._doc.getDomElement().childNodes[1],el2.getDomElement());this.assertIdentical(this._doc.getDomElement().childNodes[2],el3.getDomElement());this.assertIdentical(this._doc.getDomElement().childNodes[3],el5.getDomElement());this.assertIdentical(this._doc.getDomElement().childNodes[4],undefined);this.assertIdentical(el2.getDomElement().style.display,"none");this.assertIdentical(el3.getDomElement().style.display,"");},testResetStyles:function(){var el=new qx.html.Element();this._doc.add(el);qx.html.Element.flush();this.assertIdentical(el.getDomElement().style.backgroundColor,'');el.setStyle("backgroundColor","green");qx.html.Element.flush();this.assertCssColor("green",el.getDomElement().style.backgroundColor);el.setStyle("backgroundColor",null);el.setStyle("backgroundColor","yellow");qx.html.Element.flush();this.assertCssColor("yellow",el.getDomElement().style.backgroundColor);el.setStyle("backgroundColor",null);qx.html.Element.flush();this.assertIdentical(el.getDomElement().style.backgroundColor,"");}}});qx.Class.define("qx.legacy.core.Client",{statics:{__init:function(){var vRunsLocally=window.location.protocol==="file:";var vBrowserUserAgent=navigator.userAgent;var vBrowserVendor=navigator.vendor;var vBrowserProduct=navigator.product;var vBrowserPlatform=navigator.platform;var vBrowser;var vEngine=null;var vEngineVersion=null;var vEngineVersionMajor=0;var vEngineVersionMinor=0;var vEngineVersionRevision=0;var vEngineVersionBuild=0;var vEngineEmulation=null;var vEngineNightly=null;var vVersionHelper;if(window.opera&&/Opera[\s\/]([0-9\.]*)/.test(vBrowserUserAgent)){vEngine="opera";vEngineVersion=RegExp.$1;vBrowser="opera";vEngineVersion=vEngineVersion.substring(0,3)+"."+vEngineVersion.substring(3);vEngineEmulation=vBrowserUserAgent.indexOf("MSIE")!==-1?"mshtml":vBrowserUserAgent.indexOf("Mozilla")!==-1?"gecko":null;}else if(typeof vBrowserVendor==="string"&&vBrowserVendor==="KDE"&&/KHTML\/([0-9-\.]*)/.test(vBrowserUserAgent)){vEngine="khtml";vBrowser="konqueror";vEngineVersion=RegExp.$1;}else if(vBrowserUserAgent.indexOf("AppleWebKit")!=-1&&/AppleWebKit\/([^ ]+)/.test(vBrowserUserAgent)){vEngine="webkit";vEngineVersion=RegExp.$1;vEngineNightly=vEngineVersion.indexOf("+")!=-1;var invalidCharacter=RegExp("[^\\.0-9]").exec(vEngineVersion);if(invalidCharacter){vEngineVersion=vEngineVersion.slice(0,invalidCharacter.index);}if(vBrowserUserAgent.indexOf("Safari")!=-1){vBrowser="safari";}else if(vBrowserUserAgent.indexOf("OmniWeb")!=-1){vBrowser="omniweb";}else if(vBrowserUserAgent.indexOf("Shiira")!=-1){vBrowser="shiira";}else if(vBrowserUserAgent.indexOf("NetNewsWire")!=-1){vBrowser="netnewswire";}else if(vBrowserUserAgent.indexOf("RealPlayer")!=-1){vBrowser="realplayer";}else{vBrowser="other webkit";}if(vEngineNightly){vBrowser+=" (nightly)";}}else if(window.controllers&&typeof vBrowserProduct==="string"&&vBrowserProduct==="Gecko"&&/rv\:([^\);]+)(\)|;)/.test(vBrowserUserAgent)){vEngine="gecko";vEngineVersion=RegExp.$1;if(vBrowserUserAgent.indexOf("Firefox")!=-1){vBrowser="firefox";}else if(vBrowserUserAgent.indexOf("Camino")!=-1){vBrowser="camino";}else if(vBrowserUserAgent.indexOf("Galeon")!=-1){vBrowser="galeon";}else{vBrowser="other gecko";}}else if(/MSIE\s+([^\);]+)(\)|;)/.test(vBrowserUserAgent)){vEngine="mshtml";vEngineVersion=RegExp.$1;vBrowser="explorer";}if(vEngineVersion){vVersionHelper=vEngineVersion.split(".");vEngineVersionMajor=vVersionHelper[0]||0;vEngineVersionMinor=vVersionHelper[1]||0;vEngineVersionRevision=vVersionHelper[2]||0;vEngineVersionBuild=vVersionHelper[3]||0;}var vEngineBoxSizingAttr=[];switch(vEngine){case "gecko":vEngineBoxSizingAttr.push("-moz-box-sizing");break;case "khtml":vEngineBoxSizingAttr.push("-khtml-box-sizing");break;case "webkit":vEngineBoxSizingAttr.push("-khtml-box-sizing");vEngineBoxSizingAttr.push("-webkit-box-sizing");break;case "mshtml":break;default:break;}vEngineBoxSizingAttr.push("box-sizing");var vEngineQuirksMode=document.compatMode!=="CSS1Compat";var vDefaultLocale="en";var vBrowserLocale=(vEngine=="mshtml"?navigator.userLanguage:navigator.language).toLowerCase();var vBrowserLocaleVariant=null;var vBrowserLocaleVariantIndex=vBrowserLocale.indexOf("-");if(vBrowserLocaleVariantIndex!=-1){vBrowserLocaleVariant=vBrowserLocale.substr(vBrowserLocaleVariantIndex+1);vBrowserLocale=vBrowserLocale.substr(0,vBrowserLocaleVariantIndex);}var vPlatform="none";var vPlatformWindows=false;var vPlatformMacintosh=false;var vPlatformUnix=false;var vPlatformOther=false;if(vBrowserPlatform.indexOf("Windows")!=-1||vBrowserPlatform.indexOf("Win32")!=-1||vBrowserPlatform.indexOf("Win64")!=-1){vPlatformWindows=true;vPlatform="win";}else if(vBrowserPlatform.indexOf("Macintosh")!=-1||vBrowserPlatform.indexOf("MacPPC")!=-1||vBrowserPlatform.indexOf("MacIntel")!=-1){vPlatformMacintosh=true;vPlatform="mac";}else if(vBrowserPlatform.indexOf("X11")!=-1||vBrowserPlatform.indexOf("Linux")!=-1||vBrowserPlatform.indexOf("BSD")!=-1){vPlatformUnix=true;vPlatform="unix";}else{vPlatformOther=true;vPlatform="other";}var vGfxVml=false;var vGfxSvg=false;var vGfxSvgBuiltin=false;var vGfxSvgPlugin=false;if(vEngine=="mshtml"){vGfxVml=true;}if(document.implementation&&document.implementation.hasFeature){if(document.implementation.hasFeature("org.w3c.dom.svg","1.0")){vGfxSvg=vGfxSvgBuiltin=true;}}this._runsLocally=vRunsLocally;this._engineName=vEngine;this._engineNameMshtml=vEngine==="mshtml";this._engineNameGecko=vEngine==="gecko";this._engineNameOpera=vEngine==="opera";this._engineNameKhtml=vEngine==="khtml";this._engineNameWebkit=vEngine==="webkit";this._engineVersion=parseFloat(vEngineVersion);this._engineVersionMajor=parseInt(vEngineVersionMajor);this._engineVersionMinor=parseInt(vEngineVersionMinor);this._engineVersionRevision=parseInt(vEngineVersionRevision);this._engineVersionBuild=parseInt(vEngineVersionBuild);this._engineQuirksMode=vEngineQuirksMode;this._engineBoxSizingAttributes=vEngineBoxSizingAttr;this._engineEmulation=vEngineEmulation;this._browserName=vBrowser;this._defaultLocale=vDefaultLocale;this._browserPlatform=vPlatform;this._browserPlatformWindows=vPlatformWindows;this._browserPlatformMacintosh=vPlatformMacintosh;this._browserPlatformUnix=vPlatformUnix;this._browserPlatformOther=vPlatformOther;this._browserLocale=vBrowserLocale;this._browserLocaleVariant=vBrowserLocaleVariant;this._gfxVml=vGfxVml;this._gfxSvg=vGfxSvg;this._gfxSvgBuiltin=vGfxSvgBuiltin;this._gfxSvgPlugin=vGfxSvgPlugin;this._fireBugActive=(window.console&&console.log&&console.debug&&console.assert);this._supportsTextContent=(document.documentElement.textContent!==undefined);this._supportsInnerText=(document.documentElement.innerText!==undefined);this._supportsXPath=!!document.evaluate;this._supportsElementExtensions=!!window.HTMLElement;},getRunsLocally:function(){return this._runsLocally;},getEngine:function(){return this._engineName;},getBrowser:function(){return this._browserName;},getVersion:function(){return this._engineVersion;},getMajor:function(){return this._engineVersionMajor;},getMinor:function(){return this._engineVersionMinor;},getRevision:function(){return this._engineVersionRevision;},getBuild:function(){return this._engineVersionBuild;},getEmulation:function(){return this._engineEmulation;},isMshtml:function(){return this._engineNameMshtml;},isGecko:function(){return this._engineNameGecko;},isOpera:function(){return this._engineNameOpera;},isKhtml:function(){return this._engineNameKhtml;},isWebkit:function(){return this._engineNameWebkit;},isSafari2:function(){return this._engineNameWebkit&&(this._engineVersion<420);},isInQuirksMode:function(){return this._engineQuirksMode;},getLocale:function(){return this._browserLocale;},getLocaleVariant:function(){return this._browserLocaleVariant;},getDefaultLocale:function(){return this._defaultLocale;},usesDefaultLocale:function(){return this._browserLocale===this._defaultLocale;},getEngineBoxSizingAttributes:function(){return this._engineBoxSizingAttributes;},getPlatform:function(){return this._browserPlatform;},runsOnWindows:function(){return this._browserPlatformWindows;},runsOnMacintosh:function(){return this._browserPlatformMacintosh;},runsOnUnix:function(){return this._browserPlatformUnix;},supportsVml:function(){return this._gfxVml;},supportsSvg:function(){return this._gfxSvg;},usesSvgBuiltin:function(){return this._gfxSvgBuiltin;},usesSvgPlugin:function(){return this._gfxSvgPlugin;},isFireBugActive:function(){return this._fireBugActive;},supportsTextContent:function(){return this._supportsTextContent;},supportsInnerText:function(){return this._supportsInnerText;},getInstance:function(){return this;}},defer:function(statics,members,properties){statics.__init();}});qx.Class.define("qx.test.core.Variants",{extend:qx.dev.unit.TestCase,members:{testBrowserAllDefined:function(){this.debug("test testBrowserAllDefined");qx.Class.define("qx.test.Browser1",{extend:Object,construct:function(){},members:{getName:qx.core.Variant.select("qx.client",{"default":function(){return "unknown browser";},"gecko":function(){return "Gecko";},"mshtml":function(){return "Internet Explorer";},"webkit":function(){return "Webkit";},"opera":function(){return "Opera";}})}});var b=new qx.test.Browser1();if(qx.legacy.core.Client.getInstance().isGecko()){this.assertEquals("Gecko",b.getName());}else if(qx.legacy.core.Client.getInstance().isMshtml()){this.assertEquals("Internet Explorer",b.getName());}else if(qx.legacy.core.Client.getInstance().isWebkit()){this.assertEquals("Webkit",b.getName());}else if(qx.legacy.core.Client.getInstance().isOpera()){this.assertEquals("Opera",b.getName());}},testBrowserOrDefined:function(){this.debug("test testBrowserOrDefined");qx.Class.define("qx.test.Browser2",{extend:Object,construct:function(){},members:{getName:qx.core.Variant.select("qx.client",{"default":function(){return "unknown browser";},"gecko|mshtml|webkit|opera":function(){return "known browser";}})}});var b=new qx.test.Browser2();this.assertEquals("known browser",b.getName());},testBrowserOneDefined:function(){this.debug("test testBrowserOneDefined");qx.Class.define("qx.test.Browser3",{extend:Object,construct:function(){},members:{getName:qx.core.Variant.select("qx.client",{"default":function(){return "default browser";},"unknown":function(){return "unknown browser";}})}});var b=new qx.test.Browser3();this.assertEquals("default browser",b.getName());},testInlineSwitch:function(){this.debug("test testInlineSwitch");qx.core.Variant.define("test.animal",["dog","cat","snake"],"snake");this.assertEquals("snake",qx.core.Variant.get("test.animal"));var c;if(qx.core.Variant.isSet("test.animal","dog|snake")){if(qx.core.Variant.isSet("test.animal","dog")){c="dog";}else{c="snake";}}else if(qx.core.Variant.isSet("test.animal","cat")){c="cat";}if(qx.core.Variant.isSet("test.animal","default")){c="snake";}this.assertEquals(qx.core.Variant.get("test.animal"),c);},testIfWithComment:function(){this.debug("test testIfWithComment");var b;if(qx.core.Variant.isSet("qx.client","mshtml")){b="mshtml";}else if(qx.core.Variant.isSet("qx.client","gecko")){b="gecko";}else if(qx.core.Variant.isSet("qx.client","webkit")){b="webkit";}else if(qx.core.Variant.isSet("qx.client","opera")){b="opera";}this.assertEquals(qx.core.Variant.get("qx.client"),b);if(qx.core.Variant.isSet("qx.client","mshtml")){b="mshtml";}else{b="other";}if(qx.legacy.core.Client.getInstance().isMshtml()){this.assertEquals("mshtml",b);}else{this.assertEquals("other",b);}},testInlineOr:function(){this.debug("test testInlineOr");var c;if(qx.core.Variant.isSet("qx.client","mshtml|opera|webkit|gecko")){c="all";}else{c="unknown";}this.assertEquals("all",c);},testTernary:function(){var a=qx.core.Variant.isSet("qx.client","mshtml")?"mshtml":"other";if(qx.legacy.core.Client.getInstance().isMshtml()){this.assertEquals("mshtml",a);}else{this.assertEquals("other",a);}},testScope:function(){this.assertUndefined(window.abcdef);if(qx.core.Variant.isSet("qx.client","mshtml|opera|webkit|gecko")){abcdef="mshtml";var g;}else{var abcdef="other";var f=function(){var y;};var g,gh;}this.assertUndefined(window.abcdef);},testVariantInElse:function(){var i=1;if(true){var i=3;}else if(qx.core.Variant.isSet("qx.client","mshtml")){debug("");}i=2;this.assertEquals(2,i);}}});qx.Class.define("qx.test.lang.Array",{extend:qx.dev.unit.TestCase,members:{testAppend:function(){this.assertNotUndefined(qx.lang.Array.append);var a=[1,2,3];qx.lang.Array.append(a,[4,5,6]);this.assertJsonEquals(a,[1,2,3,4,5,6]);var error=false;try{qx.lang.Array.append(a,1);}catch(ex){error=true;}this.assert(error);},testMinNumeric:function(){var a=[-3,-2,-1,0,1,2,3];var result=qx.lang.Array.min(a);this.assertEquals(-3,result);},testMaxNumeric:function(){var a=[-3,-2,-1,0,1,2,3];var result=qx.lang.Array.max(a);this.assertEquals(3,result);},testMinMixed:function(){var a=[-3,-2,-1,0,1,2,3,'foo','bar',undefined,null];var result=qx.lang.Array.min(a);this.assertEquals(-3,result);},testMaxMixed:function(){var a=[-3,-2,-1,0,1,2,3,'foo','bar',undefined,null];var result=qx.lang.Array.max(a);this.assertEquals(3,result);},testMinEmpty:function(){var a=[];var result=qx.lang.Array.min(a);this.assertEquals(null,result);},testMaxEmpty:function(){var a=[];var result=qx.lang.Array.max(a);this.assertEquals(null,result);}}});qx.Class.define("qx.test.renderer.Color",{extend:qx.dev.unit.TestCase,members:{testValidColors:function(){var validColors={"red":[255,0,0],"black":[0,0,0],"#FFF":[255,255,255],"#Ff1":[255,255,17],"#0101FF":[1,1,255],"rgb(123,11,1)":[123,11,1]};for(var color in validColors){this.assertJsonEquals(validColors[color],qx.util.ColorUtil.stringToRgb(color));}},testInvalidColors:function(){var invalidColors=["blau","1234","#ff","#ffff","rgb(12,13)"];for(var i=0;i<invalidColors.length;i++){this.assertException(function(){qx.util.ColorUtil.stringToRgb(invalidColors[i]);},Error,"Could not parse color");}this.assertException(function(){qx.util.ColorUtil.stringToRgb("inactivecaptiontext");},Error,"Could not convert system colors to RGB");}}});qx.Class.define("qx.test.ui.BackgroundColor",{extend:qx.test.ui.LayoutTestCase,members:{testChangeColorInContainer:function(){var widget=new qx.ui.container.Composite();this.getRoot().add(widget);this.assertStyle(widget,"backgroundColor","");widget.setBackgroundColor("red");this.assertStyle(widget,"backgroundColor","red");widget.setBackgroundColor("green");this.assertStyle(widget,"backgroundColor","green");widget.setBackgroundColor(null);this.assertStyle(widget,"backgroundColor","");this.getRoot().remove(widget);widget.destroy();},testChangeColorInDecorator:function(){var widget=new qx.ui.container.Composite();this.getRoot().add(widget);var deco=new qx.ui.decoration.Single(1);widget.setDecorator(deco);this.assertStyle(widget,"backgroundColor","","no bg color");this.assertDecoratorStyle(widget,"backgroundColor","","no bg color");widget.setBackgroundColor("red");this.assertStyle(widget,"backgroundColor","","red bg color");this.assertDecoratorStyle(widget,"backgroundColor","red","red bg color");widget.setBackgroundColor("green");this.assertStyle(widget,"backgroundColor","","green bg color");this.assertDecoratorStyle(widget,"backgroundColor","green","green bg color");widget.setBackgroundColor(null);this.assertStyle(widget,"backgroundColor","","null bg color");this.assertDecoratorStyle(widget,"backgroundColor","","null bg color");this.getRoot().remove(widget);widget.dispose();},testSetColorInContainer:function(){var widget=new qx.ui.container.Composite();this.getRoot().add(widget);widget.setBackgroundColor("red");this.assertStyle(widget,"backgroundColor","red");this.assertNull(widget.getDecoratorElement());var deco=new qx.ui.decoration.Single(1);widget.setDecorator(deco);this.assertStyle(widget,"backgroundColor","");this.assertDecoratorStyle(widget,"backgroundColor","red");widget.setDecorator(null);this.assertDecoratorStyle(widget,"backgroundColor","");this.assertStyle(widget,"backgroundColor","red");this.getRoot().remove(widget);widget.dispose();},testSetColorInDecorator:function(){var widget=new qx.ui.container.Composite();this.getRoot().add(widget);this.assertStyle(widget,"backgroundColor","");this.assertNull(widget.getDecoratorElement());var deco=new qx.ui.decoration.Single(1);widget.setDecorator(deco);this.assertStyle(widget,"backgroundColor","");this.assertDecoratorStyle(widget,"backgroundColor","");widget.setBackgroundColor("red");this.assertDecoratorStyle(widget,"backgroundColor","red");this.assertStyle(widget,"backgroundColor","");widget.setDecorator(null);this.assertDecoratorStyle(widget,"backgroundColor","");this.assertStyle(widget,"backgroundColor","red");this.getRoot().remove(widget);widget.dispose();},testChangeDecorator:function(){var widget=new qx.ui.container.Composite();this.getRoot().add(widget);this.assertStyle(widget,"backgroundColor","");widget.setDecorator(new qx.ui.decoration.Single(1));widget.setBackgroundColor("red");this.assertDecoratorStyle(widget,"backgroundColor","red");this.assertStyle(widget,"backgroundColor","");var repl=new qx.ui.decoration.Double(1,"solid","green",1,"black");widget.setDecorator(repl);this.assertDecoratorStyle(widget,"backgroundColor","red");this.assertStyle(widget,"backgroundColor","");widget.setDecorator(null);this.assertDecoratorStyle(widget,"backgroundColor","");this.assertStyle(widget,"backgroundColor","red");widget.destroy();},testDecorationColor:function(){var widget=new qx.ui.container.Composite();this.getRoot().add(widget);this.assertStyle(widget,"backgroundColor","");widget.setBackgroundColor("green");this.assertStyle(widget,"backgroundColor","green");var deco=new qx.ui.decoration.Single(1);deco.setBackgroundColor("red");widget.setDecorator(deco);this.assertDecoratorStyle(widget,"backgroundColor","green");this.assertStyle(widget,"backgroundColor","");widget.setBackgroundColor(null);this.assertDecoratorStyle(widget,"backgroundColor","red");this.assertStyle(widget,"backgroundColor","");widget.setDecorator(null);this.assertDecoratorStyle(widget,"backgroundColor","");this.assertStyle(widget,"backgroundColor","");this.getRoot().remove(widget);widget.dispose();}}});qx.Mixin.define("qx.ui.core.MLayoutHandling",{members:{setLayout:function(layout){return this._setLayout(layout);},getLayout:function(){return this._getLayout();}},statics:{remap:function(members){members.getLayout=members._getLayout;members.setLayout=members._setLayout;}}});qx.Class.define("qx.ui.container.Composite",{extend:qx.ui.core.Widget,include:[qx.ui.core.MChildrenHandling,qx.ui.core.MLayoutHandling],construct:function(layout){this.base(arguments);if(layout!=null){this._setLayout(layout);}},events:{addChildWidget:"qx.event.type.Data",removeChildWidget:"qx.event.type.Data"},members:{_afterAddChild:function(child){this.fireNonBubblingEvent("addChildWidget",qx.event.type.Data,[child]);},_afterRemoveChild:function(child){this.fireNonBubblingEvent("removeChildWidget",qx.event.type.Data,[child]);}},defer:function(statics,members){qx.ui.core.MChildrenHandling.remap(members);qx.ui.core.MLayoutHandling.remap(members);}});qx.Class.define("qx.test.lang.Function",{extend:qx.dev.unit.TestCase,members:{testGetCaller:function(){var self=this;var fcn=arguments.callee;function f1(caller){self.assertIdentical(caller,qx.lang.Function.getCaller(arguments),"Wrong caller. (Fails in Opera)");}function f2(){f1(f2);}f2();f1(fcn);},testFunctionWrap:function(){var context=null;var result=0;var add=function(a,b){context=this;return a+b;};context=null;result=add(1,2);this.assertEquals(context,window,"This test fails in Safari 3 but is fixed in WebKit nightly");this.assertEquals(3,result);context=null;var boundAdd=qx.lang.Function.bind(add,this);result=boundAdd(1,3);this.assertEquals(context,this);this.assertEquals(4,result);context=null;var addOne=qx.lang.Function.bind(add,this,1);result=addOne(4);this.assertEquals(context,this);this.assertEquals(5,result);}}});qx.Class.define("qx.test.EditDistance",{extend:qx.dev.unit.TestCase,members:{assertTransform:function(strA,strB){arrA=qx.lang.String.toArray(strA);arrB=qx.lang.String.toArray(strB);var operations=qx.util.EditDistance.getEditOperations(arrA,arrB);for(var i=0,l=operations.length;i<l;i++){job=operations[i];switch(job.operation){case qx.util.EditDistance.OPERATION_DELETE:qx.lang.Array.removeAt(arrA,job.pos);break;case qx.util.EditDistance.OPERATION_REPLACE:arrA[job.pos]=job.value;break;case qx.util.EditDistance.OPERATION_INSERT:qx.lang.Array.insertAt(arrA,job.value,job.pos);break;default:throw new Error("Invalid operation: "+job.operation);}}result=arrA.join("");if(result!==strB){throw new Error("Implementation could not transform: "+strA+" to "+strB+"! Result was: "+result);}this.debug("Successfully transformed: "+strA+" to "+strB+".");},testBasics:function(){this.assertTransform("hello world","hallo welt");this.assertTransform("abcdef","abdcef");this.assertTransform("abcdef","fedcba");this.assertTransform("abcdef","abc");this.assertTransform("abcdef","def");this.assertTransform("abcdef","bcef");this.assertTransform("abcdef","abcghi");this.assertTransform("abcdef","abcstudef");}}});qx.Class.define("qx.util.EditDistance",{statics:{OPERATION_DELETE:1,OPERATION_INSERT:2,OPERATION_REPLACE:3,__computeLevenshteinDistance:function(dataA,dataB){var distance=[];var posA,posB,cost;for(posA=0;posA<=dataA.length;posA++){distance[posA]=[];distance[posA][0]=posA;}for(posB=1;posB<=dataB.length;posB++){distance[0][posB]=posB;}for(posA=1;posA<=dataA.length;posA++){for(posB=1;posB<=dataB.length;posB++){cost=dataA[posA-1]===dataB[posB-1]?0:1;if(distance[posA]===undefined){distance[posA]=[];}distance[posA][posB]=Math.min(distance[posA-1][posB]+1,distance[posA][posB-1]+1,distance[posA-1][posB-1]+cost);}}return distance;},__computeEditOperations:function(distance,dataA,dataB){var operations=[];var posA=dataA.length;var posB=dataB.length;if(posA===0){for(var i=0;i<posB;i++){operations.push({operation:this.OPERATION_INSERT,pos:i,old:null,value:dataB[i]});}return operations;}if(posB===0){for(var i=posA-1;i>=0;i--){operations.push({operation:this.OPERATION_DELETE,pos:i,old:dataA[i],value:null});}return operations;}while(posA!==0||posB!==0){if(posA!=0&&distance[posA][posB]==distance[posA-1][posB]+1){operations.push({operation:this.OPERATION_DELETE,pos:posA-1,old:dataA[posA-1],value:null});posA-=1;}else if(posB!=0&&distance[posA][posB]==distance[posA][posB-1]+1){operations.push({operation:this.OPERATION_INSERT,pos:posA,old:null,value:dataB[posB-1]});posB-=1;}else{if(dataA[posA-1]!==dataB[posB-1]){operations.push({operation:this.OPERATION_REPLACE,pos:posA-1,old:dataA[posA-1],value:dataB[posB-1]});}posA-=1;posB-=1;}}return operations;},getEditOperations:function(dataA,dataB){var distance=this.__computeLevenshteinDistance(dataA,dataB);var operations=this.__computeEditOperations(distance,dataA,dataB);return operations;}}});qx.Class.define("qx.test.Dom",{extend:qx.dev.unit.TestCase,members:{setUp:function(){var div=document.createElement("div");div.id="html_basics";div.innerHTML='<div id="test1">'+'<div id="test2"></div>'+'<div id="test3">'+'<div id="test4"></div>'+'</div>'+'</div>';document.body.appendChild(div);},tearDown:function(){var div=document.getElementById("html_basics");document.body.removeChild(div);},testIsDocument:function(){this.assertTrue(qx.dom.Node.isDocument(document));this.assertFalse(qx.dom.Node.isDocument(document.body));this.assertFalse(qx.dom.Node.isDocument(window));},testContains:function(){var test1=document.getElementById("test1");var test2=document.getElementById("test2");var test3=document.getElementById("test3");var test4=document.getElementById("test4");this.assertTrue(qx.dom.Hierarchy.contains(document,document.body));this.assertTrue(qx.dom.Hierarchy.contains(test1,test2));this.assertTrue(qx.dom.Hierarchy.contains(test1,test4));this.assertTrue(qx.dom.Hierarchy.contains(document,test2));this.assertTrue(qx.dom.Hierarchy.contains(document.body,test2));this.assertFalse(qx.dom.Hierarchy.contains(document.body,document));this.assertFalse(qx.dom.Hierarchy.contains(test2,test1));this.assertFalse(qx.dom.Hierarchy.contains(test4,test1));this.assertFalse(qx.dom.Hierarchy.contains(test2,document));this.assertFalse(qx.dom.Hierarchy.contains(test2,document.body));this.assertFalse(qx.dom.Hierarchy.contains(test2,test3));this.assertFalse(qx.dom.Hierarchy.contains(test2,test4));}}});qx.Class.define("qx.test.ui.Grid",{extend:qx.test.ui.LayoutTestCase,members:{setUp:function(){this._gridWidget=new qx.ui.container.Composite();this._gridLayout=new qx.ui.layout.Grid();this._gridWidget.setLayout(this._gridLayout);this.getRoot().add(this._gridWidget);},tearDown:function(){this.getRoot().remove(this._gridWidget);this._gridWidget.dispose();},_getFixedWidget:function(){var widget=new qx.ui.core.Widget();widget.set({width:200,height:100,allowGrowX:false,allowShrinkX:false,allowGrowY:false,allowShrinkY:false});return widget;},testAutoSize:function(){this._gridWidget.add(this._getFixedWidget(),{row:0,column:0});this._gridWidget.add(this._getFixedWidget(),{row:0,column:1});this._gridWidget.add(this._getFixedWidget(),{row:1,column:0});this._gridWidget.add(this._getFixedWidget(),{row:1,column:1});this.assertSize(this._gridWidget,400,200);this._gridLayout.setSpacingY(10);this._gridLayout.setSpacingX(20);this.assertSize(this._gridWidget,420,210);},testAddRemove:function(){var a=this._getFixedWidget();var b=this._getFixedWidget();var c=this._getFixedWidget();var d=this._getFixedWidget();this._gridLayout.setSpacingY(10);this._gridLayout.setSpacingX(20);this._gridWidget.add(a,{row:0,column:0});this._gridWidget.add(b,{row:0,column:1});this._gridWidget.add(c,{row:1,column:0});this._gridWidget.add(d,{row:1,column:1});this.assertSize(this._gridWidget,420,210);this._gridWidget.remove(b);this._gridWidget.remove(d);this.assertSize(this._gridWidget,200,210);this._gridWidget.remove(c);this._gridWidget.add(d,{row:0,column:1});this._gridWidget.add(b,{row:0,column:2});this._gridWidget.add(c,{row:0,column:3});this.assertSize(this._gridWidget,860,100);},testVisibility:function(){var a=this._getFixedWidget();var b=this._getFixedWidget();var c=this._getFixedWidget();var d=this._getFixedWidget();this._gridLayout.setSpacingY(10);this._gridLayout.setSpacingX(20);this._gridWidget.add(a,{row:0,column:0});this._gridWidget.add(b,{row:0,column:1});this._gridWidget.add(c,{row:1,column:0});this._gridWidget.add(d,{row:1,column:1});this.assertSize(this._gridWidget,420,210);a.setVisibility("hidden");b.setVisibility("hidden");c.setVisibility("hidden");this.assertSize(this._gridWidget,420,210);this.assertStyle(a,"display","none");this.assertStyle(b,"display","none");this.assertStyle(c,"display","none");b.setVisibility("visible");c.setVisibility("excluded");d.setVisibility("excluded");this.assertSize(this._gridWidget,420,100);this.assertStyle(b,"display","");this.assertStyle(c,"display","none");this.assertStyle(d,"display","none");a.setVisibility("excluded");b.setVisibility("excluded");c.setVisibility("visible");d.setVisibility("visible");this.assertSize(this._gridWidget,420,110);this.assertStyle(b,"display","none");this.assertStyle(b,"display","none");this.assertStyle(c,"display","");this.assertStyle(d,"display","");},testCellSize:function(){this._gridLayout.setRowHeight(0,40);this._gridLayout.setRowHeight(1,150);this._gridLayout.setColumnWidth(0,70);this._gridLayout.setColumnWidth(1,290);var a=new qx.ui.core.Widget();var b=new qx.ui.core.Widget();var c=new qx.ui.core.Widget();var d=new qx.ui.core.Widget();this._gridWidget.add(a,{row:0,column:0});this._gridWidget.add(b,{row:0,column:1});this._gridWidget.add(c,{row:1,column:0});this._gridWidget.add(d,{row:1,column:1});this.assertSize(a,70,40);this.assertSize(b,290,40);this.assertSize(c,70,150);this.assertSize(d,290,150);}}});qx.Class.define("qx.ui.layout.Grid",{extend:qx.ui.layout.Abstract,construct:function(spacingX,spacingY){this.base(arguments);this.__rowData=[];this.__colData=[];if(spacingX){this.setSpacingX(spacingX);}if(spacingY){this.setSpacingY(spacingY);}},properties:{spacingX:{check:"Integer",init:0,apply:"_applyLayoutChange"},spacingY:{check:"Integer",init:0,apply:"_applyLayoutChange"}},members:{__grid:null,__rowData:null,__colData:null,__colSpans:null,__rowSpans:null,__maxRowIndex:null,__maxColIndex:null,__rowHeights:null,__colWidths:null,verifyLayoutProperty:null,__buildGrid:function(){var grid=[];var colSpans=[];var rowSpans=[];var maxRowIndex=0;var maxColIndex=0;var children=this._getLayoutChildren();for(var i=0,l=children.length;i<l;i++){var child=children[i];var props=child.getLayoutProperties();var row=props.row;var column=props.column;props.colSpan=props.colSpan||1;props.rowSpan=props.rowSpan||1;if(row==null||column==null){throw new Error("The layout properties 'row' and 'column' must be defined!");}if(grid[row]&&grid[row][column]){throw new Error("There is already a widget in this cell ("+row+", "+column+")");}for(var x=column;x<column+props.colSpan;x++){for(var y=row;y<row+props.rowSpan;y++){if(grid[y]==undefined){grid[y]=[];}grid[y][x]=child;maxColIndex=Math.max(maxColIndex,x);maxRowIndex=Math.max(maxRowIndex,y);}}if(props.rowSpan>1){rowSpans.push(child);}if(props.colSpan>1){colSpans.push(child);}}for(var y=0;y<=maxRowIndex;y++){if(grid[y]==undefined){grid[y]=[];}}this.__grid=grid;this.__colSpans=colSpans;this.__rowSpans=rowSpans;this.__maxRowIndex=maxRowIndex;this.__maxColIndex=maxColIndex;delete this._invalidChildrenCache;},_setRowData:function(row,key,value){var rowData=this.__rowData[row];if(!rowData){this.__rowData[row]={};this.__rowData[row][key]=value;}else{rowData[key]=value;}},_setColumnData:function(column,key,value){var colData=this.__colData[column];if(!colData){this.__colData[column]={};this.__colData[column][key]=value;}else{colData[key]=value;}},setSpacing:function(spacing){this.setSpacingY(spacing);this.setSpacingX(spacing);},setColumnAlign:function(column,hAlign,vAlign){{};this._setColumnData(column,"hAlign",hAlign);this._setColumnData(column,"vAlign",vAlign);this._applyLayoutChange();return this;},getColumnAlign:function(column){var colData=this.__colData[column]||{};return {vAlign:colData.vAlign||"top",hAlign:colData.hAlign||"left"};},setRowAlign:function(row,hAlign,vAlign){{};this._setRowData(row,"hAlign",hAlign);this._setRowData(row,"vAlign",vAlign);this._applyLayoutChange();return this;},getRowAlign:function(row){var rowData=this.__rowData[row]||{};return {vAlign:rowData.vAlign||"top",hAlign:rowData.hAlign||"left"};},getCellWidget:function(row,column){if(this._invalidChildrenCache){this.__buildGrid();}return this.__grid[row][column]||null;},getCellAlign:function(row,column){var vAlign="top";var hAlign="left";var rowData=this.__rowData[row];var colData=this.__colData[column];var widget=this.__grid[row][column];if(widget){var widgetProps={vAlign:widget.getAlignY(),hAlign:widget.getAlignX()};}else{widgetProps={};}if(widgetProps.vAlign){vAlign=widgetProps.vAlign;}else if(rowData&&rowData.vAlign){vAlign=rowData.vAlign;}else if(colData&&colData.vAlign){vAlign=colData.vAlign;}if(widgetProps.hAlign){hAlign=widgetProps.hAlign;}else if(colData&&colData.hAlign){hAlign=colData.hAlign;}else if(rowData&&rowData.hAlign){hAlign=rowData.hAlign;}return {vAlign:vAlign,hAlign:hAlign};},setColumnFlex:function(column,flex){this._setColumnData(column,"flex",flex);this._applyLayoutChange();return this;},getColumnFlex:function(column){var colData=this.__colData[column]||{};return colData.flex!==undefined?colData.flex:0;},setRowFlex:function(row,flex){this._setRowData(row,"flex",flex);this._applyLayoutChange();return this;},getRowFlex:function(row){var rowData=this.__rowData[row]||{};var rowFlex=rowData.flex!==undefined?rowData.flex:0;return rowFlex;},setColumnMaxWidth:function(column,maxWidth){this._setColumnData(column,"maxWidth",maxWidth);this._applyLayoutChange();return this;},getColumnMaxWidth:function(column){var colData=this.__colData[column]||{};return colData.maxWidth!==undefined?colData.maxWidth:Infinity;},setColumnWidth:function(column,width){this._setColumnData(column,"width",width);this._applyLayoutChange();return this;},getColumnWidth:function(column){var colData=this.__colData[column]||{};return colData.width!==undefined?colData.width:null;},setColumnMinWidth:function(column,minWidth){this._setColumnData(column,"minWidth",minWidth);this._applyLayoutChange();return this;},getColumnMinWidth:function(column){var colData=this.__colData[column]||{};return colData.minWidth||0;},setRowMaxHeight:function(row,maxHeight){this._setRowData(row,"maxHeight",maxHeight);this._applyLayoutChange();return this;},getRowMaxHeight:function(row){var rowData=this.__rowData[row]||{};return rowData.maxHeight||Infinity;},setRowHeight:function(row,height){this._setRowData(row,"height",height);this._applyLayoutChange();return this;},getRowHeight:function(row){var rowData=this.__rowData[row]||{};return rowData.height!==undefined?rowData.height:null;},setRowMinHeight:function(row,minHeight){this._setRowData(row,"minHeight",minHeight);this._applyLayoutChange();return this;},getRowMinHeight:function(row){var rowData=this.__rowData[row]||{};return rowData.minHeight||0;},__getOuterSize:function(widget){var hint=widget.getSizeHint();var hMargins=widget.getMarginLeft()+widget.getMarginRight();var vMargins=widget.getMarginTop()+widget.getMarginBottom();var outerSize={height:hint.height+vMargins,width:hint.width+hMargins,minHeight:hint.minHeight+vMargins,minWidth:hint.minWidth+hMargins,maxHeight:hint.maxHeight+vMargins,maxWidth:hint.maxWidth+hMargins};return outerSize;},_fixHeightsRowSpan:function(rowHeights){var vSpacing=this.getSpacingY();for(var i=0,l=this.__rowSpans.length;i<l;i++){var widget=this.__rowSpans[i];var hint=this.__getOuterSize(widget);var widgetProps=widget.getLayoutProperties();var widgetRow=widgetProps.row;var prefSpanHeight=vSpacing*(widgetProps.rowSpan-1);var minSpanHeight=prefSpanHeight;var rowFlexes={};for(var j=0;j<widgetProps.rowSpan;j++){var row=widgetProps.row+j;var rowHeight=rowHeights[row];var rowFlex=this.getRowFlex(row);if(rowFlex>0){rowFlexes[row]={min:rowHeight.minHeight,value:rowHeight.height,max:rowHeight.maxHeight,flex:rowFlex};}prefSpanHeight+=rowHeight.height;minSpanHeight+=rowHeight.minHeight;}if(prefSpanHeight<hint.height){var rowIncrements=qx.ui.layout.Util.computeFlexOffsets(rowFlexes,hint.height,prefSpanHeight);for(var j=0;j<widgetProps.rowSpan;j++){var offset=rowIncrements[widgetRow+j]?rowIncrements[widgetRow+j].offset:0;rowHeights[widgetRow+j].height+=offset;}}if(minSpanHeight<hint.minHeight){var rowIncrements=qx.ui.layout.Util.computeFlexOffsets(rowFlexes,hint.minHeight,minSpanHeight);for(var j=0;j<widgetProps.rowSpan;j++){var offset=rowIncrements[widgetRow+j]?rowIncrements[widgetRow+j].offset:0;rowHeights[widgetRow+j].minHeight+=offset;}}}},_fixWidthsColSpan:function(colWidths){var hSpacing=this.getSpacingX();for(var i=0,l=this.__colSpans.length;i<l;i++){var widget=this.__colSpans[i];var hint=this.__getOuterSize(widget);var widgetProps=widget.getLayoutProperties();var widgetColumn=widgetProps.column;var prefSpanWidth=hSpacing*(widgetProps.colSpan-1);var minSpanWidth=prefSpanWidth;var colFlexes={};var offset;for(var j=0;j<widgetProps.colSpan;j++){var col=widgetProps.column+j;var colWidth=colWidths[col];var colFlex=this.getColumnFlex(col);if(colFlex>0){colFlexes[col]={min:colWidth.minWidth,value:colWidth.width,max:colWidth.maxWidth,flex:colFlex};}prefSpanWidth+=colWidth.width;minSpanWidth+=colWidth.minWidth;}if(prefSpanWidth<hint.width){var colIncrements=qx.ui.layout.Util.computeFlexOffsets(colFlexes,hint.width,prefSpanWidth);for(var j=0;j<widgetProps.colSpan;j++){offset=colIncrements[widgetColumn+j]?colIncrements[widgetColumn+j].offset:0;colWidths[widgetColumn+j].width+=offset;}}if(minSpanWidth<hint.minWidth){var colIncrements=qx.ui.layout.Util.computeFlexOffsets(colFlexes,hint.minWidth,minSpanWidth);for(var j=0;j<widgetProps.colSpan;j++){offset=colIncrements[widgetColumn+j]?colIncrements[widgetColumn+j].offset:0;colWidths[widgetColumn+j].minWidth+=offset;}}}},_getRowHeights:function(){if(this.__rowHeights!=null){return this.__rowHeights;}var rowHeights=[];var maxRowIndex=this.__maxRowIndex;var maxColIndex=this.__maxColIndex;for(var row=0;row<=maxRowIndex;row++){var minHeight=0;var height=0;var maxHeight=0;for(var col=0;col<=maxColIndex;col++){var widget=this.__grid[row][col];if(!widget){continue;}var widgetRowSpan=widget.getLayoutProperties().rowSpan||0;if(widgetRowSpan>1){continue;}var cellSize=this.__getOuterSize(widget);if(this.getRowFlex(row)>0){minHeight=Math.max(minHeight,cellSize.minHeight);}else{minHeight=Math.max(minHeight,cellSize.height);}height=Math.max(height,cellSize.height);}var minHeight=Math.max(minHeight,this.getRowMinHeight(row));var maxHeight=this.getRowMaxHeight(row);if(this.getRowHeight(row)!==null){var height=this.getRowHeight(row);}else{var height=Math.max(minHeight,Math.min(height,maxHeight));}rowHeights[row]={minHeight:minHeight,height:height,maxHeight:maxHeight};}if(this.__rowSpans.length>0){this._fixHeightsRowSpan(rowHeights);}this.__rowHeights=rowHeights;return rowHeights;},_getColWidths:function(){if(this.__colWidths!=null){return this.__colWidths;}var colWidths=[];var maxColIndex=this.__maxColIndex;var maxRowIndex=this.__maxRowIndex;for(var col=0;col<=maxColIndex;col++){var width=0;var minWidth=0;var maxWidth=Infinity;for(var row=0;row<=maxRowIndex;row++){var widget=this.__grid[row][col];if(!widget){continue;}var widgetColSpan=widget.getLayoutProperties().colSpan||0;if(widgetColSpan>1){continue;}var cellSize=this.__getOuterSize(widget);if(this.getColumnFlex(col)>0){minWidth=Math.max(minWidth,cellSize.minWidth);}else{minWidth=Math.max(minWidth,cellSize.width);}width=Math.max(width,cellSize.width);}var minWidth=Math.max(minWidth,this.getColumnMinWidth(col));var maxWidth=this.getColumnMaxWidth(col);if(this.getColumnWidth(col)!==null){var width=this.getColumnWidth(col);}else{var width=Math.max(minWidth,Math.min(width,maxWidth));}colWidths[col]={minWidth:minWidth,width:width,maxWidth:maxWidth};}if(this.__colSpans.length>0){this._fixWidthsColSpan(colWidths);}this.__colWidths=colWidths;return colWidths;},_getColumnFlexOffsets:function(width){var hint=this.getSizeHint();var diff=width-hint.width;if(diff==0){return {};}var colWidths=this._getColWidths();var flexibles={};for(var i=0,l=colWidths.length;i<l;i++){var col=colWidths[i];var colFlex=this.getColumnFlex(i);if((colFlex<=0)||(col.width==col.maxWidth&&diff>0)||(col.width==col.minWidth&&diff<0)){continue;}flexibles[i]={min:col.minWidth,value:col.width,max:col.maxWidth,flex:colFlex};}return qx.ui.layout.Util.computeFlexOffsets(flexibles,width,hint.width);},_getRowFlexOffsets:function(height){var hint=this.getSizeHint();var diff=height-hint.height;if(diff==0){return {};}var rowHeights=this._getRowHeights();var flexibles={};for(var i=0,l=rowHeights.length;i<l;i++){var row=rowHeights[i];var rowFlex=this.getRowFlex(i);if((rowFlex<=0)||(row.height==row.maxHeight&&diff>0)||(row.height==row.minHeight&&diff<0)){continue;}flexibles[i]={min:row.minHeight,value:row.height,max:row.maxHeight,flex:rowFlex};}return qx.ui.layout.Util.computeFlexOffsets(flexibles,height,hint.height);},renderLayout:function(availWidth,availHeight){if(this._invalidChildrenCache){this.__buildGrid();}var Util=qx.ui.layout.Util;var hSpacing=this.getSpacingX();var vSpacing=this.getSpacingY();var prefWidths=this._getColWidths();var colStretchOffsets=this._getColumnFlexOffsets(availWidth);var colWidths=[];var maxColIndex=this.__maxColIndex;var maxRowIndex=this.__maxRowIndex;var offset;for(var col=0;col<=maxColIndex;col++){offset=colStretchOffsets[col]?colStretchOffsets[col].offset:0;colWidths[col]=prefWidths[col].width+offset;}var prefHeights=this._getRowHeights();var rowStretchOffsets=this._getRowFlexOffsets(availHeight);var rowHeights=[];for(var row=0;row<=maxRowIndex;row++){offset=rowStretchOffsets[row]?rowStretchOffsets[row].offset:0;rowHeights[row]=prefHeights[row].height+offset;}var left=0;for(var col=0;col<=maxColIndex;col++){var top=0;for(var row=0;row<=maxRowIndex;row++){var widget=this.__grid[row][col];if(!widget){top+=rowHeights[row]+vSpacing;continue;}var widgetProps=widget.getLayoutProperties();if(widgetProps.row!==row||widgetProps.column!==col){top+=rowHeights[row]+vSpacing;continue;}var spanWidth=hSpacing*(widgetProps.colSpan-1);for(var i=0;i<widgetProps.colSpan;i++){spanWidth+=colWidths[col+i];}var spanHeight=vSpacing*(widgetProps.rowSpan-1);for(var i=0;i<widgetProps.rowSpan;i++){spanHeight+=rowHeights[row+i];}var cellHint=widget.getSizeHint();var marginTop=widget.getMarginTop();var marginLeft=widget.getMarginLeft();var marginBottom=widget.getMarginBottom();var marginRight=widget.getMarginRight();var cellWidth=Math.max(cellHint.minWidth,Math.min(spanWidth-marginLeft-marginRight,cellHint.maxWidth));var cellHeight=Math.max(cellHint.minHeight,Math.min(spanHeight-marginTop-marginBottom,cellHint.maxHeight));var cellAlign=this.getCellAlign(row,col);var cellLeft=left+Util.computeHorizontalAlignOffset(cellAlign.hAlign,cellWidth,spanWidth,marginLeft,marginRight);var cellTop=top+Util.computeVerticalAlignOffset(cellAlign.vAlign,cellHeight,spanHeight,marginTop,marginBottom);widget.renderLayout(cellLeft,cellTop,cellWidth,cellHeight);top+=rowHeights[row]+vSpacing;}left+=colWidths[col]+hSpacing;}},invalidateLayoutCache:function(){this.base(arguments);this.__colWidths=null;this.__rowHeights=null;},_computeSizeHint:function(){if(this._invalidChildrenCache){this.__buildGrid();}var colWidths=this._getColWidths();var minWidth=0,width=0;for(var i=0,l=colWidths.length;i<l;i++){var col=colWidths[i];if(this.getColumnFlex(i)>0){minWidth+=col.minWidth;}else{minWidth+=col.width;}width+=col.width;}var rowHeights=this._getRowHeights();var minHeight=0,height=0;for(var i=0,l=rowHeights.length;i<l;i++){var row=rowHeights[i];if(this.getRowFlex(i)>0){minHeight+=row.minHeight;}else{minHeight+=row.height;}height+=row.height;}var spacingX=this.getSpacingX()*(colWidths.length-1);var spacingY=this.getSpacingY()*(rowHeights.length-1);var hint={minWidth:minWidth+spacingX,width:width+spacingX,minHeight:minHeight+spacingY,height:height+spacingY};return hint;}},destruct:function(){this._disposeFields("__grid","__rowData","__colData","__colSpans","__rowSpans","__colWidths","__rowHeights");}});qx.Class.define("qx.ui.layout.Util",{statics:{PERCENT_VALUE:/[0-9]+(?:\.[0-9]+)?%/,computeFlexOffsets:function(flexibles,avail,used){var child,key,flexSum,flexStep;var grow=avail>used;var remaining=Math.abs(avail-used);var roundingOffset,currentOffset;var result={};for(key in flexibles){child=flexibles[key];result[key]={potential:grow?child.max-child.value:child.value-child.min,flex:grow?child.flex:1/child.flex,offset:0};}while(remaining!=0){flexStep=Infinity;flexSum=0;for(key in result){child=result[key];if(child.potential>0){flexSum+=child.flex;flexStep=Math.min(flexStep,child.potential/child.flex);}}if(flexSum==0){break;}flexStep=Math.min(remaining,flexStep*flexSum)/flexSum;roundingOffset=0;for(key in result){child=result[key];if(child.potential>0){currentOffset=Math.min(remaining,child.potential,Math.ceil(flexStep*child.flex));roundingOffset+=currentOffset-flexStep*child.flex;if(roundingOffset>=1){roundingOffset-=1;currentOffset-=1;}child.potential-=currentOffset;if(grow){child.offset+=currentOffset;}else{child.offset-=currentOffset;}remaining-=currentOffset;}}}return result;},computeHorizontalAlignOffset:function(align,width,availWidth,marginLeft,marginRight){if(marginLeft==null){marginLeft=0;}if(marginRight==null){marginRight=0;}var value=0;switch(align){case "left":value=marginLeft;break;case "right":value=availWidth-width-marginRight;break;case "center":value=Math.round((availWidth-width)/2);if(value<marginLeft){value=marginLeft;}else if(value<marginRight){value=Math.max(marginLeft,availWidth-width-marginRight);}break;}return value;},computeVerticalAlignOffset:function(align,height,availHeight,marginTop,marginBottom){if(marginTop==null){marginTop=0;}if(marginBottom==null){marginBottom=0;}var value=0;switch(align){case "top":value=marginTop;break;case "bottom":value=availHeight-height-marginBottom;break;case "middle":value=Math.round((availHeight-height)/2);if(value<marginTop){value=marginTop;}else if(value<marginBottom){value=Math.max(marginTop,availHeight-height-marginBottom);}break;}return value;},collapseMargins:function(varargs){var max=0,min=0;for(var i=0,l=arguments.length;i<l;i++){var value=arguments[i];if(value<0){min=Math.min(min,value);}else if(value>0){max=Math.max(max,value);}}return max+min;},computeHorizontalGaps:function(children,spacing,collapse){if(spacing==null){spacing=0;}var gaps=0;if(collapse){gaps+=children[0].getMarginLeft();for(var i=1,l=children.length;i<l;i+=1){gaps+=this.collapseMargins(spacing,children[i-1].getMarginRight(),children[i].getMarginLeft());}gaps+=children[l-1].getMarginRight();}else{for(var i=1,l=children.length;i<l;i+=1){gaps+=children[i].getMarginLeft()+children[i].getMarginRight();}gaps+=(spacing*(l-1));}return gaps;},computeVerticalGaps:function(children,spacing,collapse){if(spacing==null){spacing=0;}var gaps=0;if(collapse){gaps+=children[0].getMarginTop();for(var i=1,l=children.length;i<l;i+=1){gaps+=this.collapseMargins(spacing,children[i-1].getMarginBottom(),children[i].getMarginTop());}gaps+=children[l-1].getMarginBottom();}else{for(var i=1,l=children.length;i<l;i+=1){gaps+=children[i].getMarginTop()+children[i].getMarginBottom();}gaps+=(spacing*(l-1));}return gaps;},computeHorizontalSeparatorGaps:function(children,spacing,separator){var instance=qx.theme.manager.Decoration.getInstance().resolve(separator);var insets=instance.getInsets();var width=insets.left+insets.right;var gaps=0;for(var i=0,l=children.length;i<l;i++){var child=children[i];gaps+=child.getMarginLeft()+child.getMarginRight();}gaps+=(spacing+width+spacing)*(l-1);return gaps;},computeVerticalSeparatorGaps:function(children,spacing,separator){var instance=qx.theme.manager.Decoration.getInstance().resolve(separator);var insets=instance.getInsets();var height=insets.top+insets.bottom;var gaps=0;for(var i=0,l=children.length;i<l;i++){var child=children[i];gaps+=child.getMarginTop()+child.getMarginBottom();}gaps+=(spacing+height+spacing)*(l-1);return gaps;},arrangeIdeals:function(beginMin,beginIdeal,beginMax,endMin,endIdeal,endMax){if(beginIdeal<beginMin||endIdeal<endMin){if(beginIdeal<beginMin&&endIdeal<endMin){beginIdeal=beginMin;endIdeal=endMin;}else if(beginIdeal<beginMin){endIdeal-=(beginMin-beginIdeal);beginIdeal=beginMin;if(endIdeal<endMin){endIdeal=endMin;}}else if(endIdeal<endMin){beginIdeal-=(endMin-endIdeal);endIdeal=endMin;if(beginIdeal<beginMin){beginIdeal=beginMin;}}}if(beginIdeal>beginMax||endIdeal>endMax){if(beginIdeal>beginMax&&endIdeal>endMax){beginIdeal=beginMax;endIdeal=endMax;}else if(beginIdeal>beginMax){endIdeal+=(beginIdeal-beginMax);beginIdeal=beginMax;if(endIdeal>endMax){endIdeal=endMax;}}else if(endIdeal>endMax){beginIdeal+=(endIdeal-endMax);endIdeal=endMax;if(beginIdeal>beginMax){beginIdeal=beginMax;}}}return {begin:beginIdeal,end:endIdeal};}}});qx.Class.define("qx.test.ui.ChildrenHandling",{extend:qx.test.ui.LayoutTestCase,members:{assertArrayEquals:function(expected,found,msg){this.assertArray(expected,msg);this.assertArray(found,msg);this.assertEquals(expected.length,found.length,msg);for(var i=0;i<expected.length;i++){this.assertIdentical(expected[i],found[i],msg);}},_setChildren:function(parent,children){parent.removeAll();for(var i=0;i<children.length;i++){parent.add(children[i]);}qx.ui.core.queue.Manager.flush();this.assertArrayEquals(children,parent.getChildren());},testRemove:function(){var parent=new qx.ui.container.Composite(new qx.ui.layout.Basic());var c1=new qx.ui.core.Widget();var c2=new qx.ui.core.Widget();var c3=new qx.ui.core.Widget();var w1=new qx.ui.core.Widget();var children=[c1,c2,c3];this._setChildren(parent,children);parent.remove(c1);this.assertArrayEquals([c2,c3],parent.getChildren(),"remove first");this._setChildren(parent,children);parent.remove(c2);this.assertArrayEquals([c1,c3],parent.getChildren(),"remove middle");this._setChildren(parent,children);parent.remove(c3);this.assertArrayEquals([c1,c2],parent.getChildren(),"remove last");this._setChildren(parent,children);parent.remove(w1);this.assertArrayEquals([c1,c2,c3],parent.getChildren(),"remove non child");this._setChildren(parent,children);c1.destroy();c2.destroy();c3.destroy();w1.destroy();parent.destroy();},testRemoveAt:function(){var parent=new qx.ui.container.Composite(new qx.ui.layout.Basic());var c1=new qx.ui.core.Widget();var c2=new qx.ui.core.Widget();var c3=new qx.ui.core.Widget();var w1=new qx.ui.core.Widget();var children=[c1,c2,c3];this._setChildren(parent,children);parent.removeAt(0);this.assertArrayEquals([c2,c3],parent.getChildren(),"remove first");this._setChildren(parent,children);parent.removeAt(1);this.assertArrayEquals([c1,c3],parent.getChildren(),"remove middle");this._setChildren(parent,children);parent.removeAt(2);this.assertArrayEquals([c1,c2],parent.getChildren(),"remove last");if(this.isDebugOn()){this._setChildren(parent,children);this.assertException(function(){parent.removeAt(-1);},qx.core.AssertionError,"","remove at negative index");}if(this.isDebugOn()){this._setChildren(parent,children);this.assertException(function(){parent.removeAt(-1);},qx.core.AssertionError,"","remove at negative index");}c1.destroy();c2.destroy();c3.destroy();w1.destroy();parent.destroy();},testAddBefore:function(){var parent=new qx.ui.container.Composite(new qx.ui.layout.Basic());var c1=new qx.ui.core.Widget();var c2=new qx.ui.core.Widget();var c3=new qx.ui.core.Widget();var w1=new qx.ui.core.Widget();var w2=new qx.ui.core.Widget();var children=[c1,c2,c3];this._setChildren(parent,children);parent.addBefore(w1,c1);this.assertArrayEquals([w1,c1,c2,c3],parent.getChildren(),"add new widget at begin");this._setChildren(parent,children);parent.addBefore(w1,c3);this.assertArrayEquals([c1,c2,w1,c3],parent.getChildren(),"add new widget in the middle");this._setChildren(parent,children);if(this.isDebugOn()){var self=this;this.assertException(function(){parent.addBefore(w1,w2);},qx.core.AssertionError,"","add new widget before non child");this._setChildren(parent,children);}parent.addBefore(c1,c1);this.assertArrayEquals([c1,c2,c3],parent.getChildren(),"add existing before itself");this._setChildren(parent,children);parent.addBefore(c3,c1);this.assertArrayEquals([c3,c1,c2],parent.getChildren(),"add existing before first");this._setChildren(parent,children);parent.addBefore(c3,c2);this.assertArrayEquals([c1,c3,c2],parent.getChildren(),"add existing in the middle");this._setChildren(parent,children);if(this.isDebugOn()){var self=this;this.assertException(function(){parent.addBefore(c3,w2);},qx.core.AssertionError,"","add existing before non child");this._setChildren(parent,children);}c1.destroy();c2.destroy();c3.destroy();w1.destroy();w2.destroy();parent.destroy();},testAddAfter:function(){var parent=new qx.ui.container.Composite(new qx.ui.layout.Basic());var c1=new qx.ui.core.Widget();var c2=new qx.ui.core.Widget();var c3=new qx.ui.core.Widget();var w1=new qx.ui.core.Widget();var w2=new qx.ui.core.Widget();var children=[c1,c2,c3];this._setChildren(parent,children);parent.addAfter(w1,c3);this.assertArrayEquals([c1,c2,c3,w1],parent.getChildren(),"add new widget ar end");this._setChildren(parent,children);parent.addAfter(w1,c1);this.assertArrayEquals([c1,w1,c2,c3],parent.getChildren(),"add new widget in the middle");this._setChildren(parent,children);if(this.isDebugOn()){var self=this;this.assertException(function(){parent.addAfter(w1,w2);},qx.core.AssertionError,"","add new widget after non child");this._setChildren(parent,children);}parent.addAfter(c1,c1);this.assertArrayEquals([c1,c2,c3],parent.getChildren(),"add existing before itself");this._setChildren(parent,children);parent.addAfter(c1,c3);this.assertArrayEquals([c2,c3,c1],parent.getChildren(),"add existing before last");this._setChildren(parent,children);parent.addAfter(c1,c2);this.assertArrayEquals([c2,c1,c3],parent.getChildren(),"add existing in the middle");this._setChildren(parent,children);if(this.isDebugOn()){var self=this;this.assertException(function(){parent.addAfter(c1,w2);},qx.core.AssertionError,"","add existing after non child");this._setChildren(parent,children);}c1.destroy();c2.destroy();c3.destroy();w1.destroy();w2.destroy();parent.destroy();},testDoubleAdd:function(){var parent=new qx.ui.container.Composite(new qx.ui.layout.Basic());var children=[];for(var i=0;i<4;i++){children[i]=new qx.ui.core.Widget();parent.add(children[i]);}this.assertArrayEquals(children,parent.getChildren());var child=children[1];parent.add(child);qx.lang.Array.remove(children,child);children.push(child);this.assertArrayEquals(children,parent.getChildren());parent.destroy();}}});qx.Class.define("qx.ui.layout.Basic",{extend:qx.ui.layout.Abstract,members:{verifyLayoutProperty:null,renderLayout:function(availWidth,availHeight){var children=this._getLayoutChildren();var child,size,props,left,top;for(var i=0,l=children.length;i<l;i++){child=children[i];size=child.getSizeHint();props=child.getLayoutProperties();left=(props.left||0)+child.getMarginLeft();top=(props.top||0)+child.getMarginTop();child.renderLayout(left,top,size.width,size.height);}},_computeSizeHint:function(){var children=this._getLayoutChildren();var child,size,props;var neededWidth=0,neededHeight=0;var localWidth,localHeight;for(var i=0,l=children.length;i<l;i++){child=children[i];size=child.getSizeHint();props=child.getLayoutProperties();localWidth=size.width+(props.left||0)+child.getMarginLeft()+child.getMarginRight();localHeight=size.height+(props.top||0)+child.getMarginTop()+child.getMarginBottom();if(localWidth>neededWidth){neededWidth=localWidth;}if(localHeight>neededHeight){neededHeight=localHeight;}}return {width:neededWidth,height:neededHeight};}}});qx.Class.define("qx.test.ui.table.Dispose",{extend:qx.test.ui.LayoutTestCase,members:{testSimple:function(){this.assertDestroy(function(){var tableModel=new qx.ui.table.model.Simple();tableModel.setColumns(["ID","A number","A date","Boolean"]);tableModel.setData([[]]);var table=new qx.ui.table.Table(tableModel);this.getRoot().add(table);qx.ui.core.queue.Manager.flush();table.destroy();tableModel.dispose();},this,"Dispose simple table");}}});qx.Interface.define("qx.ui.table.ITableModel",{events:{"dataChanged":"qx.event.type.DataEvent","metaDataChanged":"qx.event.type.DataEvent"},statics:{EVENT_TYPE_DATA_CHANGED:"dataChanged",EVENT_TYPE_META_DATA_CHANGED:"metaDataChanged"},members:{getRowCount:function(){},getRowData:function(rowIndex){},getColumnCount:function(){},getColumnId:function(columnIndex){},getColumnIndexById:function(columnId){},getColumnName:function(columnIndex){},isColumnEditable:function(columnIndex){},isColumnSortable:function(columnIndex){},sortByColumn:function(columnIndex,ascending){},getSortColumnIndex:function(){},isSortAscending:function(){},prefetchRows:function(firstRowIndex,lastRowIndex){},getValue:function(columnIndex,rowIndex){},getValueById:function(columnId,rowIndex){},setValue:function(columnIndex,rowIndex,value){},setValueById:function(columnId,rowIndex,value){}}});qx.Class.define("qx.ui.table.model.Abstract",{type:"abstract",extend:qx.core.Object,implement:qx.ui.table.ITableModel,events:{"dataChanged":"qx.event.type.DataEvent","metaDataChanged":"qx.event.type.DataEvent"},construct:function(){this.base(arguments);this.__columnIdArr=[];this.__columnNameArr=[];this.__columnIndexMap={};},members:{__columnIdArr:null,__columnNameArr:null,__columnIndexMap:null,__internalChange:null,getRowCount:function(){throw new Error("getRowCount is abstract");},getRowData:function(rowIndex){return null;},isColumnEditable:function(columnIndex){return false;},isColumnSortable:function(columnIndex){return false;},sortByColumn:function(columnIndex,ascending){},getSortColumnIndex:function(){return -1;},isSortAscending:function(){return true;},prefetchRows:function(firstRowIndex,lastRowIndex){},getValue:function(columnIndex,rowIndex){throw new Error("getValue is abstract");},getValueById:function(columnId,rowIndex){return this.getValue(this.getColumnIndexById(columnId),rowIndex);},setValue:function(columnIndex,rowIndex,value){throw new Error("setValue is abstract");},setValueById:function(columnId,rowIndex,value){return this.setValue(this.getColumnIndexById(columnId),rowIndex,value);},getColumnCount:function(){return this.__columnIdArr.length;},getColumnIndexById:function(columnId){return this.__columnIndexMap[columnId];},getColumnId:function(columnIndex){return this.__columnIdArr[columnIndex];},getColumnName:function(columnIndex){return this.__columnNameArr[columnIndex];},setColumnIds:function(columnIdArr){this.__columnIdArr=columnIdArr;this.__columnIndexMap={};for(var i=0;i<columnIdArr.length;i++){this.__columnIndexMap[columnIdArr[i]]=i;}this.__columnNameArr=new Array(columnIdArr.length);if(!this.__internalChange){this.fireEvent(qx.ui.table.ITableModel.EVENT_TYPE_META_DATA_CHANGED);}},setColumnNamesByIndex:function(columnNameArr){if(this.__columnIdArr.length!=columnNameArr.length){throw new Error("this.__columnIdArr and columnNameArr have different length: "+this.__columnIdArr.length+" != "+columnNameArr.length);}this.__columnNameArr=columnNameArr;this.fireEvent(qx.ui.table.ITableModel.EVENT_TYPE_META_DATA_CHANGED);},setColumnNamesById:function(columnNameMap){this.__columnNameArr=new Array(this.__columnIdArr.length);for(var i=0;i<this.__columnIdArr.length;++i){this.__columnNameArr[i]=columnNameMap[this.__columnIdArr[i]];}},setColumns:function(columnNameArr,columnIdArr){if(columnIdArr==null){columnIdArr=columnNameArr;}if(columnIdArr.length!=columnNameArr.length){throw new Error("columnIdArr and columnNameArr have different length: "+columnIdArr.length+" != "+columnNameArr.length);}this.__internalChange=true;this.setColumnIds(columnIdArr);this.__internalChange=false;this.setColumnNamesByIndex(columnNameArr);}},destruct:function(){this._disposeFields("__columnIdArr","__columnNameArr","__columnIndexMap");}});qx.Class.define("qx.ui.table.model.Simple",{extend:qx.ui.table.model.Abstract,construct:function(){this.base(arguments);this.__rowArr=[];this.__sortColumnIndex=-1;this.__sortAscending;this.__sortMethods=[];this.__editableColArr=null;},properties:{caseSensitiveSorting:{check:"Boolean",init:true}},statics:{_defaultSortComparatorAscending:function(row1,row2){var obj1=row1[arguments.callee.columnIndex];var obj2=row2[arguments.callee.columnIndex];return (obj1>obj2)?1:((obj1==obj2)?0:-1);},_defaultSortComparatorInsensitiveAscending:function(row1,row2){var obj1=(isNaN(row1[arguments.callee.columnIndex])?row1[arguments.callee.columnIndex].toLowerCase():row1[arguments.callee.columnIndex]);var obj2=(isNaN(row2[arguments.callee.columnIndex])?row2[arguments.callee.columnIndex].toLowerCase():row2[arguments.callee.columnIndex]);return (obj1>obj2)?1:((obj1==obj2)?0:-1);},_defaultSortComparatorDescending:function(row1,row2){var obj1=row1[arguments.callee.columnIndex];var obj2=row2[arguments.callee.columnIndex];return (obj1<obj2)?1:((obj1==obj2)?0:-1);},_defaultSortComparatorInsensitiveDescending:function(row1,row2){var obj1=(isNaN(row1[arguments.callee.columnIndex])?row1[arguments.callee.columnIndex].toLowerCase():row1[arguments.callee.columnIndex]);var obj2=(isNaN(row2[arguments.callee.columnIndex])?row2[arguments.callee.columnIndex].toLowerCase():row2[arguments.callee.columnIndex]);return (obj1<obj2)?1:((obj1==obj2)?0:-1);}},members:{__rowArr:null,__editableColArr:null,__sortableColArr:null,__sortMethods:null,__sortColumnIndex:null,__sortAscending:null,getRowData:function(rowIndex){var rowData=this.__rowArr[rowIndex];if(rowData==null||rowData.originalData==null){return rowData;}else{return rowData.originalData;}},getRowDataAsMap:function(rowIndex){var columnArr=this.__rowArr[rowIndex];var map={};for(var col=0;col<this.getColumnCount();col++){map[this.getColumnId(col)]=columnArr[col];}return map;},setEditable:function(editable){this.__editableColArr=[];for(var col=0;col<this.getColumnCount();col++){this.__editableColArr[col]=editable;}this.fireEvent(qx.ui.table.ITableModel.EVENT_TYPE_META_DATA_CHANGED);},setColumnEditable:function(columnIndex,editable){if(editable!=this.isColumnEditable(columnIndex)){if(this.__editableColArr==null){this.__editableColArr=[];}this.__editableColArr[columnIndex]=editable;this.fireEvent(qx.ui.table.ITableModel.EVENT_TYPE_META_DATA_CHANGED);}},isColumnEditable:function(columnIndex){return this.__editableColArr?(this.__editableColArr[columnIndex]==true):false;},setColumnSortable:function(columnIndex,sortable){if(sortable!=this.isColumnSortable(columnIndex)){if(this.__sortableColArr==null){this.__sortableColArr=[];}this.__sortableColArr[columnIndex]=sortable;this.fireEvent(qx.ui.table.ITableModel.EVENT_TYPE_META_DATA_CHANGED);}},isColumnSortable:function(columnIndex){return (this.__sortableColArr?(this.__sortableColArr[columnIndex]!==false):true);},sortByColumn:function(columnIndex,ascending){var comparator;var sortMethods=this.__sortMethods[columnIndex];if(sortMethods){comparator=(ascending?sortMethods.ascending:sortMethods.descending);}else{if(this.getCaseSensitiveSorting()){comparator=(ascending?qx.ui.table.model.Simple._defaultSortComparatorAscending:qx.ui.table.model.Simple._defaultSortComparatorDescending);}else{comparator=(ascending?qx.ui.table.model.Simple._defaultSortComparatorInsensitiveAscending:qx.ui.table.model.Simple._defaultSortComparatorInsensitiveDescending);}}comparator.columnIndex=columnIndex;this.__rowArr.sort(comparator);this.__sortColumnIndex=columnIndex;this.__sortAscending=ascending;this.fireEvent(qx.ui.table.ITableModel.EVENT_TYPE_META_DATA_CHANGED);},setSortMethods:function(columnIndex,methods){this.__sortMethods[columnIndex]=methods;},clearSorting:function(){if(this.__sortColumnIndex!=-1){this.__sortColumnIndex=-1;this.__sortAscending=true;this.fireEvent(qx.ui.table.ITableModel.EVENT_TYPE_META_DATA_CHANGED);}},getSortColumnIndex:function(){return this.__sortColumnIndex;},isSortAscending:function(){return this.__sortAscending;},getRowCount:function(){return this.__rowArr.length;},getValue:function(columnIndex,rowIndex){if(rowIndex<0||rowIndex>=this.__rowArr.length){throw new Error("this.__rowArr out of bounds: "+rowIndex+" (0.."+this.__rowArr.length+")");}return this.__rowArr[rowIndex][columnIndex];},setValue:function(columnIndex,rowIndex,value){if(this.__rowArr[rowIndex][columnIndex]!=value){this.__rowArr[rowIndex][columnIndex]=value;if(this.hasListener(qx.ui.table.ITableModel.EVENT_TYPE_DATA_CHANGED)){var data={firstRow:rowIndex,lastRow:rowIndex,firstColumn:columnIndex,lastColumn:columnIndex};this.fireDataEvent(qx.ui.table.ITableModel.EVENT_TYPE_DATA_CHANGED,data);}if(columnIndex==this.__sortColumnIndex){this.clearSorting();}}},setData:function(rowArr,clearSorting){this.__rowArr=rowArr;if(this.hasListener(qx.ui.table.ITableModel.EVENT_TYPE_DATA_CHANGED)){var data={firstRow:0,lastRow:rowArr.length-1,firstColumn:0,lastColumn:this.getColumnCount()-1};this.fireDataEvent(qx.ui.table.ITableModel.EVENT_TYPE_DATA_CHANGED,data);}if(clearSorting!==false){this.clearSorting();}},getData:function(){return this.__rowArr;},setDataAsMapArray:function(mapArr,rememberMaps,clearSorting){this.setData(this._mapArray2RowArr(mapArr,rememberMaps),clearSorting);},addRows:function(rowArr,startIndex,clearSorting){if(startIndex==null){startIndex=this.__rowArr.length;}rowArr.splice(0,0,startIndex,0);Array.prototype.splice.apply(this.__rowArr,rowArr);var data={firstRow:startIndex,lastRow:this.__rowArr.length-1,firstColumn:0,lastColumn:this.getColumnCount()-1};this.fireDataEvent(qx.ui.table.ITableModel.EVENT_TYPE_DATA_CHANGED,data);if(clearSorting!==false){this.clearSorting();}},addRowsAsMapArray:function(mapArr,startIndex,rememberMaps,clearSorting){this.addRows(this._mapArray2RowArr(mapArr,rememberMaps),startIndex,clearSorting);},removeRows:function(startIndex,howMany,clearSorting){this.__rowArr.splice(startIndex,howMany);var data={firstRow:startIndex,lastRow:this.__rowArr.length-1,firstColumn:0,lastColumn:this.getColumnCount()-1,removeStart:startIndex,removeCount:howMany};this.fireDataEvent(qx.ui.table.ITableModel.EVENT_TYPE_DATA_CHANGED,data);if(clearSorting!==false){this.clearSorting();}},_mapArray2RowArr:function(mapArr,rememberMaps){var rowCount=mapArr.length;var columnCount=this.getColumnCount();var dataArr=new Array(rowCount);var columnArr;for(var i=0;i<rowCount;++i){columnArr=[];if(rememberMaps){columnArr.originalData=mapArr[i];}for(var j=0;j<columnCount;++j){columnArr[j]=mapArr[i][this.getColumnId(j)];}dataArr[i]=columnArr;}return dataArr;}},destruct:function(){this._disposeFields("__rowArr","__editableColArr","__sortMethods","__sortableColArr");}});qx.Class.define("qx.ui.table.Table",{extend:qx.ui.core.Widget,construct:function(tableModel,custom){this.base(arguments);if(!custom){custom={};}if(custom.selectionManager){this.setNewSelectionManager(custom.selectionManager);}if(custom.selectionModel){this.setNewSelectionModel(custom.selectionModel);}if(custom.tableColumnModel){this.setNewTableColumnModel(custom.tableColumnModel);}if(custom.tablePane){this.setNewTablePane(custom.tablePane);}if(custom.tablePaneHeader){this.setNewTablePaneHeader(custom.tablePaneHeader);}if(custom.tablePaneScroller){this.setNewTablePaneScroller(custom.tablePaneScroller);}if(custom.tablePaneModel){this.setNewTablePaneModel(custom.tablePaneModel);}this._setLayout(new qx.ui.layout.VBox());this.__scrollerParent=new qx.ui.container.Composite(new qx.ui.layout.HBox());this.__statusBar=this._getChildControl("statusbar");this._add(this.__scrollerParent,{flex:1});this._add(this.__statusBar);this.__columnVisibilityBt=this._getChildControl("column-button");this.setDataRowRenderer(new qx.ui.table.rowrenderer.Default(this));this.__selectionManager=this.getNewSelectionManager()(this);this.setSelectionModel(this.getNewSelectionModel()(this));this.setTableColumnModel(this.getNewTableColumnModel()(this));if(tableModel!=null){this.setTableModel(tableModel);}this.setMetaColumnCounts([-1]);this.setTabIndex(1);this.addListener("keypress",this._onKeyPress);this.addListener("focus",this._onFocusChanged);this.addListener("blur",this._onFocusChanged);var spacer=new qx.ui.core.Widget().set({height:0});this._add(spacer);spacer.addListener("resize",this._onResize,this);this.__focusedCol=null;this.__focusedRow=null;if(qx.core.Variant.isSet("qx.dynamicLocaleSwitch","on")){qx.locale.Manager.getInstance().addListener("changeLocale",this._onChangeLocale,this);}},events:{"columnVisibilityMenuCreateStart":"qx.event.type.DataEvent","columnVisibilityMenuCreateEnd":"qx.event.type.DataEvent","tableWidthChanged":"qx.event.type.Event","verticalScrollBarChanged":"qx.event.type.DataEvent","cellClick":"qx.ui.table.pane.CellEvent","cellDblclick":"qx.ui.table.pane.CellEvent","cellContextmenu":"qx.ui.table.pane.CellEvent"},statics:{__redirectEvents:{cellClick:1,cellDblclick:1,cellContextmenu:1}},properties:{appearance:{refine:true,init:"table"},focusable:{refine:true,init:true},selectionModel:{check:"qx.ui.table.selection.Model",apply:"_applySelectionModel",event:"changeSelectionModel"},tableModel:{check:"qx.ui.table.ITableModel",apply:"_applyTableModel",event:"changeTableModel",nullable:true},tableColumnModel:{check:"qx.ui.table.columnmodel.Basic",apply:"_applyTableColumnModel",event:"changeTableColumnModel"},rowHeight:{check:"Number",init:20,apply:"_applyRowHeight",event:"changeRowHeight"},forceLineHeight:{check:"Boolean",init:true},headerCellHeight:{check:"Integer",init:16,apply:"_applyHeaderCellHeight",event:"changeHeaderCellHeight"},statusBarVisible:{check:"Boolean",init:true,apply:"_applyStatusBarVisible"},additionalStatusBarText:{nullable:true,init:null,apply:"_applyAdditionalStatusBarText"},columnVisibilityButtonVisible:{check:"Boolean",init:true,apply:"_applyColumnVisibilityButtonVisible"},metaColumnCounts:{check:"Object",apply:"_applyMetaColumnCounts"},focusCellOnMouseMove:{check:"Boolean",init:false,apply:"_applyFocusCellOnMouseMove"},showCellFocusIndicator:{check:"Boolean",init:true,apply:"_applyShowCellFocusIndicator"},keepFirstVisibleRowComplete:{check:"Boolean",init:true,apply:"_applyKeepFirstVisibleRowComplete"},alwaysUpdateCells:{check:"Boolean",init:false},dataRowRenderer:{check:"qx.ui.table.IRowRenderer",init:null,nullable:true,event:"changeDataRowRenderer"},modalCellEditorPreOpenFunction:{check:"Function",init:null,nullable:true},newSelectionManager:{check:"Function",init:function(obj){return new qx.ui.table.selection.Manager(obj);}},newSelectionModel:{check:"Function",init:function(obj){return new qx.ui.table.selection.Model(obj);}},newTableColumnModel:{check:"Function",init:function(obj){return new qx.ui.table.columnmodel.Basic(obj);}},newTablePane:{check:"Function",init:function(obj){return new qx.ui.table.pane.Pane(obj);}},newTablePaneHeader:{check:"Function",init:function(obj){return new qx.ui.table.pane.Header(obj);}},newTablePaneScroller:{check:"Function",init:function(obj){return new qx.ui.table.pane.Scroller(obj);}},newTablePaneModel:{check:"Function",init:function(columnModel){return new qx.ui.table.pane.Model(columnModel);}}},members:{__focusedCol:null,__focusedRow:null,__scrollerParent:null,__statusBar:null,__columnVisibilityBt:null,__selectionManager:null,__additionalStatusBarText:null,__lastRowCount:null,__internalChange:null,_createChildControlImpl:function(id){var control;switch(id){case "statusbar":control=new qx.ui.basic.Label().set({allowGrowX:true});break;case "column-button":control=new qx.ui.form.MenuButton().set({focusable:false});break;}return control||this.base(arguments,id);},_applySelectionModel:function(value,old){this.__selectionManager.setSelectionModel(value);if(old!=null){old.removeListener("changeSelection",this._onSelectionChanged,this);}value.addListener("changeSelection",this._onSelectionChanged,this);},_applyRowHeight:function(value,old){if(!this.getTableModel()){return;}var scrollerArr=this._getPaneScrollerArr();for(var i=0;i<scrollerArr.length;i++){scrollerArr[i].updateVerScrollBarMaximum();}},_applyHeaderCellHeight:function(value,old){var scrollerArr=this._getPaneScrollerArr();for(var i=0;i<scrollerArr.length;i++){scrollerArr[i].getHeader().setHeight(value);}},_applyTableModel:function(value,old){this.getTableColumnModel().init(value.getColumnCount(),this);if(old!=null){old.removeListener(qx.ui.table.ITableModel.EVENT_TYPE_META_DATA_CHANGED,this._onTableModelMetaDataChanged,this);old.removeListener(qx.ui.table.ITableModel.EVENT_TYPE_DATA_CHANGED,this._onTableModelDataChanged,this);}value.addListener(qx.ui.table.ITableModel.EVENT_TYPE_META_DATA_CHANGED,this._onTableModelMetaDataChanged,this);value.addListener(qx.ui.table.ITableModel.EVENT_TYPE_DATA_CHANGED,this._onTableModelDataChanged,this);this._updateStatusBar();this._initColumnMenu();},_applyTableColumnModel:function(value,old){if(old!=null){throw new Error("The table column model can only be set once per table.");}value.addListener("visibilityChanged",this._onColVisibilityChanged,this);value.addListener("widthChanged",this._onColWidthChanged,this);value.addListener("orderChanged",this._onColOrderChanged,this);var tm=this.getTableModel();if(tm){value.init(tm.getColumnCount(),this);}var scrollerArr=this._getPaneScrollerArr();for(var i=0;i<scrollerArr.length;i++){var paneScroller=scrollerArr[i];var paneModel=paneScroller.getTablePaneModel();paneModel.setTableColumnModel(value);}},_applyStatusBarVisible:function(value,old){this.__statusBar.setVisibility(value?"visible":"excluded");if(value){this._updateStatusBar();}},_applyAdditionalStatusBarText:function(value,old){this.__additionalStatusBarText=value;this._updateStatusBar();},_applyColumnVisibilityButtonVisible:function(value,old){this.__columnVisibilityBt.setVisibility(value?"visible":"excluded");},_applyMetaColumnCounts:function(value,old){var metaColumnCounts=value;var scrollerArr=this._getPaneScrollerArr();this._cleanUpMetaColumns(metaColumnCounts.length);var leftX=0;for(var i=0;i<scrollerArr.length;i++){var paneScroller=scrollerArr[i];var paneModel=paneScroller.getTablePaneModel();paneModel.setFirstColumnX(leftX);paneModel.setMaxColumnCount(metaColumnCounts[i]);leftX+=metaColumnCounts[i];}if(metaColumnCounts.length>scrollerArr.length){var columnModel=this.getTableColumnModel();for(var i=scrollerArr.length;i<metaColumnCounts.length;i++){var paneModel=this.getNewTablePaneModel()(columnModel);paneModel.setFirstColumnX(leftX);paneModel.setMaxColumnCount(metaColumnCounts[i]);leftX+=metaColumnCounts[i];var paneScroller=this.getNewTablePaneScroller()(this);paneScroller.setTablePaneModel(paneModel);paneScroller.addListener("changeScrollY",this._onScrollY,this);var flex=(i==metaColumnCounts.length-1)?1:0;this.__scrollerParent.add(paneScroller,{flex:flex});scrollerArr=this._getPaneScrollerArr();}}for(var i=0;i<scrollerArr.length;i++){var paneScroller=scrollerArr[i];var isLast=(i==(scrollerArr.length-1));paneScroller.getHeader().setHeight(this.getHeaderCellHeight());paneScroller.setTopRightWidget(isLast?this.__columnVisibilityBt:null);}this._updateScrollerWidths();this._updateScrollBarVisibility();},_applyFocusCellOnMouseMove:function(value,old){var scrollerArr=this._getPaneScrollerArr();for(var i=0;i<scrollerArr.length;i++){scrollerArr[i].setFocusCellOnMouseMove(value);}},_applyShowCellFocusIndicator:function(value,old){var scrollerArr=this._getPaneScrollerArr();for(var i=0;i<scrollerArr.length;i++){scrollerArr[i].setShowCellFocusIndicator(value);}},_applyKeepFirstVisibleRowComplete:function(value,old){var scrollerArr=this._getPaneScrollerArr();for(var i=0;i<scrollerArr.length;i++){scrollerArr[i].onKeepFirstVisibleRowCompleteChanged();}},getSelectionManager:function(){return this.__selectionManager;},_getPaneScrollerArr:function(){return this.__scrollerParent.getChildren();},getPaneScroller:function(metaColumn){return this._getPaneScrollerArr()[metaColumn];},_cleanUpMetaColumns:function(fromMetaColumn){var scrollerArr=this._getPaneScrollerArr();if(scrollerArr!=null){for(var i=scrollerArr.length-1;i>=fromMetaColumn;i--){scrollerArr[i].dispose();}}},_onChangeLocale:function(evt){this.updateContent();this._updateStatusBar();},_onSelectionChanged:function(evt){var scrollerArr=this._getPaneScrollerArr();for(var i=0;i<scrollerArr.length;i++){scrollerArr[i].onSelectionChanged();}this._updateStatusBar();},_onTableModelMetaDataChanged:function(evt){var scrollerArr=this._getPaneScrollerArr();for(var i=0;i<scrollerArr.length;i++){scrollerArr[i].onTableModelMetaDataChanged();}this._updateStatusBar();},_onTableModelDataChanged:function(evt){var scrollerArr=this._getPaneScrollerArr();var data=evt.getData();if(data.removeCount){this.getSelectionModel().removeSelectionInterval(data.removeStart,data.removeStart+data.removeCount);}for(var i=0;i<scrollerArr.length;i++){scrollerArr[i].onTableModelDataChanged(data.firstRow,data.lastRow,data.firstColumn,data.lastColumn);}var rowCount=this.getTableModel().getRowCount();if(rowCount!=this.__lastRowCount){this.__lastRowCount=rowCount;this._updateScrollBarVisibility();this._updateStatusBar();}},_onScrollY:function(evt){if(!this.__internalChange){this.__internalChange=true;var scrollerArr=this._getPaneScrollerArr();for(var i=0;i<scrollerArr.length;i++){scrollerArr[i].setScrollY(evt.getData());}this.__internalChange=false;}},_onKeyPress:function(evt){if(!this.getEnabled()){return;}var oldFocusedRow=this.__focusedRow;var consumed=true;var identifier=evt.getKeyIdentifier();if(this.isEditing()){if(evt.getModifiers()==0){switch(identifier){case "Enter":this.stopEditing();var oldFocusedRow=this.__focusedRow;this.moveFocusedCell(0,1);if(this.__focusedRow!=oldFocusedRow){consumed=this.startEditing();}break;case "Escape":this.cancelEditing();this.focus();break;default:consumed=false;break;}}return;}else{if(evt.isCtrlPressed()){consumed=true;switch(identifier){case "A":var rowCount=this.getTableModel().getRowCount();if(rowCount>0){this.getSelectionModel().setSelectionInterval(0,rowCount-1);}break;default:consumed=false;break;}}else{switch(identifier){case "Space":this.__selectionManager.handleSelectKeyDown(this.__focusedRow,evt);break;case "F2":case "Enter":consumed=this.startEditing();break;case "Home":this.setFocusedCell(this.__focusedCol,0,true);break;case "End":var rowCount=this.getTableModel().getRowCount();this.setFocusedCell(this.__focusedCol,rowCount-1,true);break;case "Left":this.moveFocusedCell(-1,0);break;case "Right":this.moveFocusedCell(1,0);break;case "Up":this.moveFocusedCell(0,-1);break;case "Down":this.moveFocusedCell(0,1);break;case "PageUp":case "PageDown":var scroller=this.getPaneScroller(0);var pane=scroller.getTablePane();var rowCount=pane.getVisibleRowCount()-1;var rowHeight=this.getRowHeight();var direction=(identifier=="PageUp")?-1:1;scroller.setScrollY(scroller.getScrollY()+direction*rowCount*rowHeight);this.moveFocusedCell(0,direction*rowCount);break;default:consumed=false;}}}if(oldFocusedRow!=this.__focusedRow){this.__selectionManager.handleMoveKeyDown(this.__focusedRow,evt);}if(consumed){evt.preventDefault();evt.stopPropagation();}},_onFocusChanged:function(evt){var scrollerArr=this._getPaneScrollerArr();for(var i=0;i<scrollerArr.length;i++){scrollerArr[i].onFocusChanged();}},_onColVisibilityChanged:function(evt){var scrollerArr=this._getPaneScrollerArr();for(var i=0;i<scrollerArr.length;i++){scrollerArr[i].onColVisibilityChanged();}this._updateScrollerWidths();this._updateScrollBarVisibility();},_onColWidthChanged:function(evt){var scrollerArr=this._getPaneScrollerArr();for(var i=0;i<scrollerArr.length;i++){var data=evt.getData();scrollerArr[i].setColumnWidth(data.col,data.newWidth);}this._updateScrollerWidths();this._updateScrollBarVisibility();},_onColOrderChanged:function(evt){var scrollerArr=this._getPaneScrollerArr();for(var i=0;i<scrollerArr.length;i++){scrollerArr[i].onColOrderChanged();}this._updateScrollerWidths();this._updateScrollBarVisibility();},getTablePaneScrollerAtPageX:function(pageX){var metaCol=this._getMetaColumnAtPageX(pageX);return (metaCol!=-1)?this.getPaneScroller(metaCol):null;},setFocusedCell:function(col,row,scrollVisible){if(!this.isEditing()&&(col!=this.__focusedCol||row!=this.__focusedRow)){this.__focusedCol=col;this.__focusedRow=row;var scrollerArr=this._getPaneScrollerArr();for(var i=0;i<scrollerArr.length;i++){scrollerArr[i].setFocusedCell(col,row);}if(col!==null&&scrollVisible){this.scrollCellVisible(col,row);}}},clearSelection:function(){this.getSelectionModel().clearSelection();},resetCellFocus:function(){this.setFocusedCell(null,null,false);},getFocusedColumn:function(){return this.__focusedCol;},getFocusedRow:function(){return this.__focusedRow;},moveFocusedCell:function(deltaX,deltaY){var col=this.__focusedCol;var row=this.__focusedRow;if(col===null||row===null){return;}if(deltaX!=0){var columnModel=this.getTableColumnModel();var x=columnModel.getVisibleX(col);var colCount=columnModel.getVisibleColumnCount();x=qx.lang.Number.limit(x+deltaX,0,colCount-1);col=columnModel.getVisibleColumnAtX(x);}if(deltaY!=0){var tableModel=this.getTableModel();row=qx.lang.Number.limit(row+deltaY,0,tableModel.getRowCount()-1);}this.setFocusedCell(col,row,true);},scrollCellVisible:function(col,row){var columnModel=this.getTableColumnModel();var x=columnModel.getVisibleX(col);var metaColumn=this._getMetaColumnAtColumnX(x);if(metaColumn!=-1){this.getPaneScroller(metaColumn).scrollCellVisible(col,row);}},isEditing:function(){if(this.__focusedCol!=null){var x=this.getTableColumnModel().getVisibleX(this.__focusedCol);var metaColumn=this._getMetaColumnAtColumnX(x);return this.getPaneScroller(metaColumn).isEditing();}return false;},startEditing:function(){if(this.__focusedCol!=null){var x=this.getTableColumnModel().getVisibleX(this.__focusedCol);var metaColumn=this._getMetaColumnAtColumnX(x);var started=this.getPaneScroller(metaColumn).startEditing();return started;}return false;},stopEditing:function(){if(this.__focusedCol!=null){var x=this.getTableColumnModel().getVisibleX(this.__focusedCol);var metaColumn=this._getMetaColumnAtColumnX(x);this.getPaneScroller(metaColumn).stopEditing();}},cancelEditing:function(){if(this.__focusedCol!=null){var x=this.getTableColumnModel().getVisibleX(this.__focusedCol);var metaColumn=this._getMetaColumnAtColumnX(x);this.getPaneScroller(metaColumn).cancelEditing();}},updateContent:function(){var scrollerArr=this._getPaneScrollerArr();for(var i=0;i<scrollerArr.length;i++){scrollerArr[i].getTablePane().updateContent();}},_getMetaColumnAtPageX:function(pageX){var scrollerArr=this._getPaneScrollerArr();for(var i=0;i<scrollerArr.length;i++){var pos=scrollerArr[i].getContainerLocation();if(pageX>=pos.left&&pageX<=pos.right){return i;}}return -1;},_getMetaColumnAtColumnX:function(visXPos){var metaColumnCounts=this.getMetaColumnCounts();var rightXPos=0;for(var i=0;i<metaColumnCounts.length;i++){var counts=metaColumnCounts[i];rightXPos+=counts;if(counts==-1||visXPos<rightXPos){return i;}}return -1;},_updateStatusBar:function(){if(this.getStatusBarVisible()){var selectedRowCount=this.getSelectionModel().getSelectedCount();var rowCount=this.getTableModel().getRowCount();var text;if(rowCount>0){if(selectedRowCount==0){text=this.trn("one row","%1 rows",rowCount,rowCount);}else{text=this.trn("one of one row","%1 of %2 rows",rowCount,selectedRowCount,rowCount);}}if(this.__additionalStatusBarText){if(text){text+=this.__additionalStatusBarText;}else{text=this.__additionalStatusBarText;}}if(text){this.__statusBar.setContent(text);}}},_updateScrollerWidths:function(){var scrollerArr=this._getPaneScrollerArr();for(var i=0;i<scrollerArr.length;i++){var isLast=(i==(scrollerArr.length-1));var width=scrollerArr[i].getTablePaneModel().getTotalWidth();scrollerArr[i].setWidth(width);var flex=isLast?1:0;scrollerArr[i].setLayoutProperties({flex:flex});}},_updateScrollBarVisibility:function(){if(!this.getBounds()){return;}var horBar=qx.ui.table.pane.Scroller.HORIZONTAL_SCROLLBAR;var verBar=qx.ui.table.pane.Scroller.VERTICAL_SCROLLBAR;var scrollerArr=this._getPaneScrollerArr();var horNeeded=false;var verNeeded=false;for(var i=0;i<scrollerArr.length;i++){var isLast=(i==(scrollerArr.length-1));var bars=scrollerArr[i].getNeededScrollBars(horNeeded,!isLast);if(bars&horBar){horNeeded=true;}if(isLast&&(bars&verBar)){verNeeded=true;}}for(var i=0;i<scrollerArr.length;i++){var isLast=(i==(scrollerArr.length-1));var bHadVerticalScrollBar;scrollerArr[i].setHorizontalScrollBarVisible(horNeeded);if(isLast){bHadVerticalScrollBar=scrollerArr[i].getVerticalScrollBarVisible();}scrollerArr[i].setVerticalScrollBarVisible(isLast&&verNeeded);if(isLast&&verNeeded!=bHadVerticalScrollBar){this.fireDataEvent("verticalScrollBarChanged",verNeeded);}}},_initColumnMenu:function(){var tableModel=this.getTableModel();var columnModel=this.getTableColumnModel();var menu=this.__columnVisibilityBt.getMenu();if(menu){var entries=menu.getChildren();for(var i=0,l=entries.length;i<l;i++){entries[i].destroy();}}else{var menu=new qx.ui.menu.Menu();this.__columnVisibilityBt.setMenu(menu);}var data={table:this,menu:menu};this.fireDataEvent("columnVisibilityMenuCreateStart",data);for(var col=0,l=tableModel.getColumnCount();col<l;col++){var menuButton=new qx.ui.menu.CheckBox(tableModel.getColumnName(col));menuButton.setChecked(columnModel.isColumnVisible(col));menuButton.addListener("changeChecked",this._createColumnVisibilityCheckBoxHandler(col),this);menu.add(menuButton);}var data={table:this,menu:menu};this.fireDataEvent("columnVisibilityMenuCreateEnd",data);},_createColumnVisibilityCheckBoxHandler:function(col){return function(evt){var columnModel=this.getTableColumnModel();columnModel.setColumnVisible(col,evt.getData());};},setColumnWidth:function(col,width){this.getTableColumnModel().setColumnWidth(col,width);},_onResize:function(){this.fireEvent("tableWidthChanged");this._updateScrollerWidths();this._updateScrollBarVisibility();},addListener:function(type,listener,self,capture){if(this.self(arguments).__redirectEvents[type]){for(var i=0,arr=this._getPaneScrollerArr();i<arr.length;i++){arr[i].addListener.apply(arr[i],arguments);}}else{this.base(arguments,type,listener,self,capture);}},removeListener:function(type,listener,self,capture){if(this.self(arguments).__redirectEvents[type]){for(var i=0,arr=this._getPaneScrollerArr();i<arr.length;i++){arr[i].removeListener.apply(arr[i],arguments);}}else{this.base(arguments,type,listener,self,capture);}}},destruct:function(){if(qx.core.Variant.isSet("qx.dynamicLocaleSwitch","on")){qx.locale.Manager.getInstance().removeListener("changeLocale",this._onChangeLocale,this);}var selectionModel=this.getSelectionModel();if(selectionModel){selectionModel.dispose();}var dataRowRenderer=this.getDataRowRenderer();if(dataRowRenderer){dataRowRenderer.dispose();}this._cleanUpMetaColumns(0);this._disposeObjects("__selectionManager","_columnVisibilityMenu","_tableModel","__columnVisibilityBt","__scrollerParent","__statusBar");}});qx.Class.define("qx.ui.layout.VBox",{extend:qx.ui.layout.Abstract,construct:function(spacing,alignY,separator){this.base(arguments);if(spacing){this.setSpacing(spacing);}if(alignY){this.setAlignY(alignY);}if(separator){this.setSeparator(separator);}},properties:{alignY:{check:["top","middle","bottom"],init:"top",apply:"_applyLayoutChange"},alignX:{check:["left","center","right","baseline"],init:"left",apply:"_applyLayoutChange"},spacing:{check:"Integer",init:0,apply:"_applyLayoutChange"},separator:{check:"Decorator",nullable:true,apply:"_applyLayoutChange"},reversed:{check:"Boolean",init:false,apply:"_applyReversed"}},members:{__heights:null,__flexs:null,__enableFlex:null,__children:null,_applyReversed:function(){this._invalidChildrenCache=true;this._applyLayoutChange();},__rebuildCache:function(){var children=this._getLayoutChildren();var length=children.length;var enableFlex=false;var reuse=this.__heights&&this.__heights.length!=length&&this.__flexs&&this.__heights;var props;var heights=reuse?this.__heights:new Array(length);var flexs=reuse?this.__flexs:new Array(length);if(this.getReversed()){children=children.concat().reverse();}for(var i=0;i<length;i++){props=children[i].getLayoutProperties();if(props.height!=null){heights[i]=parseFloat(props.height)/100;}if(props.flex!=null){flexs[i]=props.flex;enableFlex=true;}}if(!reuse){this.__heights=heights;this.__flexs=flexs;}this.__enableFlex=enableFlex;this.__children=children;delete this._invalidChildrenCache;},verifyLayoutProperty:null,renderLayout:function(availWidth,availHeight){if(this._invalidChildrenCache){this.__rebuildCache();}var children=this.__children;var length=children.length;var util=qx.ui.layout.Util;var spacing=this.getSpacing();var separator=this.getSeparator();if(separator){var gaps=util.computeVerticalSeparatorGaps(children,spacing,separator);}else{var gaps=util.computeVerticalGaps(children,spacing,true);}var i,child,height,percent;var heights=[];var allocatedHeight=gaps;for(i=0;i<length;i+=1){percent=this.__heights[i];height=percent!=null?Math.floor((availHeight-gaps)*percent):children[i].getSizeHint().height;heights.push(height);allocatedHeight+=height;}if(this.__enableFlex&&allocatedHeight!=availHeight){var flexibles={};var flex,offset;for(i=0;i<length;i+=1){flex=this.__flexs[i];if(flex>0){hint=children[i].getSizeHint();flexibles[i]={min:hint.minHeight,value:heights[i],max:hint.maxHeight,flex:flex};}}var result=util.computeFlexOffsets(flexibles,availHeight,allocatedHeight);for(i in result){offset=result[i].offset;heights[i]+=offset;allocatedHeight+=offset;}}var top=children[0].getMarginTop();if(allocatedHeight<availHeight&&this.getAlignY()!="top"){top=availHeight-allocatedHeight;if(this.getAlignY()==="middle"){top=Math.round(top/2);}}var hint,left,width,height,marginBottom,marginLeft,marginRight;var spacing=this.getSpacing();this._clearSeparators();if(separator){var separatorInsets=qx.theme.manager.Decoration.getInstance().resolve(separator).getInsets();var separatorHeight=separatorInsets.top+separatorInsets.bottom;}for(i=0;i<length;i+=1){child=children[i];height=heights[i];hint=child.getSizeHint();marginLeft=child.getMarginLeft();marginRight=child.getMarginRight();width=Math.max(hint.minWidth,Math.min(availWidth-marginLeft-marginRight,hint.maxWidth));left=util.computeHorizontalAlignOffset(child.getAlignX()||this.getAlignX(),width,availWidth,marginLeft,marginRight);if(i>0){if(separator){top+=marginBottom+spacing;this._renderSeparator(separator,{top:top,left:0,height:separatorHeight,width:availWidth});top+=separatorHeight+spacing+child.getMarginTop();}else{top+=util.collapseMargins(spacing,marginBottom,child.getMarginTop());}}child.renderLayout(left,top,width,height);top+=height;marginBottom=child.getMarginBottom();}},_computeSizeHint:function(){if(this._invalidChildrenCache){this.__rebuildCache();}var util=qx.ui.layout.Util;var children=this.__children;var minHeight=0,height=0;var minWidth=0,width=0;var child,hint,margin;for(var i=0,l=children.length;i<l;i+=1){child=children[i];hint=child.getSizeHint();height+=hint.height;minHeight+=this.__flexs[i]>0?hint.minHeight:hint.height;margin=child.getMarginLeft()+child.getMarginRight();if((hint.width+margin)>width){width=hint.width+margin;}if((hint.minWidth+margin)>minWidth){minWidth=hint.minWidth+margin;}}var spacing=this.getSpacing();var separator=this.getSeparator();if(separator){var gaps=util.computeVerticalSeparatorGaps(children,spacing,separator);}else{var gaps=util.computeVerticalGaps(children,spacing,true);}return {minHeight:minHeight+gaps,height:height+gaps,minWidth:minWidth,width:width};}},destruct:function(){this._disposeFields("__heights","__flexs","__children");}});qx.Class.define("qx.ui.layout.HBox",{extend:qx.ui.layout.Abstract,construct:function(spacing,alignX,separator){this.base(arguments);if(spacing){this.setSpacing(spacing);}if(alignX){this.setAlignX(alignX);}if(separator){this.setSeparator(separator);}},properties:{alignX:{check:["left","center","right"],init:"left",apply:"_applyLayoutChange"},alignY:{check:["top","middle","bottom","baseline"],init:"top",apply:"_applyLayoutChange"},spacing:{check:"Integer",init:0,apply:"_applyLayoutChange"},separator:{check:"Decorator",nullable:true,apply:"_applyLayoutChange"},reversed:{check:"Boolean",init:false,apply:"_applyReversed"}},members:{__widths:null,__flexs:null,__enableFlex:null,__children:null,_applyReversed:function(){this._invalidChildrenCache=true;this._applyLayoutChange();},__rebuildCache:function(){var children=this._getLayoutChildren();var length=children.length;var enableFlex=false;var reuse=this.__widths&&this.__widths.length!=length&&this.__flexs&&this.__widths;var props;var widths=reuse?this.__widths:new Array(length);var flexs=reuse?this.__flexs:new Array(length);if(this.getReversed()){children=children.concat().reverse();}for(var i=0;i<length;i++){props=children[i].getLayoutProperties();if(props.width!=null){widths[i]=parseFloat(props.width)/100;}if(props.flex!=null){flexs[i]=props.flex;enableFlex=true;}}if(!reuse){this.__widths=widths;this.__flexs=flexs;}this.__enableFlex=enableFlex;this.__children=children;delete this._invalidChildrenCache;},verifyLayoutProperty:null,renderLayout:function(availWidth,availHeight){if(this._invalidChildrenCache){this.__rebuildCache();}var children=this.__children;var length=children.length;var util=qx.ui.layout.Util;var spacing=this.getSpacing();var separator=this.getSeparator();if(separator){var gaps=util.computeHorizontalSeparatorGaps(children,spacing,separator);}else{var gaps=util.computeHorizontalGaps(children,spacing,true);}var i,child,width,percent;var widths=[];var allocatedWidth=gaps;for(i=0;i<length;i+=1){percent=this.__widths[i];width=percent!=null?Math.floor((availWidth-gaps)*percent):children[i].getSizeHint().width;widths.push(width);allocatedWidth+=width;}if(this.__enableFlex&&allocatedWidth!=availWidth){var flexibles={};var flex,offset;for(i=0;i<length;i+=1){flex=this.__flexs[i];if(flex>0){hint=children[i].getSizeHint();flexibles[i]={min:hint.minWidth,value:widths[i],max:hint.maxWidth,flex:flex};}}var result=util.computeFlexOffsets(flexibles,availWidth,allocatedWidth);for(i in result){offset=result[i].offset;widths[i]+=offset;allocatedWidth+=offset;}}var left=children[0].getMarginLeft();if(allocatedWidth<availWidth&&this.getAlignX()!="left"){left=availWidth-allocatedWidth;if(this.getAlignX()==="center"){left=Math.round(left/2);}}var hint,top,height,width,marginRight,marginTop,marginBottom;var spacing=this.getSpacing();this._clearSeparators();if(separator){var separatorInsets=qx.theme.manager.Decoration.getInstance().resolve(separator).getInsets();var separatorWidth=separatorInsets.left+separatorInsets.right;}for(i=0;i<length;i+=1){child=children[i];width=widths[i];hint=child.getSizeHint();marginTop=child.getMarginTop();marginBottom=child.getMarginBottom();height=Math.max(hint.minHeight,Math.min(availHeight-marginTop-marginBottom,hint.maxHeight));top=util.computeVerticalAlignOffset(child.getAlignY()||this.getAlignY(),height,availHeight,marginTop,marginBottom);if(i>0){if(separator){left+=marginRight+spacing;this._renderSeparator(separator,{left:left,top:0,width:separatorWidth,height:availHeight});left+=separatorWidth+spacing+child.getMarginLeft();}else{left+=util.collapseMargins(spacing,marginRight,child.getMarginLeft());}}child.renderLayout(left,top,width,height);left+=width;marginRight=child.getMarginRight();}},_computeSizeHint:function(){if(this._invalidChildrenCache){this.__rebuildCache();}var util=qx.ui.layout.Util;var children=this.__children;var minWidth=0,width=0;var minHeight=0,height=0;var child,hint,margin;for(var i=0,l=children.length;i<l;i+=1){child=children[i];hint=child.getSizeHint();width+=hint.width;minWidth+=this.__flexs[i]>0?hint.minWidth:hint.width;margin=child.getMarginTop()+child.getMarginBottom();if((hint.height+margin)>height){height=hint.height+margin;}if((hint.minHeight+margin)>minHeight){minHeight=hint.minHeight+margin;}}var spacing=this.getSpacing();var separator=this.getSeparator();if(separator){var gaps=util.computeHorizontalSeparatorGaps(children,spacing,separator);}else{var gaps=util.computeHorizontalGaps(children,spacing,true);}return {minWidth:minWidth+gaps,width:width+gaps,minHeight:minHeight,height:height};}},destruct:function(){this._disposeFields("__widths","__flexs","__children");}});qx.Interface.define("qx.ui.table.IRowRenderer",{members:{updateDataRowElement:function(rowInfo,rowElement){},getRowHeightStyle:function(height){},createRowStyle:function(rowInfo){},getRowClass:function(rowInfo){}}});qx.Class.define("qx.ui.table.rowrenderer.Default",{extend:qx.core.Object,implement:qx.ui.table.IRowRenderer,construct:function(){this.base(arguments);this.__fontStyleString="";this.__fontStyleString={};this.__colors={};this._renderFont(qx.theme.manager.Font.getInstance().resolve("default"));var colorMgr=qx.theme.manager.Color.getInstance();this.__colors.bgcolFocusedSelected=colorMgr.resolve("table-row-background-focused-selected");this.__colors.bgcolFocused=colorMgr.resolve("table-row-background-focused");this.__colors.bgcolSelected=colorMgr.resolve("table-row-background-selected");this.__colors.bgcolEven=colorMgr.resolve("table-row-background-even");this.__colors.bgcolOdd=colorMgr.resolve("table-row-background-odd");this.__colors.colSelected=colorMgr.resolve("table-row-selected");this.__colors.colNormal=colorMgr.resolve("table-row");this.__colors.horLine=colorMgr.resolve("table-row-line");},properties:{highlightFocusRow:{check:"Boolean",init:true}},members:{__colors:null,__fontStyle:null,__fontStyleString:null,_insetY:1,_renderFont:function(font){if(font){this.__fontStyle=font.getStyles();this.__fontStyleString=qx.bom.element.Style.compile(this.__fontStyle);this.__fontStyleString=this.__fontStyleString.replace(/"/g,"'");}else{this.__fontStyleString="";this.__fontStyle=qx.bom.Font.getDefaultStyles();}},updateDataRowElement:function(rowInfo,rowElem){var fontStyle=this.__fontStyle;var style=rowElem.style;qx.bom.element.Style.setStyles(rowElem,fontStyle);if(rowInfo.focusedRow&&this.getHighlightFocusRow()){style.backgroundColor=rowInfo.selected?this.__colors.bgcolFocusedSelected:this.__colors.bgcolFocused;}else{if(rowInfo.selected){style.backgroundColor=this.__colors.bgcolSelected;}else{style.backgroundColor=(rowInfo.row%2==0)?this.__colors.bgcolEven:this.__colors.bgcolOdd;}}style.color=rowInfo.selected?this.__colors.colSelected:this.__colors.colNormal;style.borderBottom="1px solid "+this.__colors.horLine;},getRowHeightStyle:function(height){if(qx.bom.client.Feature.CONTENT_BOX){height-=this._insetY;}return "height:"+height+"px;";},createRowStyle:function(rowInfo){var rowStyle=[];rowStyle.push(";");rowStyle.push(this.__fontStyleString);rowStyle.push("background-color:");if(rowInfo.focusedRow&&this.getHighlightFocusRow()){rowStyle.push(rowInfo.selected?this.__colors.bgcolFocusedSelected:this.__colors.bgcolFocused);}else{if(rowInfo.selected){rowStyle.push(this.__colors.bgcolSelected);}else{rowStyle.push((rowInfo.row%2==0)?this.__colors.bgcolEven:this.__colors.bgcolOdd);}}rowStyle.push(';color:');rowStyle.push(rowInfo.selected?this.__colors.colSelected:this.__colors.colNormal);rowStyle.push(';border-bottom: 1px solid ',this.__colors.horLine);return rowStyle.join("");},getRowClass:function(rowInfo){return "";}},destruct:function(){this._disposeFields("__colors","__fontStyle","__fontStyleString");}});qx.Class.define("qx.ui.table.selection.Manager",{extend:qx.core.Object,construct:function(){this.base(arguments);},properties:{selectionModel:{check:"qx.ui.table.selection.Model"}},members:{__lastMouseDownHandled:null,handleMouseDown:function(index,evt){if(evt.isLeftPressed()){var selectionModel=this.getSelectionModel();if(!selectionModel.isSelectedIndex(index)){this._handleSelectEvent(index,evt);this.__lastMouseDownHandled=true;}else{this.__lastMouseDownHandled=false;}}else if(evt.isRightPressed()&&evt.getModifiers()==0){var selectionModel=this.getSelectionModel();if(!selectionModel.isSelectedIndex(index)){selectionModel.setSelectionInterval(index,index);}}},handleMouseUp:function(index,evt){if(evt.isLeftPressed()&&!this.__lastMouseDownHandled){this._handleSelectEvent(index,evt);}},handleClick:function(index,evt){},handleSelectKeyDown:function(index,evt){this._handleSelectEvent(index,evt);},handleMoveKeyDown:function(index,evt){var selectionModel=this.getSelectionModel();switch(evt.getModifiers()){case 0:selectionModel.setSelectionInterval(index,index);break;case qx.event.type.Dom.SHIFT_MASK:var anchor=selectionModel.getAnchorSelectionIndex();if(anchor==-1){selectionModel.setSelectionInterval(index,index);}else{selectionModel.setSelectionInterval(anchor,index);}break;}},_handleSelectEvent:function(index,evt){var selectionModel=this.getSelectionModel();var leadIndex=selectionModel.getLeadSelectionIndex();var anchorIndex=selectionModel.getAnchorSelectionIndex();if(evt.isShiftPressed()){if(index!=leadIndex||selectionModel.isSelectionEmpty()){if(anchorIndex==-1){anchorIndex=index;}if(evt.isCtrlOrCommandPressed()){selectionModel.addSelectionInterval(anchorIndex,index);}else{selectionModel.setSelectionInterval(anchorIndex,index);}}}else if(evt.isCtrlOrCommandPressed()){if(selectionModel.isSelectedIndex(index)){selectionModel.removeSelectionInterval(index,index);}else{selectionModel.addSelectionInterval(index,index);}}else{if(!(anchorIndex==leadIndex&&anchorIndex==index&&selectionModel.getSelectedCount()==1)){selectionModel.setSelectionInterval(index,index);}}}}});qx.Class.define("qx.ui.table.selection.Model",{extend:qx.core.Object,construct:function(){this.base(arguments);this.__selectedRangeArr=[];this.__anchorSelectionIndex=-1;this.__leadSelectionIndex=-1;this.hasBatchModeRefCount=0;this.__hadChangeEventInBatchMode=false;},events:{"changeSelection":"qx.event.type.Event"},statics:{NO_SELECTION:1,SINGLE_SELECTION:2,SINGLE_INTERVAL_SELECTION:3,MULTIPLE_INTERVAL_SELECTION:4,MULTIPLE_INTERVAL_SELECTION_TOGGLE:5},properties:{selectionMode:{init:2,check:[1,2,3,4,5],apply:"_applySelectionMode"}},members:{__hadChangeEventInBatchMode:null,__anchorSelectionIndex:null,__leadSelectionIndex:null,__selectedRangeArr:null,_applySelectionMode:function(selectionMode){this.clearSelection();},setBatchMode:function(batchMode){if(batchMode){this.hasBatchModeRefCount+=1;}else{if(this.hasBatchModeRefCount==0){throw new Error("Try to turn off batch mode althoug it was not turned on.");}this.hasBatchModeRefCount-=1;if(this.__hadChangeEventInBatchMode){this.__hadChangeEventInBatchMode=false;this._fireChangeSelection();}}return this.hasBatchMode();},hasBatchMode:function(){return this.hasBatchModeRefCount>0;},getAnchorSelectionIndex:function(){return this.__anchorSelectionIndex;},getLeadSelectionIndex:function(){return this.__leadSelectionIndex;},clearSelection:function(){if(!this.isSelectionEmpty()){this._clearSelection();this._fireChangeSelection();}},isSelectionEmpty:function(){return this.__selectedRangeArr.length==0;},getSelectedCount:function(){var selectedCount=0;for(var i=0;i<this.__selectedRangeArr.length;i++){var range=this.__selectedRangeArr[i];selectedCount+=range.maxIndex-range.minIndex+1;}return selectedCount;},isSelectedIndex:function(index){for(var i=0;i<this.__selectedRangeArr.length;i++){var range=this.__selectedRangeArr[i];if(index>=range.minIndex&&index<=range.maxIndex){return true;}}return false;},getSelectedRanges:function(){var retVal=[];for(var i=0;i<this.__selectedRangeArr.length;i++){retVal.push({minIndex:this.__selectedRangeArr[i].minIndex,maxIndex:this.__selectedRangeArr[i].maxIndex});}return retVal;},iterateSelection:function(iterator,object){for(var i=0;i<this.__selectedRangeArr.length;i++){for(var j=this.__selectedRangeArr[i].minIndex;j<=this.__selectedRangeArr[i].maxIndex;j++){iterator.call(object,j);}}},setSelectionInterval:function(fromIndex,toIndex){var me=this.self(arguments);switch(this.getSelectionMode()){case me.NO_SELECTION:return;case me.SINGLE_SELECTION:fromIndex=toIndex;break;case me.MULTIPLE_INTERVAL_SELECTION_TOGGLE:this.setBatchMode(true);try{for(var i=fromIndex;i<=toIndex;i++){if(!this.isSelectedIndex(i)){this._addSelectionInterval(i,i);}else{this.removeSelectionInterval(i,i);}}}finally{this.setBatchMode(false);}this._fireChangeSelection();return;}this._clearSelection();this._addSelectionInterval(fromIndex,toIndex);this._fireChangeSelection();},addSelectionInterval:function(fromIndex,toIndex){var SelectionModel=qx.ui.table.selection.Model;switch(this.getSelectionMode()){case SelectionModel.NO_SELECTION:return;case SelectionModel.MULTIPLE_INTERVAL_SELECTION:case SelectionModel.MULTIPLE_INTERVAL_SELECTION_TOGGLE:this._addSelectionInterval(fromIndex,toIndex);this._fireChangeSelection();break;default:this.setSelectionInterval(fromIndex,toIndex);break;}},removeSelectionInterval:function(fromIndex,toIndex){this.__anchorSelectionIndex=fromIndex;this.__leadSelectionIndex=toIndex;var minIndex=Math.min(fromIndex,toIndex);var maxIndex=Math.max(fromIndex,toIndex);for(var i=0;i<this.__selectedRangeArr.length;i++){var range=this.__selectedRangeArr[i];if(range.minIndex>maxIndex){break;}else if(range.maxIndex>=minIndex){var minIsIn=(range.minIndex>=minIndex)&&(range.minIndex<=maxIndex);var maxIsIn=(range.maxIndex>=minIndex)&&(range.maxIndex<=maxIndex);if(minIsIn&&maxIsIn){this.__selectedRangeArr.splice(i,1);i--;}else if(minIsIn){range.minIndex=maxIndex+1;}else if(maxIsIn){range.maxIndex=minIndex-1;}else{var newRange={minIndex:maxIndex+1,maxIndex:range.maxIndex};this.__selectedRangeArr.splice(i+1,0,newRange);range.maxIndex=minIndex-1;break;}}}this._fireChangeSelection();},_clearSelection:function(){this.__selectedRangeArr=[];this.__anchorSelectionIndex=-1;this.__leadSelectionIndex=-1;},_addSelectionInterval:function(fromIndex,toIndex){this.__anchorSelectionIndex=fromIndex;this.__leadSelectionIndex=toIndex;var minIndex=Math.min(fromIndex,toIndex);var maxIndex=Math.max(fromIndex,toIndex);var newRangeIndex=0;for(;newRangeIndex<this.__selectedRangeArr.length;newRangeIndex++){var range=this.__selectedRangeArr[newRangeIndex];if(range.minIndex>minIndex){break;}}this.__selectedRangeArr.splice(newRangeIndex,0,{minIndex:minIndex,maxIndex:maxIndex});var lastRange=this.__selectedRangeArr[0];for(var i=1;i<this.__selectedRangeArr.length;i++){var range=this.__selectedRangeArr[i];if(lastRange.maxIndex+1>=range.minIndex){lastRange.maxIndex=Math.max(lastRange.maxIndex,range.maxIndex);this.__selectedRangeArr.splice(i,1);i--;}else{lastRange=range;}}},_dumpRanges:function(){var text="Ranges:";for(var i=0;i<this.__selectedRangeArr.length;i++){var range=this.__selectedRangeArr[i];text+=" ["+range.minIndex+".."+range.maxIndex+"]";}this.debug(text);},_fireChangeSelection:function(){if(this.hasBatchMode()){this.__hadChangeEventInBatchMode=true;}this.fireEvent("changeSelection");}},destruct:function(){this._disposeFields("__selectedRangeArr");}});qx.Interface.define("qx.ui.table.IHeaderRenderer",{members:{createHeaderCell:function(cellInfo){return true;},updateHeaderCell:function(cellInfo,cellWidget){return true;}}});qx.Class.define("qx.ui.table.headerrenderer.Default",{extend:qx.core.Object,implement:qx.ui.table.IHeaderRenderer,statics:{STATE_SORTED:"sorted",STATE_SORTED_ASCENDING:"sortedAscending"},properties:{toolTip:{check:"String",init:null,nullable:true}},members:{createHeaderCell:function(cellInfo){var widget=new qx.ui.table.headerrenderer.HeaderCell();this.updateHeaderCell(cellInfo,widget);return widget;},updateHeaderCell:function(cellInfo,cellWidget){var DefaultHeaderCellRenderer=qx.ui.table.headerrenderer.Default;cellWidget.setLabel(cellInfo.name);var widgetToolTip=cellWidget.getToolTip();if(this.getToolTip()!=null){if(widgetToolTip==null){widgetToolTip=new qx.ui.tooltip.ToolTip(this.getToolTip());cellWidget.setToolTip(widgetToolTip);}else{widgetToolTip.setLabel(this.getToolTip());}}cellInfo.sorted?cellWidget.addState(DefaultHeaderCellRenderer.STATE_SORTED):cellWidget.removeState(DefaultHeaderCellRenderer.STATE_SORTED);cellInfo.sortedAscending?cellWidget.addState(DefaultHeaderCellRenderer.STATE_SORTED_ASCENDING):cellWidget.removeState(DefaultHeaderCellRenderer.STATE_SORTED_ASCENDING);}}});qx.Interface.define("qx.ui.table.ICellRenderer",{members:{createDataCellHtml:function(cellInfo,htmlArr){return true;}}});qx.Class.define("qx.ui.table.cellrenderer.Abstract",{type:"abstract",implement:qx.ui.table.ICellRenderer,extend:qx.core.Object,construct:function(){this.base(arguments);var cr=qx.ui.table.cellrenderer.Abstract;if(!cr.__clazz){var colorMgr=qx.theme.manager.Color.getInstance();cr.__clazz=this.self(arguments);var stylesheet=".qooxdoo-table-cell {"+qx.bom.element.Style.compile({position:"absolute",top:"0px",overflow:"hidden",whiteSpace:"nowrap",borderRight:"1px solid "+colorMgr.resolve("table-row-line"),padding:"0px 6px",cursor:"default",textOverflow:"ellipsis",userSelect:"none"})+"} "+".qooxdoo-table-cell-right { text-align:right } "+".qooxdoo-table-cell-italic { font-style:italic} "+".qooxdoo-table-cell-bold { font-weight:bold } ";if(!qx.core.Variant.isSet("qx.client","mshtml")){stylesheet+=".qooxdoo-table-cell {"+qx.bom.element.BoxSizing.compile("content-box")+"}";}cr.__clazz.stylesheet=qx.bom.Stylesheet.createElement(stylesheet);}},members:{_insetX:6+6+1,_insetY:0,_getCellClass:function(cellInfo){return "qooxdoo-table-cell";},_getCellStyle:function(cellInfo){return cellInfo.style||"";},_getContentHtml:function(cellInfo){return cellInfo.value||"";},_getCellSizeStyle:function(width,height,insetX,insetY){var style="";if(qx.bom.client.Feature.CONTENT_BOX){width-=insetX;height-=insetY;}style+="width:"+width+"px;";style+="height:"+height+"px;";return style;},createDataCellHtml:function(cellInfo,htmlArr){htmlArr.push('<div class="',this._getCellClass(cellInfo),'" style="','left:',cellInfo.styleLeft,'px;',this._getCellSizeStyle(cellInfo.styleWidth,cellInfo.styleHeight,this._insetX,this._insetY),this._getCellStyle(cellInfo),'">'+this._getContentHtml(cellInfo),'</div>');}}});qx.Class.define("qx.ui.table.cellrenderer.Default",{extend:qx.ui.table.cellrenderer.Abstract,statics:{STYLEFLAG_ALIGN_RIGHT:1,STYLEFLAG_BOLD:2,STYLEFLAG_ITALIC:4},properties:{useAutoAlign:{check:"Boolean",init:true}},members:{_getStyleFlags:function(cellInfo){if(this.getUseAutoAlign()){if(typeof cellInfo.value=="number"){return qx.ui.table.cellrenderer.Default.STYLEFLAG_ALIGN_RIGHT;}}},_getCellClass:function(cellInfo){var cellClass=this.base(arguments,cellInfo);if(!cellClass){return "";}var stylesToApply=this._getStyleFlags(cellInfo);if(stylesToApply&qx.ui.table.cellrenderer.Default.STYLEFLAG_ALIGN_RIGHT){cellClass+=" qooxdoo-table-cell-right";}if(stylesToApply&qx.ui.table.cellrenderer.Default.STYLEFLAG_BOLD){cellClass+=" qooxdoo-table-cell-bold";}if(stylesToApply&qx.ui.table.cellrenderer.Default.STYLEFLAG_ITALIC){cellClass+=" qooxdoo-table-cell-italic";}return cellClass;},_getContentHtml:function(cellInfo){return qx.bom.String.escape(this._formatValue(cellInfo));},_formatValue:function(cellInfo){var value=cellInfo.value;if(value==null){return "";}if(typeof value=="string"){return value;}else if(typeof value=="number"){if(!qx.ui.table.cellrenderer.Default._numberFormat){qx.ui.table.cellrenderer.Default._numberFormat=new qx.util.format.NumberFormat();qx.ui.table.cellrenderer.Default._numberFormat.setMaximumFractionDigits(2);}var res=qx.ui.table.cellrenderer.Default._numberFormat.format(value);}else if(value instanceof Date){res=qx.util.format.DateFormat.getDateInstance().format(value);}else{res=value;}return res;}}});qx.Interface.define("qx.ui.table.ICellEditorFactory",{members:{createCellEditor:function(cellInfo){return true;},getCellEditorValue:function(cellEditor){return true;}}});qx.Class.define("qx.ui.table.celleditor.TextField",{extend:qx.core.Object,implement:qx.ui.table.ICellEditorFactory,construct:function(){this.base(arguments);},properties:{validationFunction:{check:"Function",nullable:true,init:null}},members:{__done:null,createCellEditor:function(cellInfo){var cellEditor=new qx.ui.form.TextField;cellEditor.setAppearance("table-editor-textfield");cellEditor.originalValue=cellInfo.value;if(cellInfo.value===null){cellInfo.value="";}cellEditor.setValue(""+cellInfo.value);cellEditor.addListener("appear",function(){cellEditor.selectAll();});return cellEditor;},getCellEditorValue:function(cellEditor){var value=cellEditor.getValue();var validationFunc=this.getValidationFunction();if(!this.__done&&validationFunc){value=validationFunc(value,cellEditor.originalValue);this.__done=true;}if(typeof cellEditor.originalValue=="number"){value=parseFloat(value);}return value;}}});qx.Class.define("qx.ui.table.columnmodel.Basic",{extend:qx.core.Object,events:{"widthChanged":"qx.event.type.DataEvent","visibilityChangedPre":"qx.event.type.DataEvent","visibilityChanged":"qx.event.type.DataEvent","orderChanged":"qx.event.type.DataEvent"},statics:{DEFAULT_WIDTH:100,DEFAULT_HEADER_RENDERER:qx.ui.table.headerrenderer.Default,DEFAULT_DATA_RENDERER:qx.ui.table.cellrenderer.Default,DEFAULT_EDITOR_FACTORY:qx.ui.table.celleditor.TextField},members:{__internalChange:null,__colToXPosMap:null,__visibleColumnArr:null,__overallColumnArr:null,__columnDataArr:null,__headerRenderer:null,__dataRenderer:null,__editorFactory:null,init:function(colCount){this.__columnDataArr=[];var width=qx.ui.table.columnmodel.Basic.DEFAULT_WIDTH;var headerRenderer=this.__headerRenderer=new qx.ui.table.columnmodel.Basic.DEFAULT_HEADER_RENDERER();var dataRenderer=this.__dataRenderer=new qx.ui.table.columnmodel.Basic.DEFAULT_DATA_RENDERER();var editorFactory=this.__editorFactory=new qx.ui.table.columnmodel.Basic.DEFAULT_EDITOR_FACTORY();this.__overallColumnArr=[];this.__visibleColumnArr=[];for(var col=0;col<colCount;col++){this.__columnDataArr[col]={width:width,headerRenderer:headerRenderer,dataRenderer:dataRenderer,editorFactory:editorFactory};this.__overallColumnArr[col]=col;this.__visibleColumnArr[col]=col;}this.__colToXPosMap=null;},getVisibleColumns:function(){return this.__visibleColumnArr;},setColumnWidth:function(col,width){var oldWidth=this.__columnDataArr[col].width;if(oldWidth!=width){this.__columnDataArr[col].width=width;var data={col:col,newWidth:width,oldWidth:oldWidth};this.fireDataEvent("widthChanged",data);}},getColumnWidth:function(col){return this.__columnDataArr[col].width;},setHeaderCellRenderer:function(col,renderer){var oldRenderer=this.__columnDataArr[col].headerRenderer;if(oldRenderer!==this.__headerRenderer){oldRenderer.dispose();}this.__columnDataArr[col].headerRenderer=renderer;},getHeaderCellRenderer:function(col){return this.__columnDataArr[col].headerRenderer;},setDataCellRenderer:function(col,renderer){var oldRenderer=this.__columnDataArr[col].headerRenderer;if(oldRenderer!==this.__dataRenderer){oldRenderer.dispose();}this.__columnDataArr[col].dataRenderer=renderer;},getDataCellRenderer:function(col){return this.__columnDataArr[col].dataRenderer;},setCellEditorFactory:function(col,factory){var oldRenderer=this.__columnDataArr[col].headerRenderer;if(oldRenderer!==this.__editorFactory){oldRenderer.dispose();}this.__columnDataArr[col].editorFactory=factory;},getCellEditorFactory:function(col){return this.__columnDataArr[col].editorFactory;},_getColToXPosMap:function(){if(this.__colToXPosMap==null){this.__colToXPosMap={};for(var overX=0;overX<this.__overallColumnArr.length;overX++){var col=this.__overallColumnArr[overX];this.__colToXPosMap[col]={overX:overX};}for(var visX=0;visX<this.__visibleColumnArr.length;visX++){var col=this.__visibleColumnArr[visX];this.__colToXPosMap[col].visX=visX;}}return this.__colToXPosMap;},getVisibleColumnCount:function(){return this.__visibleColumnArr.length;},getVisibleColumnAtX:function(visXPos){return this.__visibleColumnArr[visXPos];},getVisibleX:function(col){return this._getColToXPosMap()[col].visX;},getOverallColumnCount:function(){return this.__overallColumnArr.length;},getOverallColumnAtX:function(overXPos){return this.__overallColumnArr[overXPos];},getOverallX:function(col){return this._getColToXPosMap()[col].overX;},isColumnVisible:function(col){return (this._getColToXPosMap()[col].visX!=null);},setColumnVisible:function(col,visible){if(visible!=this.isColumnVisible(col)){if(visible){var colToXPosMap=this._getColToXPosMap();var overX=colToXPosMap[col].overX;if(overX==null){throw new Error("Showing column failed: "+col+". The column is not added to this TablePaneModel.");}var nextVisX;for(var x=overX+1;x<this.__overallColumnArr.length;x++){var currCol=this.__overallColumnArr[x];var currVisX=colToXPosMap[currCol].visX;if(currVisX!=null){nextVisX=currVisX;break;}}if(nextVisX==null){nextVisX=this.__visibleColumnArr.length;}this.__visibleColumnArr.splice(nextVisX,0,col);}else{var visX=this.getVisibleX(col);this.__visibleColumnArr.splice(visX,1);}this.__colToXPosMap=null;if(!this.__internalChange){var data={col:col,visible:visible};this.fireDataEvent("visibilityChangedPre",data);this.fireDataEvent("visibilityChanged",data);}}},moveColumn:function(fromOverXPos,toOverXPos){this.__internalChange=true;var col=this.__overallColumnArr[fromOverXPos];var visible=this.isColumnVisible(col);if(visible){this.setColumnVisible(col,false);}this.__overallColumnArr.splice(fromOverXPos,1);this.__overallColumnArr.splice(toOverXPos,0,col);this.__colToXPosMap=null;if(visible){this.setColumnVisible(col,true);}this.__internalChange=false;var data={col:col,fromOverXPos:fromOverXPos,toOverXPos:toOverXPos};this.fireDataEvent("orderChanged",data);}},destruct:function(){for(var i=0;i<this.__columnDataArr.length;i++){this.__columnDataArr[i].headerRenderer.dispose();this.__columnDataArr[i].dataRenderer.dispose();this.__columnDataArr[i].editorFactory.dispose();}this._disposeFields("__overallColumnArr","__visibleColumnArr","__columnDataArr","__colToXPosMap");this._disposeObjects("__headerRenderer","__dataRenderer","__editorFactory");}});qx.Class.define("qx.ui.table.headerrenderer.HeaderCell",{extend:qx.ui.container.Composite,construct:function(){this.base(arguments);var layout=new qx.ui.layout.Grid();layout.setRowFlex(0,1);layout.setColumnFlex(1,1);layout.setColumnFlex(2,1);this.setLayout(layout);},properties:{appearance:{refine:true,init:"table-header-cell"},label:{check:"String",init:null,nullable:true,apply:"_applyLabel"},sortIcon:{check:"String",init:null,nullable:true,apply:"_applySortIcon",themeable:true},icon:{check:"String",init:null,nullable:true,apply:"_applyIcon"}},members:{_applyLabel:function(value,old){if(value){this._showChildControl("label").setContent(value);}else{this._excludeChildControl("label");}},_applySortIcon:function(value,old){if(value){this._showChildControl("sort-icon").setSource(value);}else{this._excludeChildControl("sort-icon");}},_applyIcon:function(value,old){if(value){this._showChildControl("icon").setSource(value);}else{this._excludeChildControl("icon");}},_createChildControlImpl:function(id){var control;switch(id){case "label":control=new qx.ui.basic.Label(this.getLabel()).set({anonymous:true,allowShrinkX:true});this._add(control,{row:0,column:1});break;case "sort-icon":control=new qx.ui.basic.Image(this.getSortIcon());control.setAnonymous(true);this._add(control,{row:0,column:2});break;case "icon":control=new qx.ui.basic.Image(this.getIcon()).set({anonymous:true,allowShrinkX:true});this._add(control,{row:0,column:0});break;}return control||this.base(arguments,id);}}});qx.Class.define("qx.ui.popup.Popup",{extend:qx.ui.container.Composite,include:qx.ui.core.MPlacement,construct:function(layout){this.base(arguments,layout);qx.core.Init.getApplication().getRoot().add(this);this.initVisibility();},properties:{appearance:{refine:true,init:"popup"},visibility:{refine:true,init:"excluded"},autoHide:{check:"Boolean",init:true}},members:{_applyVisibility:function(value,old){this.base(arguments,value,old);var mgr=qx.ui.popup.Manager.getInstance();value==="visible"?mgr.add(this):mgr.remove(this);}},destruct:function(){qx.ui.popup.Manager.getInstance().remove(this);}});qx.Class.define("qx.ui.tooltip.ToolTip",{extend:qx.ui.popup.Popup,construct:function(label,icon){this.base(arguments);qx.ui.tooltip.Manager.getInstance();this.setLayout(new qx.ui.layout.Grow);this._createChildControl("atom");if(label!=null){this.setLabel(label);}if(icon!=null){this.setIcon(icon);}},properties:{appearance:{refine:true,init:"tooltip"},showTimeout:{check:"Integer",init:1000,themeable:true},hideTimeout:{check:"Integer",init:4000,themeable:true},label:{check:"String",nullable:true,apply:"_applyLabel"},icon:{check:"String",nullable:true,apply:"_applyIcon",themeable:true}},members:{_createChildControlImpl:function(id){var control;switch(id){case "atom":control=new qx.ui.basic.Atom;this._add(control);break;}return control||this.base(arguments,id);},_applyIcon:function(value,old){var atom=this._getChildControl("atom");value==null?atom.resetIcon:atom.setIcon(value);},_applyLabel:function(value,old){var atom=this._getChildControl("atom");value==null?atom.resetLabel():atom.setLabel(value);}}});qx.Class.define("qx.ui.popup.Manager",{type:"singleton",extend:qx.core.Object,construct:function(){this.base(arguments);this.__objects={};var root=qx.core.Init.getApplication().getRoot();root.addListener("mousedown",this.__onMouseDown,this,true);qx.bom.Element.addListener(window,"blur",this.hideAll,this);},members:{__objects:null,add:function(obj){{};this.__objects[obj.$$hash]=obj;this.__updateIndexes();},remove:function(obj){{};var reg=this.__objects;if(reg){delete reg[obj.$$hash];this.__updateIndexes();}},hideAll:function(){var reg=this.__objects;if(reg){for(var hash in reg){reg[hash].exclude();}}},__updateIndexes:function(){var min=1e6;var reg=this.__objects;for(var hash in reg){reg[hash].setZIndex(min++);}},__onMouseDown:function(e){var target=e.getTarget();var reg=this.__objects;for(var hash in reg){var obj=reg[hash];if(!obj.getAutoHide()||target==obj||qx.ui.core.Widget.contains(obj,target)){continue;}obj.exclude();}}},destruct:function(){var root=qx.core.Init.getApplication().getRoot();if(root){root.removeListener("mousedown",this.__onMouseDown,this,true);}this._disposeMap("__objects");}});qx.Class.define("qx.ui.tooltip.Manager",{type:"singleton",extend:qx.core.Object,construct:function(){this.base(arguments);var root=qx.core.Init.getApplication().getRoot();root.addListener("mouseover",this.__onMouseOverRoot,this,true);root.addListener("focusin",this.__onFocusInRoot,this,true);this.__showTimer=new qx.event.Timer();this.__showTimer.addListener("interval",this.__onShowInterval,this);this.__hideTimer=new qx.event.Timer();this.__hideTimer.addListener("interval",this.__onHideInterval,this);this.__mousePosition={left:0,top:0};},properties:{current:{check:"qx.ui.tooltip.ToolTip",nullable:true,apply:"_applyCurrent"}},members:{__mousePosition:null,__hideTimer:null,__showTimer:null,_applyCurrent:function(value,old){if(old&&qx.ui.core.Widget.contains(old,value)){return;}if(old){old.exclude();this.__showTimer.stop();this.__hideTimer.stop();}var root=qx.core.Init.getApplication().getRoot();if(value){this.__showTimer.startWith(value.getShowTimeout());root.addListener("mouseout",this.__onMouseOutRoot,this,true);root.addListener("focusout",this.__onFocusOutRoot,this,true);root.addListener("mousemove",this.__onMouseMoveRoot,this,true);}else{root.removeListener("mouseout",this.__onMouseOutRoot,this,true);root.removeListener("focusout",this.__onFocusOutRoot,this,true);root.removeListener("mousemove",this.__onMouseMoveRoot,this,true);}},__onShowInterval:function(e){var current=this.getCurrent();if(current){this.__hideTimer.startWith(current.getHideTimeout());current.placeToPoint(this.__mousePosition);current.show();}this.__showTimer.stop();},__onHideInterval:function(e){var current=this.getCurrent();if(current){current.exclude();}this.__hideTimer.stop();this.resetCurrent();},__onMouseMoveRoot:function(e){var pos=this.__mousePosition;pos.left=e.getDocumentLeft();pos.top=e.getDocumentTop();},__onMouseOverRoot:function(e){var target=e.getTarget();var tooltip;while(target!=null){var tooltip=target.getToolTip();if(tooltip){break;}target=target.getLayoutParent();}if(tooltip){this.setCurrent(tooltip);}},__onMouseOutRoot:function(e){var target=e.getTarget();var related=e.getRelatedTarget();var tooltip=this.getCurrent();if(tooltip&&(related==tooltip||qx.ui.core.Widget.contains(tooltip,related))){return;}if(related&&target&&qx.ui.core.Widget.contains(target,related)){return;}if(tooltip&&!related){this.setCurrent(null);}else{this.resetCurrent();}},__onFocusInRoot:function(e){var target=e.getTarget();var tooltip=target.getToolTip();if(tooltip!=null){this.setCurrent(tooltip);}},__onFocusOutRoot:function(e){var target=e.getTarget();if(!target){return;}var tooltip=this.getCurrent();if(tooltip&&tooltip==target.getToolTip()){this.setCurrent(null);}}},destruct:function(){var root=qx.core.Init.getApplication().getRoot();if(root){root.addListener("mouseover",this.__onMouseOverRoot,this,true);root.addListener("focusin",this.__onFocusInRoot,this,true);}this._disposeObjects("__showTimer","__hideTimer");this._disposeFields("__mousePosition");}});qx.Class.define("qx.ui.layout.Grow",{extend:qx.ui.layout.Abstract,members:{verifyLayoutProperty:null,renderLayout:function(availWidth,availHeight){var children=this._getLayoutChildren();var child,size,width,height;for(var i=0,l=children.length;i<l;i++){child=children[i];size=child.getSizeHint();width=availWidth;if(width<size.minWidth){width=size.minWidth;}else if(width>size.maxWidth){width=size.maxWidth;}height=availHeight;if(height<size.minHeight){height=size.minHeight;}else if(height>size.maxHeight){height=size.maxHeight;}child.renderLayout(0,0,width,height);}},_computeSizeHint:function(){var children=this._getLayoutChildren();var child,size;var neededWidth=0,neededHeight=0;for(var i=0,l=children.length;i<l;i++){child=children[i];size=child.getSizeHint();neededWidth=Math.max(neededWidth,size.width);neededHeight=Math.max(neededHeight,size.height);}return {width:neededWidth,height:neededHeight};}}});qx.Class.define("qx.ui.basic.Atom",{extend:qx.ui.core.Widget,construct:function(label,icon){{};this.base(arguments);this._setLayout(new qx.ui.layout.Atom());if(label!=null){this.setLabel(label);}if(icon!=null){this.setIcon(icon);}},properties:{appearance:{refine:true,init:"atom"},label:{apply:"_applyLabel",nullable:true,dispose:true,check:"String"},rich:{check:"Boolean",init:false,apply:"_applyRich"},icon:{check:"String",apply:"_applyIcon",nullable:true,themeable:true},gap:{check:"Integer",nullable:false,event:"changeGap",apply:"_applyGap",themeable:true,init:4},show:{init:"both",check:["both","label","icon"],themeable:true,inheritable:true,apply:"_applyShow",event:"changeShow"},iconPosition:{init:"left",check:["top","right","bottom","left"],themeable:true,apply:"_applyIconPosition"},center:{init:false,check:"Boolean",themeable:true,apply:"_applyCenter"}},members:{_createChildControlImpl:function(id){var control;switch(id){case "label":control=new qx.ui.basic.Label(this.getLabel());control.setAnonymous(true);control.setRich(this.getRich());this._add(control);if(this.getLabel()==null||this.getShow()==="icon"){control.exclude();}break;case "icon":control=new qx.ui.basic.Image(this.getIcon());control.setAnonymous(true);this._addAt(control,0);if(this.getIcon()==null||this.getShow()==="label"){control.exclude();}break;}return control||this.base(arguments,id);},_forwardStates:{focused:true,hovered:true},_handleLabel:function(){if(this.getLabel()==null||this.getShow()==="icon"){this._excludeChildControl("label");}else{this._showChildControl("label");}},_handleIcon:function(){if(this.getIcon()==null||this.getShow()==="label"){this._excludeChildControl("icon");}else{this._showChildControl("icon");}},_applyLabel:function(value,old){var label=this._getChildControl("label",true);if(label){label.setContent(value);}this._handleLabel();},_applyRich:function(value,old){var label=this._getChildControl("label",true);if(label){label.setRich(value);}},_applyIcon:function(value,old){var icon=this._getChildControl("icon",true);if(icon){icon.setSource(value);}this._handleIcon();},_applyGap:function(value,old){this._getLayout().setGap(value);},_applyShow:function(value,old){this._handleLabel();this._handleIcon();},_applyIconPosition:function(value,old){this._getLayout().setIconPosition(value);},_applyCenter:function(value,old){this._getLayout().setCenter(value);}}});qx.Class.define("qx.ui.layout.Atom",{extend:qx.ui.layout.Abstract,properties:{gap:{check:"Integer",init:4,apply:"_applyLayoutChange"},iconPosition:{check:["left","top","right","bottom"],init:"left",apply:"_applyLayoutChange"},center:{check:"Boolean",init:false,apply:"_applyLayoutChange"}},members:{verifyLayoutProperty:null,renderLayout:function(availWidth,availHeight){var Util=qx.ui.layout.Util;var iconPosition=this.getIconPosition();var children=this._getLayoutChildren();var length=children.length;var left,top,width,height;var child,hint;var gap=this.getGap();var center=this.getCenter();if(iconPosition==="bottom"||iconPosition==="right"){var start=length-1;var end=-1;var increment=-1;}else{var start=0;var end=length;var increment=1;}if(iconPosition=="top"||iconPosition=="bottom"){if(center){var allocatedHeight=0;for(var i=start;i!=end;i+=increment){height=children[i].getSizeHint().height;if(height>0){allocatedHeight+=height;if(i!=start){allocatedHeight+=gap;}}}top=Math.round((availHeight-allocatedHeight)/2);}else{top=0;}for(var i=start;i!=end;i+=increment){child=children[i];hint=child.getSizeHint();width=Math.min(hint.maxWidth,Math.max(availWidth,hint.minWidth));height=hint.height;left=Util.computeHorizontalAlignOffset("center",width,availWidth);child.renderLayout(left,top,width,height);if(height>0){top+=height+gap;}}}else{var remainingWidth=availWidth;var allocatedWidth=0;var shrinkTarget=null;var count=0;for(var i=start;i!=end;i+=increment){child=children[i];width=child.getSizeHint().width;if(width>0){if(!shrinkTarget&&child instanceof qx.ui.basic.Label){shrinkTarget=child;}else{remainingWidth-=width;}allocatedWidth+=width;count++;}}if(count>1){var gapSum=(count-1)*gap;remainingWidth-=gapSum;allocatedWidth+=gapSum;}if(center&&allocatedWidth<availWidth){left=Math.round((availWidth-allocatedWidth)/2);}else{left=0;}for(var i=start;i!=end;i+=increment){child=children[i];hint=child.getSizeHint();height=Math.min(hint.maxHeight,Math.max(availHeight,hint.minHeight));if(child===shrinkTarget){width=Math.max(hint.minWidth,Math.min(remainingWidth,hint.width));}else{width=hint.width;}top=Util.computeVerticalAlignOffset("middle",hint.height,availHeight);child.renderLayout(left,top,width,height);if(width>0){left+=width+gap;}}}},_computeSizeHint:function(){var children=this._getLayoutChildren();var length=children.length;var hint,result;if(length===1){var hint=children[0].getSizeHint();result={width:hint.width,height:hint.height,minWidth:hint.minWidth,minHeight:hint.minHeight};}else{var minWidth=0,width=0;var minHeight=0,height=0;var iconPosition=this.getIconPosition();var gap=this.getGap();if(iconPosition==="top"||iconPosition==="bottom"){var count=0;for(var i=0;i<length;i++){hint=children[i].getSizeHint();width=Math.max(width,hint.width);minWidth=Math.max(minWidth,hint.minWidth);if(hint.height>0){height+=hint.height;minHeight+=hint.minHeight;count++;}}if(count>1){var gapSum=(count-1)*gap;height+=gapSum;minHeight+=gapSum;}}else{var count=0;for(var i=0;i<length;i++){hint=children[i].getSizeHint();height=Math.max(height,hint.height);minHeight=Math.max(minHeight,hint.minHeight);if(hint.width>0){width+=hint.width;minWidth+=hint.minWidth;count++;}}if(count>1){var gapSum=(count-1)*gap;width+=gapSum;minWidth+=gapSum;}}result={minWidth:minWidth,width:width,minHeight:minHeight,height:height};}return result;}}});qx.Class.define("qx.bom.String",{statics:{TO_CHARCODE:{"quot":34,"amp":38,"lt":60,"gt":62,"nbsp":160,"iexcl":161,"cent":162,"pound":163,"curren":164,"yen":165,"brvbar":166,"sect":167,"uml":168,"copy":169,"ordf":170,"laquo":171,"not":172,"shy":173,"reg":174,"macr":175,"deg":176,"plusmn":177,"sup2":178,"sup3":179,"acute":180,"micro":181,"para":182,"middot":183,"cedil":184,"sup1":185,"ordm":186,"raquo":187,"frac14":188,"frac12":189,"frac34":190,"iquest":191,"Agrave":192,"Aacute":193,"Acirc":194,"Atilde":195,"Auml":196,"Aring":197,"AElig":198,"Ccedil":199,"Egrave":200,"Eacute":201,"Ecirc":202,"Euml":203,"Igrave":204,"Iacute":205,"Icirc":206,"Iuml":207,"ETH":208,"Ntilde":209,"Ograve":210,"Oacute":211,"Ocirc":212,"Otilde":213,"Ouml":214,"times":215,"Oslash":216,"Ugrave":217,"Uacute":218,"Ucirc":219,"Uuml":220,"Yacute":221,"THORN":222,"szlig":223,"agrave":224,"aacute":225,"acirc":226,"atilde":227,"auml":228,"aring":229,"aelig":230,"ccedil":231,"egrave":232,"eacute":233,"ecirc":234,"euml":235,"igrave":236,"iacute":237,"icirc":238,"iuml":239,"eth":240,"ntilde":241,"ograve":242,"oacute":243,"ocirc":244,"otilde":245,"ouml":246,"divide":247,"oslash":248,"ugrave":249,"uacute":250,"ucirc":251,"uuml":252,"yacute":253,"thorn":254,"yuml":255,"fnof":402,"Alpha":913,"Beta":914,"Gamma":915,"Delta":916,"Epsilon":917,"Zeta":918,"Eta":919,"Theta":920,"Iota":921,"Kappa":922,"Lambda":923,"Mu":924,"Nu":925,"Xi":926,"Omicron":927,"Pi":928,"Rho":929,"Sigma":931,"Tau":932,"Upsilon":933,"Phi":934,"Chi":935,"Psi":936,"Omega":937,"alpha":945,"beta":946,"gamma":947,"delta":948,"epsilon":949,"zeta":950,"eta":951,"theta":952,"iota":953,"kappa":954,"lambda":955,"mu":956,"nu":957,"xi":958,"omicron":959,"pi":960,"rho":961,"sigmaf":962,"sigma":963,"tau":964,"upsilon":965,"phi":966,"chi":967,"psi":968,"omega":969,"thetasym":977,"upsih":978,"piv":982,"bull":8226,"hellip":8230,"prime":8242,"Prime":8243,"oline":8254,"frasl":8260,"weierp":8472,"image":8465,"real":8476,"trade":8482,"alefsym":8501,"larr":8592,"uarr":8593,"rarr":8594,"darr":8595,"harr":8596,"crarr":8629,"lArr":8656,"uArr":8657,"rArr":8658,"dArr":8659,"hArr":8660,"forall":8704,"part":8706,"exist":8707,"empty":8709,"nabla":8711,"isin":8712,"notin":8713,"ni":8715,"prod":8719,"sum":8721,"minus":8722,"lowast":8727,"radic":8730,"prop":8733,"infin":8734,"ang":8736,"and":8743,"or":8744,"cap":8745,"cup":8746,"int":8747,"there4":8756,"sim":8764,"cong":8773,"asymp":8776,"ne":8800,"equiv":8801,"le":8804,"ge":8805,"sub":8834,"sup":8835,"sube":8838,"supe":8839,"oplus":8853,"otimes":8855,"perp":8869,"sdot":8901,"lceil":8968,"rceil":8969,"lfloor":8970,"rfloor":8971,"lang":9001,"rang":9002,"loz":9674,"spades":9824,"clubs":9827,"hearts":9829,"diams":9830,"OElig":338,"oelig":339,"Scaron":352,"scaron":353,"Yuml":376,"circ":710,"tilde":732,"ensp":8194,"emsp":8195,"thinsp":8201,"zwnj":8204,"zwj":8205,"lrm":8206,"rlm":8207,"ndash":8211,"mdash":8212,"lsquo":8216,"rsquo":8217,"sbquo":8218,"ldquo":8220,"rdquo":8221,"bdquo":8222,"dagger":8224,"Dagger":8225,"permil":8240,"lsaquo":8249,"rsaquo":8250,"euro":8364},escape:function(str){return qx.util.StringEscape.escape(str,qx.bom.String.FROM_CHARCODE);},unescape:function(str){return qx.util.StringEscape.unescape(str,qx.bom.String.TO_CHARCODE);},fromText:function(str){return qx.bom.String.escape(str).replace(/(  |\n)/g,function(chr){var map={"  ":" &nbsp;","\n":"<br>"};return map[chr]||chr;});},toText:function(str){return qx.bom.String.unescape(str.replace(/\s+|<([^>])+>/gi,function(chr){if(/\s+/.test(chr)){return " ";}else if(/^<BR|^<br/gi.test(chr)){return "\n";}else{return "";}}));}},defer:function(statics,members,properties){statics.FROM_CHARCODE=qx.lang.Object.invert(statics.TO_CHARCODE);}});qx.Interface.define("qx.util.format.IFormat",{members:{format:function(obj){},parse:function(str){}}});qx.Class.define("qx.util.format.NumberFormat",{extend:qx.core.Object,implement:qx.util.format.IFormat,construct:function(locale){this.base(arguments);this._locale=locale;},statics:{getIntegerInstance:function(){var NumberFormat=qx.util.format.NumberFormat;if(NumberFormat._integerInstance==null){NumberFormat._integerInstance=new NumberFormat();NumberFormat._integerInstance.setMaximumFractionDigits(0);}return NumberFormat._integerInstance;},getInstance:function(){if(!this._instance){this._instance=new this;}return this._instance;}},properties:{minimumIntegerDigits:{check:"Number",init:0},maximumIntegerDigits:{check:"Number",nullable:true},minimumFractionDigits:{check:"Number",init:0},maximumFractionDigits:{check:"Number",nullable:true},groupingUsed:{check:"Boolean",init:true},prefix:{check:"String",init:""},postfix:{check:"String",init:""}},members:{format:function(num){switch(num){case Infinity:return "Infinity";case -Infinity:return "-Infinity";case NaN:return "NaN";}var negative=(num<0);if(negative){num=-num;}if(this.getMaximumFractionDigits()!=null){var mover=Math.pow(10,this.getMaximumFractionDigits());num=Math.round(num*mover)/mover;}var integerDigits=String(Math.floor(num)).length;var numStr=""+num;var integerStr=numStr.substring(0,integerDigits);while(integerStr.length<this.getMinimumIntegerDigits()){integerStr="0"+integerStr;}if(this.getMaximumIntegerDigits()!=null&&integerStr.length>this.getMaximumIntegerDigits()){integerStr=integerStr.substring(integerStr.length-this.getMaximumIntegerDigits());}var fractionStr=numStr.substring(integerDigits+1);while(fractionStr.length<this.getMinimumFractionDigits()){fractionStr+="0";}if(this.getMaximumFractionDigits()!=null&&fractionStr.length>this.getMaximumFractionDigits()){fractionStr=fractionStr.substring(0,this.getMaximumFractionDigits());}if(this.getGroupingUsed()){var origIntegerStr=integerStr;integerStr="";var groupPos;for(groupPos=origIntegerStr.length;groupPos>3;groupPos-=3){integerStr=""+qx.locale.Number.getGroupSeparator(this._locale)+origIntegerStr.substring(groupPos-3,groupPos)+integerStr;}integerStr=origIntegerStr.substring(0,groupPos)+integerStr;}var prefix=this.getPrefix()?this.getPrefix():"";var postfix=this.getPostfix()?this.getPostfix():"";var str=prefix+(negative?"-":"")+integerStr;if(fractionStr.length>0){str+=""+qx.locale.Number.getDecimalSeparator(this._locale)+fractionStr;}str+=postfix;return str;},parse:function(str){var groupSepEsc=qx.lang.String.escapeRegexpChars(qx.locale.Number.getGroupSeparator(this._locale)+"");var decimalSepEsc=qx.lang.String.escapeRegexpChars(qx.locale.Number.getDecimalSeparator(this._locale)+"");var regex=new RegExp("^"+qx.lang.String.escapeRegexpChars(this.getPrefix())+'([-+]){0,1}'+'([0-9]{1,3}(?:'+groupSepEsc+'{0,1}[0-9]{3}){0,})'+'('+decimalSepEsc+'\\d+){0,1}'+qx.lang.String.escapeRegexpChars(this.getPostfix())+"$");var hit=regex.exec(str);if(hit==null){throw new Error("Number string '"+str+"' does not match the number format");}var negative=(hit[1]=="-");var integerStr=hit[2];var fractionStr=hit[3];integerStr=integerStr.replace(new RegExp(groupSepEsc,"g"),"");var asStr=(negative?"-":"")+integerStr;if(fractionStr!=null&&fractionStr.length!=0){fractionStr=fractionStr.replace(new RegExp(decimalSepEsc),"");asStr+="."+fractionStr;}return parseFloat(asStr);}}});qx.Class.define("qx.locale.Number",{statics:{getDecimalSeparator:function(locale){return qx.locale.Manager.getInstance().localize("cldr_number_decimal_separator",[],locale);},getGroupSeparator:function(locale){return qx.locale.Manager.getInstance().localize("cldr_number_group_separator",[],locale);},getPercentFormat:function(locale){return qx.locale.Manager.getInstance().localize("cldr_number_percent_format",[],locale);}}});qx.Class.define("qx.util.format.DateFormat",{extend:qx.core.Object,implement:qx.util.format.IFormat,construct:function(format,locale){this.base(arguments);if(!locale){this.__locale=qx.locale.Manager.getInstance().getLocale();}else{this.__locale=locale;}if(format!=null){this.__format=format.toString();}else{this.__format=qx.locale.Date.getDateFormat("long",this.__locale)+" "+qx.locale.Date.getDateTimeFormat("HHmmss","HH:mm:ss",this.__locale);}},statics:{getDateTimeInstance:function(){var DateFormat=qx.util.format.DateFormat;var format=qx.locale.Date.getDateFormat("long")+" "+qx.locale.Date.getDateTimeFormat("HHmmss","HH:mm:ss");if(DateFormat._dateInstance==null||DateFormat.__format!=format){DateFormat._dateTimeInstance=new DateFormat();}return DateFormat._dateTimeInstance;},getDateInstance:function(){var DateFormat=qx.util.format.DateFormat;var format=qx.locale.Date.getDateFormat("short")+"";if(DateFormat._dateInstance==null||DateFormat.__format!=format){DateFormat._dateInstance=new DateFormat(format);}return DateFormat._dateInstance;},ASSUME_YEAR_2000_THRESHOLD:30,LOGGING_DATE_TIME__format:"yyyy-MM-dd HH:mm:ss",AM_MARKER:"am",PM_MARKER:"pm",MEDIUM_TIMEZONE_NAMES:["GMT"],FULL_TIMEZONE_NAMES:["Greenwich Mean Time"]},members:{__locale:null,__format:null,__parseFeed:null,__parseRules:null,__fillNumber:function(number,minSize){var str=""+number;while(str.length<minSize){str="0"+str;}return str;},__getDayInYear:function(date){var helpDate=new Date(date.getTime());var day=helpDate.getDate();while(helpDate.getMonth()!=0){helpDate.setDate(-1);day+=helpDate.getDate()+1;}return day;},__thursdayOfSameWeek:function(date){return new Date(date.getTime()+(3-((date.getDay()+6)%7))*86400000);},__getWeekInYear:function(date){var thursdayDate=this.__thursdayOfSameWeek(date);var weekYear=thursdayDate.getFullYear();var thursdayWeek1=this.__thursdayOfSameWeek(new Date(weekYear,0,4));return Math.floor(1.5+(thursdayDate.getTime()-thursdayWeek1.getTime())/86400000/7);},format:function(date){var DateFormat=qx.util.format.DateFormat;var locale=this.__locale;var fullYear=date.getFullYear();var month=date.getMonth();var dayOfMonth=date.getDate();var dayOfWeek=date.getDay();var hours=date.getHours();var minutes=date.getMinutes();var seconds=date.getSeconds();var ms=date.getMilliseconds();var timezone=date.getTimezoneOffset()/60;this.__initFormatTree();var output="";for(var i=0;i<this.___formatTree.length;i++){var currAtom=this.___formatTree[i];if(currAtom.type=="literal"){output+=currAtom.text;}else{var wildcardChar=currAtom.character;var wildcardSize=currAtom.size;var replacement="?";switch(wildcardChar){case 'y':if(wildcardSize==2){replacement=this.__fillNumber(fullYear%100,2);}else if(wildcardSize==4){replacement=fullYear;}break;case 'D':replacement=this.__fillNumber(this.__getDayInYear(date),wildcardSize);break;case 'd':replacement=this.__fillNumber(dayOfMonth,wildcardSize);break;case 'w':replacement=this.__fillNumber(this.__getWeekInYear(date),wildcardSize);break;case 'E':if(wildcardSize==2){replacement=qx.locale.Date.getDayName("narrow",dayOfWeek,locale);}else if(wildcardSize==3){replacement=qx.locale.Date.getDayName("abbreviated",dayOfWeek,locale);}else if(wildcardSize==4){replacement=qx.locale.Date.getDayName("wide",dayOfWeek,locale);}break;case 'M':if(wildcardSize==1||wildcardSize==2){replacement=this.__fillNumber(month+1,wildcardSize);}else if(wildcardSize==3){replacement=qx.locale.Date.getMonthName("abbreviated",month,locale);}else if(wildcardSize==4){replacement=qx.locale.Date.getMonthName("wide",month,locale);}break;case 'a':replacement=(hours<12)?qx.locale.Date.getAmMarker(locale):qx.locale.Date.getPmMarker(locale);break;case 'H':replacement=this.__fillNumber(hours,wildcardSize);break;case 'k':replacement=this.__fillNumber((hours==0)?24:hours,wildcardSize);break;case 'K':replacement=this.__fillNumber(hours%12,wildcardSize);break;case 'h':replacement=this.__fillNumber(((hours%12)==0)?12:(hours%12),wildcardSize);break;case 'm':replacement=this.__fillNumber(minutes,wildcardSize);break;case 's':replacement=this.__fillNumber(seconds,wildcardSize);break;case 'S':replacement=this.__fillNumber(ms,wildcardSize);break;case 'z':if(wildcardSize==1){replacement="GMT"+((timezone<0)?"-":"+")+this.__fillNumber(timezone)+":00";}else if(wildcardSize==2){replacement=DateFormat.MEDIUM_TIMEZONE_NAMES[timezone];}else if(wildcardSize==3){replacement=DateFormat.FULL_TIMEZONE_NAMES[timezone];}break;case 'Z':replacement=((timezone<0)?"-":"+")+this.__fillNumber(timezone,2)+"00";}output+=replacement;}}return output;},parse:function(dateStr){this.__initParseFeed();var hit=this.__parseFeed.regex.exec(dateStr);if(hit==null){throw new Error("Date string '"+dateStr+"' does not match the date format: "+this.__format);}var dateValues={year:1970,month:0,day:1,hour:0,ispm:false,min:0,sec:0,ms:0};var currGroup=1;for(var i=0;i<this.__parseFeed.usedRules.length;i++){var rule=this.__parseFeed.usedRules[i];var value=hit[currGroup];if(rule.field!=null){dateValues[rule.field]=parseInt(value,10);}else{rule.manipulator(dateValues,value);}currGroup+=(rule.groups==null)?1:rule.groups;}var date=new Date(dateValues.year,dateValues.month,dateValues.day,(dateValues.ispm)?(dateValues.hour+12):dateValues.hour,dateValues.min,dateValues.sec,dateValues.ms);if(dateValues.month!=date.getMonth()||dateValues.year!=date.getFullYear()){throw new Error("Error parsing date '"+dateStr+"': the value for day or month is too large");}return date;},__initFormatTree:function(){if(this.___formatTree!=null){return;}this.___formatTree=[];var currWildcardChar;var currWildcardSize=0;var currLiteral="";var format=this.__format;var state="default";var i=0;while(i<format.length){var currChar=format.charAt(i);switch(state){case "quoted_literal":if(currChar=="'"){if(i+1>=format.length){i++;break;}var lookAhead=format.charAt(i+1);if(lookAhead=="'"){currLiteral+=currChar;i++;}else{i++;state="unkown";}}else{currLiteral+=currChar;i++;}break;case "wildcard":if(currChar==currWildcardChar){currWildcardSize++;i++;}else{this.___formatTree.push({type:"wildcard",character:currWildcardChar,size:currWildcardSize});currWildcardChar=null;currWildcardSize=0;state="default";}break;default:if((currChar>='a'&&currChar<='z')||(currChar>='A'&&currChar<='Z')){currWildcardChar=currChar;state="wildcard";}else if(currChar=="'"){if(i+1>=format.length){currLiteral+=currChar;i++;break;}var lookAhead=format.charAt(i+1);if(lookAhead=="'"){currLiteral+=currChar;i++;}i++;state="quoted_literal";}else{state="default";}if(state!="default"){if(currLiteral.length>0){this.___formatTree.push({type:"literal",text:currLiteral});currLiteral="";}}else{currLiteral+=currChar;i++;}break;}}if(currWildcardChar!=null){this.___formatTree.push({type:"wildcard",character:currWildcardChar,size:currWildcardSize});}else if(currLiteral.length>0){this.___formatTree.push({type:"literal",text:currLiteral});}},__initParseFeed:function(){if(this.__parseFeed!=null){return ;}var format=this.__format;this.__initParseRules();this.__initFormatTree();var usedRules=[];var pattern="^";for(var atomIdx=0;atomIdx<this.___formatTree.length;atomIdx++){var currAtom=this.___formatTree[atomIdx];if(currAtom.type=="literal"){pattern+=qx.lang.String.escapeRegexpChars(currAtom.text);}else{var wildcardChar=currAtom.character;var wildcardSize=currAtom.size;var wildcardRule;for(var ruleIdx=0;ruleIdx<this.__parseRules.length;ruleIdx++){var rule=this.__parseRules[ruleIdx];if(wildcardChar==rule.pattern.charAt(0)&&wildcardSize==rule.pattern.length){wildcardRule=rule;break;}}if(wildcardRule==null){var wildcardStr="";for(var i=0;i<wildcardSize;i++){wildcardStr+=wildcardChar;}throw new Error("Malformed date format: "+format+". Wildcard "+wildcardStr+" is not supported");}else{usedRules.push(wildcardRule);pattern+=wildcardRule.regex;}}}pattern+="$";var regex;try{regex=new RegExp(pattern);}catch(exc){throw new Error("Malformed date format: "+format);}this.__parseFeed={regex:regex,"usedRules":usedRules,pattern:pattern};},__initParseRules:function(){var DateFormat=qx.util.format.DateFormat;if(this.__parseRules!=null){return ;}this.__parseRules=[];var yearManipulator=function(dateValues,value){value=parseInt(value,10);if(value<DateFormat.ASSUME_YEAR_2000_THRESHOLD){value+=2000;}else if(value<100){value+=1900;}dateValues.year=value;};var monthManipulator=function(dateValues,value){dateValues.month=parseInt(value,10)-1;};var ampmManipulator=function(dateValues,value){dateValues.ispm=(value==DateFormat.PM_MARKER);};var noZeroHourManipulator=function(dateValues,value){dateValues.hour=parseInt(value,10)%24;};var noZeroAmPmHourManipulator=function(dateValues,value){dateValues.hour=parseInt(value,10)%12;};var ignoreManipulator=function(dateValues,value){return;};var shortMonthNames=qx.locale.Date.getMonthNames("abbreviated",this.__locale);for(var i=0;i<shortMonthNames.length;i++){shortMonthNames[i]=qx.lang.String.escapeRegexpChars(shortMonthNames[i].toString());}var shortMonthNamesManipulator=function(dateValues,value){value=qx.lang.String.escapeRegexpChars(value);dateValues.month=shortMonthNames.indexOf(value);};var fullMonthNames=qx.locale.Date.getMonthNames("wide",this.__locale);for(var i=0;i<fullMonthNames.length;i++){fullMonthNames[i]=qx.lang.String.escapeRegexpChars(fullMonthNames[i].toString());}var fullMonthNamesManipulator=function(dateValues,value){value=qx.lang.String.escapeRegexpChars(value);dateValues.month=fullMonthNames.indexOf(value);};var narrowDayNames=qx.locale.Date.getDayNames("narrow",this.__locale);for(var i=0;i<narrowDayNames.length;i++){narrowDayNames[i]=qx.lang.String.escapeRegexpChars(narrowDayNames[i].toString());}var narrowDayNamesManipulator=function(dateValues,value){value=qx.lang.String.escapeRegexpChars(value);dateValues.month=narrowDayNames.indexOf(value);};var abbrDayNames=qx.locale.Date.getDayNames("abbreviated",this.__locale);for(var i=0;i<abbrDayNames.length;i++){abbrDayNames[i]=qx.lang.String.escapeRegexpChars(abbrDayNames[i].toString());}var abbrDayNamesManipulator=function(dateValues,value){value=qx.lang.String.escapeRegexpChars(value);dateValues.month=abbrDayNames.indexOf(value);};var fullDayNames=qx.locale.Date.getDayNames("wide",this.__locale);for(var i=0;i<fullDayNames.length;i++){fullDayNames[i]=qx.lang.String.escapeRegexpChars(fullDayNames[i].toString());}var fullDayNamesManipulator=function(dateValues,value){value=qx.lang.String.escapeRegexpChars(value);dateValues.month=fullDayNames.indexOf(value);};this.__parseRules.push({pattern:"yyyy",regex:"(\\d\\d(\\d\\d)?)",groups:2,manipulator:yearManipulator});this.__parseRules.push({pattern:"yy",regex:"(\\d\\d)",manipulator:yearManipulator});this.__parseRules.push({pattern:"M",regex:"(\\d\\d?)",manipulator:monthManipulator});this.__parseRules.push({pattern:"MM",regex:"(\\d\\d?)",manipulator:monthManipulator});this.__parseRules.push({pattern:"MMM",regex:"("+shortMonthNames.join("|")+")",manipulator:shortMonthNamesManipulator});this.__parseRules.push({pattern:"MMMM",regex:"("+fullMonthNames.join("|")+")",manipulator:fullMonthNamesManipulator});this.__parseRules.push({pattern:"dd",regex:"(\\d\\d?)",field:"day"});this.__parseRules.push({pattern:"d",regex:"(\\d\\d?)",field:"day"});this.__parseRules.push({pattern:"EE",regex:"("+narrowDayNames.join("|")+")",manipulator:narrowDayNamesManipulator});this.__parseRules.push({pattern:"EEE",regex:"("+abbrDayNames.join("|")+")",manipulator:abbrDayNamesManipulator});this.__parseRules.push({pattern:"EEEE",regex:"("+fullDayNames.join("|")+")",manipulator:fullDayNamesManipulator});this.__parseRules.push({pattern:"a",regex:"("+DateFormat.AM_MARKER+"|"+DateFormat.PM_MARKER+")",manipulator:ampmManipulator});this.__parseRules.push({pattern:"HH",regex:"(\\d\\d?)",field:"hour"});this.__parseRules.push({pattern:"H",regex:"(\\d\\d?)",field:"hour"});this.__parseRules.push({pattern:"kk",regex:"(\\d\\d?)",manipulator:noZeroHourManipulator});this.__parseRules.push({pattern:"k",regex:"(\\d\\d?)",manipulator:noZeroHourManipulator});this.__parseRules.push({pattern:"KK",regex:"(\\d\\d?)",field:"hour"});this.__parseRules.push({pattern:"K",regex:"(\\d\\d?)",field:"hour"});this.__parseRules.push({pattern:"hh",regex:"(\\d\\d?)",manipulator:noZeroAmPmHourManipulator});this.__parseRules.push({pattern:"h",regex:"(\\d\\d?)",manipulator:noZeroAmPmHourManipulator});this.__parseRules.push({pattern:"mm",regex:"(\\d\\d?)",field:"min"});this.__parseRules.push({pattern:"m",regex:"(\\d\\d?)",field:"min"});this.__parseRules.push({pattern:"ss",regex:"(\\d\\d?)",field:"sec"});this.__parseRules.push({pattern:"s",regex:"(\\d\\d?)",field:"sec"});this.__parseRules.push({pattern:"SSS",regex:"(\\d\\d?\\d?)",field:"ms"});this.__parseRules.push({pattern:"SS",regex:"(\\d\\d?\\d?)",field:"ms"});this.__parseRules.push({pattern:"S",regex:"(\\d\\d?\\d?)",field:"ms"});this.__parseRules.push({pattern:"Z",regex:"((\\+|\\-)\\d\\d:?\\d\\d)",manipulator:ignoreManipulator});this.__parseRules.push({pattern:"z",regex:"([a-zA-Z]+)",manipulator:ignoreManipulator});}},destruct:function(){this._disposeFields("__format","__locale","___formatTree","__parseFeed","__parseRules");}});qx.Class.define("qx.locale.Date",{statics:{__mgr:qx.locale.Manager.getInstance(),getAmMarker:function(locale){return this.__mgr.localize("cldr_am",[],locale);},getPmMarker:function(locale){return this.__mgr.localize("cldr_pm",[],locale);},getDayNames:function(length,locale){{};var days=["sun","mon","tue","wed","thu","fri","sat"];var names=[];for(var i=0;i<days.length;i++){var key="cldr_day_"+length+"_"+days[i];names.push(this.__mgr.localize(key,[],locale));}return names;},getDayName:function(length,day,locale){{};var days=["sun","mon","tue","wed","thu","fri","sat"];var key="cldr_day_"+length+"_"+days[day];return this.__mgr.localize(key,[],locale);},getMonthNames:function(length,locale){{};var names=[];for(var i=0;i<12;i++){var key="cldr_month_"+length+"_"+(i+1);names.push(this.__mgr.localize(key,[],locale));}return names;},getMonthName:function(length,month,locale){{};var key="cldr_month_"+length+"_"+(month+1);return this.__mgr.localize(key,[],locale);},getDateFormat:function(size,locale){{};var key="cldr_date_format_"+size;return this.__mgr.localize(key,[],locale);},getDateTimeFormat:function(canonical,fallback,locale){var key="cldr_date_time_format_"+canonical;var localizedFormat=this.__mgr.localize(key,[],locale);if(localizedFormat==key){localizedFormat=fallback;}return localizedFormat;},getTimeFormat:function(size,locale){{};var key="cldr_time_format_"+size;var localizedFormat=this.__mgr.localize(key,[],locale);if(localizedFormat!=key){return localizedFormat;}switch(size){case "short":case "medium":return qx.locale.Date.getDateTimeFormat("HHmm","HH:mm");case "long":return qx.locale.Date.getDateTimeFormat("HHmmss","HH:mm:ss");case "full":return qx.locale.Date.getDateTimeFormat("HHmmsszz","HH:mm:ss zz");default:throw new Error("This case should never happen.");}},getWeekStart:function(locale){var weekStart={"MV":5,"AE":6,"AF":6,"BH":6,"DJ":6,"DZ":6,"EG":6,"ER":6,"ET":6,"IQ":6,"IR":6,"JO":6,"KE":6,"KW":6,"LB":6,"LY":6,"MA":6,"OM":6,"QA":6,"SA":6,"SD":6,"SO":6,"TN":6,"YE":6,"AS":0,"AU":0,"AZ":0,"BW":0,"CA":0,"CN":0,"FO":0,"GE":0,"GL":0,"GU":0,"HK":0,"IE":0,"IL":0,"IS":0,"JM":0,"JP":0,"KG":0,"KR":0,"LA":0,"MH":0,"MN":0,"MO":0,"MP":0,"MT":0,"NZ":0,"PH":0,"PK":0,"SG":0,"TH":0,"TT":0,"TW":0,"UM":0,"US":0,"UZ":0,"VI":0,"ZA":0,"ZW":0,"MW":0,"NG":0,"TJ":0};var territory=qx.locale.Date._getTerritory(locale);return weekStart[territory]!=null?weekStart[territory]:1;},getWeekendStart:function(locale){var weekendStart={"EG":5,"IL":5,"SY":5,"IN":0,"AE":4,"BH":4,"DZ":4,"IQ":4,"JO":4,"KW":4,"LB":4,"LY":4,"MA":4,"OM":4,"QA":4,"SA":4,"SD":4,"TN":4,"YE":4};var territory=qx.locale.Date._getTerritory(locale);return weekendStart[territory]!=null?weekendStart[territory]:6;},getWeekendEnd:function(locale){var weekendEnd={"AE":5,"BH":5,"DZ":5,"IQ":5,"JO":5,"KW":5,"LB":5,"LY":5,"MA":5,"OM":5,"QA":5,"SA":5,"SD":5,"TN":5,"YE":5,"AF":5,"IR":5,"EG":6,"IL":6,"SY":6};var territory=qx.locale.Date._getTerritory(locale);return weekendEnd[territory]!=null?weekendEnd[territory]:0;},isWeekend:function(day,locale){var weekendStart=qx.locale.Date.getWeekendStart(locale);var weekendEnd=qx.locale.Date.getWeekendEnd(locale);if(weekendEnd>weekendStart){return ((day>=weekendStart)&&(day<=weekendEnd));}else{return ((day>=weekendStart)||(day<=weekendEnd));}},_getTerritory:function(locale){if(locale){var territory=locale.split("_")[1]||locale;}else{territory=this.__mgr.getTerritory()||this.__mgr.getLanguage();}return territory.toUpperCase();}}});qx.Interface.define("qx.ui.form.IFormElement",{events:{"changeValue":"qx.event.type.Data","changeName":"qx.event.type.Data","changeEnabled":"qx.event.type.Data"},members:{setEnabled:function(value){this.assertType(value,"boolean");},getEnabled:function(){},setName:function(value){this.assertType(value,"string");},getName:function(){},setValue:function(value){this.assertType(value,"string");},getValue:function(){}}});qx.Class.define("qx.ui.form.AbstractField",{extend:qx.ui.core.Widget,implement:qx.ui.form.IFormElement,type:"abstract",construct:function(value){this.base(arguments);if(value!=null){this.setValue(value);}this.getContentElement().addListener("change",this._onChangeContent,this);},events:{"input":"qx.event.type.Data","changeValue":"qx.event.type.Data"},properties:{name:{check:"String",nullable:true,event:"changeName"},textAlign:{check:["left","center","right"],nullable:true,themeable:true,apply:"_applyTextAlign"},readOnly:{check:"Boolean",apply:"_applyReadOnly",init:false},selectable:{refine:true,init:true},focusable:{refine:true,init:true}},members:{getFocusElement:function(){return this.getContentElement();},_createInputElement:function(){return new qx.html.Input("text");},_createContentElement:function(){var el=this._createInputElement();if(qx.core.Variant.isSet("qx.client","gecko")){el.setAttribute("spellcheck","false");}el.setStyles({"border":"none","padding":0,"margin":0,"display":"block","background":"transparent","outline":"none","appearance":"none"});if(qx.core.Variant.isSet("qx.client","webkit")){el.setStyle("resize","none");}return el;},_applyEnabled:function(value,old){this.base(arguments,value,old);this.getContentElement().setAttribute("disabled",value===false);},_textSize:{width:16,height:16},_getContentHint:function(){return {width:this._textSize.width*10,height:this._textSize.height||16};},_applyFont:function(value,old){var styles;if(value){var font=qx.theme.manager.Font.getInstance().resolve(value);styles=font.getStyles();}else{styles=qx.bom.Font.getDefaultStyles();}this.getContentElement().setStyles(styles);if(value){this._textSize=qx.bom.Label.getTextSize("A",styles);}else{delete this._textSize;}qx.ui.core.queue.Layout.add(this);},_applyTextColor:function(value,old){if(value){this.getContentElement().setStyle("color",qx.theme.manager.Color.getInstance().resolve(value));}else{this.getContentElement().removeStyle("color");}},tabFocus:function(){this.base(arguments);this.selectAll();},setValue:function(value){if(typeof value==="string"||value instanceof String){var elem=this.getContentElement();if(elem.getValue()!=value){elem.setValue(value);this.fireNonBubblingEvent("changeValue",qx.event.type.Data,[value]);}return value;}throw new Error("Invalid value type: "+value);},getValue:function(){return this.getContentElement().getValue();},_onChangeContent:function(e){this.fireNonBubblingEvent("changeValue",qx.event.type.Data,[e.getData()]);},getSelection:function(){return this.getContentElement().getSelection();},getSelectionLength:function(){return this.getContentElement().getSelectionLength();},setSelection:function(start,end){this.getContentElement().setSelection(start,end);},clearSelection:function(){this.getContentElement().clearSelection();},selectAll:function(){this.setSelection(0);},_applyTextAlign:function(value,old){this.getContentElement().setStyle("textAlign",value);},_applyReadOnly:function(value,old){this.getContentElement().setAttribute("readOnly",value);if(value){this.addState("readonly");}else{this.removeState("readonly");}}}});qx.Class.define("qx.ui.form.TextField",{extend:qx.ui.form.AbstractField,properties:{maxLength:{check:"Integer",apply:"_applyMaxLength",nullable:true},appearance:{refine:true,init:"textfield"},allowGrowY:{refine:true,init:false},allowShrinkY:{refine:true,init:false}},events:{"input":"qx.event.type.Data"},members:{_createInputElement:function(){var input=new qx.html.Input("text");input.addListener("input",this._onHtmlInput,this);return input;},_onHtmlInput:function(e){this.fireDataEvent("input",e.getData());},_applyMaxLength:function(value,old){this.getContentElement().setAttribute("maxLength",value==null?"":value);}}});qx.Class.define("qx.html.Input",{extend:qx.html.Element,construct:function(type){this.base(arguments);this.__type=type;if(type==="select"||type==="textarea"){this._nodeName=type;}else{this._nodeName="input";}},members:{_createDomElement:function(){return qx.bom.Input.create(this.__type);},_applyProperty:function(name,value){this.base(arguments,name,value);if(name==="value"){qx.bom.Input.setValue(this._element,value);}else if(name==="wrap"){qx.bom.Input.setWrap(this._element,value);}},setValue:function(value){if(this._element){if(this._element.value!=value){qx.bom.Input.setValue(this._element,value);}}else{this._setProperty("value",value);}return this;},getValue:function(){if(this._element){return qx.bom.Input.getValue(this._element);}return this._getProperty("value")||"";},setWrap:function(wrap){if(this.__type==="textarea"){this._setProperty("wrap",wrap);}else{throw new Error("Text wrapping is only support by textareas!");}return this;},getWrap:function(){if(this.__type==="textarea"){return this._getProperty("wrap");}else{throw new Error("Text wrapping is only support by textareas!");}}}});qx.Class.define("qx.event.handler.Input",{extend:qx.core.Object,implement:qx.event.IEventHandler,construct:function(){this.base(arguments);this._onChangeCheckedWrapper=qx.lang.Function.listener(this._onChangeChecked,this);this._onChangeValueWrapper=qx.lang.Function.listener(this._onChangeValue,this);this._onInputWrapper=qx.lang.Function.listener(this._onInput,this);this._onPropertyWrapper=qx.lang.Function.listener(this._onProperty,this);},statics:{PRIORITY:qx.event.Registration.PRIORITY_NORMAL,SUPPORTED_TYPES:{input:1,change:1},TARGET_CHECK:qx.event.IEventHandler.TARGET_DOMNODE,IGNORE_CAN_HANDLE:false},members:{canHandleEvent:function(target,type){var lower=target.tagName.toLowerCase();if(type==="input"&&(lower==="input"||lower==="textarea")){return true;}if(type==="change"&&(lower==="input"||lower==="textarea"||lower==="select")){return true;}return false;},registerEvent:qx.core.Variant.select("qx.client",{"mshtml":function(target,type,capture){if(!target.__inputHandlerAttached){var tag=target.tagName.toLowerCase();var type=target.type;if(type==="text"||tag==="textarea"||type==="checkbox"||type==="radio"){qx.bom.Event.addNativeListener(target,"propertychange",this._onPropertyWrapper);}if(type!=="checkbox"&&type!=="radio"){qx.bom.Event.addNativeListener(target,"change",this._onChangeValueWrapper);}target.__inputHandlerAttached=true;}},"default":function(target,type,capture){if(type==="input"){qx.bom.Event.addNativeListener(target,"input",this._onInputWrapper);}else if(type==="change"){if(target.type==="radio"||target.type==="checkbox"){qx.bom.Event.addNativeListener(target,"change",this._onChangeCheckedWrapper);}else{qx.bom.Event.addNativeListener(target,"change",this._onChangeValueWrapper);}}}}),unregisterEvent:qx.core.Variant.select("qx.client",{"mshtml":function(target,type){if(!target.__inputHandlerAttached){var tag=target.tagName.toLowerCase();var type=target.type;if(type==="text"||tag==="textarea"||type==="checkbox"||type==="radio"){qx.bom.Event.removeNativeListener(target,"propertychange",this._onPropertyWrapper);}if(type!=="checkbox"&&type!=="radio"){qx.bom.Event.removeNativeListener(target,"change",this._onChangeValueWrapper);}delete target.__inputHandlerAttached;}},"default":function(target,type){if(type==="input"){qx.bom.Event.removeNativeListener(target,"input",this._onInputWrapper);}else if(type==="change"){if(target.type==="radio"||target.type==="checkbox"){qx.bom.Event.removeNativeListener(target,"change",this._onChangeCheckedWrapper);}else{qx.bom.Event.removeNativeListener(target,"change",this._onChangeValueWrapper);}}}}),_onInput:function(e){var target=e.target;qx.event.Registration.fireEvent(target,"input",qx.event.type.Data,[target.value]);},_onChangeValue:function(e){var target=e.target||e.srcElement;var data=target.value;if(target.type==="select-multiple"){var data=[];for(var i=0,o=target.options,l=o.length;i<l;i++){if(o[i].selected){data.push(o[i].value);}}}qx.event.Registration.fireEvent(target,"change",qx.event.type.Data,[data]);},_onChangeChecked:function(e){var target=e.target;if(target.type==="radio"){if(target.checked){qx.event.Registration.fireEvent(target,"change",qx.event.type.Data,[target.value]);}}else{qx.event.Registration.fireEvent(target,"change",qx.event.type.Data,[target.checked]);}},_onProperty:qx.core.Variant.select("qx.client",{"mshtml":function(e){var target=e.target||e.srcElement;var prop=e.propertyName;if(prop==="value"&&(target.type==="text"||target.tagName.toLowerCase()==="textarea")){if(!target.__inValueSet){qx.event.Registration.fireEvent(target,"input",qx.event.type.Data,[target.value]);}}else if(prop==="checked"){if(target.type==="checkbox"){qx.event.Registration.fireEvent(target,"change",qx.event.type.Data,[target.checked]);}else if(target.checked){qx.event.Registration.fireEvent(target,"change",qx.event.type.Data,[target.value]);}}},"default":function(){}})},defer:function(statics){qx.event.Registration.addHandler(statics);}});qx.Class.define("qx.bom.Input",{statics:{__types:{text:1,textarea:1,select:1,checkbox:1,radio:1,password:1,hidden:1,submit:1,image:1,file:1,search:1,reset:1,button:1},create:function(type,attributes,win){{};var attributes=attributes?qx.lang.Object.copy(attributes):{};var tag;if(type==="textarea"||type==="select"){tag=type;}else{tag="input";attributes.type=type;}return qx.bom.Element.create(tag,attributes,win);},setValue:qx.core.Variant.select("qx.client",{"mshtml":function(element,value){element.__inValueSet=true;element.value=value;element.__inValueSet=null;},"default":function(element,value){element.value=value;}}),getValue:function(element){return element.value;},setWrap:qx.core.Variant.select("qx.client",{"mshtml":function(element,wrap){element.wrap=wrap?"soft":"off";},"gecko":function(element,wrap){var wrapValue=wrap?"soft":"off";var styleValue=wrap?"":"auto";element.setAttribute('wrap',wrapValue);element.style.overflow=styleValue;},"default":function(element,wrap){element.style.whiteSpace=wrap?"normal":"nowrap";}})}});qx.Class.define("qx.ui.table.pane.Pane",{extend:qx.ui.core.Widget,construct:function(paneScroller){this.base(arguments);this.__paneScroller=paneScroller;this.__lastColCount=0;this.__lastRowCount=0;this.__rowCache=[];},properties:{firstVisibleRow:{check:"Number",init:0,apply:"_applyFirstVisibleRow"},visibleRowCount:{check:"Number",init:0,apply:"_applyVisibleRowCount"},maxCacheLines:{check:"Number",init:1000,apply:"_applyMaxCacheLines"},allowShrinkX:{refine:true,init:false},allowGrowY:{refine:true,init:false},allowShrinkY:{refine:true,init:false}},members:{__lastRowCount:null,__lastColCount:null,__paneScroller:null,__tableContainer:null,__focusedRow:null,__focusedCol:null,__rowCache:null,__rowCacheCount:0,_applyFirstVisibleRow:function(value,old){this.updateContent(false,value-old);},_applyVisibleRowCount:function(value,old){this.updateContent();},getPaneScroller:function(){return this.__paneScroller;},getTable:function(){return this.__paneScroller.getTable();},setFocusedCell:function(col,row,massUpdate){if(col!=this.__focusedCol||row!=this.__focusedRow){var oldRow=this.__focusedRow;this.__focusedCol=col;this.__focusedRow=row;if(row!=oldRow&&!massUpdate){if(row!==null&&oldRow!==null){this.updateContent(false,null,oldRow,true);this.updateContent(false,null,row,true);}else{this.updateContent();}}}},onSelectionChanged:function(){this.updateContent(false,null,null,true);},onFocusChanged:function(){this.updateContent(false,null,null,true);},setColumnWidth:function(col,width){this.updateContent(true);},onColOrderChanged:function(){this.updateContent(true);},onPaneModelChanged:function(){this.updateContent(true);},onTableModelDataChanged:function(firstRow,lastRow,firstColumn,lastColumn){this.__rowCacheClear();var paneFirstRow=this.getFirstVisibleRow();var rowCount=this.getVisibleRowCount();if(lastRow==-1||lastRow>=paneFirstRow&&firstRow<paneFirstRow+rowCount){this.updateContent();}},onTableModelMetaDataChanged:function(){this.updateContent(true);},_applyMaxCacheLines:function(value,old){if(this.__rowCacheCount>=value&&value!==-1){this.__rowCacheClear();}},__rowCacheClear:function(){this.__rowCache=[];this.__rowCacheCount=0;},__rowCacheGet:function(row,selected,focused){if(!selected&&!focused&&this.__rowCache[row]){return this.__rowCache[row];}else{return null;}},__rowCacheSet:function(row,rowString,selected,focused){if(!selected&&!focused&&!this.__rowCache[row]){this._applyMaxCacheLines(this.getMaxCacheLines());this.__rowCache[row]=rowString;this.__rowCacheCount+=1;}},updateContent:function(completeUpdate,scrollOffset,onlyRow,onlySelectionOrFocusChanged){if(completeUpdate){this.__rowCacheClear();}if(scrollOffset&&Math.abs(scrollOffset)<=Math.min(10,this.getVisibleRowCount())){this._scrollContent(scrollOffset);}else if(onlySelectionOrFocusChanged&&!this.getTable().getAlwaysUpdateCells()){this._updateRowStyles(onlyRow);}else{this._updateAllRows();}},_updateRowStyles:function(onlyRow){var elem=this.getContentElement().getDomElement();if(!elem||!elem.firstChild){this._updateAllRows();return;}var table=this.getTable();var selectionModel=table.getSelectionModel();var tableModel=table.getTableModel();var rowRenderer=table.getDataRowRenderer();var rowNodes=elem.firstChild.childNodes;var cellInfo={table:table};var row=this.getFirstVisibleRow();var y=0;var end=rowNodes.length;if(onlyRow!=null){var offset=onlyRow-row;if(offset>=0&&offset<end){row=onlyRow;y=offset;end=offset+1;}else{return;}}for(;y<end;y++,row++){cellInfo.row=row;cellInfo.selected=selectionModel.isSelectedIndex(row);cellInfo.focusedRow=(this.__focusedRow==row);cellInfo.rowData=tableModel.getRowData(row);rowRenderer.updateDataRowElement(cellInfo,rowNodes[y]);}},_getRowsHtml:function(firstRow,rowCount){var table=this.getTable();var selectionModel=table.getSelectionModel();var tableModel=table.getTableModel();var columnModel=table.getTableColumnModel();var paneModel=this.getPaneScroller().getTablePaneModel();var rowRenderer=table.getDataRowRenderer();tableModel.prefetchRows(firstRow,firstRow+rowCount-1);var rowHeight=table.getRowHeight();var colCount=paneModel.getColumnCount();var left=0;var cols=[];for(var x=0;x<colCount;x++){var col=paneModel.getColumnAtX(x);var cellWidth=columnModel.getColumnWidth(col);cols.push({col:col,xPos:x,editable:tableModel.isColumnEditable(col),focusedCol:this.__focusedCol==col,styleLeft:left,styleWidth:cellWidth});left+=cellWidth;}var rowsArr=[];for(var row=firstRow;row<firstRow+rowCount;row++){var selected=selectionModel.isSelectedIndex(row);var focusedRow=(this.__focusedRow==row);var cachedRow=this.__rowCacheGet(row,selected,focusedRow);if(cachedRow){rowsArr.push(cachedRow);continue;}var rowHtml=[];var cellInfo={table:table};cellInfo.styleHeight=rowHeight;cellInfo.row=row;cellInfo.selected=selected;cellInfo.focusedRow=focusedRow;cellInfo.rowData=tableModel.getRowData(row);rowHtml.push('<div ');var rowClass=rowRenderer.getRowClass(cellInfo);if(rowClass){rowHtml.push('class="',rowClass,'" ');}var rowStyle=rowRenderer.createRowStyle(cellInfo);rowStyle+=";position:relative;"+rowRenderer.getRowHeightStyle(rowHeight)+"width:100%;";if(rowStyle){rowHtml.push('style="',rowStyle,'" ');}rowHtml.push('>');for(var x=0;x<colCount;x++){var col_def=cols[x];for(var attr in col_def){cellInfo[attr]=col_def[attr];}var col=cellInfo.col;cellInfo.value=tableModel.getValue(col,row);var cellRenderer=columnModel.getDataCellRenderer(col);cellRenderer.createDataCellHtml(cellInfo,rowHtml);}rowHtml.push('</div>');var rowString=rowHtml.join("");this.__rowCacheSet(row,rowString,selected,focusedRow);rowsArr.push(rowString);}return rowsArr.join("");},_scrollContent:function(rowOffset){var el=this.getContentElement().getDomElement();if(!(el&&el.firstChild)){this._updateAllRows();return;}var tableBody=el.firstChild;var tableChildNodes=tableBody.childNodes;var rowCount=this.getVisibleRowCount();var firstRow=this.getFirstVisibleRow();var modelRowCount=this.getTable().getTableModel().getRowCount();if(firstRow+rowCount>modelRowCount){this._updateAllRows();return;}var removeRowBase=rowOffset<0?rowCount+rowOffset:0;var addRowBase=rowOffset<0?0:rowCount-rowOffset;for(i=Math.abs(rowOffset)-1;i>=0;i--){var rowElem=tableChildNodes[removeRowBase];try{tableBody.removeChild(rowElem);}catch(exp){break;}}if(!this.__tableContainer){this.__tableContainer=document.createElement("div");}var tableDummy='<div>';tableDummy+=this._getRowsHtml(firstRow+addRowBase,Math.abs(rowOffset));tableDummy+='</div>';this.__tableContainer.innerHTML=tableDummy;var newTableRows=this.__tableContainer.firstChild.childNodes;if(rowOffset>0){for(var i=newTableRows.length-1;i>=0;i--){var rowElem=newTableRows[0];tableBody.appendChild(rowElem);}}else{for(var i=newTableRows.length-1;i>=0;i--){var rowElem=newTableRows[newTableRows.length-1];tableBody.insertBefore(rowElem,tableBody.firstChild);}}if(this.__focusedRow!==null){this._updateRowStyles(this.__focusedRow-rowOffset);this._updateRowStyles(this.__focusedRow);}},_updateAllRows:function(){var elem=this.getContentElement().getDomElement();if(!elem){this.addListenerOnce("appear",arguments.callee,this);return;}var table=this.getTable();var tableModel=table.getTableModel();var paneModel=this.getPaneScroller().getTablePaneModel();var colCount=paneModel.getColumnCount();var rowHeight=table.getRowHeight();var firstRow=this.getFirstVisibleRow();var rowCount=this.getVisibleRowCount();var modelRowCount=tableModel.getRowCount();if(firstRow+rowCount>modelRowCount){rowCount=Math.max(0,modelRowCount-firstRow);}var rowWidth=paneModel.getTotalWidth();var htmlArr;if(rowCount>0){htmlArr=["<div style='","width: 100%;",(table.getForceLineHeight()?"line-height: "+rowHeight+"px;":""),"overflow: hidden;","'>",this._getRowsHtml(firstRow,rowCount),"</div>"];}else{htmlArr=[];}var data=htmlArr.join("");elem.innerHTML=data;this.setHeight(rowCount*rowHeight);this.setWidth(rowWidth);this.__lastColCount=colCount;this.__lastRowCount=rowCount;}},destruct:function(){this._disposeFields("__tableContainer","__paneScroller","__rowCache");}});qx.Class.define("qx.ui.table.pane.Header",{extend:qx.ui.core.Widget,construct:function(paneScroller){this.base(arguments);this._setLayout(new qx.ui.layout.HBox());this.__paneScroller=paneScroller;},members:{__paneScroller:null,__moveFeedback:null,__lastMouseOverColumn:null,getPaneScroller:function(){return this.__paneScroller;},getTable:function(){return this.__paneScroller.getTable();},onColOrderChanged:function(){this._updateContent(true);},onPaneModelChanged:function(){this._updateContent(true);},onTableModelMetaDataChanged:function(){this._updateContent();},setColumnWidth:function(col,width){var child=this.getHeaderWidgetAtColumn(col);if(child!=null){child.setWidth(width);}},setMouseOverColumn:function(col){if(col!=this.__lastMouseOverColumn){if(this.__lastMouseOverColumn!=null){var widget=this.getHeaderWidgetAtColumn(this.__lastMouseOverColumn);if(widget!=null){widget.removeState("hovered");}}if(col!=null){this.getHeaderWidgetAtColumn(col).addState("hovered");}this.__lastMouseOverColumn=col;}},getHeaderWidgetAtColumn:function(col){var xPos=this.getPaneScroller().getTablePaneModel().getX(col);return this._getChildren()[xPos];},showColumnMoveFeedback:function(col,x){var pos=this.getContainerLocation();if(this.__moveFeedback==null){var xPos=this.getPaneScroller().getTablePaneModel().getX(col);var cellWidget=this._getChildren()[xPos];var tableModel=this.getTable().getTableModel();var columnModel=this.getTable().getTableColumnModel();var cellInfo={xPos:xPos,col:col,name:tableModel.getColumnName(col)};var cellRenderer=columnModel.getHeaderCellRenderer(col);var feedback=cellRenderer.createHeaderCell(cellInfo);var size=cellWidget.getBounds();feedback.setWidth(size.width);feedback.setHeight(size.height);feedback.setZIndex(1000000);feedback.setOpacity(0.8);feedback.setLayoutProperties({top:pos.top});this.getApplicationRoot().add(feedback);this.__moveFeedback=feedback;}this.__moveFeedback.setLayoutProperties({left:pos.left+x});this.__moveFeedback.show();},hideColumnMoveFeedback:function(){if(this.__moveFeedback!=null){this.__moveFeedback.getLayoutParent().remove(this.__moveFeedback);this.__moveFeedback.dispose();this.__moveFeedback=null;}},isShowingColumnMoveFeedback:function(){return this.__moveFeedback!=null;},_updateContent:function(completeUpdate){var tableModel=this.getTable().getTableModel();var columnModel=this.getTable().getTableColumnModel();var paneModel=this.getPaneScroller().getTablePaneModel();var children=this._getChildren();var colCount=paneModel.getColumnCount();var sortedColum=tableModel.getSortColumnIndex();if(completeUpdate){this._cleanUpCells();}var cellInfo={};cellInfo.sortedAscending=tableModel.isSortAscending();for(var x=0;x<colCount;x++){var col=paneModel.getColumnAtX(x);var colWidth=columnModel.getColumnWidth(col);var cellRenderer=columnModel.getHeaderCellRenderer(col);cellInfo.xPos=x;cellInfo.col=col;cellInfo.name=tableModel.getColumnName(col);cellInfo.editable=tableModel.isColumnEditable(col);cellInfo.sorted=(col==sortedColum);var cachedWidget=children[x];if(cachedWidget==null){cachedWidget=cellRenderer.createHeaderCell(cellInfo);cachedWidget.set({width:colWidth});this._add(cachedWidget);}else{cellRenderer.updateHeaderCell(cellInfo,cachedWidget);}}},_cleanUpCells:function(){var children=this._getChildren();for(var x=children.length-1;x>=0;x--){var cellWidget=children[x];this._remove(cellWidget);cellWidget.dispose();}}},destruct:function(){this._disposeObjects("__paneScroller");}});qx.Class.define("qx.ui.table.pane.Scroller",{extend:qx.ui.core.Widget,construct:function(table){this.base(arguments);this.__table=table;var grid=new qx.ui.layout.Grid();grid.setColumnFlex(0,1);grid.setRowFlex(1,1);this._setLayout(grid);this.__horScrollBar=this._showChildControl("scrollbar-x");this.__verScrollBar=this._showChildControl("scrollbar-y");this.__header=this._showChildControl("header");this.__tablePane=this._showChildControl("pane");this._top=new qx.ui.container.Composite(new qx.ui.layout.HBox());this._add(this._top,{row:0,column:0,colSpan:2});this.__headerClipper=new qx.ui.table.pane.Clipper();this.__headerClipper.add(this.__header);this.__headerClipper.addListener("losecapture",this._onChangeCaptureHeader,this);this.__headerClipper.addListener("mousemove",this._onMousemoveHeader,this);this.__headerClipper.addListener("mousedown",this._onMousedownHeader,this);this.__headerClipper.addListener("mouseup",this._onMouseupHeader,this);this.__headerClipper.addListener("click",this._onClickHeader,this);this._top.add(this.__headerClipper,{flex:1});this.__paneClipper=new qx.ui.table.pane.Clipper();this.__paneClipper.add(this.__tablePane);this.__paneClipper.addListener("mousewheel",this._onMousewheel,this);this.__paneClipper.addListener("mousemove",this._onMousemovePane,this);this.__paneClipper.addListener("mousedown",this._onMousedownPane,this);this.__paneClipper.addListener("mouseup",this._onMouseupPane,this);this.__paneClipper.addListener("click",this._onClickPane,this);this.__paneClipper.addListener("contextmenu",this._onContextMenu,this);this.__paneClipper.addListener("dblclick",this._onDblclickPane,this);this.__paneClipper.addListener("resize",this._onResizePane,this);this._add(this.__paneClipper,{row:1,column:0});this.__focusIndicator=this._getChildControl("focus-indicator");this._getChildControl("resize-line");this._excludeChildControl("resize-line");this.addListener("mouseout",this._onMouseout,this);this.addListener("appear",this._onAppear,this);this.addListener("disappear",this._onDisappear,this);if(!this.__onintervalWrapper){this.__onintervalWrapper=qx.lang.Function.bind(this._oninterval,this);}this.initScrollTimeout();},statics:{MIN_COLUMN_WIDTH:10,RESIZE_REGION_RADIUS:5,CLICK_TOLERANCE:5,HORIZONTAL_SCROLLBAR:1,VERTICAL_SCROLLBAR:2},events:{"changeScrollY":"qx.event.type.ChangeEvent","changeScrollX":"qx.event.type.ChangeEvent","cellClick":"qx.ui.table.pane.CellEvent","cellDblclick":"qx.ui.table.pane.CellEvent","cellContextmenu":"qx.ui.table.pane.CellEvent"},properties:{horizontalScrollBarVisible:{check:"Boolean",init:true,apply:"_applyHorizontalScrollBarVisible",event:"changeHorizontalScrollBarVisible"},verticalScrollBarVisible:{check:"Boolean",init:true,apply:"_applyVerticalScrollBarVisible",event:"changeVerticalScrollBarVisible"},tablePaneModel:{check:"qx.ui.table.pane.Model",apply:"_applyTablePaneModel",event:"changeTablePaneModel"},liveResize:{check:"Boolean",init:false},focusCellOnMouseMove:{check:"Boolean",init:false},selectBeforeFocus:{check:"Boolean",init:false},showCellFocusIndicator:{check:"Boolean",init:true,apply:"_applyShowCellFocusIndicator"},scrollTimeout:{check:"Integer",init:100,apply:"_applyScrollTimeout"},appearance:{refine:true,init:"table-scroller"}},members:{__lastRowCount:null,__table:null,__updateInterval:null,__updateContentPlanned:null,__onintervalWrapper:null,__moveColumn:null,__lastMoveColPos:null,__lastMoveTargetX:null,__lastMoveTargetScroller:null,__lastMoveMousePageX:null,__resizeColumn:null,__lastResizeMousePageX:null,__lastResizeWidth:null,__lastMouseDownCell:null,__ignoreClick:null,__lastMousePageX:null,__lastMousePageY:null,__ignoreScrollYEvent:null,__focusedCol:null,__focusedRow:null,__cellEditor:null,__cellEditorFactory:null,__topRightWidget:null,__horScrollBar:null,__verScrollBar:null,__header:null,__headerClipper:null,__tablePane:null,__paneClipper:null,__focusIndicator:null,_createChildControlImpl:function(id){var control;switch(id){case "header":control=this.getTable().getNewTablePaneHeader()(this);break;case "pane":control=this.getTable().getNewTablePane()(this);break;case "focus-indicator":control=new qx.ui.table.pane.FocusIndicator(this);control.setUserBounds(0,0,0,0);control.setZIndex(1000);control.addListener("mouseup",this._onMouseupFocusIndicator,this);this.__paneClipper.add(control);control.exclude();break;case "resize-line":control=new qx.ui.core.Widget();control.setUserBounds(0,0,0,0);control.setZIndex(1000);this.__paneClipper.add(control);break;case "scrollbar-x":control=new qx.ui.core.ScrollBar("horizontal").set({minWidth:0,alignY:"bottom"});control.addListener("scroll",this._onScrollX,this);this._add(control,{row:2,column:0});break;case "scrollbar-y":control=new qx.ui.core.ScrollBar("vertical");control.addListener("scroll",this._onScrollY,this);this._add(control,{row:1,column:1});break;}return control||this.base(arguments,id);},_applyHorizontalScrollBarVisible:function(value,old){this.__horScrollBar.setVisibility(value?"visible":"excluded");if(!value){this.setScrollY(0,true);}},_applyVerticalScrollBarVisible:function(value,old){this.__verScrollBar.setVisibility(value?"visible":"excluded");if(!value){this.setScrollX(0);}},_applyTablePaneModel:function(value,old){if(old!=null){old.removeListener("modelChanged",this._onPaneModelChanged,this);}value.addListener("modelChanged",this._onPaneModelChanged,this);},_applyShowCellFocusIndicator:function(value,old){if(value){this._updateFocusIndicator();}else{if(this.__focusIndicator){this.__focusIndicator.hide();}}},getScrollY:function(){return this.__verScrollBar.getPosition();},setScrollY:function(scrollY,renderSync){this.__ignoreScrollYEvent=renderSync;this.__verScrollBar.scrollTo(scrollY);if(renderSync){this._updateContent();}this.__ignoreScrollYEvent=false;},getScrollX:function(){return this.__horScrollBar.getPosition();},setScrollX:function(scrollX){this.__horScrollBar.scrollTo(scrollX);},getTable:function(){return this.__table;},onColVisibilityChanged:function(){this.updateHorScrollBarMaximum();this._updateFocusIndicator();},setColumnWidth:function(col,width){this.__header.setColumnWidth(col,width);this.__tablePane.setColumnWidth(col,width);var paneModel=this.getTablePaneModel();var x=paneModel.getX(col);if(x!=-1){this.updateHorScrollBarMaximum();this._updateFocusIndicator();}},onColOrderChanged:function(){this.__header.onColOrderChanged();this.__tablePane.onColOrderChanged();this.updateHorScrollBarMaximum();},onTableModelDataChanged:function(firstRow,lastRow,firstColumn,lastColumn){this.__tablePane.onTableModelDataChanged(firstRow,lastRow,firstColumn,lastColumn);var rowCount=this.getTable().getTableModel().getRowCount();if(rowCount!=this.__lastRowCount){this.updateVerScrollBarMaximum();if(this.getFocusedRow()>=rowCount){if(rowCount==0){this.setFocusedCell(null,null);}else{this.setFocusedCell(this.getFocusedColumn(),rowCount-1);}}this.__lastRowCount=rowCount;}},onSelectionChanged:function(){this.__tablePane.onSelectionChanged();},onFocusChanged:function(){this.__tablePane.onFocusChanged();},onTableModelMetaDataChanged:function(){this.__header.onTableModelMetaDataChanged();this.__tablePane.onTableModelMetaDataChanged();},_onPaneModelChanged:function(){this.__header.onPaneModelChanged();this.__tablePane.onPaneModelChanged();},_onResizePane:function(){this.updateHorScrollBarMaximum();this.updateVerScrollBarMaximum();this._updateContent();this.__header._updateContent();},updateHorScrollBarMaximum:function(){var paneSize=this.__paneClipper.getInnerSize();if(!paneSize){return ;}var scrollSize=this.getTablePaneModel().getTotalWidth();var scrollBar=this.__horScrollBar;if(paneSize.width<scrollSize){var max=Math.max(0,scrollSize-paneSize.width);scrollBar.setMaximum(max);scrollBar.setKnobFactor(paneSize.width/scrollSize);var pos=scrollBar.getPosition();scrollBar.setPosition(Math.min(pos,max));}else{scrollBar.setMaximum(0);scrollBar.setKnobFactor(1);scrollBar.setPosition(0);}},updateVerScrollBarMaximum:function(){var paneSize=this.__paneClipper.getInnerSize();if(!paneSize){return ;}var rowCount=this.getTable().getTableModel().getRowCount();if(this.getTable().getKeepFirstVisibleRowComplete()){rowCount+=1;}var rowHeight=this.getTable().getRowHeight();var scrollSize=rowCount*rowHeight;var scrollBar=this.__verScrollBar;if(paneSize.height<scrollSize){var max=Math.max(0,scrollSize-paneSize.height);scrollBar.setMaximum(max);scrollBar.setKnobFactor(paneSize.height/scrollSize);var pos=scrollBar.getPosition();scrollBar.setPosition(Math.min(pos,max));}else{scrollBar.setMaximum(0);scrollBar.setKnobFactor(1);scrollBar.setPosition(0);}},onKeepFirstVisibleRowCompleteChanged:function(){this.updateVerScrollBarMaximum();this._updateContent();},_onAppear:function(){this._startInterval(this.getScrollTimeout());},_onDisappear:function(){this._stopInterval();},_onScrollX:function(e){var scrollLeft=e.getData();this.fireDataEvent("changeScrollX",scrollLeft,e.getOldData());this.__headerClipper.scrollToX(scrollLeft);this.__paneClipper.scrollToX(scrollLeft);},_onScrollY:function(e){this.fireDataEvent("changeScrollY",e.getData(),e.getOldData());this._postponedUpdateContent();},_onMousewheel:function(e){var table=this.getTable();if(!table.getEnabled()){return;}this.__verScrollBar.scrollTo(this.__verScrollBar.getPosition()+((e.getWheelDelta()*3)*table.getRowHeight()));if(this.__lastMousePageX&&this.getFocusCellOnMouseMove()){this._focusCellAtPagePos(this.__lastMousePageX,this.__lastMousePageY);}},__handleResizeColumn:function(pageX){var table=this.getTable();var headerCell=this.__header.getHeaderWidgetAtColumn(this.__resizeColumn);var minColumnWidth=headerCell.getSizeHint().minWidth;var newWidth=Math.max(minColumnWidth,this.__lastResizeWidth+pageX-this.__lastResizeMousePageX);if(this.getLiveResize()){var columnModel=table.getTableColumnModel();columnModel.setColumnWidth(this.__resizeColumn,newWidth);}else{this.__header.setColumnWidth(this.__resizeColumn,newWidth);var paneModel=this.getTablePaneModel();this._showResizeLine(paneModel.getColumnLeft(this.__resizeColumn)+newWidth);}this.__lastResizeMousePageX+=newWidth-this.__lastResizeWidth;this.__lastResizeWidth=newWidth;},__handleMoveColumn:function(pageX){var clickTolerance=qx.ui.table.pane.Scroller.CLICK_TOLERANCE;if(this.__header.isShowingColumnMoveFeedback()||pageX>this.__lastMoveMousePageX+clickTolerance||pageX<this.__lastMoveMousePageX-clickTolerance){this.__lastMoveColPos+=pageX-this.__lastMoveMousePageX;this.__header.showColumnMoveFeedback(this.__moveColumn,this.__lastMoveColPos);var targetScroller=this.__table.getTablePaneScrollerAtPageX(pageX);if(this.__lastMoveTargetScroller&&this.__lastMoveTargetScroller!=targetScroller){this.__lastMoveTargetScroller.hideColumnMoveFeedback();}if(targetScroller!=null){this.__lastMoveTargetX=targetScroller.showColumnMoveFeedback(pageX);}else{this.__lastMoveTargetX=null;}this.__lastMoveTargetScroller=targetScroller;this.__lastMoveMousePageX=pageX;}},_onMousemoveHeader:function(e){var table=this.getTable();if(!table.getEnabled()){return;}var useResizeCursor=false;var mouseOverColumn=null;var pageX=e.getDocumentLeft();var pageY=e.getDocumentTop();this.__lastMousePageX=pageX;this.__lastMousePageY=pageY;if(this.__resizeColumn!=null){this.__handleResizeColumn(pageX);useResizeCursor=true;}else if(this.__moveColumn!=null){this.__handleMoveColumn(pageX);}else{var resizeCol=this._getResizeColumnForPageX(pageX);if(resizeCol!=-1){useResizeCursor=true;}else{var tableModel=table.getTableModel();var col=this._getColumnForPageX(pageX);if(col!=null&&tableModel.isColumnSortable(col)){mouseOverColumn=col;}}}var cursor=useResizeCursor?"ew-resize":null;this.getApplicationRoot().setGlobalCursor(cursor);this.setCursor(cursor);this.__header.setMouseOverColumn(mouseOverColumn);},_onMousemovePane:function(e){var table=this.getTable();if(!table.getEnabled()){return;}var pageX=e.getDocumentLeft();var pageY=e.getDocumentTop();this.__lastMousePageX=pageX;this.__lastMousePageY=pageY;var row=this._getRowForPagePos(pageX,pageY);if(row!=null&&this._getColumnForPageX(pageX)!=null){if(this.getFocusCellOnMouseMove()){this._focusCellAtPagePos(pageX,pageY);}}this.__header.setMouseOverColumn(null);},_onMousedownHeader:function(e){if(!this.getTable().getEnabled()){return;}var pageX=e.getDocumentLeft();var resizeCol=this._getResizeColumnForPageX(pageX);if(resizeCol!=-1){this._startResizeHeader(resizeCol,pageX);}else{var moveCol=this._getColumnForPageX(pageX);if(moveCol!=null){this._startMoveHeader(moveCol,pageX);}}},_startResizeHeader:function(resizeCol,pageX){var columnModel=this.getTable().getTableColumnModel();this.__resizeColumn=resizeCol;this.__lastResizeMousePageX=pageX;this.__lastResizeWidth=columnModel.getColumnWidth(this.__resizeColumn);this.__headerClipper.capture();},_startMoveHeader:function(moveCol,pageX){this.__moveColumn=moveCol;this.__lastMoveMousePageX=pageX;this.__lastMoveColPos=this.getTablePaneModel().getColumnLeft(moveCol);this.__headerClipper.capture();},_onMousedownPane:function(e){var table=this.getTable();if(!table.getEnabled()){return;}if(this.isEditing()){this.stopEditing();}var pageX=e.getDocumentLeft();var pageY=e.getDocumentTop();var row=this._getRowForPagePos(pageX,pageY);var col=this._getColumnForPageX(pageX);if(row!==null){this.__lastMouseDownCell={row:row,col:col};var selectBeforeFocus=this.getSelectBeforeFocus();if(selectBeforeFocus){table.getSelectionManager().handleMouseDown(row,e);}if(!this.getFocusCellOnMouseMove()){this._focusCellAtPagePos(pageX,pageY);}if(!selectBeforeFocus){table.getSelectionManager().handleMouseDown(row,e);}}},_onMouseupFocusIndicator:function(e){if(this.__lastMouseDownCell&&this.__focusIndicator.getRow()==this.__lastMouseDownCell.row&&this.__focusIndicator.getColumn()==this.__lastMouseDownCell.col){this.__lastMouseDownCell={};this.fireEvent("cellClick",qx.ui.table.pane.CellEvent,[this,e,this.__lastMouseDownCell.row,this.__lastMouseDownCell.col],true);}},_onChangeCaptureHeader:function(e){if(this.__resizeColumn!=null&&e.getData()==false){this._stopResizeHeader();}if(this.__moveColumn!=null&&e.getData()==false){this._stopMoveHeader();}},_stopResizeHeader:function(){var columnModel=this.getTable().getTableColumnModel();if(!this.getLiveResize()){this._hideResizeLine();columnModel.setColumnWidth(this.__resizeColumn,this.__lastResizeWidth);}this.__resizeColumn=null;this.__headerClipper.releaseCapture();this.getApplicationRoot().setGlobalCursor(null);this.setCursor(null);},_stopMoveHeader:function(){var columnModel=this.getTable().getTableColumnModel();var paneModel=this.getTablePaneModel();this.__header.hideColumnMoveFeedback();if(this.__lastMoveTargetScroller){this.__lastMoveTargetScroller.hideColumnMoveFeedback();}if(this.__lastMoveTargetX!=null){var fromVisXPos=paneModel.getFirstColumnX()+paneModel.getX(this.__moveColumn);var toVisXPos=this.__lastMoveTargetX;if(toVisXPos!=fromVisXPos&&toVisXPos!=fromVisXPos+1){var fromCol=columnModel.getVisibleColumnAtX(fromVisXPos);var toCol=columnModel.getVisibleColumnAtX(toVisXPos);var fromOverXPos=columnModel.getOverallX(fromCol);var toOverXPos=(toCol!=null)?columnModel.getOverallX(toCol):columnModel.getOverallColumnCount();if(toOverXPos>fromOverXPos){toOverXPos--;}columnModel.moveColumn(fromOverXPos,toOverXPos);}}this.__moveColumn=null;this.__lastMoveTargetX=null;this.__headerClipper.releaseCapture();},_onMouseupPane:function(e){var table=this.getTable();if(!table.getEnabled()){return;}var row=this._getRowForPagePos(e.getDocumentLeft(),e.getDocumentTop());if(row!=-1&&row!=null&&this._getColumnForPageX(e.getDocumentLeft())!=null){table.getSelectionManager().handleMouseUp(row,e);}},_onMouseupHeader:function(e){var table=this.getTable();if(!table.getEnabled()){return;}if(this.__resizeColumn!=null){this._stopResizeHeader();this.__ignoreClick=true;}else if(this.__moveColumn!=null){this._stopMoveHeader();}},_onClickHeader:function(e){if(this.__ignoreClick){this.__ignoreClick=false;return;}var table=this.getTable();if(!table.getEnabled()){return;}var tableModel=table.getTableModel();var pageX=e.getDocumentLeft();var resizeCol=this._getResizeColumnForPageX(pageX);if(resizeCol==-1){var col=this._getColumnForPageX(pageX);if(col!=null&&tableModel.isColumnSortable(col)){var sortCol=tableModel.getSortColumnIndex();var ascending=(col!=sortCol)?true:!tableModel.isSortAscending();tableModel.sortByColumn(col,ascending);table.getSelectionModel().clearSelection();}}},_onClickPane:function(e){var table=this.getTable();if(!table.getEnabled()){return;}var pageX=e.getDocumentLeft();var pageY=e.getDocumentTop();var row=this._getRowForPagePos(pageX,pageY);var col=this._getColumnForPageX(pageX);if(row!=null&&col!=null){table.getSelectionManager().handleClick(row,e);if(this.__lastMouseDownCell&&row==this.__lastMouseDownCell.row&&col==this.__lastMouseDownCell.col){this.__lastMouseDownCell={};this.fireEvent("cellClick",qx.ui.table.pane.CellEvent,[this,e,row,col],true);}}},_onContextMenu:function(e){var pageX=e.getDocumentLeft();var pageY=e.getDocumentTop();var row=this._getRowForPagePos(pageX,pageY);var col=this._getColumnForPageX(pageX);if(this.__lastMouseDownCell&&row==this.__lastMouseDownCell.row&&col==this.__lastMouseDownCell.col){this.__lastMouseDownCell={};this.fireEvent("cellContextmenu",qx.ui.table.pane.CellEvent,[this,e,row,col],true);}},_onDblclickPane:function(e){var pageX=e.getDocumentLeft();var pageY=e.getDocumentTop();this._focusCellAtPagePos(pageX,pageY);this.startEditing();var row=this._getRowForPagePos(pageX,pageY);if(row!=-1&&row!=null){this.fireEvent("cellDblclick",qx.ui.table.pane.CellEvent,[this,e,row],true);}},_onMouseout:function(e){var table=this.getTable();if(!table.getEnabled()){return;}if(this.__resizeColumn==null){this.setCursor(null);this.getApplicationRoot().setGlobalCursor(null);}this.__header.setMouseOverColumn(null);},_showResizeLine:function(x){var resizeLine=this._showChildControl("resize-line");var width=resizeLine.getWidth();var paneBounds=this.__paneClipper.getBounds();resizeLine.setUserBounds(x-Math.round(width/2),0,width,paneBounds.height);},_hideResizeLine:function(){this._excludeChildControl("resize-line");},showColumnMoveFeedback:function(pageX){var paneModel=this.getTablePaneModel();var columnModel=this.getTable().getTableColumnModel();var paneLeft=this.__tablePane.getContainerLocation().left;var colCount=paneModel.getColumnCount();var targetXPos=0;var targetX=0;var currX=paneLeft;for(var xPos=0;xPos<colCount;xPos++){var col=paneModel.getColumnAtX(xPos);var colWidth=columnModel.getColumnWidth(col);if(pageX<currX+colWidth/2){break;}currX+=colWidth;targetXPos=xPos+1;targetX=currX-paneLeft;}var scrollerLeft=this.__paneClipper.getContainerLocation().left;var scrollerWidth=this.__paneClipper.getBounds().width;var scrollX=scrollerLeft-paneLeft;targetX=qx.lang.Number.limit(targetX,scrollX+2,scrollX+scrollerWidth-1);this._showResizeLine(targetX);return paneModel.getFirstColumnX()+targetXPos;},hideColumnMoveFeedback:function(){this._hideResizeLine();},_focusCellAtPagePos:function(pageX,pageY){var row=this._getRowForPagePos(pageX,pageY);if(row!=-1&&row!=null){var col=this._getColumnForPageX(pageX);this.__table.setFocusedCell(col,row);}},setFocusedCell:function(col,row){if(!this.isEditing()){this.__tablePane.setFocusedCell(col,row,this.__updateContentPlanned);this.__focusedCol=col;this.__focusedRow=row;this._updateFocusIndicator();}},getFocusedColumn:function(){return this.__focusedCol;},getFocusedRow:function(){return this.__focusedRow;},scrollCellVisible:function(col,row){var paneModel=this.getTablePaneModel();var xPos=paneModel.getX(col);if(xPos!=-1){var clipperSize=this.__paneClipper.getInnerSize();if(!clipperSize){return;}var columnModel=this.getTable().getTableColumnModel();var colLeft=paneModel.getColumnLeft(col);var colWidth=columnModel.getColumnWidth(col);var rowHeight=this.getTable().getRowHeight();var rowTop=row*rowHeight;var scrollX=this.getScrollX();var scrollY=this.getScrollY();var minScrollX=Math.min(colLeft,colLeft+colWidth-clipperSize.width);var maxScrollX=colLeft;this.setScrollX(Math.max(minScrollX,Math.min(maxScrollX,scrollX)));var minScrollY=rowTop+rowHeight-clipperSize.height;if(this.getTable().getKeepFirstVisibleRowComplete()){minScrollY+=rowHeight;}var maxScrollY=rowTop;this.setScrollY(Math.max(minScrollY,Math.min(maxScrollY,scrollY)),true);}},isEditing:function(){return this.__cellEditor!=null;},startEditing:function(){var table=this.getTable();var tableModel=table.getTableModel();var col=this.__focusedCol;if(!this.isEditing()&&(col!=null)&&tableModel.isColumnEditable(col)){var row=this.__focusedRow;var xPos=this.getTablePaneModel().getX(col);var value=tableModel.getValue(col,row);this.__cellEditorFactory=table.getTableColumnModel().getCellEditorFactory(col);var cellInfo={col:col,row:row,xPos:xPos,value:value,table:table};this.__cellEditor=this.__cellEditorFactory.createCellEditor(cellInfo);if(this.__cellEditor===null){return false;}else if(this.__cellEditor instanceof qx.ui.window.Window){this.__cellEditor.setModal(true);this.__cellEditor.setShowClose(false);this.__cellEditor.addListener("close",this._onCellEditorModalWindowClose,this);var f=table.getModalCellEditorPreOpenFunction();if(f!=null){f(this.__cellEditor,cellInfo);}this.__cellEditor.open();}else{var size=this.__focusIndicator.getInnerSize();this.__cellEditor.setUserBounds(0,0,size.width,size.height);this.__focusIndicator.addListener("mousedown",function(e){e.stopPropagation();});this.__focusIndicator.add(this.__cellEditor);this.__focusIndicator.addState("editing");this.__focusIndicator.setKeepActive(false);this.__cellEditor.focus();this.__cellEditor.activate();}return true;}return false;},stopEditing:function(){this.flushEditor();this.cancelEditing();},flushEditor:function(){if(this.isEditing()){var value=this.__cellEditorFactory.getCellEditorValue(this.__cellEditor);this.getTable().getTableModel().setValue(this.__focusedCol,this.__focusedRow,value);this.__table.focus();}},cancelEditing:function(){if(this.isEditing()&&!this.__cellEditor.pendingDispose){if(this._cellEditorIsModalWindow){this.__cellEditor.destroy();this.__cellEditor=null;this.__cellEditorFactory=null;this.__cellEditor.pendingDispose=true;}else{this.__focusIndicator.removeState("editing");this.__focusIndicator.setKeepActive(true);this.__cellEditor.destroy();this.__cellEditor=null;this.__cellEditorFactory=null;}}},_onCellEditorModalWindowClose:function(e){this.stopEditing();},_getColumnForPageX:function(pageX){var columnModel=this.getTable().getTableColumnModel();var paneModel=this.getTablePaneModel();var colCount=paneModel.getColumnCount();var currX=this.__header.getContainerLocation().left;for(var x=0;x<colCount;x++){var col=paneModel.getColumnAtX(x);var colWidth=columnModel.getColumnWidth(col);currX+=colWidth;if(pageX<currX){return col;}}return null;},_getResizeColumnForPageX:function(pageX){var columnModel=this.getTable().getTableColumnModel();var paneModel=this.getTablePaneModel();var colCount=paneModel.getColumnCount();var currX=this.__header.getContainerLocation().left;var regionRadius=qx.ui.table.pane.Scroller.RESIZE_REGION_RADIUS;for(var x=0;x<colCount;x++){var col=paneModel.getColumnAtX(x);var colWidth=columnModel.getColumnWidth(col);currX+=colWidth;if(pageX>=(currX-regionRadius)&&pageX<=(currX+regionRadius)){return col;}}return -1;},_getRowForPagePos:function(pageX,pageY){var panePos=this.__tablePane.getContentLocation();if(pageX<panePos.left||pageX>panePos.right){return null;}if(pageY>=panePos.top&&pageY<=panePos.bottom){var rowHeight=this.getTable().getRowHeight();var scrollY=this.__verScrollBar.getPosition();if(this.getTable().getKeepFirstVisibleRowComplete()){scrollY=Math.floor(scrollY/rowHeight)*rowHeight;}var tableY=scrollY+pageY-panePos.top;var row=Math.floor(tableY/rowHeight);var rowCount=this.getTable().getTableModel().getRowCount();return (row<rowCount)?row:null;}var headerPos=this.__header.getContainerLocation();if(pageY>=headerPos.top&&pageY<=headerPos.bottom&&pageX<=headerPos.right){return -1;}return null;},setTopRightWidget:function(widget){var oldWidget=this.__topRightWidget;if(oldWidget!=null){this._top.remove(oldWidget);}if(widget!=null){this._top.add(widget);}this.__topRightWidget=widget;},getTopRightWidget:function(){return this.__topRightWidget;},getHeader:function(){return this.__header;},getTablePane:function(){return this.__tablePane;},getVerticalScrollBarWidth:function(){var scrollBar=this.__verScrollBar;return scrollBar.isVisible()?(scrollBar.getSizeHint().width||0):0;},getNeededScrollBars:function(forceHorizontal,preventVertical){var barWidth=this.__verScrollBar.getSizeHint().width;var clipperSize=this.__paneClipper.getInnerSize();var viewWidth=clipperSize.width;if(this.getVerticalScrollBarVisible()){viewWidth+=barWidth;}var viewHeight=clipperSize.height;if(this.getHorizontalScrollBarVisible()){viewHeight+=barWidth;}var paneWidth=this.getTablePaneModel().getTotalWidth();var paneHeight=this.getTable().getRowHeight()*this.getTable().getTableModel().getRowCount();var horNeeded=false;var verNeeded=false;if(paneWidth>viewWidth){horNeeded=true;if(paneHeight>viewHeight-barWidth){verNeeded=true;}}else if(paneHeight>viewHeight){verNeeded=true;if(!preventVertical&&(paneWidth>viewWidth-barWidth)){horNeeded=true;}}var horBar=qx.ui.table.pane.Scroller.HORIZONTAL_SCROLLBAR;var verBar=qx.ui.table.pane.Scroller.VERTICAL_SCROLLBAR;return ((forceHorizontal||horNeeded)?horBar:0)|((preventVertical||!verNeeded)?0:verBar);},_applyScrollTimeout:function(value,old){this._startInterval(value);},_startInterval:function(timeout){this._stopInterval();if(timeout){this.__updateInterval=window.setInterval(this.__onintervalWrapper,timeout);}},_stopInterval:function(){if(this.__updateInterval){window.clearInterval(this.__updateInterval);this.__updateInterval=null;}},_postponedUpdateContent:function(){this._updateContent();},_oninterval:function(){if(this.__updateContentPlanned&&!this.__tablePane._layoutPending){this.__updateContentPlanned=false;this._updateContent();}},_updateContent:function(){var paneSize=this.__paneClipper.getInnerSize();if(!paneSize){return;}var paneHeight=paneSize.height;var scrollX=this.__horScrollBar.getPosition();var scrollY=this.__verScrollBar.getPosition();var rowHeight=this.getTable().getRowHeight();var firstRow=Math.floor(scrollY/rowHeight);var oldFirstRow=this.__tablePane.getFirstVisibleRow();this.__tablePane.setFirstVisibleRow(firstRow);var visibleRowCount=Math.ceil(paneHeight/rowHeight);var paneOffset=0;var firstVisibleRowComplete=this.getTable().getKeepFirstVisibleRowComplete();if(!firstVisibleRowComplete){visibleRowCount++;paneOffset=scrollY%rowHeight;}this.__tablePane.setVisibleRowCount(visibleRowCount);if(firstRow!=oldFirstRow){this._updateFocusIndicator();}this.__paneClipper.scrollToX(scrollX);if(!firstVisibleRowComplete){this.__paneClipper.scrollToY(paneOffset);}},_updateFocusIndicator:function(){if(!this.getShowCellFocusIndicator()){return;}var table=this.getTable();if(!table.getEnabled()){return;}this.__focusIndicator.moveToCell(this.__focusedCol,this.__focusedRow);}},destruct:function(){this._stopInterval();var tablePaneModel=this.getTablePaneModel();if(tablePaneModel){tablePaneModel.dispose();}this._disposeFields("__lastMouseDownCell");this._disposeObjects("__table","__horScrollBar","__verScrollBar","__headerClipper","__paneClipper","__focusIndicator","__header","__tablePane","_top","__topRightWidget");}});qx.Class.define("qx.ui.table.pane.Clipper",{extend:qx.ui.container.Composite,construct:function(){this.base(arguments,new qx.ui.layout.Grow());},members:{scrollToX:function(value){this.getContentElement().scrollToX(value,false);},scrollToY:function(value){this.getContentElement().scrollToY(value,true);}}});qx.Class.define("qx.ui.table.pane.FocusIndicator",{extend:qx.ui.container.Composite,construct:function(scroller){this.base(arguments);this.__scroller=scroller;this.setKeepActive(true);this.addListener("keypress",this._onKeyPress,this);},properties:{visibility:{refine:true,init:"excluded"},row:{check:"Integer",nullable:true},column:{check:"Integer",nullable:true}},members:{__scroller:null,_onKeyPress:function(e){var iden=e.getKeyIdentifier();if(iden!=="Escape"&&iden!=="Enter"){e.stopPropagation();}},moveToCell:function(col,row){if(col==null){this.hide();this.setRow(null);this.setColumn(null);}else{var xPos=this.__scroller.getTablePaneModel().getX(col);if(xPos==-1){this.hide();this.setRow(null);this.setColumn(null);}else{var table=this.__scroller.getTable();var columnModel=table.getTableColumnModel();var paneModel=this.__scroller.getTablePaneModel();var firstRow=this.__scroller.getTablePane().getFirstVisibleRow();var rowHeight=table.getRowHeight();this.setUserBounds(paneModel.getColumnLeft(col)-2,(row-firstRow)*rowHeight-2,columnModel.getColumnWidth(col)+3,rowHeight+3);this.show();this.setRow(row);this.setColumn(col);}}}},destruct:function(){this._disposeFields("__scroller");}});qx.Class.define("qx.ui.core.ScrollBar",{extend:qx.ui.core.Widget,construct:function(orientation){this.base(arguments);this._createChildControl("button-begin");this._createChildControl("slider");this._createChildControl("button-end");if(orientation!=null){this.setOrientation(orientation);}else{this.initOrientation();}},properties:{appearance:{refine:true,init:"scrollbar"},orientation:{check:["horizontal","vertical"],init:"horizontal",apply:"_applyOrientation"},maximum:{check:"PositiveInteger",apply:"_applyMaximum",init:100},position:{check:"typeof value==='number'&&value>=0&&value<=this.getMaximum()",init:0,apply:"_applyPosition",event:"scroll"},singleStep:{check:"Integer",init:20},pageStep:{check:"Integer",init:10,apply:"_applyPageStep"},knobFactor:{check:"PositiveNumber",apply:"_applyKnobFactor",nullable:true}},members:{_createChildControlImpl:function(id){var control;switch(id){case "slider":control=new qx.ui.core.ScrollSlider;control.setPageStep(100);control.setFocusable(false);control.addListener("changeValue",this._onChangeSliderValue,this);this._add(control,{flex:1});break;case "button-begin":control=new qx.ui.form.RepeatButton;control.setFocusable(false);control.addListener("execute",this._onExecuteBegin,this);this._add(control);break;case "button-end":control=new qx.ui.form.RepeatButton;control.setFocusable(false);control.addListener("execute",this._onExecuteEnd,this);this._add(control);break;}return control||this.base(arguments,id);},_applyMaximum:function(value){this._getChildControl("slider").setMaximum(value);},_applyPosition:function(value){this._getChildControl("slider").setValue(value);},_applyKnobFactor:function(value){this._getChildControl("slider").setKnobFactor(value);},_applyPageStep:function(value){this._getChildControl("slider").setPageStep(value);},_applyOrientation:function(value,old){var oldLayout=this._getLayout();if(oldLayout){oldLayout.dispose();}if(value==="horizontal"){this._setLayout(new qx.ui.layout.HBox());this.setAllowStretchX(true);this.setAllowStretchY(false);this.replaceState("vertical","horizontal");this._getChildControl("button-begin").replaceState("up","left");this._getChildControl("button-end").replaceState("down","right");}else{this._setLayout(new qx.ui.layout.VBox());this.setAllowStretchX(false);this.setAllowStretchY(true);this.replaceState("horizontal","vertical");this._getChildControl("button-begin").replaceState("left","up");this._getChildControl("button-end").replaceState("right","down");}this._getChildControl("slider").setOrientation(value);},scrollTo:function(position){this._getChildControl("slider").slideTo(position);},scrollBy:function(offset){this._getChildControl("slider").slideBy(offset);},scrollBySteps:function(steps){var size=this.getSingleStep();this._getChildControl("slider").slideBy(steps*size);},_onExecuteBegin:function(e){this.scrollBy(-this.getSingleStep());},_onExecuteEnd:function(e){this.scrollBy(this.getSingleStep());},_onChangeSliderValue:function(e){this.setPosition(e.getData());}}});qx.Class.define("qx.ui.form.Slider",{extend:qx.ui.core.Widget,implement:qx.ui.form.IFormElement,construct:function(orientation){this.base(arguments);this._setLayout(new qx.ui.layout.Canvas());this.addListener("keypress",this._onKeyPress);this.addListener("mousewheel",this._onMouseWheel);this.addListener("mousedown",this._onMouseDown);this.addListener("mouseup",this._onMouseUp);this.addListener("losecapture",this._onMouseUp);this.addListener("resize",this._onUpdate);this.addListener("contextmenu",this._onStopEvent);this.addListener("click",this._onStopEvent);this.addListener("dblclick",this._onStopEvent);if(orientation!=null){this.setOrientation(orientation);}else{this.initOrientation();}},properties:{appearance:{refine:true,init:"slider"},focusable:{refine:true,init:true},orientation:{check:["horizontal","vertical"],init:"horizontal",apply:"_applyOrientation"},name:{check:"String",nullable:true,event:"changeName"},value:{check:"typeof value==='number'&&value>=this.getMinimum()&&value<=this.getMaximum()",init:0,apply:"_applyValue",event:"changeValue"},minimum:{check:"Integer",init:0,apply:"_applyMinimum"},maximum:{check:"Integer",init:100,apply:"_applyMaximum"},singleStep:{check:"Integer",init:1},pageStep:{check:"Integer",init:10},knobFactor:{check:"Number",apply:"_applyKnobFactor",nullable:true}},members:{__sliderLocation:null,__knobLocation:null,__knobSize:null,__dragMode:null,__dragOffset:null,__trackingMode:null,__trackingDirection:null,__trackingEnd:null,__timer:null,_createChildControlImpl:function(id){var control;switch(id){case "knob":control=new qx.ui.core.Widget();control.addListener("resize",this._onUpdate,this);this._add(control);break;}return control||this.base(arguments,id);},_onMouseWheel:function(e){var direction=e.getWheelDelta()>0?1:-1;this.slideBy(direction*this.getSingleStep());e.stop();},_onKeyPress:function(e){var isHorizontal=this.getOrientation()==="horizontal";var backward=isHorizontal?"Left":"Up";var forward=isHorizontal?"Right":"Down";switch(e.getKeyIdentifier()){case forward:this.slideForward();break;case backward:this.slideBack();break;case "PageDown":this.slidePageForward();break;case "PageUp":this.slidePageBack();break;case "Home":this.slideToBegin();break;case "End":this.slideToEnd();break;default:return;}e.stop();},_onMouseDown:function(e){var isHorizontal=this.__isHorizontal;var knob=this._getChildControl("knob");var locationProperty=isHorizontal?"left":"top";var cursorLocation=isHorizontal?e.getDocumentLeft():e.getDocumentTop();var sliderLocation=this.__sliderLocation=qx.bom.element.Location.get(this.getContentElement().getDomElement())[locationProperty];var knobLocation=this.__knobLocation=qx.bom.element.Location.get(knob.getContainerElement().getDomElement())[locationProperty];if(e.getTarget()===knob){this.__dragMode=true;this.__dragOffset=cursorLocation+sliderLocation-knobLocation;}else{this.__trackingMode=true;this.__trackingDirection=cursorLocation<=knobLocation?-1:1;this.__computeTrackingEnd(e);this._onInterval();if(!this.__timer){this.__timer=new qx.event.Timer(100);this.__timer.addListener("interval",this._onInterval,this);}this.__timer.start();}this.addListener("mousemove",this._onMouseMove);this.capture();e.stopPropagation();},_onMouseUp:function(e){if(this.__dragMode){this.releaseCapture();delete this.__dragMode;delete this.__dragOffset;}else if(this.__trackingMode){this.__timer.stop();this.releaseCapture();delete this.__trackingMode;delete this.__trackingDirection;delete this.__trackingEnd;}this.removeListener("mousemove",this._onMouseMove);if(e.getType()==="mouseup"){e.stopPropagation();}},_onMouseMove:function(e){if(this.__dragMode){var dragStop=this.__isHorizontal?e.getDocumentLeft():e.getDocumentTop();var position=dragStop-this.__dragOffset;this.slideTo(this._positionToValue(position));}else if(this.__trackingMode){this.__computeTrackingEnd(e);}e.stopPropagation();},_onInterval:function(e){var value=this.getValue()+(this.__trackingDirection*this.getPageStep());if(value<this.getMinimum()){value=this.getMinimum();}else if(value>this.getMaximum()){value=this.getMaximum();}var slideBack=this.__trackingDirection==-1;if((slideBack&&value<=this.__trackingEnd)||(!slideBack&&value>=this.__trackingEnd)){value=this.__trackingEnd;}this.slideTo(value);},_onUpdate:function(e){var availSize=this.getInnerSize();var knobSize=this._getChildControl("knob").getBounds();var sizeProperty=this.__isHorizontal?"width":"height";this._updateKnobSize();this.__slidingSpace=availSize[sizeProperty]-knobSize[sizeProperty];this.__knobSize=knobSize[sizeProperty];this._updateKnobPosition();},__isHorizontal:false,__slidingSpace:0,__computeTrackingEnd:function(e){var isHorizontal=this.__isHorizontal;var cursorLocation=isHorizontal?e.getDocumentLeft():e.getDocumentTop();var sliderLocation=this.__sliderLocation;var knobLocation=this.__knobLocation;var knobSize=this.__knobSize;var position=cursorLocation-sliderLocation;if(cursorLocation>=knobLocation){position-=knobSize;}var value=this._positionToValue(position);var min=this.getMinimum();var max=this.getMaximum();if(value<min){value=min;}else if(value>max){value=max;}else{var old=this.getValue();var step=this.getPageStep();var method=this.__trackingDirection<0?"floor":"ceil";value=old+(Math[method]((value-old)/step)*step);}if(this.__trackingEnd==null||(this.__trackingDirection==-1&&value<=this.__trackingEnd)||(this.__trackingDirection==1&&value>=this.__trackingEnd)){this.__trackingEnd=value;}},_positionToValue:function(position){var avail=this.__slidingSpace;if(avail==null||avail==0){return 0;}var percent=position/avail;if(percent<0){percent=0;}else if(percent>1){percent=1;}var range=this.getMaximum()-this.getMinimum();return this.getMinimum()+Math.round(range*percent);},_valueToPosition:function(value){var avail=this.__slidingSpace;if(avail==null){return 0;}var range=this.getMaximum()-this.getMinimum();if(range==0){return 0;}var value=value-this.getMinimum();var percent=value/range;if(percent<0){percent=0;}else if(percent>1){percent=1;}return Math.round(avail*percent);},_updateKnobPosition:function(){this._setKnobPosition(this._valueToPosition(this.getValue()));},_setKnobPosition:function(position){var container=this._getChildControl("knob").getContainerElement();if(this.__isHorizontal){container.setStyle("left",position+"px",true);}else{container.setStyle("top",position+"px",true);}},_updateKnobSize:function(){var knobFactor=this.getKnobFactor();if(knobFactor==null){return;}var avail=this.getInnerSize();if(avail==null){return;}if(this.__isHorizontal){this._getChildControl("knob").setWidth(Math.round(knobFactor*avail.width));}else{this._getChildControl("knob").setHeight(Math.round(knobFactor*avail.height));}},slideToBegin:function(){this.slideTo(this.getMinimum());},slideToEnd:function(){this.slideTo(this.getMaximum());},slideForward:function(){this.slideBy(this.getSingleStep());},slideBack:function(){this.slideBy(-this.getSingleStep());},slidePageForward:function(){this.slideBy(this.getPageStep());},slidePageBack:function(){this.slideBy(-this.getPageStep());},slideBy:function(offset){this.slideTo(this.getValue()+offset);},slideTo:function(value){if(value<this.getMinimum()){value=this.getMinimum();}else if(value>this.getMaximum()){value=this.getMaximum();}else{value=this.getMinimum()+Math.round((value-this.getMinimum())/this.getSingleStep())*this.getSingleStep();}this.setValue(value);},_applyOrientation:function(value,old){var knob=this._getChildControl("knob");this.__isHorizontal=value==="horizontal";if(this.__isHorizontal){this.removeState("vertical");knob.removeState("vertical");this.addState("horizontal");knob.addState("horizontal");knob.setLayoutProperties({top:0,right:null,bottom:0});}else{this.removeState("horizontal");knob.removeState("horizontal");this.addState("vertical");knob.addState("vertical");knob.setLayoutProperties({right:0,bottom:null,left:0});}this._updateKnobPosition();},_applyKnobFactor:function(value,old){if(value!=null){this._updateKnobSize();}else{if(this.__isHorizontal){this._getChildControl("knob").resetWidth();}else{this._getChildControl("knob").resetHeight();}}},_applyValue:function(value,old){this._updateKnobPosition();},_applyMinimum:function(value,old){if(this.getValue()<value){this.setValue(value);}this._updateKnobPosition();},_applyMaximum:function(value,old){if(this.getValue()>value){this.setValue(value);}this._updateKnobPosition();}}});qx.Class.define("qx.ui.core.ScrollSlider",{extend:qx.ui.form.Slider,construct:function(orientation){this.base(arguments,orientation);this.removeListener("keypress",this._onKeyPress);this.removeListener("mousewheel",this._onMouseWheel);}});qx.Mixin.define("qx.ui.core.MExecutable",{events:{"execute":"qx.event.type.Event"},properties:{command:{check:"qx.event.Command",apply:"_applyCommand",event:"changeCommand",nullable:true}},members:{execute:function(){var cmd=this.getCommand();if(cmd){cmd.execute(this);}this.fireEvent("execute");},_applyCommand:function(value,old){if(old){old.removeListener("changeEnabled",this._onChangeEnabledCommand,this);}if(value){value.addListener("changeEnabled",this._onChangeEnabledCommand,this);if(this.getEnabled()===false){value.setEnabled(false);}else if(value.getEnabled()===false){this.setEnabled(false);}}},_onChangeEnabledCommand:function(e){this.setEnabled(e.getData());}}});qx.Class.define("qx.ui.form.Button",{extend:qx.ui.basic.Atom,include:qx.ui.core.MExecutable,implement:qx.ui.form.IFormElement,construct:function(label,icon,command){this.base(arguments,label,icon);if(command!=null){this.setCommand(command);}this.addListener("mouseover",this._onMouseOver);this.addListener("mouseout",this._onMouseOut);this.addListener("mousedown",this._onMouseDown);this.addListener("mouseup",this._onMouseUp);this.addListener("keydown",this._onKeyDown);this.addListener("keyup",this._onKeyUp);this.addListener("dblclick",this._onStopEvent);},properties:{name:{check:"String",nullable:true,event:"changeName"},value:{check:"String",nullable:true,event:"changeValue"},appearance:{refine:true,init:"button"},focusable:{refine:true,init:true}},members:{press:function(){if(this.hasState("abandoned")){return;}this.addState("pressed");},release:function(){if(this.hasState("pressed")){this.removeState("pressed");}},reset:function(){this.removeState("pressed");this.removeState("abandoned");this.removeState("hovered");},_onMouseOver:function(e){if(!this.isEnabled()||e.getTarget()!==this){return;}if(this.hasState("abandoned")){this.removeState("abandoned");this.addState("pressed");}this.addState("hovered");},_onMouseOut:function(e){if(!this.isEnabled()||e.getTarget()!==this){return;}this.removeState("hovered");if(this.hasState("pressed")){this.removeState("pressed");this.addState("abandoned");}},_onMouseDown:function(e){if(!e.isLeftPressed()){return;}e.stopPropagation();this.capture();this.removeState("abandoned");this.addState("pressed");},_onMouseUp:function(e){this.releaseCapture();var hasPressed=this.hasState("pressed");var hasAbandoned=this.hasState("abandoned");if(hasPressed){this.removeState("pressed");}if(hasAbandoned){this.removeState("abandoned");}else{this.addState("hovered");if(hasPressed){this.execute();}}e.stopPropagation();},_onKeyDown:function(e){switch(e.getKeyIdentifier()){case "Enter":case "Space":this.removeState("abandoned");this.addState("pressed");e.stopPropagation();}},_onKeyUp:function(e){switch(e.getKeyIdentifier()){case "Enter":case "Space":if(this.hasState("pressed")){this.removeState("abandoned");this.removeState("pressed");this.execute();e.stopPropagation();}}}}});qx.Class.define("qx.ui.form.RepeatButton",{extend:qx.ui.form.Button,construct:function(label,icon){this.base(arguments,label,icon);this.__timer=new qx.event.Timer(this.getInterval());this.__timer.addListener("interval",this._onInterval,this);},events:{"execute":"qx.event.type.Event","press":"qx.event.type.Event","release":"qx.event.type.Event"},properties:{interval:{check:"Integer",init:100},firstInterval:{check:"Integer",init:500},minTimer:{check:"Integer",init:20},timerDecrease:{check:"Integer",init:2}},members:{__currentInterval:null,__executed:null,__timer:null,press:function(){if(this.isEnabled()){if(!this.hasState("pressed")){this.__startInternalTimer();}this.removeState("abandoned");this.addState("pressed");}},release:function(fireExecuteEvent){if(!this.isEnabled()){return;}if(this.hasState("pressed")){if(!this.__executed){this.execute();}}this.removeState("pressed");this.removeState("abandoned");this.__stopInternalTimer();},_applyEnabled:function(value,old){this.base(arguments,value,old);if(!value){this.removeState("pressed");this.removeState("abandoned");this.__stopInternalTimer();}},_onMouseOver:function(e){if(!this.isEnabled()||e.getTarget()!==this){return;}if(this.hasState("abandoned")){this.removeState("abandoned");this.addState("pressed");this.__timer.start();}this.addState("hovered");},_onMouseOut:function(e){if(!this.isEnabled()||e.getTarget()!==this){return;}this.removeState("hovered");if(this.hasState("pressed")){this.removeState("pressed");this.addState("abandoned");this.__timer.stop();this.__currentInterval=this.getInterval();}},_onMouseDown:function(e){if(!e.isLeftPressed()){return;}this.capture();this.__startInternalTimer();e.stopPropagation();},_onMouseUp:function(e){this.releaseCapture();if(!this.hasState("abandoned")){this.addState("hovered");if(this.hasState("pressed")&&!this.__executed){this.execute();}}this.__stopInternalTimer();e.stopPropagation();},_onKeyUp:function(e){switch(e.getKeyIdentifier()){case "Enter":case "Space":if(this.hasState("pressed")){if(!this.__executed){this.execute();}this.removeState("pressed");this.removeState("abandoned");e.stopPropagation();this.__stopInternalTimer();}}},_onKeyDown:function(e){switch(e.getKeyIdentifier()){case "Enter":case "Space":this.removeState("abandoned");this.addState("pressed");e.stopPropagation();this.__startInternalTimer();}},_onInterval:function(e){this.__timer.stop();if(this.__currentInterval==null){this.__currentInterval=this.getInterval();}this.__currentInterval=(Math.max(this.getMinTimer(),this.__currentInterval-this.getTimerDecrease()));this.__timer.restartWith(this.__currentInterval);this.__executed=true;this.fireEvent("execute");},__startInternalTimer:function(){this.fireEvent("press");this.__executed=false;this.__timer.setInterval(this.getFirstInterval());this.__timer.start();this.removeState("abandoned");this.addState("pressed");},__stopInternalTimer:function(){this.fireEvent("release");this.__timer.stop();this.__currentInterval=null;this.removeState("abandoned");this.removeState("pressed");}},destruct:function(){this._disposeObjects("__timer");}});qx.Class.define("qx.ui.table.pane.CellEvent",{extend:qx.event.type.Mouse,properties:{row:{check:"Integer",nullable:true},column:{check:"Integer",nullable:true}},members:{init:function(scroller,me,row,column){me.clone(this);this.setBubbles(false);if(row!=null){this.setRow(row);}else{this.setRow(scroller._getRowForPagePos(this.getDocumentLeft(),this.getDocumentTop()));}if(column!=null){this.setColumn(column);}else{this.setColumn(scroller._getColumnForPageX(this.getDocumentLeft()));}}}});qx.Bootstrap.define("qx.lang.Number",{statics:{isInRange:function(nr,vmin,vmax){return nr>=vmin&&nr<=vmax;},isBetweenRange:function(nr,vmin,vmax){return nr>vmin&&nr<vmax;},limit:function(nr,vmin,vmax){if(vmax!=null&&nr>vmax){return vmax;}else if(vmin!=null&&nr<vmin){return vmin;}else{return nr;}}}});qx.Mixin.define("qx.ui.core.MRemoteChildrenHandling",{members:{getChildren:function(){return this.getChildrenContainer().getChildren();},hasChildren:function(){return this.getChildrenContainer().hasChildren();},add:function(child,options){return this.getChildrenContainer().add(child,options);},remove:function(child){return this.getChildrenContainer().remove(child);},removeAll:function(){return this.getChildrenContainer().removeAll();},indexOf:function(child){return this.getChildrenContainer().indexOf(child);},addAt:function(child,index,options){return this.getChildrenContainer().addAt(child,index,options);},addBefore:function(child,before,options){return this.getChildrenContainer().addBefore(child,before,options);},addAfter:function(child,after,options){return this.getChildrenContainer().addAfter(child,after,options);},removeAt:function(index){return this.getChildrenContainer().removeAt(index);}}});qx.Mixin.define("qx.ui.core.MRemoteLayoutHandling",{members:{setLayout:function(layout){return this.getChildrenContainer().setLayout(layout);},getLayout:function(){return this.getChildrenContainer().getLayout();}}});qx.Mixin.define("qx.ui.core.MResizable",{construct:function(){this.addListener("mousedown",this.__onResizeMouseDown,this,true);this.addListener("mouseup",this.__onResizeMouseUp,this);this.addListener("mousemove",this.__onResizeMouseMove,this);this.addListener("mouseout",this.__onResizeMouseOut,this);this.addListener("losecapture",this.__onResizeLoseCapture,this);},properties:{resizable:{check:"Boolean",init:true},resizeAllEdges:{check:"Boolean",init:true},resizeSensitivity:{check:"Integer",init:5},useResizeFrame:{check:"Boolean",init:true}},members:{__resizeFrame:null,__resizeActive:null,__resizeLeft:null,__resizeTop:null,__resizeStart:null,__getResizeFrame:function(){var frame=this.__resizeFrame;if(!frame){frame=this.__resizeFrame=new qx.ui.core.Widget();frame.setAppearance("resize-frame");frame.exclude();qx.core.Init.getApplication().getRoot().add(frame);}return frame;},__showResizeFrame:function(){var bounds=this.__resizeStart;var frame=this.__getResizeFrame();frame.setUserBounds(bounds.left,bounds.top,bounds.width,bounds.height);frame.show();frame.setZIndex(this.getZIndex()+1);},__computeResizeResult:function(e){var resizeActive=this.__resizeActive;var hint=this.getSizeHint();var start=this.__resizeStart;var width=start.width;var height=start.height;var left=start.left;var top=start.top;var diff;if(resizeActive&1||resizeActive&2){diff=e.getDocumentTop()-this.__resizeTop;if(resizeActive&1){height-=diff;}else{height+=diff;}if(height<hint.minHeight){height=hint.minHeight;}else if(height>hint.maxHeight){height=hint.maxHeight;}if(resizeActive&1){top+=start.height-height;}}if(resizeActive&4||resizeActive&8){diff=e.getDocumentLeft()-this.__resizeLeft;if(resizeActive&4){width-=diff;}else{width+=diff;}if(width<hint.minWidth){width=hint.minWidth;}else if(width>hint.maxWidth){width=hint.maxWidth;}if(resizeActive&4){left+=start.width-width;}}return {left:left,top:top,width:width,height:height};},__resizeCursors:{1:"n-resize",2:"s-resize",4:"w-resize",8:"e-resize",5:"nw-resize",6:"sw-resize",9:"ne-resize",10:"se-resize"},__computeResizeMode:function(e){if(!this.getResizable()){return;}var contentLocation=this.getContentLocation();var resizeAll=this.getResizeAllEdges();var mouseTolerance=this.getResizeSensitivity();var mouseLeft=e.getDocumentLeft();var mouseTop=e.getDocumentTop();var resizeActive=0;if(resizeAll&&Math.abs(contentLocation.top-mouseTop)<mouseTolerance){resizeActive+=1;}else if(Math.abs(contentLocation.bottom-mouseTop)<mouseTolerance){resizeActive+=2;}if(resizeAll&&Math.abs(contentLocation.left-mouseLeft)<mouseTolerance){resizeActive+=4;}else if(Math.abs(contentLocation.right-mouseLeft)<mouseTolerance){resizeActive+=8;}this.__resizeActive=resizeActive;},__onResizeMouseDown:function(e){if(!this.__resizeActive){return;}this.addState("resize");this.capture();this.__resizeLeft=e.getDocumentLeft();this.__resizeTop=e.getDocumentTop();var location=this.getContainerLocation();var bounds=this.getBounds();this.__resizeStart={top:location.top,left:location.left,width:bounds.width,height:bounds.height};if(this.getUseResizeFrame()){this.__showResizeFrame();}e.stop();},__onResizeMouseUp:function(e){if(!this.__resizeActive){return;}if(this.getUseResizeFrame()){this.__getResizeFrame().exclude();}var bounds=this.__computeResizeResult(e);this.setWidth(bounds.width);this.setHeight(bounds.height);if(this.getResizeAllEdges()){this.setLayoutProperties({left:bounds.left,top:bounds.top});}this.__resizeActive=0;this.removeState("resize");this.resetCursor();this.getApplicationRoot().resetGlobalCursor();this.releaseCapture();},__onResizeLoseCapture:function(e){if(!this.__resizeActive){return;}this.resetCursor();this.getApplicationRoot().resetGlobalCursor();this.removeState("move");if(this.getUseResizeFrame()){this.__getResizeFrame().exclude();}},__onResizeMouseMove:function(e){if(this.hasState("resize")){var bounds=this.__computeResizeResult(e);if(this.getUseResizeFrame()){var frame=this.__getResizeFrame();frame.setUserBounds(bounds.left,bounds.top,bounds.width,bounds.height);}else{this.setWidth(bounds.width);this.setHeight(bounds.height);if(this.getResizeAllEdges()){this.setLayoutProperties({left:bounds.left,top:bounds.top});}}e.stop();}else if(!this.hasState("maximized")){this.__computeResizeMode(e);var resizeActive=this.__resizeActive;var root=this.getApplicationRoot();if(resizeActive){var cursor=this.__resizeCursors[resizeActive];this.setCursor(cursor);root.setGlobalCursor(cursor);}else if(this.getCursor()){this.resetCursor();root.resetGlobalCursor();}}},__onResizeMouseOut:function(e){if(this.getCursor()&&!this.hasState("resize")){this.resetCursor();this.getApplicationRoot().resetGlobalCursor();}}},destruct:function(){this._disposeObjects("__resizeFrame");}});qx.Mixin.define("qx.ui.core.MMovable",{properties:{movable:{check:"Boolean",init:true},useMoveFrame:{check:"Boolean",init:false}},members:{__moveHandle:null,__moveFrame:null,__dragRange:null,__dragLeft:null,__dragTop:null,_activateMoveHandle:function(widget){if(this.__moveHandle){throw new Error("The move handle could not be redefined!");}this.__moveHandle=widget;widget.addListener("mousedown",this._onMoveMouseDown,this);widget.addListener("mouseup",this._onMoveMouseUp,this);widget.addListener("mousemove",this._onMoveMouseMove,this);widget.addListener("losecapture",this.__onMoveLoseCapture,this);},__getMoveFrame:function(){var frame=this.__moveFrame;if(!frame){frame=this.__moveFrame=new qx.ui.core.Widget();frame.setAppearance("move-frame");frame.exclude();qx.core.Init.getApplication().getRoot().add(frame);}return frame;},__showMoveFrame:function(){var bounds=this.getBounds();var frame=this.__getMoveFrame();frame.setUserBounds(bounds.left,bounds.top,bounds.width,bounds.height);frame.show();frame.setZIndex(this.getZIndex()+1);},__computeMoveCoordinates:function(e){var range=this.__dragRange;var mouseLeft=Math.max(range.left,Math.min(range.right,e.getDocumentLeft()));var mouseTop=Math.max(range.top,Math.min(range.bottom,e.getDocumentTop()));return {left:this.__dragLeft+mouseLeft,top:this.__dragTop+mouseTop};},_onMoveMouseDown:function(e){if(!this.getMovable()||this.hasState("maximized")){return;}var parent=this.getLayoutParent();var parentLocation=parent.getContentLocation();var parentBounds=parent.getBounds();this.__dragRange={left:parentLocation.left,top:parentLocation.top,right:parentLocation.left+parentBounds.width,bottom:parentLocation.top+parentBounds.height};var widgetLocation=this.getContainerLocation();this.__dragLeft=widgetLocation.left-e.getDocumentLeft();this.__dragTop=widgetLocation.top-e.getDocumentTop();this.addState("move");this.__moveHandle.capture();if(this.getUseMoveFrame()){this.__showMoveFrame();}e.stop();},_onMoveMouseMove:function(e){if(!this.hasState("move")){return;}var coords=this.__computeMoveCoordinates(e);if(this.getUseMoveFrame()){this.__getMoveFrame().setDomPosition(coords.left,coords.top);}else{this.setDomPosition(coords.left,coords.top);}},_onMoveMouseUp:function(e){if(!this.hasState("move")){return;}this.removeState("move");this.__moveHandle.releaseCapture();var coords=this.__computeMoveCoordinates(e);this.setLayoutProperties({left:coords.left,top:coords.top});if(this.getUseMoveFrame()){this.__getMoveFrame().exclude();}},__onMoveLoseCapture:function(e){if(!this.hasState("move")){return;}this.removeState("move");if(this.getUseMoveFrame()){this.__getMoveFrame().exclude();}}},destruct:function(){this._disposeObjects("__moveFrame","__moveHandle");this._disposeFields("__dragRange");}});qx.Mixin.define("qx.ui.core.MContentPadding",{properties:{contentPaddingTop:{check:"Integer",init:0,apply:"_applyContentPadding",themeable:true},contentPaddingRight:{check:"Integer",init:0,apply:"_applyContentPadding",themeable:true},contentPaddingBottom:{check:"Integer",init:0,apply:"_applyContentPadding",themeable:true},contentPaddingLeft:{check:"Integer",init:0,apply:"_applyContentPadding",themeable:true},contentPadding:{group:["contentPaddingTop","contentPaddingRight","contentPaddingBottom","contentPaddingLeft"],mode:"shorthand",themeable:true}},members:{__contentPaddingSetter:{contentPaddingTop:"setPaddingTop",contentPaddingRight:"setPaddingRight",contentPaddingBottom:"setPaddingBottom",contentPaddingLeft:"setPaddingLeft"},__contentPaddingResetter:{contentPaddingTop:"resetPaddingTop",contentPaddingRight:"resetPaddingRight",contentPaddingBottom:"resetPaddingBottom",contentPaddingLeft:"resetPaddingLeft"},_applyContentPadding:function(value,old,name){var target=this._getContentPaddingTarget();if(value==null){var resetter=this.__contentPaddingResetter[name];target[resetter]();}else{var setter=this.__contentPaddingSetter[name];target[setter](value);}}}});qx.Interface.define("qx.ui.window.IWindowManager",{members:{setDesktop:function(desktop){this.assertInterface(desktop,qx.ui.window.IDesktop);},changeActiveWindow:function(active,oldActive){},updateStack:function(){},bringToFront:function(win){this.assertInstance(win,qx.ui.window.Window);},sendToBack:function(win){this.assertInstance(win,qx.ui.window.Window);}}});qx.Class.define("qx.ui.window.Manager",{extend:qx.core.Object,implement:qx.ui.window.IWindowManager,members:{__desktop:null,setDesktop:function(desktop){this.__desktop=desktop;this.updateStack();},changeActiveWindow:function(active,oldActive){this.bringToFront(active);},_minZIndex:1e5,updateStack:function(){qx.ui.core.queue.Widget.add(this);},syncWidget:function(){this.__desktop.unblockContent();var windows=this.__desktop.getWindows();var zIndex=this._minZIndex-1;var hasActive=false;var win,last;for(var i=0,l=windows.length;i<l;i++){win=windows[i];if(!win.isVisible()){continue;}zIndex+=2;win.setZIndex(zIndex);if(win.getModal()){this.__desktop.blockContent(zIndex-1);}hasActive=hasActive||win.isActive();last=win;}if(!hasActive&&last){last.setActive(true);}},bringToFront:function(win){var windows=this.__desktop.getWindows();var removed=qx.lang.Array.remove(windows,win);if(removed){windows.push(win);this.updateStack();}},sendToBack:function(win){var windows=this.__desktop.getWindows();var removed=qx.lang.Array.remove(windows,win);if(removed){windows.unshift(win);this.updateStack();}}},destruct:function(){this._disposeObjects("__desktop");}});qx.Class.define("qx.ui.window.Window",{extend:qx.ui.core.Widget,include:[qx.ui.core.MRemoteChildrenHandling,qx.ui.core.MRemoteLayoutHandling,qx.ui.core.MResizable,qx.ui.core.MMovable,qx.ui.core.MBlocker,qx.ui.core.MContentPadding],construct:function(caption,icon){this.base(arguments);this._setLayout(new qx.ui.layout.VBox());this._createChildControl("captionbar");this._createChildControl("pane");if(icon!=null){this.setIcon(icon);}if(caption!=null){this.setCaption(caption);}this._updateCaptionBar();this.addListener("mousedown",this._onWindowEventStop);this.addListener("mouseup",this._onWindowEventStop);this.addListener("click",this._onWindowEventStop);this.addListener("mousedown",this._onWindowMouseDown,this,true);qx.core.Init.getApplication().getRoot().add(this);this.initVisibility();qx.ui.core.FocusHandler.getInstance().addRoot(this);},statics:{DEFAULT_MANAGER_CLASS:qx.ui.window.Manager},events:{"beforeClose":"qx.event.type.Event","close":"qx.event.type.Event","beforeMinimize":"qx.event.type.Event","minimize":"qx.event.type.Event","beforeMaximize":"qx.event.type.Event","maximize":"qx.event.type.Event","beforeRestore":"qx.event.type.Event","restore":"qx.event.type.Event"},properties:{appearance:{refine:true,init:"window"},visibility:{refine:true,init:"excluded"},focusable:{refine:true,init:true},active:{check:"Boolean",init:false,apply:"_applyActive",event:"changeActive"},modal:{check:"Boolean",init:false,event:"changeModal"},caption:{apply:"_applyCaption",event:"changeCaption",nullable:true},icon:{check:"String",nullable:true,apply:"_applyIcon",event:"changeIcon",themeable:true},status:{check:"String",nullable:true,apply:"_applyStatus",event:"changeStatus"},showClose:{check:"Boolean",init:true,apply:"_applyCaptionBarChange",themeable:true},showMaximize:{check:"Boolean",init:true,apply:"_applyCaptionBarChange",themeable:true},showMinimize:{check:"Boolean",init:true,apply:"_applyCaptionBarChange",themeable:true},allowClose:{check:"Boolean",init:true,apply:"_applyCaptionBarChange"},allowMaximize:{check:"Boolean",init:true,apply:"_applyCaptionBarChange"},allowMinimize:{check:"Boolean",init:true,apply:"_applyCaptionBarChange"},showStatusbar:{check:"Boolean",init:false,apply:"_applyShowStatusbar"}},members:{__restoredTop:null,__restoredLeft:null,getChildrenContainer:function(){return this._getChildControl("pane");},_forwardStates:{active:true,maximized:true},setLayoutParent:function(parent){{};this.base(arguments,parent);},_createChildControlImpl:function(id){var control;switch(id){case "statusbar":control=new qx.ui.container.Composite(new qx.ui.layout.HBox());this._add(control);control.add(this._getChildControl("statusbar-text"));break;case "statusbar-text":control=new qx.ui.basic.Label();control.setContent(this.getStatus());break;case "pane":control=new qx.ui.container.Composite();this._add(control,{flex:1});break;case "captionbar":var layout=new qx.ui.layout.Grid();layout.setColumnFlex(2,1);layout.setRowFlex(0,1);control=new qx.ui.container.Composite(layout);this._add(control);control.addListener("dblclick",this._onCaptionMouseDblClick,this);this._activateMoveHandle(control);break;case "icon":control=new qx.ui.basic.Image(this.getIcon());this._getChildControl("captionbar").add(control,{row:0,column:0});break;case "title":control=new qx.ui.basic.Label(this.getCaption());this._getChildControl("captionbar").add(control,{row:0,column:1});break;case "spacer":control=new qx.ui.core.Spacer();this._getChildControl("captionbar").add(control,{row:0,column:2});break;case "minimize-button":control=new qx.ui.form.Button();control.setFocusable(false);control.addListener("execute",this._onMinimizeButtonClick,this);this._getChildControl("captionbar").add(control,{row:0,column:3});break;case "restore-button":control=new qx.ui.form.Button();control.setFocusable(false);control.addListener("execute",this._onRestoreButtonClick,this);this._getChildControl("captionbar").add(control,{row:0,column:4});break;case "maximize-button":control=new qx.ui.form.Button();control.setFocusable(false);control.addListener("execute",this._onMaximizeButtonClick,this);this._getChildControl("captionbar").add(control,{row:0,column:5});break;case "close-button":control=new qx.ui.form.Button();control.setFocusable(false);control.addListener("execute",this._onCloseButtonClick,this);this._getChildControl("captionbar").add(control,{row:0,column:6});break;}return control||this.base(arguments,id);},_updateCaptionBar:function(){var btn;if(this.getIcon()){this._showChildControl("icon");}else{this._excludeChildControl("icon");}if(this.getCaption()){this._showChildControl("title");}else{this._excludeChildControl("title");}if(this.getShowMinimize()){this._showChildControl("minimize-button");btn=this._getChildControl("minimize-button");this.getAllowMinimize()?btn.resetEnabled():btn.setEnabled(false);}else{this._excludeChildControl("minimize-button");}if(this.getShowMaximize()){if(this.hasState("maximized")){this._showChildControl("restore-button");this._excludeChildControl("maximize-button");}else{this._showChildControl("maximize-button");this._excludeChildControl("restore-button");}btn=this._getChildControl("maximize-button");this.getAllowMaximize()?btn.resetEnabled():btn.setEnabled(false);}else{this._excludeChildControl("maximize-button");this._excludeChildControl("restore-button");}if(this.getShowClose()){this._showChildControl("close-button");btn=this._getChildControl("close-button");this.getAllowClose()?btn.resetEnabled():btn.setEnabled(false);}else{this._excludeChildControl("close-button");}},close:function(){if(this.fireNonBubblingEvent("beforeClose",qx.event.type.Event,[false,true])){this.hide();this.fireEvent("close");}},open:function(){this.show();this.setActive(true);this.focus();},center:function(){var parent=this.getLayoutParent();if(parent){var bounds=parent.getBounds();if(bounds){var hint=this.getSizeHint();var left=Math.round((bounds.width-hint.width)/2);var top=Math.round((bounds.height-hint.height)/2);this.moveTo(left,top);return;}}this.warn("Centering depends on parent bounds!");},maximize:function(){var parent=this.getLayoutParent();if(!parent){return;}if(parent.supportsMaximize()){if(this.fireNonBubblingEvent("beforeMaximize",qx.event.type.Event,[false,true])){var props=this.getLayoutProperties();this.__restoredLeft=props.left;this.__restoredTop=props.top;this.setLayoutProperties({left:null,top:null,edge:0});this.addState("maximized");this._updateCaptionBar();this.fireEvent("maximize");}}},minimize:function(){if(this.fireNonBubblingEvent("beforeMinimize",qx.event.type.Event,[false,true])){this.hide();this.fireEvent("minimize");}},restore:function(){if(!this.hasState("maximized")){return;}if(this.fireNonBubblingEvent("beforeRestore",qx.event.type.Event,[false,true])){var left=this.__restoredLeft;var top=this.__restoredTop;this.setLayoutProperties({edge:null,left:left,top:top});this.removeState("maximized");this._updateCaptionBar();this.fireEvent("restore");}},moveTo:function(left,top){if(this.hasState("maximized")){return;}this.setLayoutProperties({left:left,top:top});},_applyActive:function(value,old){if(old){this.removeState("active");}else{this.addState("active");}},_getContentPaddingTarget:function(){return this._getChildControl("pane");},_applyShowStatusbar:function(value,old){if(value){this._showChildControl("statusbar");}else{this._excludeChildControl("statusbar");}},_applyCaptionBarChange:function(value,old){this._updateCaptionBar();},_applyStatus:function(value,old){var label=this._getChildControl("statusbar-text",true);if(label){label.setContent(value);}},_applyCaption:function(value,old){this._getChildControl("title").setContent(value);},_applyIcon:function(value,old){this._getChildControl("icon").setSource(value);},_onWindowEventStop:function(e){e.stopPropagation();},_onWindowMouseDown:function(e){this.setActive(true);},_onCaptionMouseDblClick:function(e){if(this.getAllowMaximize()){this.hasState("maximized")?this.restore():this.maximize();}},_onMinimizeButtonClick:function(e){this.minimize();this._getChildControl("minimize-button").reset();},_onRestoreButtonClick:function(e){this.restore();this._getChildControl("restore-button").reset();},_onMaximizeButtonClick:function(e){this.maximize();this._getChildControl("maximize-button").reset();},_onCloseButtonClick:function(e){this.close();this._getChildControl("close-button").reset();}}});qx.Interface.define("qx.ui.window.IDesktop",{members:{setWindowManager:function(manager){this.assertInterface(manager,qx.ui.window.IWindowManager);},getWindows:function(){},supportsMaximize:function(){},blockContent:function(zIndex){this.assertInteger(zIndex);},unblockContent:function(){}}});qx.Class.define("qx.ui.core.Spacer",{extend:qx.ui.core.LayoutItem,construct:function(width,height){this.base(arguments);this.setWidth(width!=null?width:0);this.setHeight(height!=null?height:0);},members:{destroy:function(){}}});qx.Class.define("qx.ui.table.pane.Model",{extend:qx.core.Object,construct:function(tableColumnModel){this.base(arguments);tableColumnModel.addListener("visibilityChangedPre",this._onColVisibilityChanged,this);this.__tableColumnModel=tableColumnModel;},events:{"modelChanged":"qx.event.type.Event"},statics:{EVENT_TYPE_MODEL_CHANGED:"modelChanged"},properties:{firstColumnX:{check:"Integer",init:0,apply:"_applyFirstColumnX"},maxColumnCount:{check:"Number",init:-1,apply:"_applyMaxColumnCount"}},members:{__columnCount:null,__tableColumnModel:null,_applyFirstColumnX:function(value,old){this.__columnCount=null;this.fireEvent(qx.ui.table.pane.Model.EVENT_TYPE_MODEL_CHANGED);},_applyMaxColumnCount:function(value,old){this.__columnCount=null;this.fireEvent(qx.ui.table.pane.Model.EVENT_TYPE_MODEL_CHANGED);},setTableColumnModel:function(tableColumnModel){this.__tableColumnModel=tableColumnModel;},_onColVisibilityChanged:function(evt){this.__columnCount=null;this.fireEvent(qx.ui.table.pane.Model.EVENT_TYPE_MODEL_CHANGED);},getColumnCount:function(){if(this.__columnCount==null){var firstX=this.getFirstColumnX();var maxColCount=this.getMaxColumnCount();var totalColCount=this.__tableColumnModel.getVisibleColumnCount();if(maxColCount==-1||(firstX+maxColCount)>totalColCount){this.__columnCount=totalColCount-firstX;}else{this.__columnCount=maxColCount;}}return this.__columnCount;},getColumnAtX:function(xPos){var firstX=this.getFirstColumnX();return this.__tableColumnModel.getVisibleColumnAtX(firstX+xPos);},getX:function(col){var firstX=this.getFirstColumnX();var maxColCount=this.getMaxColumnCount();var x=this.__tableColumnModel.getVisibleX(col)-firstX;if(x>=0&&(maxColCount==-1||x<maxColCount)){return x;}else{return -1;}},getColumnLeft:function(col){var left=0;var colCount=this.getColumnCount();for(var x=0;x<colCount;x++){var currCol=this.getColumnAtX(x);if(currCol==col){return left;}left+=this.__tableColumnModel.getColumnWidth(currCol);}return -1;},getTotalWidth:function(){var totalWidth=0;var colCount=this.getColumnCount();for(var x=0;x<colCount;x++){var col=this.getColumnAtX(x);totalWidth+=this.__tableColumnModel.getColumnWidth(col);}return totalWidth;}},destruct:function(){this._disposeObjects("__tableColumnModel");}});qx.Class.define("qx.ui.form.MenuButton",{extend:qx.ui.form.Button,construct:function(label,icon,menu){this.base(arguments,label,icon);if(menu!=null){this.setMenu(menu);}},properties:{menu:{check:"qx.ui.menu.Menu",nullable:true,apply:"_applyMenu",event:"changeMenu"}},members:{_applyMenu:function(value,old){if(old){old.removeListener("changeVisibility",this._onMenuChange,this);old.resetOpener();}if(value){value.addListener("changeVisibility",this._onMenuChange,this);value.setOpener(this);}},open:function(selectFirst){var menu=this.getMenu();if(menu){qx.ui.menu.Manager.getInstance().hideAll();menu.open();if(selectFirst){var first=menu.getChildren()[0];if(first){menu.setSelectedButton(first);}}}},_onMenuChange:function(e){var menu=this.getMenu();if(menu.isVisible()){this.addState("pressed");}else{this.removeState("pressed");}},_onMouseDown:function(e){var menu=this.getMenu();if(menu){if(!menu.isVisible()){this.open();}else{menu.exclude();}e.stopPropagation();}},_onMouseUp:function(e){e.stopPropagation();},_onMouseOver:function(e){this.addState("hovered");},_onMouseOut:function(e){this.removeState("hovered");},_onKeyDown:function(e){switch(e.getKeyIdentifier()){case "Enter":this.removeState("abandoned");this.addState("pressed");var menu=this.getMenu();if(menu){if(!menu.isVisible()){this.open();}else{menu.exclude();}}e.stopPropagation();}},_onKeyUp:function(e){}},destruct:function(){if(this.getMenu()){if(!qx.core.ObjectRegistry.inShutDown){this.getMenu().destroy();}}}});qx.Class.define("qx.ui.menu.Manager",{type:"singleton",extend:qx.core.Object,construct:function(){this.base(arguments);this.__objects=[];var root=qx.core.Init.getApplication().getRoot();root.addListener("mousedown",this._onMouseDown,this,true);root.addListener("mouseup",this._onMouseUp,this);root.addListener("keydown",this._onKeyUpDown,this,true);root.addListener("keyup",this._onKeyUpDown,this,true);root.addListener("keypress",this._onKeyPress,this,true);qx.bom.Element.addListener(window,"blur",this.hideAll,this);this.__openTimer=new qx.event.Timer;this.__openTimer.addListener("interval",this._onOpenInterval,this);this.__closeTimer=new qx.event.Timer;this.__closeTimer.addListener("interval",this._onCloseInterval,this);},members:{__scheduleOpen:null,__scheduleClose:null,__openTimer:null,__closeTimer:null,__objects:null,_getChild:function(menu,start,iter,loop){var children=menu.getChildren();var length=children.length;var child;for(var i=start;i<length&&i>=0;i+=iter){child=children[i];if(child.isEnabled()&&!child.isAnonymous()){return child;}}if(loop){i=i==length?0:length-1;for(;i!=start;i+=iter){child=children[i];if(child.isEnabled()&&!child.isAnonymous()){return child;}}}return null;},_isInMenu:function(widget){while(widget){if(widget instanceof qx.ui.menu.Menu){return true;}widget=widget.getLayoutParent();}return false;},add:function(obj){{};var reg=this.__objects;reg.push(obj);obj.setZIndex(1e6+reg.length);},remove:function(obj){{};var reg=this.__objects;if(reg){qx.lang.Array.remove(reg,obj);}},hideAll:function(){var reg=this.__objects;if(reg){for(var i=reg.length-1;i>=0;i--){reg[i].exclude();}}},getActiveMenu:function(){var reg=this.__objects;return reg.length>0?reg[reg.length-1]:null;},scheduleOpen:function(menu){this.cancelClose(menu);if(menu.isVisible()){if(this.__scheduleOpen){this.cancelOpen(this.__scheduleOpen);}}else if(this.__scheduleOpen!=menu){this.__scheduleOpen=menu;this.__openTimer.restartWith(menu.getOpenInterval());}},scheduleClose:function(menu){this.cancelOpen(menu);if(!menu.isVisible()){if(this.__scheduleClose){this.cancelClose(this.__scheduleClose);}}else if(this.__scheduleClose!=menu){this.__scheduleClose=menu;this.__closeTimer.restartWith(menu.getCloseInterval());}},cancelOpen:function(menu){if(this.__scheduleOpen==menu){this.__openTimer.stop();this.__scheduleOpen=null;}},cancelClose:function(menu){if(this.__scheduleClose==menu){this.__closeTimer.stop();this.__scheduleClose=null;}},_onOpenInterval:function(e){this.__openTimer.stop();this.__scheduleOpen.open();this.__scheduleOpen=null;},_onCloseInterval:function(e){this.__closeTimer.stop();this.__scheduleClose.exclude();this.__scheduleClose=null;},_onMouseDown:function(e){var target=e.getTarget();if(target.getMenu&&target.getMenu()&&target.getMenu().isVisible()){return;}if(!this._isInMenu(target)){this.hideAll();}},_onMouseUp:function(e){var target=e.getTarget();if(!(target instanceof qx.ui.menu.Menu)){this.hideAll();}},__selectionKeys:{"Enter":1,"Space":1},__navigationKeys:{"Escape":1,"Up":1,"Down":1,"Left":1,"Right":1},_onKeyUpDown:function(e){var menu=this.getActiveMenu();if(!menu){return;}var iden=e.getKeyIdentifier();if(this.__navigationKeys[iden]||(this.__selectionKeys[iden]&&menu.getSelectedButton())){e.stopPropagation();}},_onKeyPress:function(e){var menu=this.getActiveMenu();if(!menu){return;}var iden=e.getKeyIdentifier();var navigation=this.__navigationKeys[iden];var selection=this.__selectionKeys[iden];if(navigation){switch(iden){case "Up":this._onKeyPressUp(menu);break;case "Down":this._onKeyPressDown(menu);break;case "Left":this._onKeyPressLeft(menu);break;case "Right":this._onKeyPressRight(menu);break;case "Escape":this.hideAll();break;}e.stopPropagation();}else if(selection){var button=menu.getSelectedButton();if(button){switch(iden){case "Enter":this._onKeyPressEnter(menu,button,e);break;case "Space":this._onKeyPressSpace(menu,button,e);break;}e.stopPropagation();}}},_onKeyPressUp:function(menu){var selectedButton=menu.getSelectedButton();var children=menu.getChildren();var start=selectedButton?menu.indexOf(selectedButton)-1:children.length-1;var nextItem=this._getChild(menu,start,-1,true);if(nextItem){menu.setSelectedButton(nextItem);}else{menu.resetSelectedButton();}},_onKeyPressDown:function(menu){var selectedButton=menu.getSelectedButton();var start=selectedButton?menu.indexOf(selectedButton)+1:0;var nextItem=this._getChild(menu,start,1,true);if(nextItem){menu.setSelectedButton(nextItem);}else{menu.resetSelectedButton();}},_onKeyPressLeft:function(menu){var menuOpener=menu.getOpener();if(!menuOpener){return;}if(menuOpener instanceof qx.ui.menu.Button){var parentMenu=menuOpener.getLayoutParent();parentMenu.resetOpenedButton();parentMenu.setSelectedButton(menuOpener);}else if(menuOpener instanceof qx.ui.toolbar.MenuButton){var buttons=menuOpener.getToolBar().getMenuButtons();var index=buttons.indexOf(menuOpener);if(index===-1){return;}var prevButton=index==0?buttons[buttons.length-1]:buttons[index-1];if(prevButton!=menuOpener){prevButton.open(true);}}},_onKeyPressRight:function(menu){var selectedButton=menu.getSelectedButton();if(selectedButton){var subMenu=selectedButton.getMenu();if(subMenu){menu.setOpenedButton(selectedButton);var first=this._getChild(subMenu,0,1);if(first){subMenu.setSelectedButton(first);}return;}}else if(!menu.getOpenedButton()){var first=this._getChild(menu,0,1);if(first){menu.setSelectedButton(first);if(first.getMenu()){menu.setOpenedButton(first);}return;}}var menuOpener=menu.getOpener();if(menuOpener instanceof qx.ui.menu.Button&&selectedButton){while(menuOpener){menuOpener=menuOpener.getLayoutParent();if(menuOpener instanceof qx.ui.menu.Menu){menuOpener=menuOpener.getOpener();if(menuOpener instanceof qx.ui.toolbar.MenuButton){break;}}else{break;}}if(!menuOpener){return;}}if(menuOpener instanceof qx.ui.toolbar.MenuButton){var buttons=menuOpener.getToolBar().getMenuButtons();var index=buttons.indexOf(menuOpener);if(index===-1){return;}var nextButton=buttons[index+1];if(!nextButton){nextButton=buttons[0];}if(nextButton!=menuOpener){nextButton.open(true);}}},_onKeyPressEnter:function(menu,button,e){if(button.hasListener("keypress")){var clone=e.clone();clone.setBubbles(false);clone.setTarget(button);button.dispatchEvent(clone);}this.hideAll();},_onKeyPressSpace:function(menu,button,e){if(button.hasListener("keypress")){var clone=e.clone();clone.setBubbles(false);clone.setTarget(button);button.dispatchEvent(clone);}}},destruct:function(){var root=qx.core.Init.getApplication().getRoot();if(root){root.removeListener("mousedown",this._onMouseDown,this,true);root.removeListener("mouseup",this._onMouseUp,this);root.removeListener("keydown",this._onKeyUpDown,this,true);root.removeListener("keyup",this._onKeyUpDown,this,true);root.removeListener("keypress",this._onKeyPress,this,true);}this._disposeObjects("__openTimer","__closeTimer");this._disposeArray("__objects");}});qx.Class.define("qx.ui.menu.Menu",{extend:qx.ui.core.Widget,include:[qx.ui.core.MPlacement,qx.ui.core.MChildrenHandling],construct:function(){this.base(arguments);this._setLayout(new qx.ui.menu.Layout);this.getApplicationRoot().add(this);this.addListener("mouseover",this._onMouseOver);this.addListener("mouseout",this._onMouseOut);this.initVisibility();},properties:{appearance:{refine:true,init:"menu"},allowGrowX:{refine:true,init:false},allowGrowY:{refine:true,init:false},visibility:{refine:true,init:"excluded"},keepFocus:{refine:true,init:true},keepActive:{refine:true,init:true},spacingX:{check:"Integer",apply:"_applySpacingX",init:0,themeable:true},spacingY:{check:"Integer",apply:"_applySpacingY",init:0,themeable:true},iconColumnWidth:{check:"Integer",init:0,themeable:true,apply:"_applyIconColumnWidth"},arrowColumnWidth:{check:"Integer",init:0,themeable:true,apply:"_applyArrowColumnWidth"},selectedButton:{check:"qx.ui.core.Widget",nullable:true,apply:"_applySelectedButton"},openedButton:{check:"qx.ui.core.Widget",nullable:true,apply:"_applyOpenedButton"},opener:{check:"qx.ui.core.Widget",nullable:true},openInterval:{check:"Integer",themeable:true,init:250,apply:"_applyOpenInterval"},closeInterval:{check:"Integer",themeable:true,init:250,apply:"_applyCloseInterval"}},members:{__scheduledOpen:null,open:function(){this.placeToWidget(this.getOpener());this.show();},addSeparator:function(){this.add(new qx.ui.menu.Separator);},getColumnSizes:function(){return this._getLayout().getColumnSizes();},_applyIconColumnWidth:function(value,old){this._getLayout().setIconColumnWidth(value);},_applyArrowColumnWidth:function(value,old){this._getLayout().setArrowColumnWidth(value);},_applySpacingX:function(value,old){this._getLayout().setColumnSpacing(value);},_applySpacingY:function(value,old){this._getLayout().setSpacing(value);},_applyVisibility:function(value,old){this.base(arguments,value,old);var mgr=qx.ui.menu.Manager.getInstance();if(value==="visible"){mgr.add(this);var opener=this.getOpener();var parentMenu=opener.getLayoutParent();if(parentMenu&&parentMenu instanceof qx.ui.menu.Menu){parentMenu.setOpenedButton(opener);}}else if(old==="visible"){mgr.remove(this);var opener=this.getOpener();var parentMenu=opener.getLayoutParent();if(parentMenu&&parentMenu instanceof qx.ui.menu.Menu&&parentMenu.getOpenedButton()==opener){parentMenu.resetOpenedButton();}this.resetOpenedButton();this.resetSelectedButton();}},_applySelectedButton:function(value,old){if(old){old.removeState("selected");}if(value){value.addState("selected");}},_applyOpenedButton:function(value,old){if(old){old.getMenu().exclude();}if(value){value.getMenu().open();}},_onMouseOver:function(e){var mgr=qx.ui.menu.Manager.getInstance();mgr.cancelClose(this);var target=e.getTarget();if(target.isEnabled()&&target instanceof qx.ui.menu.AbstractButton){this.setSelectedButton(target);var subMenu=target.getMenu&&target.getMenu();if(subMenu){mgr.scheduleOpen(subMenu);this.__scheduledOpen=subMenu;}else{var opened=this.getOpenedButton();if(opened){mgr.scheduleClose(opened.getMenu());}if(this.__scheduledOpen){mgr.cancelOpen(this.__scheduledOpen);this.__scheduledOpen=null;}}}else if(!this.getOpenedButton()){this.resetSelectedButton();}},_onMouseOut:function(e){var mgr=qx.ui.menu.Manager.getInstance();if(!qx.ui.core.Widget.contains(this,e.getRelatedTarget())){var opened=this.getOpenedButton();opened?this.setSelectedButton(opened):this.resetSelectedButton();if(opened){mgr.cancelClose(opened.getMenu());}if(this.__scheduledOpen){mgr.cancelOpen(this.__scheduledOpen);}}}}});qx.Class.define("qx.ui.menu.Layout",{extend:qx.ui.layout.VBox,properties:{columnSpacing:{check:"Integer",init:0,apply:"_applyLayoutChange"},spanColumn:{check:"Integer",init:1,nullable:true,apply:"_applyLayoutChange"},iconColumnWidth:{check:"Integer",init:0,themeable:true,apply:"_applyLayoutChange"},arrowColumnWidth:{check:"Integer",init:0,themeable:true,apply:"_applyLayoutChange"}},members:{__columnSizes:null,_computeSizeHint:function(){var children=this._getLayoutChildren();var child,sizes,spacing;var spanColumn=this.getSpanColumn();var columnSizes=this.__columnSizes=[0,0,0,0];var columnSpacing=this.getColumnSpacing();var spanColumnWidth=0;var maxInset=0;for(var i=0,l=children.length;i<l;i++){child=children[i];if(child.isAnonymous()){continue;}sizes=child.getChildrenSizes();for(var column=0;column<sizes.length;column++){if(spanColumn!=null&&column==spanColumn&&sizes[spanColumn+1]==0){spanColumnWidth=Math.max(spanColumnWidth,sizes[column]);}else{columnSizes[column]=Math.max(columnSizes[column],sizes[column]);}}var insets=children[i].getInsets();maxInset=Math.max(maxInset,insets.left+insets.right);}if(spanColumn!=null&&columnSizes[spanColumn]+columnSpacing+columnSizes[spanColumn+1]<spanColumnWidth){columnSizes[spanColumn]=spanColumnWidth-columnSizes[spanColumn+1]-columnSpacing;}if(spanColumnWidth==0){spacing=columnSpacing*2;}else{spacing=columnSpacing*3;}if(columnSizes[0]==0){columnSizes[0]=this.getIconColumnWidth();}if(columnSizes[3]==0){columnSizes[3]=this.getArrowColumnWidth();}return {height:this.base(arguments).height,width:qx.lang.Array.sum(columnSizes)+maxInset+spacing};},getColumnSizes:function(){return this.__columnSizes||null;}}});qx.Class.define("qx.ui.menu.Separator",{extend:qx.ui.core.Widget,properties:{appearance:{refine:true,init:"menu-separator"},anonymous:{refine:true,init:true}}});qx.Class.define("qx.ui.menu.AbstractButton",{extend:qx.ui.core.Widget,type:"abstract",construct:function(){this.base(arguments);this._setLayout(new qx.ui.menu.ButtonLayout);this.addListener("mouseup",this._onMouseUp);this.addListener("keypress",this._onKeyPress);},properties:{label:{check:"String",apply:"_applyLabel",nullable:true},menu:{check:"qx.ui.menu.Menu",apply:"_applyMenu",nullable:true},icon:{check:"String",apply:"_applyIcon",themeable:true,nullable:true}},members:{_createChildControlImpl:function(id){var control;switch(id){case "icon":control=new qx.ui.basic.Image;control.setAnonymous(true);this._add(control,{column:0});break;case "label":control=new qx.ui.basic.Label;control.setAnonymous(true);this._add(control,{column:1});break;case "shortcut":control=new qx.ui.basic.Label;control.setAnonymous(true);this._add(control,{column:2});break;case "arrow":control=new qx.ui.basic.Image;control.setAnonymous(true);this._add(control,{column:3});break;}return control||this.base(arguments,id);},_forwardStates:{selected:1},getChildrenSizes:function(){var iconWidth=0,labelWidth=0,shortcutWidth=0,arrowWidth=0;if(this._isChildControlVisible("icon")){var icon=this._getChildControl("icon");iconWidth=icon.getMarginLeft()+icon.getSizeHint().width+icon.getMarginRight();}if(this._isChildControlVisible("label")){var label=this._getChildControl("label");labelWidth=label.getMarginLeft()+label.getSizeHint().width+label.getMarginRight();}if(this._isChildControlVisible("shortcut")){var shortcut=this._getChildControl("shortcut");shortcutWidth=shortcut.getMarginLeft()+shortcut.getSizeHint().width+shortcut.getMarginRight();}if(this._isChildControlVisible("arrow")){var arrow=this._getChildControl("arrow");arrowWidth=arrow.getMarginLeft()+arrow.getSizeHint().width+arrow.getMarginRight();}return [iconWidth,labelWidth,shortcutWidth,arrowWidth];},_onMouseUp:function(e){},_onKeyPress:function(e){},_applyIcon:function(value,old){if(value){this._showChildControl("icon").setSource(value);}else{this._excludeChildControl("icon");}},_applyLabel:function(value,old){if(value){this._showChildControl("label").setContent(value);}else{this._excludeChildControl("label");}},_applyMenu:function(value,old){if(old){old.resetOpener();old.removeState("submenu");}if(value){this._showChildControl("arrow");value.setOpener(this);value.addState("submenu");}else{this._excludeChildControl("arrow");}}},destruct:function(){if(this.getMenu()){if(!qx.core.ObjectRegistry.inShutDown){this.getMenu().destroy();}}}});qx.Class.define("qx.ui.menu.ButtonLayout",{extend:qx.ui.layout.Abstract,members:{verifyLayoutProperty:null,renderLayout:function(availWidth,availHeight){var children=this._getLayoutChildren();var child;var column;var columnChildren=[];for(var i=0,l=children.length;i<l;i++){child=children[i];column=child.getLayoutProperties().column;columnChildren[column]=child;}var menu=children[0].getLayoutParent().getLayoutParent();var columns=menu.getColumnSizes();var spacing=menu.getSpacingX();var left=0,top=0;var Util=qx.ui.layout.Util;for(var i=0,l=columns.length;i<l;i++){child=columnChildren[i];if(child){var hint=child.getSizeHint();var top=Util.computeVerticalAlignOffset(child.getAlignY()||"middle",hint.height,availHeight,0,0);var offsetLeft=Util.computeHorizontalAlignOffset(child.getAlignX()||"left",hint.width,columns[i],child.getMarginLeft(),child.getMarginRight());child.renderLayout(left+offsetLeft,top,hint.width,hint.height);}left+=columns[i]+spacing;}},_computeSizeHint:function(){var children=this._getLayoutChildren();var neededHeight=0;for(var i=0,l=children.length;i<l;i++){neededHeight=Math.max(neededHeight,children[i].getSizeHint().height);}return {width:0,height:neededHeight};}}});qx.Class.define("qx.ui.menu.Button",{extend:qx.ui.menu.AbstractButton,include:qx.ui.core.MExecutable,construct:function(label,icon,command,menu){this.base(arguments);this.addListener("changeCommand",this._onChangeCommand,this);if(label!=null){this.setLabel(label);}if(icon!=null){this.setIcon(icon);}if(command!=null){this.setCommand(command);}if(menu!=null){this.setMenu(menu);}},properties:{appearance:{refine:true,init:"menu-button"}},members:{_onChangeCommand:function(e){this._getChildControl("shortcut").setContent(e.getData().toString());},_onMouseUp:function(e){if(e.isLeftPressed()){this.execute();if(this.getMenu()){e.stopPropagation();}}},_onKeyPress:function(e){this.execute();}}});qx.Class.define("qx.ui.toolbar.MenuButton",{extend:qx.ui.form.MenuButton,construct:function(label,icon,menu){this.base(arguments,label,icon,menu);this.removeListener("keydown",this._onKeyDown);this.removeListener("keyup",this._onKeyUp);},properties:{appearance:{refine:true,init:"toolbar-button"},show:{refine:true,init:"inherit"},focusable:{refine:true,init:false}},members:{getToolBar:function(){var parent=this;while(parent){if(parent instanceof qx.ui.toolbar.ToolBar){return parent;}parent=parent.getLayoutParent();}return null;},_onMenuChange:function(e){var menu=this.getMenu();var toolbar=this.getToolBar();if(menu.isVisible()){this.addState("pressed");if(toolbar){toolbar.setOpenMenu(menu);}}else{this.removeState("pressed");if(toolbar&&toolbar.getOpenMenu()==menu){toolbar.resetOpenMenu();}}},_onMouseOver:function(e){this.addState("hovered");if(this.getMenu()){var toolbar=this.getToolBar();var open=toolbar.getOpenMenu();if(open&&open!=this.getMenu()){qx.ui.menu.Manager.getInstance().hideAll();this.open();}}}}});qx.Class.define("qx.ui.toolbar.ToolBar",{extend:qx.ui.core.Widget,include:qx.ui.core.MChildrenHandling,construct:function(){this.base(arguments);this._setLayout(new qx.ui.layout.HBox());},properties:{appearance:{refine:true,init:"toolbar"},openMenu:{check:"qx.ui.menu.Menu",event:"changeOpenMenu",nullable:true},show:{init:"both",check:["both","label","icon"],inheritable:true,event:"changeShow"},spacing:{nullable:true,check:"Integer",themeable:true,apply:"_applySpacing"}},members:{_applySpacing:function(value,old){var layout=this._getLayout();value==null?layout.resetSpacing():layout.setSpacing(value);},addSpacer:function(){var spacer=new qx.ui.core.Spacer;this._add(spacer,{flex:1});return spacer;},addSeparator:function(){this.add(new qx.ui.toolbar.Separator);},getMenuButtons:function(){var children=this.getChildren();var buttons=[];var child;for(var i=0,l=children.length;i<l;i++){child=children[i];if(child instanceof qx.ui.toolbar.MenuButton){buttons.push(child);}else if(child instanceof qx.ui.toolbar.Part){buttons.push.apply(buttons,child.getMenuButtons());}}return buttons;}}});qx.Class.define("qx.ui.toolbar.Separator",{extend:qx.ui.core.Widget,properties:{appearance:{refine:true,init:"toolbar-separator"},width:{refine:true,init:0},height:{refine:true,init:0}}});qx.Class.define("qx.ui.toolbar.Part",{extend:qx.ui.core.Widget,include:[qx.ui.core.MRemoteChildrenHandling],construct:function(){this.base(arguments);this._setLayout(new qx.ui.layout.HBox);this._createChildControl("handle");},properties:{appearance:{refine:true,init:"toolbar/part"},show:{init:"both",check:["both","label","icon"],inheritable:true,event:"changeShow"},spacing:{nullable:true,check:"Integer",themeable:true,apply:"_applySpacing"}},members:{_createChildControlImpl:function(id){var control;switch(id){case "handle":control=new qx.ui.basic.Image();control.setAlignY("middle");this._add(control);break;case "container":control=new qx.ui.toolbar.PartContainer;this._add(control);break;}return control||this.base(arguments,id);},getChildrenContainer:function(){return this._getChildControl("container");},_applySpacing:function(value,old){var layout=this._getChildControl("container").getLayout();value==null?layout.resetSpacing():layout.setSpacing(value);},addSeparator:function(){this.add(new qx.ui.toolbar.Separator);},getMenuButtons:function(){var children=this.getChildren();var buttons=[];var child;for(var i=0,l=children.length;i<l;i++){child=children[i];if(child instanceof qx.ui.toolbar.MenuButton){buttons.push(child);}}return buttons;}}});qx.Class.define("qx.ui.toolbar.PartContainer",{extend:qx.ui.container.Composite,construct:function(){this.base(arguments);this._setLayout(new qx.ui.layout.HBox);},properties:{appearance:{refine:true,init:"toolbar/part/container"},show:{init:"both",check:["both","label","icon"],inheritable:true,event:"changeShow"}}});qx.Class.define("qx.ui.menu.CheckBox",{extend:qx.ui.menu.AbstractButton,implement:qx.ui.form.IFormElement,construct:function(label,menu){this.base(arguments);if(label!=null){this.setLabel(label);}if(menu!=null){this.setMenu(menu);}},properties:{appearance:{refine:true,init:"menu-checkbox"},value:{check:"String",nullable:true,event:"changeValue"},name:{check:"String",nullable:true,event:"changeName"},checked:{check:"Boolean",init:false,apply:"_applyChecked",event:"changeChecked"}},members:{_applyChecked:function(value,old){value?this.addState("checked"):this.removeState("checked");},_onMouseUp:function(e){if(e.isLeftPressed()){this.toggleChecked();}},_onKeyPress:function(e){this.toggleChecked();}}});qx.Class.define("qx.test.ui.Insets",{extend:qx.test.ui.LayoutTestCase,members:{testPadding:function(){var widget=new qx.ui.core.Widget();this.getRoot().add(widget);this.assertPadding(widget,0,0,0,0);widget.setPadding(1,2,3,4);this.assertPadding(widget,1,2,3,4);widget.setPadding(1);this.assertPadding(widget,1,1,1,1);widget.setPadding(2,5);this.assertPadding(widget,2,5,2,5);this.getRoot().remove(widget);widget.dispose();},testDecoration:function(){var widget=new qx.ui.core.Widget();this.getRoot().add(widget);var deco=new qx.ui.decoration.Background();widget.setDecorator(deco);this.assertPadding(widget,0,0,0,0);this.getRoot().remove(widget);widget.dispose();},testInsets:function(){var widget=new qx.ui.core.Widget();this.getRoot().add(widget);var deco;this.assertPadding(widget,0,0,0,0);deco=new qx.ui.decoration.Single(1);widget.setDecorator(deco);this.assertPadding(widget,1,1,1,1);deco=new qx.ui.decoration.Single(1);deco.setWidth(2);widget.setDecorator(deco);widget.setPadding(2);this.assertPadding(widget,4,4,4,4);deco=new qx.ui.decoration.Single(1);deco.setWidth(2,3,5,7);widget.setDecorator(deco);widget.setPadding(1,4,16,64);this.assertPadding(widget,3,7,21,71);widget.setDecorator(null);this.assertPadding(widget,1,4,16,64);this.getRoot().remove(widget);widget.dispose();}}});qx.Class.define("qx.ui.decoration.Background",{extend:qx.core.Object,implement:[qx.ui.decoration.IDecorator],construct:function(backgroundColor){this.base(arguments);if(backgroundColor!=null){this.setBackgroundColor(backgroundColor);}},properties:{backgroundImage:{check:"String",nullable:true,apply:"_applyStyle"},backgroundRepeat:{check:["repeat","repeat-x","repeat-y","no-repeat","scale"],init:"repeat",apply:"_applyStyle"},backgroundColor:{check:"Color",nullable:true,apply:"_applyStyle"}},members:{init:function(element){element.useMarkup(this.getMarkup());},getMarkup:function(){if(this.__markup){return this.__markup;}var html=qx.ui.decoration.Util.generateBackgroundMarkup(this.getBackgroundImage(),this.getBackgroundRepeat(),"position:absolute;top:0;left:0;");return this.__markup=html;},resize:function(element,width,height){var dom=element.getDomElement();dom.style.width=width+"px";dom.style.height=height+"px";},tint:function(element,bgcolor){var Color=qx.theme.manager.Color.getInstance();var dom=element.getDomElement();if(bgcolor==null){bgcolor=this.getBackgroundColor();}dom.style.backgroundColor=Color.resolve(bgcolor)||"";},__insets:{top:0,right:0,bottom:0,left:0},getInsets:function(){return this.__insets;},_applyStyle:function(){{};}}});qx.Class.define("qx.test.lang.Webkit",{extend:qx.dev.unit.TestCase,members:{testSwitch:function(){this.assertEquals(this,this._switchFunction(12));this.assertEquals(this,this._switchFunction(this));},_switchFunction:function(val){switch(val){case this:break;default:break;}return this;}}});qx.Class.define("qx.test.core.Target",{extend:qx.dev.unit.TestCase,members:{testEvents:function(){qx.Class.define("qx.Event",{extend:qx.core.Object,events:{"click":"qx.event.type.Event"}});var target=new qx.Event();target.addListener("click",function(){});}}});qx.Class.define("qx.test.Interface",{extend:qx.dev.unit.TestCase,members:{testInterface:function(){qx.Interface.define("qx.ICar",{members:{startEngine:function(){return true;}},properties:{color:{}}});qx.Class.define("qx.Audi",{extend:Object,construct:function(){},implement:[qx.ICar],members:{startEngine:function(){return "start";}},statics:{honk:function(){return "honk";}},properties:{color:{}}});var audi=new qx.Audi("audi");if(this.isDebugOn()){this.assertException(function(){var i=new qx.ICar();},Error);this.assertException(function(){qx.Class.define("qx.Audi1",{extend:Object,construct:function(){},implement:[qx.ICar]});},Error,new RegExp('Implementation of method .* is missing'));this.assertException(function(){qx.Class.define("qx.Audi2",{extend:Object,construct:function(){},implement:[qx.ICar],statics:{honk:function(){return "honk";}},properties:{color:{}}});},Error,'Implementation of method "startEngine" is missing');this.assertException(function(){qx.Class.define("qx.Audi4",{extend:Object,construct:function(){},implement:[qx.ICar],members:{startEngine:function(){return "start";}},statics:{honk:function(){return "honk";}}});},Error,new RegExp("property .* not supported"));}},testAssertions:function(){qx.Interface.define("qx.IComplex",{members:{add:function(a){this.assertArgumentsCount(arguments,1,1);this.assertInterface(a.constructor,qx.IComplex);},setReal:function(r){this.assertArgumentsCount(arguments,1,1);this.assertType(r,"number");},abs:function(){this.assert(arguments[0]==undefined);}}});qx.Class.define("qx.Complex",{extend:qx.core.Object,implement:qx.IComplex,construct:function(real,imag){this._real=real;this._imag=imag;},members:{add:function(a){this._real+=a._real;this._imag+=a._imag;},setReal:function(r){this._real=r;},abs:function(){return Math.sqrt((this._real*this._real)+(this._imag+this._imag));},toString:function(){return this._real+"+"+this._imag+"i";}}});var a=new qx.Complex(1,1);var b=new qx.Complex(2,-3.4);a.add(b);a.setReal(20);a.abs();if(this.isDebugOn()){this.assertException(function(){a.add(b,b);},qx.dev.unit.AssertionError,null,"a");this.assertException(function(){a.setReal();},qx.dev.unit.AssertionError,null,"b");this.assertException(function(){a.setReal(1,2);},qx.dev.unit.AssertionError,null,"c");this.assertException(function(){a.setReal("Juhu");},qx.dev.unit.AssertionError,null,"d");this.assertException(function(){a.abs({});},qx.dev.unit.AssertionError,null,"e");this.assertException(function(){a.add("Juhu");},qx.dev.unit.AssertionError,null,"f");}},testProperties:function(){qx.Interface.define("qx.IProperties1",{properties:{value:{}}});qx.Class.define("qx.Properties1",{extend:qx.core.Object,implement:[qx.IProperties1],properties:{value:{check:"Integer"}}});if(this.isDebugOn()){this.assertException(function(){qx.Class.define("qx.Properties2",{extend:qx.core.Object,implement:[qx.IProperties1],members:{getValue:function(){},setValue:function(value){}}});});}qx.Interface.define("qx.IProperties2",{members:{getValue:function(){},setValue:function(value){}}});qx.Class.define("qx.Properties3",{extend:qx.core.Object,implement:[qx.IProperties2],properties:{value:{check:"Integer"}}});qx.Class.define("qx.Properties4",{extend:qx.core.Object,implement:[qx.IProperties2],members:{getValue:function(){},setValue:function(value){}}});},testEvents:function(){qx.Interface.define("qx.IEvents1",{events:{"change":"qx.event.type.Event"}});qx.Class.define("qx.Event1",{extend:qx.core.Object,implement:[qx.IEvents1],events:{change:"qx.event.type.Event"}});if(this.isDebugOn()){this.assertException(function(){qx.Class.define("qx.Event2",{extend:qx.core.Object,implement:[qx.IEvents1]});});}},testIncludes:function(){qx.Interface.define("qx.IMember",{members:{sayJuhu:function(){return true;}}});qx.Interface.define("qx.IProperties",{properties:{"color":{},"name":{}}});qx.Interface.define("qx.IAll",{extend:[qx.IMember,qx.IProperties]});qx.Interface.define("qx.IOther",{members:{bar:function(){return true;}}});var classDef={extend:Object,implement:qx.IAll,members:{sayJuhu:function(){}},statics:{sayHello:function(){return true;}},properties:{"color":{},"name":{}}};var def=qx.lang.Object.copy(classDef);qx.Class.define("qx.Implement1",def);this.assertTrue(qx.Class.implementsInterface(qx.Implement1,qx.IAll),"implements IAll");this.assertTrue(qx.Class.implementsInterface(qx.Implement1,qx.IMember),"implements IMember");this.assertTrue(qx.Class.implementsInterface(qx.Implement1,qx.IProperties),"implements IProperties");this.assertFalse(qx.Class.implementsInterface(qx.Implement1,qx.IOther),"not implements IOther");var def=qx.lang.Object.copy(classDef);delete (def.members);if(this.isDebugOn()){this.assertException(function(){qx.Class.define("qx.Implement2",def);},Error,"Implementation of method","No members defined.");}var def=qx.lang.Object.copy(classDef);delete (def.properties);if(this.isDebugOn()){this.assertException(function(){qx.Class.define("qx.Implement4",def);},Error,new RegExp("property .* is not supported"),"No properties defined.");}},testAbstractClass:function(){qx.Interface.define("qx.IJuhu",{members:{sayJuhu:function(){},sayKinners:function(){}}});qx.Class.define("qx.AbstractJuhu1",{extend:qx.core.Object,implement:qx.IJuhu,type:"abstract"});qx.Class.define("qx.AbstractJuhu2",{extend:qx.core.Object,implement:qx.IJuhu,type:"abstract",members:{sayJuhu:function(){return "Juhu";}}});if(this.isDebugOn()){this.assertException(function(){qx.Class.define("qx.Juhu1",{extend:qx.AbstractJuhu1,members:{sayJuhu:function(){return "Juhu";}}});},Error,'.*Implementation of method "sayKinners" is missing in class "qx.Juhu1" required by interface "qx.IJuhu"');}qx.Class.define("qx.Juhu1",{extend:qx.AbstractJuhu2,members:{sayKinners:function(){return "Kinners";}}});}}});qx.Class.define("qx.test.bom.Basic",{extend:qx.dev.unit.TestCase,members:{setUp:function(){var div=document.createElement("div");div.id="html_basics";div.innerHTML='<div id="test1" class="hello world" title="hello world title">'+' <input id="test2" name="foo2" type="text" maxlength="20" value="hello"/>'+'  <input tabindex="2" id="test3" type="checkbox" checked="true" name="foo3" value="bar"/>'+'  <input id="test4" type="text" disabled="disabled"/>'+'  <input id="test5" type="text" disabled="false" READONLY="true"/>'+'  <a id="test6" style="color:red;background:blue" href="../foo.html"><b>Foo</b>-Link</a>'+'  <table id="test7" valign="bottom"><tr><td colspan="3"></td></tr></table>'+'  <span id="test8">Black</span>'+'</div>';document.body.appendChild(div);},tearDown:function(){var div=document.getElementById("html_basics");document.body.removeChild(div);},testElementAttributes:function(){var attrib=qx.bom.element.Attribute;var style=qx.bom.element.Style;var opac=qx.bom.element.Opacity;var test1=document.getElementById("test1");this.assertEquals("hello world",attrib.get(test1,"class"));this.assertEquals("hello world title",attrib.get(test1,"title"));var test2=document.getElementById("test2");this.assertEquals("foo2",attrib.get(test2,"name"));this.assertEquals("hello",attrib.get(test2,"value"));this.assertEquals("text",attrib.get(test2,"type"));this.assertEquals(20,attrib.get(test2,"maxlength"));var test3=document.getElementById("test3");this.assertEquals("foo3",attrib.get(test3,"name"));this.assertEquals("bar",attrib.get(test3,"value"));this.assertEquals("checkbox",attrib.get(test3,"type"));this.assertEquals(true,attrib.get(test3,"checked"));this.assertEquals(false,attrib.get(test3,"disabled"));this.assertEquals(2,attrib.get(test3,"tabindex"));this.info("test4");this.assertEquals(true,attrib.get(document.getElementById("test4"),"disabled"));this.assertEquals(false,attrib.get(document.getElementById("test4"),"readonly"));this.info("test5");this.assertEquals(true,attrib.get(document.getElementById("test5"),"disabled"));this.assertEquals(true,attrib.get(document.getElementById("test5"),"readonly"));this.info("test6");this.assert(qx.lang.String.endsWith(attrib.get(document.getElementById("test6"),"href"),"/foo.html"));var test6Color=style.get(document.getElementById("test6"),"color");this.assertCssColor("red",test6Color);var test6BackgroundColor=style.get(document.getElementById("test6"),"backgroundColor");this.assertCssColor("blue",test6BackgroundColor);this.assertIdentical("",style.get(document.getElementById("test6"),"font",style.LOCAL_MODE));this.assertEquals("Foo-Link",attrib.get(document.getElementById("test6"),"text"));this.assertEquals("<b>foo</b>-link",attrib.get(document.getElementById("test6"),"html").toLowerCase());this.assertEquals(1,opac.get(document.getElementById("test6")));this.info("test7");this.assertEquals("bottom",attrib.get(document.getElementById("test7"),"valign"));this.assertEquals(3,attrib.get(document.getElementById("test7").getElementsByTagName("td")[0],"colspan"));this.info("test8");style.set(document.getElementById("test8"),"color","red");style.set(document.getElementById("test8"),"backgroundColor","black");opac.set(document.getElementById("test8"),0.5);var test8Color=style.get(document.getElementById("test8"),"color");this.assertCssColor("red",test8Color);var test8BackgroundColor=style.get(document.getElementById("test8"),"backgroundColor");this.assertCssColor("black",test8BackgroundColor);this.assertEquals(0.5,opac.get(document.getElementById("test8")));}}});qx.Class.define("qx.test.core.Property",{extend:qx.dev.unit.TestCase,members:{testInherited:function(){qx.Class.define("qx.Node",{extend:qx.core.Object,construct:function(){this._children=[];},properties:{parent:{apply:"applyParent"},color:{inheritable:true}},members:{applyParent:function(parent){parent._children.push(this);qx.core.Property.refresh(this);},getLayoutParent:function(){return this.getParent();},getChildren:function(){return this._children;}}});var root=new qx.Node();root.setColor("red");var child1=new qx.Node();var child2=new qx.Node();child2.setParent(child1);child1.setParent(root);this.debug("child2: "+child1.getColor());this.debug("child1: "+child2.getColor());this.debug("root: "+root.getColor());},testRecursive:function(){qx.Class.define("qx.Node",{extend:qx.core.Object,construct:function(){this._min=0;},properties:{value:{apply:"applyValue"}},members:{applyValue:function(value,old){if(value<this._min){this.setValue(this._min);}}}});var root=new qx.Node();root.setValue(100);this.assertEquals(100,root.getValue());root.setValue(-100);this.assertEquals(0,root.getValue());}}});qx.Class.define("qx.test.Mixin",{extend:qx.dev.unit.TestCase,members:{testMixinBasic:function(){qx.Mixin.define("qx.MMix1",{statics:{foo:function(){return "foo";}},members:{bar:function(){return "bar";}},properties:{color:{}}});qx.Mixin.define("qx.MMix2",{members:{bar:function(){return "bar";}}});qx.Class.define("qx.Mix",{extend:Object,include:qx.MMix1,construct:function(){}});this.assertEquals("foo",qx.MMix1.foo());this.assertEquals("bar",new qx.Mix().bar());var mix=new qx.Mix();mix.setColor("red");this.assertEquals("red",mix.getColor());if(this.isDebugOn()){this.assertException(function(){qx.Class.define("qx.Mix1",{extend:Object,include:[qx.MMix1,qx.MMix2],construct:function(){}});},Error,"Overwriting member","t1");this.assertException(function(){qx.Class.define("qx.Mix2",{extend:Object,include:qx.MMix1,construct:function(){},members:{bar:function(){return "bar";}}});},Error,"Overwriting member","t2");}qx.Class.define("qx.Mix3",{extend:Object,include:qx.MMix1,construct:function(){},statics:{foo:function(){return "foo";}}});if(this.isDebugOn()){this.assertException(function(){qx.Class.define("qx.Mix4",{extend:Object,include:qx.MMix1,construct:function(){},properties:{color:{}}});},Error,"already has a property","t3");}},testInclude:function(){qx.Mixin.define("qx.MLogger",{members:{log:function(msg){return msg;}}});qx.Class.define("qx.UseLog1",{extend:Object,construct:function(){}});qx.Class.include(qx.UseLog1,qx.MLogger);this.assertEquals("Juhu",new qx.UseLog1().log("Juhu"));qx.Class.define("qx.UseLog2",{extend:Object,construct:function(){},members:{log:function(){return "foo";}}});if(this.isDebugOn()){this.assertException(function(){qx.Class.include(qx.UseLog2,qx.MLogger);},Error,"Overwriting member");}qx.Class.define("qx.UseLog3",{extend:Object,construct:function(){},members:{log:function(){return "foo";}}});this.assertEquals("foo",new qx.UseLog3().log("Juhu"));qx.Class.patch(qx.UseLog3,qx.MLogger);this.assertEquals("Juhu",new qx.UseLog3().log("Juhu"));qx.Class.define("qx.ExtendUseLog1",{extend:qx.UseLog1});this.assertEquals("Juhu",new qx.ExtendUseLog1().log("Juhu"));},testPatchOverwritten:function(){qx.Class.define("qx.Patch1",{extend:qx.core.Object,members:{sayJuhu:function(){return "Juhu";},foo:function(){return "foo";}}});qx.Class.define("qx.Patch2",{extend:qx.core.Object,members:{sayJuhu:function(){return "Huhu";},foo:function(){return "bar";}}});qx.Mixin.define("qx.MPatch",{members:{sayJuhu:function(){return this.base(arguments)+" Kinners";},foo:function(dontRecurs){var s="";if(!dontRecurs){var b=new qx.Patch2();s+="++"+b.foo(true)+"__";}s+=this.base(arguments);return s;}}});if(this.isDebugOn()){this.assertException(function(){qx.Class.include(qx.Patch1,qx.MPatch);},Error,new RegExp('Overwriting member ".*" of Class ".*" is not allowed!'));}qx.Class.patch(qx.Patch1,qx.MPatch);qx.Class.patch(qx.Patch2,qx.MPatch);var o=new qx.Patch1();this.assertEquals("Juhu Kinners",o.sayJuhu());var o=new qx.Patch2();this.assertEquals("Huhu Kinners",o.sayJuhu());var o=new qx.Patch1();this.assertEquals("++bar__foo",o.foo());}}});qx.Class.define("qx.legacy.core.Property",{statics:{addFastProperty:function(config,proto){var vName=config.name;var vUpName=qx.lang.String.firstUp(vName);var vStorageField="_value"+vUpName;var vGetterName="get"+vUpName;var vSetterName="set"+vUpName;var vComputerName="_compute"+vUpName;proto[vStorageField]=typeof config.defaultValue!=="undefined"?config.defaultValue:null;if(!proto.hasOwnProperty(vGetterName)){if(config.noCompute){proto[vGetterName]=function(){return this[vStorageField];};}else{proto[vGetterName]=function(){return this[vStorageField]==null?this[vStorageField]=this[vComputerName]():this[vStorageField];};}proto[vGetterName].self=proto.constructor;}if(!proto.hasOwnProperty(vSetterName)){if(config.setOnlyOnce){proto[vSetterName]=function(vValue){this[vStorageField]=vValue;this[vSetterName]=null;return vValue;};}else{proto[vSetterName]=function(vValue){return this[vStorageField]=vValue;};}proto[vSetterName].self=proto.constructor;}if(!proto.hasOwnProperty(vComputerName)){if(!config.noCompute){proto[vComputerName]=function(){return null;};proto[vComputerName].self=proto.constructor;}}},addCachedProperty:function(config,proto){var vName=config.name;var vUpName=qx.lang.String.firstUp(vName);var vStorageField="_cached"+vUpName;var vComputerName="_compute"+vUpName;var vChangeName="_change"+vUpName;if(typeof config.defaultValue!=="undefined"){proto[vStorageField]=config.defaultValue;}if(!proto.hasOwnProperty("get"+vUpName)){proto["get"+vUpName]=function(){if(this[vStorageField]==null){this[vStorageField]=this[vComputerName]();}return this[vStorageField];};}if(!proto.hasOwnProperty("_invalidate"+vUpName)){proto["_invalidate"+vUpName]=function(){if(this[vStorageField]!=null){this[vStorageField]=null;if(config.addToQueueRuntime){this.addToQueueRuntime(config.name);}}};}if(!proto.hasOwnProperty("_recompute"+vUpName)){proto["_recompute"+vUpName]=function(){var vOld=this[vStorageField];var vNew=this[vComputerName]();if(vNew!=vOld){this[vStorageField]=vNew;this[vChangeName](vNew,vOld);return true;}return false;};}if(!proto.hasOwnProperty(vChangeName)){proto[vChangeName]=function(vNew,vOld){};}if(!proto.hasOwnProperty(vComputerName)){proto[vComputerName]=function(){return null;};}proto["get"+vUpName].self=proto.constructor;proto["_invalidate"+vUpName].self=proto.constructor;proto["_recompute"+vUpName].self=proto.constructor;}}});qx.Class.define("qx.legacy.ui.core.Widget",{extend:qx.core.Object,type:"abstract",include:[qx.locale.MTranslation],construct:function(){this.base(arguments);this._layoutChanges={};if(qx.core.Setting.get("qx.widgetDebugId")){this._generateHtmlId();}},events:{"beforeAppear":"qx.event.type.Event","appear":"qx.event.type.Event","beforeDisappear":"qx.event.type.Event","disappear":"qx.event.type.Event","beforeInsertDom":"qx.event.type.Event","insertDom":"qx.event.type.Event","beforeRemoveDom":"qx.event.type.Event","removeDom":"qx.event.type.Event","create":"qx.event.type.Event","execute":"qx.event.type.Event","mouseover":"qx.legacy.event.type.MouseEvent","mousemove":"qx.legacy.event.type.MouseEvent","mouseout":"qx.legacy.event.type.MouseEvent","mousedown":"qx.legacy.event.type.MouseEvent","mouseup":"qx.legacy.event.type.MouseEvent","mousewheel":"qx.legacy.event.type.MouseEvent","click":"qx.legacy.event.type.MouseEvent","dblclick":"qx.legacy.event.type.MouseEvent","contextmenu":"qx.legacy.event.type.MouseEvent","keydown":"qx.legacy.event.type.KeyEvent","keypress":"qx.legacy.event.type.KeyEvent","keyinput":"qx.legacy.event.type.KeyEvent","keyup":"qx.legacy.event.type.KeyEvent","focusout":"qx.legacy.event.type.FocusEvent","focusin":"qx.legacy.event.type.FocusEvent","blur":"qx.legacy.event.type.FocusEvent","focus":"qx.legacy.event.type.FocusEvent","dragdrop":"qx.legacy.event.type.DragEvent","dragout":"qx.legacy.event.type.DragEvent","dragover":"qx.legacy.event.type.DragEvent","dragmove":"qx.legacy.event.type.DragEvent","dragstart":"qx.legacy.event.type.DragEvent","dragend":"qx.legacy.event.type.DragEvent"},statics:{create:function(clazz,appearance){clazz._appearance=appearance;return new clazz;},SCROLLBAR_SIZE:null,$$uiReady:false,flushGlobalQueues:function(){if(qx.legacy.ui.core.Widget._inFlushGlobalQueues||!qx.legacy.ui.core.Widget.$$uiReady){return;}qx.legacy.ui.core.Widget._inFlushGlobalQueues=true;qx.legacy.ui.core.Widget.flushGlobalWidgetQueue();qx.legacy.ui.core.Widget.flushGlobalStateQueue();qx.legacy.ui.core.Widget.flushGlobalElementQueue();qx.legacy.ui.core.Widget.flushGlobalJobQueue();qx.legacy.ui.core.Widget.flushGlobalLayoutQueue();qx.legacy.ui.core.Widget.flushGlobalDisplayQueue();delete qx.legacy.ui.core.Widget._inFlushGlobalQueues;},_globalWidgetQueue:[],addToGlobalWidgetQueue:function(vWidget){if(!vWidget._isInGlobalWidgetQueue&&vWidget._isDisplayable){this.__autoFlush.schedule();qx.legacy.ui.core.Widget._globalWidgetQueue.push(vWidget);vWidget._isInGlobalWidgetQueue=true;}},removeFromGlobalWidgetQueue:function(vWidget){if(vWidget._isInGlobalWidgetQueue){qx.lang.Array.remove(qx.legacy.ui.core.Widget._globalWidgetQueue,vWidget);delete vWidget._isInGlobalWidgetQueue;}},flushGlobalWidgetQueue:function(){var vQueue=qx.legacy.ui.core.Widget._globalWidgetQueue,vLength,vWidget;while((vLength=vQueue.length)>0){for(var i=0;i<vLength;i++){vWidget=vQueue[i];vWidget.flushWidgetQueue();delete vWidget._isInGlobalWidgetQueue;}vQueue.splice(0,vLength);}},_globalElementQueue:[],addToGlobalElementQueue:function(vWidget){if(!vWidget._isInGlobalElementQueue&&vWidget._isDisplayable){this.__autoFlush.schedule();qx.legacy.ui.core.Widget._globalElementQueue.push(vWidget);vWidget._isInGlobalElementQueue=true;}},removeFromGlobalElementQueue:function(vWidget){if(vWidget._isInGlobalElementQueue){qx.lang.Array.remove(qx.legacy.ui.core.Widget._globalElementQueue,vWidget);delete vWidget._isInGlobalElementQueue;}},flushGlobalElementQueue:function(){var vQueue=qx.legacy.ui.core.Widget._globalElementQueue,vLength,vWidget;while((vLength=vQueue.length)>0){for(var i=0;i<vLength;i++){vWidget=vQueue[i];vWidget._createElementImpl();delete vWidget._isInGlobalElementQueue;}vQueue.splice(0,vLength);}},_globalStateQueue:[],addToGlobalStateQueue:function(vWidget){if(!vWidget._isInGlobalStateQueue&&vWidget._isDisplayable){this.__autoFlush.schedule();qx.legacy.ui.core.Widget._globalStateQueue.push(vWidget);vWidget._isInGlobalStateQueue=true;}},removeFromGlobalStateQueue:function(vWidget){if(vWidget._isInGlobalStateQueue){qx.lang.Array.remove(qx.legacy.ui.core.Widget._globalStateQueue,vWidget);delete vWidget._isInGlobalStateQueue;}},flushGlobalStateQueue:function(){var Widget=qx.legacy.ui.core.Widget;while(Widget._globalStateQueue.length>0){var queue=qx.lang.Array.copy(Widget._globalStateQueue);Widget._globalStateQueue=[];for(var i=0,l=queue.length;i<l;i++){var widget=queue[i];if(widget._isInGlobalStateQueue){widget._renderAppearance();delete widget._isInGlobalStateQueue;}}}},_globalJobQueue:[],addToGlobalJobQueue:function(vWidget){if(!vWidget._isInGlobalJobQueue&&vWidget._isDisplayable){this.__autoFlush.schedule();qx.legacy.ui.core.Widget._globalJobQueue.push(vWidget);vWidget._isInGlobalJobQueue=true;}},removeFromGlobalJobQueue:function(vWidget){if(vWidget._isInGlobalJobQueue){qx.lang.Array.remove(qx.legacy.ui.core.Widget._globalJobQueue,vWidget);delete vWidget._isInGlobalJobQueue;}},flushGlobalJobQueue:function(){var vQueue=qx.legacy.ui.core.Widget._globalJobQueue,vLength,vWidget;while((vLength=vQueue.length)>0){for(var i=0;i<vLength;i++){vWidget=vQueue[i];vWidget._flushJobQueue(vWidget._jobQueue);delete vWidget._isInGlobalJobQueue;}vQueue.splice(0,vLength);}},_globalLayoutQueue:[],addToGlobalLayoutQueue:function(vParent){if(!vParent._isInGlobalLayoutQueue&&vParent._isDisplayable){this.__autoFlush.schedule();qx.legacy.ui.core.Widget._globalLayoutQueue.push(vParent);vParent._isInGlobalLayoutQueue=true;}},removeFromGlobalLayoutQueue:function(vParent){if(vParent._isInGlobalLayoutQueue){qx.lang.Array.remove(qx.legacy.ui.core.Widget._globalLayoutQueue,vParent);delete vParent._isInGlobalLayoutQueue;}},flushGlobalLayoutQueue:function(){var vQueue=qx.legacy.ui.core.Widget._globalLayoutQueue,vLength,vParent;while((vLength=vQueue.length)>0){for(var i=0;i<vLength;i++){vParent=vQueue[i];vParent._flushChildrenQueue();delete vParent._isInGlobalLayoutQueue;}vQueue.splice(0,vLength);}},_fastGlobalDisplayQueue:[],_lazyGlobalDisplayQueues:{},addToGlobalDisplayQueue:function(vWidget){if(!vWidget._isInGlobalDisplayQueue&&vWidget._isDisplayable){this.__autoFlush.schedule();var vParent=vWidget.getParent();if(vParent.isSeeable()){var vKey=vParent.toHashCode();if(qx.legacy.ui.core.Widget._lazyGlobalDisplayQueues[vKey]){qx.legacy.ui.core.Widget._lazyGlobalDisplayQueues[vKey].push(vWidget);}else{qx.legacy.ui.core.Widget._lazyGlobalDisplayQueues[vKey]=[vWidget];}}else{qx.legacy.ui.core.Widget._fastGlobalDisplayQueue.push(vWidget);}vWidget._isInGlobalDisplayQueue=true;}},removeFromGlobalDisplayQueue:function(vWidget){},flushGlobalDisplayQueue:function(){var vKey,vLazyQueue,vWidget,vFragment;var vFastQueue=qx.legacy.ui.core.Widget._fastGlobalDisplayQueue;var vLazyQueues=qx.legacy.ui.core.Widget._lazyGlobalDisplayQueues;for(var i=0,l=vFastQueue.length;i<l;i++){vWidget=vFastQueue[i];vWidget.getParent()._getTargetNode().appendChild(vWidget.getElement());}if(qx.Class.isDefined("qx.legacy.ui.basic.Inline")){for(vKey in vLazyQueues){vLazyQueue=vLazyQueues[vKey];for(var i=0;i<vLazyQueue.length;i++){vWidget=vLazyQueue[i];if(vWidget instanceof qx.legacy.ui.basic.Inline){vWidget._beforeInsertDom();try{document.getElementById(vWidget.getInlineNodeId()).appendChild(vWidget.getElement());}catch(ex){vWidget.debug("Could not append to inline id: "+vWidget.getInlineNodeId(),ex);}vWidget._afterInsertDom();vWidget._afterAppear();qx.lang.Array.remove(vLazyQueue,vWidget);i--;delete vWidget._isInGlobalDisplayQueue;}}}}for(vKey in vLazyQueues){vLazyQueue=vLazyQueues[vKey];if(document.createDocumentFragment&&vLazyQueue.length>=3){vFragment=document.createDocumentFragment();for(var i=0,l=vLazyQueue.length;i<l;i++){vWidget=vLazyQueue[i];vWidget._beforeInsertDom();vFragment.appendChild(vWidget.getElement());}vLazyQueue[0].getParent()._getTargetNode().appendChild(vFragment);for(var i=0,l=vLazyQueue.length;i<l;i++){vWidget=vLazyQueue[i];vWidget._afterInsertDom();}}else{for(var i=0,l=vLazyQueue.length;i<l;i++){vWidget=vLazyQueue[i];vWidget._beforeInsertDom();vWidget.getParent()._getTargetNode().appendChild(vWidget.getElement());vWidget._afterInsertDom();}}}for(vKey in vLazyQueues){vLazyQueue=vLazyQueues[vKey];for(var i=0,l=vLazyQueue.length;i<l;i++){vWidget=vLazyQueue[i];if(vWidget.getVisibility()){vWidget._afterAppear();}delete vWidget._isInGlobalDisplayQueue;}delete vLazyQueues[vKey];}for(var i=0,l=vFastQueue.length;i<l;i++){delete vFastQueue[i]._isInGlobalDisplayQueue;}qx.lang.Array.removeAll(vFastQueue);},getActiveSiblingHelperIgnore:function(vIgnoreClasses,vInstance){for(var j=0;j<vIgnoreClasses.length;j++){if(vInstance instanceof vIgnoreClasses[j]){return true;}}return false;},getActiveSiblingHelper:function(vObject,vParent,vCalc,vIgnoreClasses,vMode){if(!vIgnoreClasses){vIgnoreClasses=[];}var vChilds=vParent.getChildren();var vPosition=vMode==null?vChilds.indexOf(vObject)+vCalc:vMode==="first"?0:vChilds.length-1;var vInstance=vChilds[vPosition];while(vInstance&&(!vInstance.getEnabled()||qx.legacy.ui.core.Widget.getActiveSiblingHelperIgnore(vIgnoreClasses,vInstance))){vPosition+=vCalc;vInstance=vChilds[vPosition];if(!vInstance){return null;}}return vInstance;},__initApplyMethods:function(members){var applyRuntime="_renderRuntime";var resetRuntime="_resetRuntime";var style="this._style.";var cssValue="=((v==null)?0:v)+'px'";var parameter="v";var properties=["left","right","top","bottom","width","height","minWidth","maxWidth","minHeight","maxHeight"];var propertiesUpper=["Left","Right","Top","Bottom","Width","Height","MinWidth","MaxWidth","MinHeight","MaxHeight"];var applyMargin=applyRuntime+"Margin";var resetMargin=resetRuntime+"Margin";var styleMargin=style+"margin";for(var i=0;i<4;i++){members[applyMargin+propertiesUpper[i]]=new Function(parameter,styleMargin+propertiesUpper[i]+cssValue);members[resetMargin+propertiesUpper[i]]=new Function(styleMargin+propertiesUpper[i]+"=''");}var applyPadding=applyRuntime+"Padding";var resetPadding=resetRuntime+"Padding";var stylePadding=style+"padding";if(qx.core.Variant.isSet("qx.client","gecko")){for(var i=0;i<4;i++){members[applyPadding+propertiesUpper[i]]=new Function(parameter,stylePadding+propertiesUpper[i]+cssValue);members[resetPadding+propertiesUpper[i]]=new Function(stylePadding+propertiesUpper[i]+"=''");}}else{for(var i=0;i<4;i++){members[applyPadding+propertiesUpper[i]]=new Function(parameter,"this.setStyleProperty('padding"+propertiesUpper[i]+"', ((v==null)?0:v)+'px')");members[resetPadding+propertiesUpper[i]]=new Function("this.removeStyleProperty('padding"+propertiesUpper[i]+"')");}}for(var i=0;i<properties.length;i++){members[applyRuntime+propertiesUpper[i]]=new Function(parameter,style+properties[i]+cssValue);members[resetRuntime+propertiesUpper[i]]=new Function(style+properties[i]+"=''");}},TYPE_NULL:0,TYPE_PIXEL:1,TYPE_PERCENT:2,TYPE_AUTO:3,TYPE_FLEX:4,layoutPropertyTypes:{},__initLayoutProperties:function(statics){var a=["width","height","minWidth","maxWidth","minHeight","maxHeight","left","right","top","bottom"];for(var i=0,l=a.length,p,b,t;i<l;i++){p=a[i];b="_computed"+qx.lang.String.firstUp(p);t=b+"Type";statics.layoutPropertyTypes[p]={dataType:t,dataParsed:b+"Parsed",dataValue:b+"Value",typePixel:t+"Pixel",typePercent:t+"Percent",typeAuto:t+"Auto",typeFlex:t+"Flex",typeNull:t+"Null"};}},initScrollbarWidth:function(){var t=document.createElement("div");var s=t.style;s.height=s.width="100px";s.overflow="scroll";document.body.appendChild(t);var c=qx.legacy.html.Dimension.getScrollBarSizeRight(t);qx.legacy.ui.core.Widget.SCROLLBAR_SIZE=c?c:16;document.body.removeChild(t);},_idCounter:0},properties:{enabled:{init:true,check:"Boolean",inheritable:true,apply:"_applyEnabled",event:"changeEnabled"},parent:{check:"qx.legacy.ui.core.Parent",nullable:true,event:"changeParent",apply:"_applyParent"},element:{check:"Element",nullable:true,apply:"_applyElement",event:"changeElement"},visibility:{check:"Boolean",init:true,apply:"_applyVisibility",event:"changeVisibility"},display:{check:"Boolean",init:true,apply:"_applyDisplay",event:"changeDisplay"},anonymous:{check:"Boolean",init:false,event:"changeAnonymous"},horizontalAlign:{check:["left","center","right"],themeable:true,nullable:true},verticalAlign:{check:["top","middle","bottom"],themeable:true,nullable:true},allowStretchX:{check:"Boolean",init:true},allowStretchY:{check:"Boolean",init:true},zIndex:{check:"Number",apply:"_applyZIndex",event:"changeZIndex",themeable:true,nullable:true,init:null},backgroundColor:{nullable:true,init:null,apply:"_applyBackgroundColor",event:"changeBackgroundColor",themeable:true},textColor:{nullable:true,apply:"_applyTextColor",event:"changeTextColor",themeable:true,inheritable:true},border:{nullable:true,init:null,apply:"_applyBorder",event:"changeBorder",themeable:true},font:{nullable:true,apply:"_applyFont",event:"changeFont",themeable:true,inheritable:true},opacity:{check:"Number",apply:"_applyOpacity",themeable:true,nullable:true,init:null},cursor:{check:"String",apply:"_applyCursor",themeable:true,nullable:true,init:null},backgroundImage:{check:"String",nullable:true,apply:"_applyBackgroundImage",themeable:true},overflow:{check:["hidden","auto","scroll","scrollX","scrollY"],nullable:true,apply:"_applyOverflow",event:"changeOverflow",themeable:true,init:null},clipLeft:{check:"Integer",apply:"_applyClip",themeable:true,nullable:true},clipTop:{check:"Integer",apply:"_applyClip",themeable:true,nullable:true},clipWidth:{check:"Integer",apply:"_applyClip",themeable:true,nullable:true},clipHeight:{check:"Integer",apply:"_applyClip",themeable:true,nullable:true},tabIndex:{check:"Integer",nullable:true,init:null,apply:"_applyTabIndex",event:"changeTabIndex"},hideFocus:{check:"Boolean",init:false,apply:"_applyHideFocus",themeable:true},enableElementFocus:{check:"Boolean",init:true},focused:{check:"Boolean",init:false,apply:"_applyFocused",event:"changeFocused"},selectable:{check:"Boolean",init:null,nullable:true,apply:"_applySelectable"},toolTip:{check:"qx.legacy.ui.popup.ToolTip",nullable:true},contextMenu:{check:"qx.legacy.ui.menu.Menu",nullable:true},capture:{check:"Boolean",init:false,apply:"_applyCapture",event:"changeCapture"},dropDataTypes:{nullable:true,dispose:true},command:{check:"qx.event.Command",nullable:true,apply:"_applyCommand"},appearance:{check:"String",init:"widget",apply:"_applyAppearance",event:"changeAppearance"},supportsDropMethod:{check:"Function",nullable:true,init:null},marginTop:{check:"Number",apply:"_applyMarginTop",nullable:true,themeable:true},marginRight:{check:"Number",apply:"_applyMarginRight",nullable:true,themeable:true},marginBottom:{check:"Number",apply:"_applyMarginBottom",nullable:true,themeable:true},marginLeft:{check:"Number",apply:"_applyMarginLeft",nullable:true,themeable:true},paddingTop:{check:"Number",apply:"_applyPaddingTop",nullable:true,themeable:true},paddingRight:{check:"Number",apply:"_applyPaddingRight",nullable:true,themeable:true},paddingBottom:{check:"Number",apply:"_applyPaddingBottom",nullable:true,themeable:true},paddingLeft:{check:"Number",apply:"_applyPaddingLeft",nullable:true,themeable:true},left:{apply:"_applyLeft",event:"changeLeft",nullable:true,themeable:true,init:null},right:{apply:"_applyRight",event:"changeRight",nullable:true,themeable:true,init:null},width:{apply:"_applyWidth",event:"changeWidth",nullable:true,themeable:true,init:null},minWidth:{apply:"_applyMinWidth",event:"changeMinWidth",nullable:true,themeable:true,init:null},maxWidth:{apply:"_applyMaxWidth",event:"changeMaxWidth",nullable:true,themeable:true,init:null},top:{apply:"_applyTop",event:"changeTop",nullable:true,themeable:true,init:null},bottom:{apply:"_applyBottom",event:"changeBottom",nullable:true,themeable:true,init:null},height:{apply:"_applyHeight",event:"changeHeight",nullable:true,themeable:true,init:null},minHeight:{apply:"_applyMinHeight",event:"changeMinHeight",nullable:true,themeable:true,init:null},maxHeight:{apply:"_applyMaxHeight",event:"changeMaxHeight",nullable:true,themeable:true,init:null},location:{group:["left","top"],themeable:true},dimension:{group:["width","height"],themeable:true},space:{group:["left","width","top","height"],themeable:true},edge:{group:["top","right","bottom","left"],themeable:true,mode:"shorthand"},padding:{group:["paddingTop","paddingRight","paddingBottom","paddingLeft"],mode:"shorthand",themeable:true},margin:{group:["marginTop","marginRight","marginBottom","marginLeft"],mode:"shorthand",themeable:true},heights:{group:["minHeight","height","maxHeight"],themeable:true},widths:{group:["minWidth","width","maxWidth"],themeable:true},align:{group:["horizontalAlign","verticalAlign"],themeable:true},clipLocation:{group:["clipLeft","clipTop"]},clipDimension:{group:["clipWidth","clipHeight"]},clip:{group:["clipLeft","clipTop","clipWidth","clipHeight"]}},members:{_computedLeftValue:null,_computedLeftParsed:null,_computedLeftType:null,_computedLeftTypeNull:true,_computedLeftTypePixel:false,_computedLeftTypePercent:false,_computedLeftTypeAuto:false,_computedLeftTypeFlex:false,_computedRightValue:null,_computedRightParsed:null,_computedRightType:null,_computedRightTypeNull:true,_computedRightTypePixel:false,_computedRightTypePercent:false,_computedRightTypeAuto:false,_computedRightTypeFlex:false,_computedTopValue:null,_computedTopParsed:null,_computedTopType:null,_computedTopTypeNull:true,_computedTopTypePixel:false,_computedTopTypePercent:false,_computedTopTypeAuto:false,_computedTopTypeFlex:false,_computedBottomValue:null,_computedBottomParsed:null,_computedBottomType:null,_computedBottomTypeNull:true,_computedBottomTypePixel:false,_computedBottomTypePercent:false,_computedBottomTypeAuto:false,_computedBottomTypeFlex:false,_computedWidthValue:null,_computedWidthParsed:null,_computedWidthType:null,_computedWidthTypeNull:true,_computedWidthTypePixel:false,_computedWidthTypePercent:false,_computedWidthTypeAuto:false,_computedWidthTypeFlex:false,_computedMinWidthValue:null,_computedMinWidthParsed:null,_computedMinWidthType:null,_computedMinWidthTypeNull:true,_computedMinWidthTypePixel:false,_computedMinWidthTypePercent:false,_computedMinWidthTypeAuto:false,_computedMinWidthTypeFlex:false,_computedMaxWidthValue:null,_computedMaxWidthParsed:null,_computedMaxWidthType:null,_computedMaxWidthTypeNull:true,_computedMaxWidthTypePixel:false,_computedMaxWidthTypePercent:false,_computedMaxWidthTypeAuto:false,_computedMaxWidthTypeFlex:false,_computedHeightValue:null,_computedHeightParsed:null,_computedHeightType:null,_computedHeightTypeNull:true,_computedHeightTypePixel:false,_computedHeightTypePercent:false,_computedHeightTypeAuto:false,_computedHeightTypeFlex:false,_computedMinHeightValue:null,_computedMinHeightParsed:null,_computedMinHeightType:null,_computedMinHeightTypeNull:true,_computedMinHeightTypePixel:false,_computedMinHeightTypePercent:false,_computedMinHeightTypeAuto:false,_computedMinHeightTypeFlex:false,_computedMaxHeightValue:null,_computedMaxHeightParsed:null,_computedMaxHeightType:null,_computedMaxHeightTypeNull:true,_computedMaxHeightTypePixel:false,_computedMaxHeightTypePercent:false,_computedMaxHeightTypeAuto:false,_computedMaxHeightTypeFlex:false,_applyLeft:function(value,old){this._unitDetectionPixelPercent("left",value);this.addToQueue("left");},_applyRight:function(value,old){this._unitDetectionPixelPercent("right",value);this.addToQueue("right");},_applyTop:function(value,old){this._unitDetectionPixelPercent("top",value);this.addToQueue("top");},_applyBottom:function(value,old){this._unitDetectionPixelPercent("bottom",value);this.addToQueue("bottom");},_applyWidth:function(value,old){this._unitDetectionPixelPercentAutoFlex("width",value);this.addToQueue("width");},_applyMinWidth:function(value,old){this._unitDetectionPixelPercentAuto("minWidth",value);this.addToQueue("minWidth");},_applyMaxWidth:function(value,old){this._unitDetectionPixelPercentAuto("maxWidth",value);this.addToQueue("maxWidth");},_applyHeight:function(value,old){this._unitDetectionPixelPercentAutoFlex("height",value);this.addToQueue("height");},_applyMinHeight:function(value,old){this._unitDetectionPixelPercentAuto("minHeight",value);this.addToQueue("minHeight");},_applyMaxHeight:function(value,old){this._unitDetectionPixelPercentAuto("maxHeight",value);this.addToQueue("maxHeight");},isMaterialized:function(){var elem=this._element;return (this._initialLayoutDone&&this._isDisplayable&&qx.legacy.html.Style.getStyleProperty(elem,"display")!="none"&&qx.legacy.html.Style.getStyleProperty(elem,"visibility")!="hidden"&&elem.offsetWidth>0&&elem.offsetHeight>0);},pack:function(){this.setWidth(this.getPreferredBoxWidth());this.setHeight(this.getPreferredBoxHeight());},auto:function(){this.setWidth("auto");this.setHeight("auto");},getChildren:qx.lang.Function.returnNull,_getChildren:function(){return this.getChildren();},getLayoutParent:function(){return this.getParent();},getChildrenLength:qx.lang.Function.returnZero,hasChildren:qx.lang.Function.returnFalse,isEmpty:qx.lang.Function.returnTrue,indexOf:function(){return -1;},contains:qx.lang.Function.returnFalse,getVisibleChildren:qx.lang.Function.returnNull,getVisibleChildrenLength:qx.lang.Function.returnZero,hasVisibleChildren:qx.lang.Function.returnFalse,isVisibleEmpty:qx.lang.Function.returnTrue,_hasParent:false,_isDisplayable:false,isDisplayable:function(){return this._isDisplayable;},_checkParent:function(value,old){if(this.contains(value)){throw new Error("Could not insert myself into a child "+value+"!");}return value;},_applyParent:function(value,old){if(old){var vOldIndex=old.getChildren().indexOf(this);this._computedWidthValue=this._computedMinWidthValue=this._computedMaxWidthValue=this._computedLeftValue=this._computedRightValue=null;this._computedHeightValue=this._computedMinHeightValue=this._computedMaxHeightValue=this._computedTopValue=this._computedBottomValue=null;this._cachedBoxWidth=this._cachedInnerWidth=this._cachedOuterWidth=null;this._cachedBoxHeight=this._cachedInnerHeight=this._cachedOuterHeight=null;qx.lang.Array.removeAt(old.getChildren(),vOldIndex);old._invalidateVisibleChildren();old._removeChildFromChildrenQueue(this);old.getLayoutImpl().updateChildrenOnRemoveChild(this,vOldIndex);old.addToJobQueue("removeChild");old._invalidatePreferredInnerDimensions();this._oldParent=old;}if(value){this._hasParent=true;if(typeof this._insertIndex=="number"){qx.lang.Array.insertAt(value.getChildren(),this,this._insertIndex);delete this._insertIndex;}else{value.getChildren().push(this);}}else{this._hasParent=false;}qx.core.Property.refresh(this);return this._handleDisplayable("parent");},_applyDisplay:function(value,old){return this._handleDisplayable("display");},_handleDisplayable:function(vHint){var vDisplayable=this._computeDisplayable();if(this._isDisplayable==vDisplayable&&!(vDisplayable&&vHint=="parent")){return true;}this._isDisplayable=vDisplayable;var vParent=this.getParent();if(vParent){vParent._invalidateVisibleChildren();vParent._invalidatePreferredInnerDimensions();}if(vHint&&this._oldParent&&this._oldParent._initialLayoutDone){var elem=this.getElement();if(elem){if(this.getVisibility()){this._beforeDisappear();}this._beforeRemoveDom();try{this._oldParent._getTargetNode().removeChild(elem);}catch(e){}this._afterRemoveDom();if(this.getVisibility()){this._afterDisappear();}}delete this._oldParent;}if(vDisplayable){if(vParent._initialLayoutDone){vParent.getLayoutImpl().updateChildrenOnAddChild(this,vParent.getChildren().indexOf(this));vParent.addToJobQueue("addChild");}this.addToLayoutChanges("initial");this.addToCustomQueues(vHint);if(this.getVisibility()){this._beforeAppear();}if(!this._isCreated){qx.legacy.ui.core.Widget.addToGlobalElementQueue(this);}qx.legacy.ui.core.Widget.addToGlobalStateQueue(this);if(!qx.lang.Object.isEmpty(this._jobQueue)){qx.legacy.ui.core.Widget.addToGlobalJobQueue(this);}if(!qx.lang.Object.isEmpty(this._childrenQueue)){qx.legacy.ui.core.Widget.addToGlobalLayoutQueue(this);}}else{qx.legacy.ui.core.Widget.removeFromGlobalElementQueue(this);qx.legacy.ui.core.Widget.removeFromGlobalStateQueue(this);qx.legacy.ui.core.Widget.removeFromGlobalJobQueue(this);qx.legacy.ui.core.Widget.removeFromGlobalLayoutQueue(this);this.removeFromCustomQueues(vHint);if(vParent&&vHint){if(this.getVisibility()){this._beforeDisappear();}if(vParent._initialLayoutDone&&this._initialLayoutDone){vParent.getLayoutImpl().updateChildrenOnRemoveChild(this,vParent.getChildren().indexOf(this));vParent.addToJobQueue("removeChild");this._beforeRemoveDom();var parentNode=this.getElement().parentNode;if(parentNode){parentNode.removeChild(this.getElement());if(parentNode&&parentNode!==vParent._getTargetNode()){this.warn("Unexpected parent node: "+parentNode);}}this._afterRemoveDom();}vParent._removeChildFromChildrenQueue(this);if(this.getVisibility()){this._afterDisappear();}}}this._handleDisplayableCustom(vDisplayable,vParent,vHint);return true;},addToCustomQueues:qx.lang.Function.returnTrue,removeFromCustomQueues:qx.lang.Function.returnTrue,_handleDisplayableCustom:qx.lang.Function.returnTrue,_computeDisplayable:function(){return this.getDisplay()&&this.getParent()&&this.getParent()._isDisplayable?true:false;},_beforeAppear:function(){this.fireEvent("beforeAppear");},_afterAppear:function(){this._isSeeable=true;this.fireEvent("appear");},_beforeDisappear:function(){this.removeState("over");if(qx.Class.isDefined("qx.legacy.ui.form.Button")){this.removeState("pressed");this.removeState("abandoned");}this.fireEvent("beforeDisappear");},_afterDisappear:function(){this._isSeeable=false;this.fireEvent("disappear");},_isSeeable:false,isSeeable:function(){return this._isSeeable;},isAppearRelevant:function(){return this.getVisibility()&&this._isDisplayable;},_beforeInsertDom:function(){this.fireEvent("beforeInsertDom");},_afterInsertDom:function(){this.fireEvent("insertDom");},_beforeRemoveDom:function(){this.fireEvent("beforeRemoveDom");},_afterRemoveDom:function(){this.fireEvent("removeDom");},_applyVisibility:function(value,old){if(value){if(this._isDisplayable){this._beforeAppear();}this.removeStyleProperty("display");if(this._isDisplayable){this._afterAppear();}}else{if(this._isDisplayable){this._beforeDisappear();}this.setStyleProperty("display","none");if(this._isDisplayable){this._afterDisappear();}}},show:function(){this.setVisibility(true);this.setDisplay(true);},hide:function(){this.setVisibility(false);},connect:function(){this.setDisplay(true);},disconnect:function(){this.setDisplay(false);},_isCreated:false,_getTargetNode:qx.core.Variant.select("qx.client",{"gecko":function(){return this._element;},"default":function(){return this._borderElement||this._element;}}),addToDocument:function(){qx.legacy.ui.core.ClientDocument.getInstance().add(this);},isCreated:function(){return this._isCreated;},_createElementImpl:function(){this.setElement(this.getTopLevelWidget().getDocumentElement().createElement("div"));},_applyElement:function(value,old){this._isCreated=value!=null;if(old){old.qx_Widget=null;}if(value){value.qx_Widget=this;value.style.position="absolute";this._element=value;this._style=value.style;this._applyStyleProperties(value);this._applyHtmlProperties(value);this._applyHtmlAttributes(value);this._applyElementData(value);this.fireEvent("create");this.addToStateQueue();}else{this._element=this._style=null;}},addToJobQueue:function(p){if(this._hasParent){qx.legacy.ui.core.Widget.addToGlobalJobQueue(this);}if(!this._jobQueue){this._jobQueue={};}this._jobQueue[p]=true;return true;},_flushJobQueue:function(q){try{var vQueue=this._jobQueue;var vParent=this.getParent();if(!vParent||qx.lang.Object.isEmpty(vQueue)){return;}var vLayoutImpl=this instanceof qx.legacy.ui.core.Parent?this.getLayoutImpl():null;if(vLayoutImpl){vLayoutImpl.updateSelfOnJobQueueFlush(vQueue);}}catch(ex){this.error("Flushing job queue (prechecks#1) failed",ex);}try{var vFlushParentJobQueue=false;var vRecomputeOuterWidth=vQueue.marginLeft||vQueue.marginRight;var vRecomputeOuterHeight=vQueue.marginTop||vQueue.marginBottom;var vRecomputeInnerWidth=vQueue.frameWidth;var vRecomputeInnerHeight=vQueue.frameHeight;var vRecomputeParentPreferredInnerWidth=(vQueue.frameWidth||vQueue.preferredInnerWidth)&&this._recomputePreferredBoxWidth();var vRecomputeParentPreferredInnerHeight=(vQueue.frameHeight||vQueue.preferredInnerHeight)&&this._recomputePreferredBoxHeight();if(vRecomputeParentPreferredInnerWidth){var vPref=this.getPreferredBoxWidth();if(this._computedWidthTypeAuto){this._computedWidthValue=vPref;vQueue.width=true;}if(this._computedMinWidthTypeAuto){this._computedMinWidthValue=vPref;vQueue.minWidth=true;}if(this._computedMaxWidthTypeAuto){this._computedMaxWidthValue=vPref;vQueue.maxWidth=true;}}if(vRecomputeParentPreferredInnerHeight){var vPref=this.getPreferredBoxHeight();if(this._computedHeightTypeAuto){this._computedHeightValue=vPref;vQueue.height=true;}if(this._computedMinHeightTypeAuto){this._computedMinHeightValue=vPref;vQueue.minHeight=true;}if(this._computedMaxHeightTypeAuto){this._computedMaxHeightValue=vPref;vQueue.maxHeight=true;}}if((vQueue.width||vQueue.minWidth||vQueue.maxWidth||vQueue.left||vQueue.right)&&this._recomputeBoxWidth()){vRecomputeOuterWidth=vRecomputeInnerWidth=true;}if((vQueue.height||vQueue.minHeight||vQueue.maxHeight||vQueue.top||vQueue.bottom)&&this._recomputeBoxHeight()){vRecomputeOuterHeight=vRecomputeInnerHeight=true;}}catch(ex){this.error("Flushing job queue (recompute#2) failed",ex);}try{if((vRecomputeOuterWidth&&this._recomputeOuterWidth())||vRecomputeParentPreferredInnerWidth){vParent._invalidatePreferredInnerWidth();vParent.getLayoutImpl().updateSelfOnChildOuterWidthChange(this);vFlushParentJobQueue=true;}if((vRecomputeOuterHeight&&this._recomputeOuterHeight())||vRecomputeParentPreferredInnerHeight){vParent._invalidatePreferredInnerHeight();vParent.getLayoutImpl().updateSelfOnChildOuterHeightChange(this);vFlushParentJobQueue=true;}if(vFlushParentJobQueue){vParent._flushJobQueue();}}catch(ex){this.error("Flushing job queue (parentsignals#3) failed",ex);}try{vParent._addChildToChildrenQueue(this);for(var i in vQueue){this._layoutChanges[i]=true;}}catch(ex){this.error("Flushing job queue (addjobs#4) failed",ex);}try{if(this instanceof qx.legacy.ui.core.Parent&&(vQueue.paddingLeft||vQueue.paddingRight||vQueue.paddingTop||vQueue.paddingBottom)){var ch=this.getChildren(),chl=ch.length;if(vQueue.paddingLeft){for(var i=0;i<chl;i++){ch[i].addToLayoutChanges("parentPaddingLeft");}}if(vQueue.paddingRight){for(var i=0;i<chl;i++){ch[i].addToLayoutChanges("parentPaddingRight");}}if(vQueue.paddingTop){for(var i=0;i<chl;i++){ch[i].addToLayoutChanges("parentPaddingTop");}}if(vQueue.paddingBottom){for(var i=0;i<chl;i++){ch[i].addToLayoutChanges("parentPaddingBottom");}}}if(vRecomputeInnerWidth){this._recomputeInnerWidth();}if(vRecomputeInnerHeight){this._recomputeInnerHeight();}if(this._initialLayoutDone){if(vLayoutImpl){vLayoutImpl.updateChildrenOnJobQueueFlush(vQueue);}}}catch(ex){this.error("Flushing job queue (childrensignals#5) failed",ex);}delete this._jobQueue;},_isWidthEssential:qx.lang.Function.returnTrue,_isHeightEssential:qx.lang.Function.returnTrue,_computeBoxWidthFallback:function(){return 0;},_computeBoxHeightFallback:function(){return 0;},_computeBoxWidth:function(){var vLayoutImpl=this.getParent().getLayoutImpl();return Math.max(0,qx.lang.Number.limit(vLayoutImpl.computeChildBoxWidth(this),this.getMinWidthValue(),this.getMaxWidthValue()));},_computeBoxHeight:function(){var vLayoutImpl=this.getParent().getLayoutImpl();return Math.max(0,qx.lang.Number.limit(vLayoutImpl.computeChildBoxHeight(this),this.getMinHeightValue(),this.getMaxHeightValue()));},_computeOuterWidth:function(){return Math.max(0,(this.getMarginLeft()+this.getBoxWidth()+this.getMarginRight()));},_computeOuterHeight:function(){return Math.max(0,(this.getMarginTop()+this.getBoxHeight()+this.getMarginBottom()));},_computeInnerWidth:function(){return Math.max(0,this.getBoxWidth()-this.getFrameWidth());},_computeInnerHeight:function(){return Math.max(0,this.getBoxHeight()-this.getFrameHeight());},getNeededWidth:function(){var vLayoutImpl=this.getParent().getLayoutImpl();return Math.max(0,vLayoutImpl.computeChildNeededWidth(this));},getNeededHeight:function(){var vLayoutImpl=this.getParent().getLayoutImpl();return Math.max(0,vLayoutImpl.computeChildNeededHeight(this));},_recomputeFlexX:function(){if(!this.getHasFlexX()){return false;}if(this._computedWidthTypeFlex){this._computedWidthValue=null;this.addToLayoutChanges("width");}return true;},_recomputeFlexY:function(){if(!this.getHasFlexY()){return false;}if(this._computedHeightTypeFlex){this._computedHeightValue=null;this.addToLayoutChanges("height");}return true;},_recomputePercentX:function(){if(!this.getHasPercentX()){return false;}if(this._computedWidthTypePercent){this._computedWidthValue=null;this.addToLayoutChanges("width");}if(this._computedMinWidthTypePercent){this._computedMinWidthValue=null;this.addToLayoutChanges("minWidth");}if(this._computedMaxWidthTypePercent){this._computedMaxWidthValue=null;this.addToLayoutChanges("maxWidth");}if(this._computedLeftTypePercent){this._computedLeftValue=null;this.addToLayoutChanges("left");}if(this._computedRightTypePercent){this._computedRightValue=null;this.addToLayoutChanges("right");}return true;},_recomputePercentY:function(){if(!this.getHasPercentY()){return false;}if(this._computedHeightTypePercent){this._computedHeightValue=null;this.addToLayoutChanges("height");}if(this._computedMinHeightTypePercent){this._computedMinHeightValue=null;this.addToLayoutChanges("minHeight");}if(this._computedMaxHeightTypePercent){this._computedMaxHeightValue=null;this.addToLayoutChanges("maxHeight");}if(this._computedTopTypePercent){this._computedTopValue=null;this.addToLayoutChanges("top");}if(this._computedBottomTypePercent){this._computedBottomValue=null;this.addToLayoutChanges("bottom");}return true;},_recomputeRangeX:qx.core.Variant.select("qx.client",{"mshtml|opera|webkit":function(){if(this._computedLeftTypeNull||this._computedRightTypeNull){return false;}this.addToLayoutChanges("width");return true;},"default":function(){return !(this._computedLeftTypeNull||this._computedRightTypeNull);}}),_recomputeRangeY:qx.core.Variant.select("qx.client",{"mshtml|opera|webkit":function(){if(this._computedTopTypeNull||this._computedBottomTypeNull){return false;}this.addToLayoutChanges("height");return true;},"default":function(){return !(this._computedTopTypeNull||this._computedBottomTypeNull);}}),_recomputeStretchingX:qx.core.Variant.select("qx.client",{"mshtml|opera|webkit":function(){if(this.getAllowStretchX()&&this._computedWidthTypeNull){this._computedWidthValue=null;this.addToLayoutChanges("width");return true;}return false;},"default":function(){if(this.getAllowStretchX()&&this._computedWidthTypeNull){return true;}return false;}}),_recomputeStretchingY:qx.core.Variant.select("qx.client",{"mshtml|opera|webkit":function(){if(this.getAllowStretchY()&&this._computedHeightTypeNull){this._computedHeightValue=null;this.addToLayoutChanges("height");return true;}return false;},"default":function(){if(this.getAllowStretchY()&&this._computedHeightTypeNull){return true;}return false;}}),_computeValuePixel:function(v){return Math.round(v);},_computeValuePixelLimit:function(v){return Math.max(0,this._computeValuePixel(v));},_computeValuePercentX:function(v){return Math.round(this.getParent().getInnerWidthForChild(this)*v*0.01);},_computeValuePercentXLimit:function(v){return Math.max(0,this._computeValuePercentX(v));},_computeValuePercentY:function(v){return Math.round(this.getParent().getInnerHeightForChild(this)*v*0.01);},_computeValuePercentYLimit:function(v){return Math.max(0,this._computeValuePercentY(v));},getWidthValue:function(){if(this._computedWidthValue!=null){return this._computedWidthValue;}switch(this._computedWidthType){case qx.legacy.ui.core.Widget.TYPE_PIXEL:return this._computedWidthValue=this._computeValuePixelLimit(this._computedWidthParsed);case qx.legacy.ui.core.Widget.TYPE_PERCENT:return this._computedWidthValue=this._computeValuePercentXLimit(this._computedWidthParsed);case qx.legacy.ui.core.Widget.TYPE_AUTO:return this._computedWidthValue=this.getPreferredBoxWidth();case qx.legacy.ui.core.Widget.TYPE_FLEX:if(this.getParent().getLayoutImpl().computeChildrenFlexWidth===undefined){throw new Error("Widget "+this+": having horizontal flex size (width="+this.getWidth()+") but parent layout "+this.getParent()+" does not support it");}this.getParent().getLayoutImpl().computeChildrenFlexWidth();return this._computedWidthValue=this._computedWidthFlexValue;}return null;},getMinWidthValue:function(){if(this._computedMinWidthValue!=null){return this._computedMinWidthValue;}switch(this._computedMinWidthType){case qx.legacy.ui.core.Widget.TYPE_PIXEL:return this._computedWidthValue=this._computeValuePixelLimit(this._computedMinWidthParsed);case qx.legacy.ui.core.Widget.TYPE_PERCENT:return this._computedWidthValue=this._computeValuePercentXLimit(this._computedMinWidthParsed);case qx.legacy.ui.core.Widget.TYPE_AUTO:return this._computedMinWidthValue=this.getPreferredBoxWidth();}return null;},getMaxWidthValue:function(){if(this._computedMaxWidthValue!=null){return this._computedMaxWidthValue;}switch(this._computedMaxWidthType){case qx.legacy.ui.core.Widget.TYPE_PIXEL:return this._computedWidthValue=this._computeValuePixelLimit(this._computedMaxWidthParsed);case qx.legacy.ui.core.Widget.TYPE_PERCENT:return this._computedWidthValue=this._computeValuePercentXLimit(this._computedMaxWidthParsed);case qx.legacy.ui.core.Widget.TYPE_AUTO:return this._computedMaxWidthValue=this.getPreferredBoxWidth();}return null;},getLeftValue:function(){if(this._computedLeftValue!=null){return this._computedLeftValue;}switch(this._computedLeftType){case qx.legacy.ui.core.Widget.TYPE_PIXEL:return this._computedLeftValue=this._computeValuePixel(this._computedLeftParsed);case qx.legacy.ui.core.Widget.TYPE_PERCENT:return this._computedLeftValue=this._computeValuePercentX(this._computedLeftParsed);}return null;},getRightValue:function(){if(this._computedRightValue!=null){return this._computedRightValue;}switch(this._computedRightType){case qx.legacy.ui.core.Widget.TYPE_PIXEL:return this._computedRightValue=this._computeValuePixel(this._computedRightParsed);case qx.legacy.ui.core.Widget.TYPE_PERCENT:return this._computedRightValue=this._computeValuePercentX(this._computedRightParsed);}return null;},getHeightValue:function(){if(this._computedHeightValue!=null){return this._computedHeightValue;}switch(this._computedHeightType){case qx.legacy.ui.core.Widget.TYPE_PIXEL:return this._computedHeightValue=this._computeValuePixelLimit(this._computedHeightParsed);case qx.legacy.ui.core.Widget.TYPE_PERCENT:return this._computedHeightValue=this._computeValuePercentYLimit(this._computedHeightParsed);case qx.legacy.ui.core.Widget.TYPE_AUTO:return this._computedHeightValue=this.getPreferredBoxHeight();case qx.legacy.ui.core.Widget.TYPE_FLEX:if(this.getParent().getLayoutImpl().computeChildrenFlexHeight===undefined){throw new Error("Widget "+this+": having vertical flex size (height="+this.getHeight()+") but parent layout "+this.getParent()+" does not support it");}this.getParent().getLayoutImpl().computeChildrenFlexHeight();return this._computedHeightValue=this._computedHeightFlexValue;}return null;},getMinHeightValue:function(){if(this._computedMinHeightValue!=null){return this._computedMinHeightValue;}switch(this._computedMinHeightType){case qx.legacy.ui.core.Widget.TYPE_PIXEL:return this._computedMinHeightValue=this._computeValuePixelLimit(this._computedMinHeightParsed);case qx.legacy.ui.core.Widget.TYPE_PERCENT:return this._computedMinHeightValue=this._computeValuePercentYLimit(this._computedMinHeightParsed);case qx.legacy.ui.core.Widget.TYPE_AUTO:return this._computedMinHeightValue=this.getPreferredBoxHeight();}return null;},getMaxHeightValue:function(){if(this._computedMaxHeightValue!=null){return this._computedMaxHeightValue;}switch(this._computedMaxHeightType){case qx.legacy.ui.core.Widget.TYPE_PIXEL:return this._computedMaxHeightValue=this._computeValuePixelLimit(this._computedMaxHeightParsed);case qx.legacy.ui.core.Widget.TYPE_PERCENT:return this._computedMaxHeightValue=this._computeValuePercentYLimit(this._computedMaxHeightParsed);case qx.legacy.ui.core.Widget.TYPE_AUTO:return this._computedMaxHeightValue=this.getPreferredBoxHeight();}return null;},getTopValue:function(){if(this._computedTopValue!=null){return this._computedTopValue;}switch(this._computedTopType){case qx.legacy.ui.core.Widget.TYPE_PIXEL:return this._computedTopValue=this._computeValuePixel(this._computedTopParsed);case qx.legacy.ui.core.Widget.TYPE_PERCENT:return this._computedTopValue=this._computeValuePercentY(this._computedTopParsed);}return null;},getBottomValue:function(){if(this._computedBottomValue!=null){return this._computedBottomValue;}switch(this._computedBottomType){case qx.legacy.ui.core.Widget.TYPE_PIXEL:return this._computedBottomValue=this._computeValuePixel(this._computedBottomParsed);case qx.legacy.ui.core.Widget.TYPE_PERCENT:return this._computedBottomValue=this._computeValuePercentY(this._computedBottomParsed);}return null;},_computeFrameWidth:function(){var fw=this._cachedBorderLeft+this.getPaddingLeft()+this.getPaddingRight()+this._cachedBorderRight;switch(this.getOverflow()){case "scroll":case "scrollY":fw+=qx.legacy.ui.core.Widget.SCROLLBAR_SIZE;break;case "auto":break;}return fw;},_computeFrameHeight:function(){var fh=this._cachedBorderTop+this.getPaddingTop()+this.getPaddingBottom()+this._cachedBorderBottom;switch(this.getOverflow()){case "scroll":case "scrollX":fh+=qx.legacy.ui.core.Widget.SCROLLBAR_SIZE;break;case "auto":break;}return fh;},_invalidateFrameDimensions:function(){this._invalidateFrameWidth();this._invalidateFrameHeight();},_invalidatePreferredInnerDimensions:function(){this._invalidatePreferredInnerWidth();this._invalidatePreferredInnerHeight();},_computePreferredBoxWidth:function(){try{return Math.max(0,this.getPreferredInnerWidth()+this.getFrameWidth());}catch(ex){this.error("_computePreferredBoxWidth failed",ex);}},_computePreferredBoxHeight:function(){try{return Math.max(0,this.getPreferredInnerHeight()+this.getFrameHeight());}catch(ex){this.error("_computePreferredBoxHeight failed",ex);}},_initialLayoutDone:false,addToLayoutChanges:function(p){if(this._isDisplayable){this.getParent()._addChildToChildrenQueue(this);}return this._layoutChanges[p]=true;},addToQueue:function(p){this._initialLayoutDone?this.addToJobQueue(p):this.addToLayoutChanges(p);},addToQueueRuntime:function(p){return !this._initialLayoutDone||this.addToJobQueue(p);},_computeHasPercentX:function(){return (this._computedLeftTypePercent||this._computedWidthTypePercent||this._computedMinWidthTypePercent||this._computedMaxWidthTypePercent||this._computedRightTypePercent);},_computeHasPercentY:function(){return (this._computedTopTypePercent||this._computedHeightTypePercent||this._computedMinHeightTypePercent||this._computedMaxHeightTypePercent||this._computedBottomTypePercent);},_computeHasAutoX:function(){return (this._computedWidthTypeAuto||this._computedMinWidthTypeAuto||this._computedMaxWidthTypeAuto);},_computeHasAutoY:function(){return (this._computedHeightTypeAuto||this._computedMinHeightTypeAuto||this._computedMaxHeightTypeAuto);},_computeHasFlexX:function(){return this._computedWidthTypeFlex;},_computeHasFlexY:function(){return this._computedHeightTypeFlex;},_evalUnitsPixelPercentAutoFlex:function(value){switch(value){case "auto":return qx.legacy.ui.core.Widget.TYPE_AUTO;case Infinity:case -Infinity:return qx.legacy.ui.core.Widget.TYPE_NULL;}switch(typeof value){case "number":return isNaN(value)?qx.legacy.ui.core.Widget.TYPE_NULL:qx.legacy.ui.core.Widget.TYPE_PIXEL;case "string":return value.indexOf("%")!=-1?qx.legacy.ui.core.Widget.TYPE_PERCENT:value.indexOf("*")!=-1?qx.legacy.ui.core.Widget.TYPE_FLEX:qx.legacy.ui.core.Widget.TYPE_NULL;}return qx.legacy.ui.core.Widget.TYPE_NULL;},_evalUnitsPixelPercentAuto:function(value){switch(value){case "auto":return qx.legacy.ui.core.Widget.TYPE_AUTO;case Infinity:case -Infinity:return qx.legacy.ui.core.Widget.TYPE_NULL;}switch(typeof value){case "number":return isNaN(value)?qx.legacy.ui.core.Widget.TYPE_NULL:qx.legacy.ui.core.Widget.TYPE_PIXEL;case "string":return value.indexOf("%")!=-1?qx.legacy.ui.core.Widget.TYPE_PERCENT:qx.legacy.ui.core.Widget.TYPE_NULL;}return qx.legacy.ui.core.Widget.TYPE_NULL;},_evalUnitsPixelPercent:function(value){switch(value){case Infinity:case -Infinity:return qx.legacy.ui.core.Widget.TYPE_NULL;}switch(typeof value){case "number":return isNaN(value)?qx.legacy.ui.core.Widget.TYPE_NULL:qx.legacy.ui.core.Widget.TYPE_PIXEL;case "string":return value.indexOf("%")!=-1?qx.legacy.ui.core.Widget.TYPE_PERCENT:qx.legacy.ui.core.Widget.TYPE_NULL;}return qx.legacy.ui.core.Widget.TYPE_NULL;},_unitDetectionPixelPercentAutoFlex:function(name,value){var r=qx.legacy.ui.core.Widget.layoutPropertyTypes[name];var s=r.dataType;var p=r.dataParsed;var v=r.dataValue;var s1=r.typePixel;var s2=r.typePercent;var s3=r.typeAuto;var s4=r.typeFlex;var s5=r.typeNull;var wasPercent=this[s2];var wasAuto=this[s3];var wasFlex=this[s4];switch(this[s]=this._evalUnitsPixelPercentAutoFlex(value)){case qx.legacy.ui.core.Widget.TYPE_PIXEL:this[s1]=true;this[s2]=this[s3]=this[s4]=this[s5]=false;this[p]=this[v]=Math.round(value);break;case qx.legacy.ui.core.Widget.TYPE_PERCENT:this[s2]=true;this[s1]=this[s3]=this[s4]=this[s5]=false;this[p]=parseFloat(value);this[v]=null;break;case qx.legacy.ui.core.Widget.TYPE_AUTO:this[s3]=true;this[s1]=this[s2]=this[s4]=this[s5]=false;this[p]=this[v]=null;break;case qx.legacy.ui.core.Widget.TYPE_FLEX:this[s4]=true;this[s1]=this[s2]=this[s3]=this[s5]=false;this[p]=parseFloat(value);this[v]=null;break;default:this[s5]=true;this[s1]=this[s2]=this[s3]=this[s4]=false;this[p]=this[v]=null;break;}if(wasPercent!=this[s2]){switch(name){case "minWidth":case "maxWidth":case "width":case "left":case "right":this._invalidateHasPercentX();break;case "maxHeight":case "minHeight":case "height":case "top":case "bottom":this._invalidateHasPercentY();break;}}if(wasAuto!=this[s3]){switch(name){case "minWidth":case "maxWidth":case "width":this._invalidateHasAutoX();break;case "minHeight":case "maxHeight":case "height":this._invalidateHasAutoY();break;}}if(wasFlex!=this[s4]){switch(name){case "width":this._invalidateHasFlexX();break;case "height":this._invalidateHasFlexY();break;}}},_unitDetectionPixelPercentAuto:function(name,value){var r=qx.legacy.ui.core.Widget.layoutPropertyTypes[name];var s=r.dataType;var p=r.dataParsed;var v=r.dataValue;var s1=r.typePixel;var s2=r.typePercent;var s3=r.typeAuto;var s4=r.typeNull;var wasPercent=this[s2];var wasAuto=this[s3];switch(this[s]=this._evalUnitsPixelPercentAuto(value)){case qx.legacy.ui.core.Widget.TYPE_PIXEL:this[s1]=true;this[s2]=this[s3]=this[s4]=false;this[p]=this[v]=Math.round(value);break;case qx.legacy.ui.core.Widget.TYPE_PERCENT:this[s2]=true;this[s1]=this[s3]=this[s4]=false;this[p]=parseFloat(value);this[v]=null;break;case qx.legacy.ui.core.Widget.TYPE_AUTO:this[s3]=true;this[s1]=this[s2]=this[s4]=false;this[p]=this[v]=null;break;default:this[s4]=true;this[s1]=this[s2]=this[s3]=false;this[p]=this[v]=null;break;}if(wasPercent!=this[s2]){switch(name){case "minWidth":case "maxWidth":case "width":case "left":case "right":this._invalidateHasPercentX();break;case "minHeight":case "maxHeight":case "height":case "top":case "bottom":this._invalidateHasPercentY();break;}}if(wasAuto!=this[s3]){switch(name){case "minWidth":case "maxWidth":case "width":this._invalidateHasAutoX();break;case "minHeight":case "maxHeight":case "height":this._invalidateHasAutoY();break;}}},_unitDetectionPixelPercent:function(name,value){var r=qx.legacy.ui.core.Widget.layoutPropertyTypes[name];var s=r.dataType;var p=r.dataParsed;var v=r.dataValue;var s1=r.typePixel;var s2=r.typePercent;var s3=r.typeNull;var wasPercent=this[s2];switch(this[s]=this._evalUnitsPixelPercent(value)){case qx.legacy.ui.core.Widget.TYPE_PIXEL:this[s1]=true;this[s2]=this[s3]=false;this[p]=this[v]=Math.round(value);break;case qx.legacy.ui.core.Widget.TYPE_PERCENT:this[s2]=true;this[s1]=this[s3]=false;this[p]=parseFloat(value);this[v]=null;break;default:this[s3]=true;this[s1]=this[s2]=false;this[p]=this[v]=null;break;}if(wasPercent!=this[s2]){switch(name){case "minWidth":case "maxWidth":case "width":case "left":case "right":this._invalidateHasPercentX();break;case "minHeight":case "maxHeight":case "height":case "top":case "bottom":this._invalidateHasPercentY();break;}}},getTopLevelWidget:function(){return this._hasParent?this.getParent().getTopLevelWidget():null;},moveSelfBefore:function(vBefore){this.getParent().addBefore(this,vBefore);},moveSelfAfter:function(vAfter){this.getParent().addAfter(this,vAfter);},moveSelfToBegin:function(){this.getParent().addAtBegin(this);},moveSelfToEnd:function(){this.getParent().addAtEnd(this);},getPreviousSibling:function(){var p=this.getParent();if(p==null){return null;}var cs=p.getChildren();return cs[cs.indexOf(this)-1];},getNextSibling:function(){var p=this.getParent();if(p==null){return null;}var cs=p.getChildren();return cs[cs.indexOf(this)+1];},getPreviousVisibleSibling:function(){if(!this._hasParent){return null;}var vChildren=this.getParent().getVisibleChildren();return vChildren[vChildren.indexOf(this)-1];},getNextVisibleSibling:function(){if(!this._hasParent){return null;}var vChildren=this.getParent().getVisibleChildren();return vChildren[vChildren.indexOf(this)+1];},getPreviousActiveSibling:function(vIgnoreClasses){var vPrev=qx.legacy.ui.core.Widget.getActiveSiblingHelper(this,this.getParent(),-1,vIgnoreClasses,null);return vPrev?vPrev:this.getParent().getLastActiveChild();},getNextActiveSibling:function(vIgnoreClasses){var vNext=qx.legacy.ui.core.Widget.getActiveSiblingHelper(this,this.getParent(),1,vIgnoreClasses,null);return vNext?vNext:this.getParent().getFirstActiveChild();},isFirstChild:function(){return this._hasParent&&this.getParent().getFirstChild()==this;},isLastChild:function(){return this._hasParent&&this.getParent().getLastChild()==this;},isFirstVisibleChild:function(){return this._hasParent&&this.getParent().getFirstVisibleChild()==this;},isLastVisibleChild:function(){return this._hasParent&&this.getParent().getLastVisibleChild()==this;},hasState:function(vState){return this.__states&&this.__states[vState]?true:false;},addState:function(vState){if(!this.__states){this.__states={};}if(!this.__states[vState]){this.__states[vState]=true;if(this._hasParent){qx.legacy.ui.core.Widget.addToGlobalStateQueue(this);}}},removeState:function(vState){if(this.__states&&this.__states[vState]){delete this.__states[vState];if(this._hasParent){qx.legacy.ui.core.Widget.addToGlobalStateQueue(this);}}},_styleFromMap:function(data){var styler=qx.core.Property.$$method.setThemed;var unstyler=qx.core.Property.$$method.resetThemed;var value;var prop;for(var prop in data){value=data[prop];value==="undefined"?this[unstyler[prop]]():this[styler[prop]](value);}},_unstyleFromArray:function(data){var unstyler=qx.core.Property.$$method.resetThemed;var i,l;for(var i=0,l=data.length;i<l;i++){this[unstyler[data[i]]]();}},_renderAppearance:function(){if(!this.__states){this.__states={};}this._applyStateStyleFocus(this.__states);var vAppearance=this.getAppearance();if(vAppearance){try{var r=qx.legacy.theme.manager.Appearance.getInstance().styleFrom(vAppearance,this.__states);if(r){this._styleFromMap(r);}}catch(ex){this.error("Could not apply state appearance",ex);}}},_resetAppearanceThemeWrapper:function(vNewAppearanceTheme,vOldAppearanceTheme){var vAppearance=this.getAppearance();if(vAppearance){var vAppearanceManager=qx.legacy.theme.manager.Appearance.getInstance();var vOldAppearanceProperties=vAppearanceManager.styleFromTheme(vOldAppearanceTheme,vAppearance,this.__states);var vNewAppearanceProperties=vAppearanceManager.styleFromTheme(vNewAppearanceTheme,vAppearance,this.__states);var vUnstyleList=[];for(var prop in vOldAppearanceProperties){if(vNewAppearanceProperties[prop]===undefined){vUnstyleList.push(prop);}}this._unstyleFromArray(vUnstyleList);this._styleFromMap(vNewAppearanceProperties);}},_applyStateStyleFocus:qx.core.Variant.select("qx.client",{"mshtml":function(vStates){},"default":function(vStates){if(vStates.focused){if(!qx.legacy.event.handler.FocusHandler.mouseFocus&&!this.getHideFocus()){this.setStyleProperty("outline","1px dotted");}}else{this.removeStyleProperty("outline");}}}),addToStateQueue:function(){qx.legacy.ui.core.Widget.addToGlobalStateQueue(this);},recursiveAddToStateQueue:function(){this.addToStateQueue();},_applyAppearance:function(value,old){if(!this.__states){this.__states={};}var vAppearanceManager=qx.legacy.theme.manager.Appearance.getInstance();if(value){var vNewAppearanceProperties=vAppearanceManager.styleFrom(value,this.__states)||{};}if(old){var vOldAppearanceProperties=vAppearanceManager.styleFrom(old,this.__states)||{};var vUnstyleList=[];for(var prop in vOldAppearanceProperties){if(!vNewAppearanceProperties||!(prop in vNewAppearanceProperties)){vUnstyleList.push(prop);}}}if(vUnstyleList){this._unstyleFromArray(vUnstyleList);}if(vNewAppearanceProperties){this._styleFromMap(vNewAppearanceProperties);}},_recursiveAppearanceThemeUpdate:function(vNewAppearanceTheme,vOldAppearanceTheme){try{this._resetAppearanceThemeWrapper(vNewAppearanceTheme,vOldAppearanceTheme);}catch(ex){this.error("Failed to update appearance theme",ex);}},_applyElementData:function(elem){},setHtmlProperty:function(propName,value){if(!this._htmlProperties){this._htmlProperties={};}this._htmlProperties[propName]=value;if(this._isCreated&&this.getElement()[propName]!=value){this.getElement()[propName]=value;}return true;},removeHtmlProperty:qx.core.Variant.select("qx.client",{"mshtml":function(propName){if(!this._htmlProperties){return;}delete this._htmlProperties[propName];if(this._isCreated){this.getElement().removeAttribute(propName);}return true;},"default":function(propName){if(!this._htmlProperties){return;}delete this._htmlProperties[propName];if(this._isCreated){this.getElement().removeAttribute(propName);delete this.getElement()[propName];}return true;}}),getHtmlProperty:function(propName){if(!this._htmlProperties){return "";}return this._htmlProperties[propName]||"";},_applyHtmlProperties:function(elem){var vProperties=this._htmlProperties;if(vProperties){var propName;for(propName in vProperties){elem[propName]=vProperties[propName];}}},_generateHtmlId:function(){var id=this.classname+"."+qx.legacy.ui.core.Widget._idCounter++;this.debug("setting autogenerated HTML id to "+id);this.setHtmlProperty("id",id);},setHtmlAttribute:function(propName,value){if(!this._htmlAttributes){this._htmlAttributes={};}this._htmlAttributes[propName]=value;if(this._isCreated){this.getElement().setAttribute(propName,value);}return true;},removeHtmlAttribute:function(propName){if(!this._htmlAttributes){return;}delete this._htmlAttributes[propName];if(this._isCreated){this.getElement().removeAttribute(propName);}return true;},getHtmlAttribute:function(propName){if(!this._htmlAttributes){return "";}return this._htmlAttributes[propName]||"";},_applyHtmlAttributes:function(elem){var vAttributes=this._htmlAttributes;if(vAttributes){var propName;for(propName in vAttributes){elem.setAttribute(propName,vAttributes[propName]);}}},getStyleProperty:function(propName){if(!this._styleProperties){return "";}return this._styleProperties[propName]||"";},__outerElementStyleProperties:{cursor:true,zIndex:true,filter:true,display:true,visibility:true},setStyleProperty:function(propName,value){if(!this._styleProperties){this._styleProperties={};}this._styleProperties[propName]=value;if(this._isCreated){var elem=this.__outerElementStyleProperties[propName]?this.getElement():this._getTargetNode();if(elem){elem.style[propName]=(value==null)?"":value;}}},removeStyleProperty:function(propName){if(!this._styleProperties){return;}delete this._styleProperties[propName];if(this._isCreated){var elem=this.__outerElementStyleProperties[propName]?this.getElement():this._getTargetNode();if(elem){elem.style[propName]="";}}},_applyStyleProperties:function(elem){var vProperties=this._styleProperties;if(!vProperties){return;}var propName;var vBaseElement=elem;var vTargetElement=this._getTargetNode();var elem;var value;for(propName in vProperties){elem=this.__outerElementStyleProperties[propName]?vBaseElement:vTargetElement;value=vProperties[propName];elem.style[propName]=(value==null)?"":value;}},_applyEnabled:function(value,old){if(value===false){this.addState("disabled");this.removeState("over");if(qx.Class.isDefined("qx.legacy.ui.form.Button")){this.removeState("abandoned");this.removeState("pressed");}}else{this.removeState("disabled");}},isFocusable:function(){return this.getEnabled()&&this.isSeeable()&&this.getTabIndex()>=0&&this.getTabIndex()!=null;},isFocusRoot:function(){return false;},getFocusRoot:function(){if(this._hasParent){return this.getParent().getFocusRoot();}return null;},getActiveChild:function(){var vRoot=this.getFocusRoot();if(vRoot){return vRoot.getActiveChild();}return null;},_ontabfocus:qx.lang.Function.returnTrue,_applyFocused:function(value,old){if(!this.isCreated()){return;}var vFocusRoot=this.getFocusRoot();if(vFocusRoot){if(value){vFocusRoot.setFocusedChild(this);this._visualizeFocus();}else{if(vFocusRoot.getFocusedChild()==this){vFocusRoot.setFocusedChild(null);}this._visualizeBlur();}}},_applyHideFocus:qx.core.Variant.select("qx.client",{"mshtml":function(value,old){this.setHtmlProperty("hideFocus",value);},"default":qx.lang.Function.returnTrue}),_visualizeBlur:function(){if(this.getEnableElementFocus()&&(!this.getFocusRoot().getFocusedChild()||(this.getFocusRoot().getFocusedChild()&&this.getFocusRoot().getFocusedChild().getEnableElementFocus()))){try{this.getElement().blur();}catch(ex){}}this.removeState("focused");},_visualizeFocus:function(){if(!qx.legacy.event.handler.FocusHandler.mouseFocus&&this.getEnableElementFocus()){try{this.getElement().focus();}catch(ex){}}this.addState("focused");},focus:function(){delete qx.legacy.event.handler.FocusHandler.mouseFocus;this.setFocused(true);},blur:function(){delete qx.legacy.event.handler.FocusHandler.mouseFocus;this.setFocused(false);},_applyCapture:function(value,old){var vMgr=qx.legacy.event.handler.EventHandler.getInstance();if(old){vMgr.setCaptureWidget(null);}if(value){vMgr.setCaptureWidget(this);}},_applyZIndex:function(value,old){if(value==null){this.removeStyleProperty("zIndex");}else{this.setStyleProperty("zIndex",value);}},_applyTabIndex:qx.core.Variant.select("qx.client",{"mshtml":function(value,old){this.setHtmlProperty("tabIndex",value<0?-1:1);},"gecko":function(value,old){this.setStyleProperty("MozUserFocus",(value<0?"ignore":"normal"));},"default":function(value,old){this.setStyleProperty("userFocus",(value<0?"ignore":"normal"));this.setHtmlProperty("tabIndex",value<0?-1:1);}}),_applySelectable:qx.core.Variant.select("qx.client",{"mshtml":function(value,old){},"gecko":function(value,old){if(value){this.removeStyleProperty("MozUserSelect");}else{this.setStyleProperty("MozUserSelect","none");}},"webkit":function(value,old){if(value){this.removeStyleProperty("WebkitUserSelect");}else{this.setStyleProperty("WebkitUserSelect","none");}},"khtml":function(value,old){if(value){this.removeStyleProperty("KhtmlUserSelect");}else{this.setStyleProperty("KhtmlUserSelect","none");}},"default":function(value,old){if(value){return this.removeStyleProperty("userSelect");}else{this.setStyleProperty("userSelect","none");}}}),_applyOpacity:qx.core.Variant.select("qx.client",{"mshtml":function(value,old){if(value==null||value>=1||value<0){this.removeStyleProperty("filter");}else{this.setStyleProperty("filter",("Alpha(Opacity="+Math.round(value*100)+")"));}},"default":function(value,old){if(value==null||value>1){if(qx.core.Variant.isSet("qx.client","gecko")){this.removeStyleProperty("MozOpacity");}else if(qx.core.Variant.isSet("qx.client","khtml")){this.removeStyleProperty("KhtmlOpacity");}this.removeStyleProperty("opacity");}else{value=qx.lang.Number.limit(value,0,1);if(qx.core.Variant.isSet("qx.client","gecko")){this.setStyleProperty("MozOpacity",value);}else if(qx.core.Variant.isSet("qx.client","khtml")){this.setStyleProperty("KhtmlOpacity",value);}this.setStyleProperty("opacity",value);}}}),__cursorMap:qx.core.Variant.select("qx.client",{"mshtml":{"cursor":"hand","ew-resize":"e-resize","ns-resize":"n-resize","nesw-resize":"ne-resize","nwse-resize":"nw-resize"},"opera":{"col-resize":"e-resize","row-resize":"n-resize","ew-resize":"e-resize","ns-resize":"n-resize","nesw-resize":"ne-resize","nwse-resize":"nw-resize"},"default":{}}),_applyCursor:function(value,old){if(value){this.setStyleProperty("cursor",this.__cursorMap[value]||value);}else{this.removeStyleProperty("cursor");}},_applyCommand:function(value,old){},_applyBackgroundImage:function(value,old){var imageMgr=qx.legacy.io.image.Manager.getInstance();var aliasMgr=qx.legacy.util.AliasManager.getInstance();if(old){imageMgr.hide(old);}if(value){imageMgr.show(value);}aliasMgr.connect(this._styleBackgroundImage,this,value);},_styleBackgroundImage:function(value){value?this.setStyleProperty("backgroundImage","url("+qx.util.ResourceManager.toUri(value)+")"):this.removeStyleProperty("backgroundImage");},_applyClip:function(value,old){return this._compileClipString();},_compileClipString:function(){var vLeft=this.getClipLeft();var vTop=this.getClipTop();var vWidth=this.getClipWidth();var vHeight=this.getClipHeight();var vRight,vBottom;if(vLeft==null){vRight=(vWidth==null?"auto":vWidth+"px");vLeft="auto";}else{vRight=(vWidth==null?"auto":vLeft+vWidth+"px");vLeft=vLeft+"px";}if(vTop==null){vBottom=(vHeight==null?"auto":vHeight+"px");vTop="auto";}else{vBottom=(vHeight==null?"auto":vTop+vHeight+"px");vTop=vTop+"px";}return this.setStyleProperty("clip",("rect("+vTop+","+vRight+","+vBottom+","+vLeft+")"));},_applyOverflow:qx.core.Variant.select("qx.client",{"default":function(value,old){var pv=value;var pn="overflow";switch(value){case "scrollX":pn="overflowX";pv="scroll";break;case "scrollY":pn="overflowY";pv="scroll";break;}var a=["overflow","overflowX","overflowY"];for(var i=0;i<a.length;i++){if(a[i]!=pn){this.removeStyleProperty(a[i]);}}switch(value){case "scrollX":this.setStyleProperty("overflowY","hidden");break;case "scrollY":this.setStyleProperty("overflowX","hidden");break;}this._renderOverflow(pn,pv,value,old);this.addToQueue("overflow");},"gecko":function(value,old){var pv=value;var pn="overflow";switch(pv){case "hidden":pv="-moz-scrollbars-none";break;case "scrollX":pv="-moz-scrollbars-horizontal";break;case "scrollY":pv="-moz-scrollbars-vertical";break;}this._renderOverflow(pn,pv,value,old);this.addToQueue("overflow");},"opera":function(value,old){var pv=value;var pn="overflow";switch(pv){case "scrollX":case "scrollY":pv="scroll";break;}this._renderOverflow(pn,pv,value,old);this.addToQueue("overflow");}}),_renderOverflow:function(pn,pv,value,old){this.setStyleProperty(pn,pv||"");this._invalidateFrameWidth();this._invalidateFrameHeight();},getOverflowX:function(){var vOverflow=this.getOverflow();return vOverflow=="scrollY"?"hidden":vOverflow;},getOverflowY:function(){var vOverflow=this.getOverflow();return vOverflow=="scrollX"?"hidden":vOverflow;},_applyBackgroundColor:function(value,old){qx.legacy.theme.manager.Color.getInstance().connect(this._styleBackgroundColor,this,value);},_styleBackgroundColor:function(value){value?this.setStyleProperty("backgroundColor",value):this.removeStyleProperty("backgroundColor");},_applyTextColor:function(value,old){},_applyFont:function(value,old){},_cachedBorderTop:0,_cachedBorderRight:0,_cachedBorderBottom:0,_cachedBorderLeft:0,_applyBorder:function(value,old){qx.legacy.theme.manager.Border.getInstance().connect(this._queueBorder,this,value);},__borderJobs:{top:"borderTop",right:"borderRight",bottom:"borderBottom",left:"borderLeft"},_queueBorder:function(value,edge){if(!edge){var jobs=this.__borderJobs;for(var entry in jobs){this.addToQueue(jobs[entry]);}this.__reflowBorderX(value);this.__reflowBorderY(value);}else{if(edge==="left"||edge==="right"){this.__reflowBorderX(value);}else{this.__reflowBorderY(value);}this.addToQueue(this.__borderJobs[edge]);}this.__borderObject=value;},__reflowBorderX:function(value){var oldLeftWidth=this._cachedBorderLeft;var oldRightWidth=this._cachedBorderRight;this._cachedBorderLeft=value?value.getWidthLeft():0;this._cachedBorderRight=value?value.getWidthRight():0;if((oldLeftWidth+oldRightWidth)!=(this._cachedBorderLeft+this._cachedBorderRight)){this._invalidateFrameWidth();}},__reflowBorderY:function(value){var oldTopWidth=this._cachedBorderTop;var oldBottomWidth=this._cachedBorderBottom;this._cachedBorderTop=value?value.getWidthTop():0;this._cachedBorderBottom=value?value.getWidthBottom():0;if((oldTopWidth+oldBottomWidth)!=(this._cachedBorderTop+this._cachedBorderBottom)){this._invalidateFrameHeight();}},renderBorder:function(changes){var value=this.__borderObject;if(value){if(changes.borderTop){value.renderTop(this);}if(changes.borderRight){value.renderRight(this);}if(changes.borderBottom){value.renderBottom(this);}if(changes.borderLeft){value.renderLeft(this);}}else{var border=qx.legacy.ui.core.Border;if(changes.borderTop){border.resetTop(this);}if(changes.borderRight){border.resetRight(this);}if(changes.borderBottom){border.resetBottom(this);}if(changes.borderLeft){border.resetLeft(this);}}},prepareEnhancedBorder:qx.core.Variant.select("qx.client",{"gecko":qx.lang.Function.returnTrue,"default":function(){var elem=this.getElement();var cl=this._borderElement=document.createElement("div");var es=elem.style;var cs=this._innerStyle=cl.style;if(qx.core.Variant.isSet("qx.client","mshtml")){}else{cs.width=cs.height="100%";}cs.position="absolute";for(var i in this._styleProperties){switch(i){case "zIndex":case "filter":case "display":break;default:cs[i]=es[i];es[i]="";}}for(var i in this._htmlProperties){switch(i){case "unselectable":cl.unselectable=this._htmlProperties[i];}}while(elem.firstChild){cl.appendChild(elem.firstChild);}elem.appendChild(cl);}}),_applyPaddingTop:function(value,old){this.addToQueue("paddingTop");this._invalidateFrameHeight();},_applyPaddingRight:function(value,old){this.addToQueue("paddingRight");this._invalidateFrameWidth();},_applyPaddingBottom:function(value,old){this.addToQueue("paddingBottom");this._invalidateFrameHeight();},_applyPaddingLeft:function(value,old){this.addToQueue("paddingLeft");this._invalidateFrameWidth();},renderPadding:function(changes){},_applyMarginLeft:function(value,old){this.addToQueue("marginLeft");},_applyMarginRight:function(value,old){this.addToQueue("marginRight");},_applyMarginTop:function(value,old){this.addToQueue("marginTop");},_applyMarginBottom:function(value,old){this.addToQueue("marginBottom");},execute:function(){var cmd=this.getCommand();if(cmd){cmd.execute(this);}this.fireEvent("execute");},_visualPropertyCheck:function(){if(!this.isCreated()){throw new Error(this.classname+": Element must be created previously!");}},setScrollLeft:function(nScrollLeft){this._visualPropertyCheck();this._getTargetNode().scrollLeft=nScrollLeft;},setScrollTop:function(nScrollTop){this._visualPropertyCheck();this._getTargetNode().scrollTop=nScrollTop;},getOffsetLeft:function(){this._visualPropertyCheck();return qx.legacy.html.Offset.getLeft(this.getElement());},getOffsetTop:function(){this._visualPropertyCheck();return qx.legacy.html.Offset.getTop(this.getElement());},getScrollLeft:function(){this._visualPropertyCheck();return this._getTargetNode().scrollLeft;},getScrollTop:function(){this._visualPropertyCheck();return this._getTargetNode().scrollTop;},getClientWidth:function(){this._visualPropertyCheck();return this._getTargetNode().clientWidth;},getClientHeight:function(){this._visualPropertyCheck();return this._getTargetNode().clientHeight;},getOffsetWidth:function(){this._visualPropertyCheck();return this.getElement().offsetWidth;},getOffsetHeight:function(){this._visualPropertyCheck();return this.getElement().offsetHeight;},getScrollWidth:function(){this._visualPropertyCheck();return this._getTargetNode().scrollWidth;},getScrollHeight:function(){this._visualPropertyCheck();return this._getTargetNode().scrollHeight;},scrollIntoView:function(alignTopLeft){this.scrollIntoViewX(alignTopLeft);this.scrollIntoViewY(alignTopLeft);},scrollIntoViewX:function(alignLeft){if(!this._isCreated||!this._isDisplayable){return false;}return qx.legacy.html.ScrollIntoView.scrollX(this.getElement(),alignLeft);},scrollIntoViewY:function(alignTop){if(!this._isCreated||!this._isDisplayable){return false;}return qx.legacy.html.ScrollIntoView.scrollY(this.getElement(),alignTop);},supportsDrop:function(dragCache){var supportsDropMethod=this.getSupportsDropMethod();if(supportsDropMethod!==null){return supportsDropMethod.call(this,dragCache);}return (this!=dragCache.sourceWidget);}},settings:{"qx.widgetQueueDebugging":false,"qx.widgetDebugId":false},defer:function(statics,members){qx.legacy.core.Property.addCachedProperty({name:"innerWidth",defaultValue:null},members);qx.legacy.core.Property.addCachedProperty({name:"innerHeight",defaultValue:null},members);qx.legacy.core.Property.addCachedProperty({name:"boxWidth",defaultValue:null},members);qx.legacy.core.Property.addCachedProperty({name:"boxHeight",defaultValue:null},members);qx.legacy.core.Property.addCachedProperty({name:"outerWidth",defaultValue:null},members);qx.legacy.core.Property.addCachedProperty({name:"outerHeight",defaultValue:null},members);qx.legacy.core.Property.addCachedProperty({name:"preferredBoxWidth",defaultValue:null},members);qx.legacy.core.Property.addCachedProperty({name:"preferredBoxHeight",defaultValue:null},members);qx.legacy.core.Property.addCachedProperty({name:"frameWidth",defaultValue:null,addToQueueRuntime:true},members);qx.legacy.core.Property.addCachedProperty({name:"frameHeight",defaultValue:null,addToQueueRuntime:true},members);qx.legacy.core.Property.addCachedProperty({name:"preferredInnerWidth",defaultValue:null,addToQueueRuntime:true},members);qx.legacy.core.Property.addCachedProperty({name:"preferredInnerHeight",defaultValue:null,addToQueueRuntime:true},members);qx.legacy.core.Property.addCachedProperty({name:"hasPercentX",defaultValue:false},members);qx.legacy.core.Property.addCachedProperty({name:"hasPercentY",defaultValue:false},members);qx.legacy.core.Property.addCachedProperty({name:"hasFlexX",defaultValue:false},members);qx.legacy.core.Property.addCachedProperty({name:"hasFlexY",defaultValue:false},members);qx.legacy.core.Property.addCachedProperty({name:"hasAutoX",defaultValue:false},members);qx.legacy.core.Property.addCachedProperty({name:"hasAutoY",defaultValue:false},members);statics.__initApplyMethods(members);if(qx.core.Variant.isSet("qx.client","mshtml")){members._renderRuntimeWidth=function(v){this._style.pixelWidth=(v==null)?0:v;if(this._innerStyle){this._innerStyle.pixelWidth=(v==null)?0:v-2;}};members._renderRuntimeHeight=function(v){this._style.pixelHeight=(v==null)?0:v;if(this._innerStyle){this._innerStyle.pixelHeight=(v==null)?0:v-2;}};members._resetRuntimeWidth=function(){this._style.width="";if(this._innerStyle){this._innerStyle.width="";}};members._resetRuntimeHeight=function(){this._style.height="";if(this._innerStyle){this._innerStyle.height="";}};}statics.__initLayoutProperties(statics);statics.__autoFlush=new qx.util.DeferredCall(qx.legacy.ui.core.Widget.flushGlobalQueues,qx.legacy.ui.core.Widget);},destruct:function(){var elem=this.getElement();if(elem){elem.qx_Widget=null;}this._disposeFields("_isCreated","_inlineEvents","_element","_style","_borderElement","_innerStyle","_oldParent","_styleProperties","_htmlProperties","_htmlAttributes","__states","_jobQueue","_layoutChanges","__borderObject");}});qx.Class.define("qx.legacy.ui.core.Parent",{extend:qx.legacy.ui.core.Widget,type:"abstract",construct:function(){this.base(arguments);this._children=[];this._layoutImpl=this._createLayoutImpl();},properties:{focusHandler:{check:"qx.legacy.event.handler.FocusHandler",apply:"_applyFocusHandler",nullable:true},activeChild:{check:"qx.legacy.ui.core.Widget",apply:"_applyActiveChild",event:"changeActiveChild",nullable:true},focusedChild:{check:"qx.legacy.ui.core.Widget",apply:"_applyFocusedChild",event:"changeFocusedChild",nullable:true}},members:{isFocusRoot:function(){return this.getFocusHandler()!=null;},getFocusRoot:function(){if(this.isFocusRoot()){return this;}if(this._hasParent){return this.getParent().getFocusRoot();}return null;},activateFocusRoot:function(){if(this._focusHandler){return;}this._focusHandler=new qx.legacy.event.handler.FocusHandler(this);this.setFocusHandler(this._focusHandler);},_onfocuskeyevent:function(e){this.getFocusHandler()._onkeyevent(this,e);},_applyFocusHandler:function(value,old){if(value){this.addListener("keypress",this._onfocuskeyevent);if(this.getTabIndex()<1){this.setTabIndex(1);}this.setHideFocus(true);this.setActiveChild(this);}else{this.removeListener("keydown",this._onfocuskeyevent);this.removeListener("keypress",this._onfocuskeyevent);this.setTabIndex(-1);this.setHideFocus(false);}},_applyActiveChild:function(value,old){},_applyFocusedChild:function(value,old){var vFocusValid=value!=null;var vBlurValid=old!=null;if(qx.Class.isDefined("qx.legacy.ui.popup.PopupManager")&&vFocusValid){var vMgr=qx.legacy.ui.popup.PopupManager.getInstance();if(vMgr){vMgr.update(value);}}if(vBlurValid){var vEventObject=qx.event.Registration.createEvent("focusout",qx.legacy.event.type.FocusEvent);vEventObject.setBubbles(true);if(vFocusValid){vEventObject.setRelatedTarget(value);}old.dispatchEvent(vEventObject);}if(vFocusValid){var vEventObject=qx.event.Registration.createEvent("focusin",qx.legacy.event.type.FocusEvent);vEventObject.setBubbles(true);if(vBlurValid){vEventObject.setRelatedTarget(old);}value.dispatchEvent(vEventObject);}if(vBlurValid){if(this.getActiveChild()==old&&!vFocusValid){this.setActiveChild(null);}old.setFocused(false);var vEventObject=qx.event.Registration.createEvent("blur",qx.legacy.event.type.FocusEvent);if(vFocusValid){vEventObject.setRelatedTarget(value);}old.dispatchEvent(vEventObject);if(qx.Class.isDefined("qx.legacy.ui.popup.ToolTipManager")){var vMgr=qx.legacy.ui.popup.ToolTipManager.getInstance();if(vMgr){vMgr.handleBlur(vEventObject);}}}if(vFocusValid){this.setActiveChild(value);value.setFocused(true);qx.legacy.event.handler.EventHandler.getInstance().setFocusRoot(this);var vEventObject=qx.event.Registration.createEvent("focus",qx.legacy.event.type.FocusEvent);if(vBlurValid){vEventObject.setRelatedTarget(old);}var eventClone=vEventObject.clone();value.dispatchEvent(vEventObject);if(qx.Class.isDefined("qx.legacy.ui.popup.ToolTipManager")){var vMgr=qx.legacy.ui.popup.ToolTipManager.getInstance();if(vMgr){eventClone.setTarget(value);vMgr.handleFocus(eventClone);}}eventClone.dispose();}},_layoutImpl:null,_createLayoutImpl:function(){return null;},getLayoutImpl:function(){return this._layoutImpl;},getChildren:function(){return this._children;},getChildrenLength:function(){return this.getChildren().length;},hasChildren:function(){return this.getChildrenLength()>0;},isEmpty:function(){return this.getChildrenLength()==0;},indexOf:function(vChild){return this.getChildren().indexOf(vChild);},contains:function(vWidget){switch(vWidget){case null:return false;case this:return true;default:return this.contains(vWidget.getParent());}},_computeVisibleChildren:function(){var vVisible=[];var vChildren=this.getChildren();if(!vChildren){return 0;}var vLength=vChildren.length;for(var i=0;i<vLength;i++){var vChild=vChildren[i];if(vChild._isDisplayable){vVisible.push(vChild);}}return vVisible;},getVisibleChildrenLength:function(){return this.getVisibleChildren().length;},hasVisibleChildren:function(){return this.getVisibleChildrenLength()>0;},isVisibleEmpty:function(){return this.getVisibleChildrenLength()==0;},add:function(varargs){var vWidget;for(var i=0,l=arguments.length;i<l;i++){vWidget=arguments[i];if(!(vWidget instanceof qx.legacy.ui.core.Parent)&&!(vWidget instanceof qx.legacy.ui.basic.Terminator)){throw new Error("Invalid Widget: "+vWidget);}else{vWidget.setParent(this);}}return this;},addAt:function(vChild,vIndex){if(vIndex==null||vIndex<0){throw new Error("Not a valid index for addAt(): "+vIndex);}if(vChild.getParent()==this){var vChildren=this.getChildren();var vOldIndex=vChildren.indexOf(vChild);if(vOldIndex!=vIndex){if(vOldIndex!=-1){qx.lang.Array.removeAt(vChildren,vOldIndex);}qx.lang.Array.insertAt(vChildren,vChild,vIndex);if(this._initialLayoutDone){this._invalidateVisibleChildren();this.getLayoutImpl().updateChildrenOnMoveChild(vChild,vIndex,vOldIndex);}}}else{vChild._insertIndex=vIndex;vChild.setParent(this);}},addAtBegin:function(vChild){return this.addAt(vChild,0);},addAtEnd:function(vChild){var vLength=this.getChildrenLength();return this.addAt(vChild,vChild.getParent()==this?vLength-1:vLength);},addBefore:function(vChild,vBefore){var vChildren=this.getChildren();var vTargetIndex=vChildren.indexOf(vBefore);if(vTargetIndex==-1){throw new Error("Child to add before: "+vBefore+" is not inside this parent.");}var vSourceIndex=vChildren.indexOf(vChild);if(vSourceIndex==-1||vSourceIndex>vTargetIndex){vTargetIndex++;}return this.addAt(vChild,Math.max(0,vTargetIndex-1));},addAfter:function(vChild,vAfter){var vChildren=this.getChildren();var vTargetIndex=vChildren.indexOf(vAfter);if(vTargetIndex==-1){throw new Error("Child to add after: "+vAfter+" is not inside this parent.");}var vSourceIndex=vChildren.indexOf(vChild);if(vSourceIndex!=-1&&vSourceIndex<vTargetIndex){vTargetIndex--;}return this.addAt(vChild,Math.min(vChildren.length,vTargetIndex+1));},remove:function(varargs){var vWidget;for(var i=0,l=arguments.length;i<l;i++){vWidget=arguments[i];if(!(vWidget instanceof qx.legacy.ui.core.Parent)&&!(vWidget instanceof qx.legacy.ui.basic.Terminator)){throw new Error("Invalid Widget: "+vWidget);}else if(vWidget.getParent()==this){vWidget.setParent(null);}}},removeAt:function(vIndex){var vChild=this.getChildren()[vIndex];if(vChild){delete vChild._insertIndex;vChild.setParent(null);}},removeAll:function(){var cs=this.getChildren();var co=cs[0];while(co){this.remove(co);co=cs[0];}},getFirstChild:function(){return qx.lang.Array.getFirst(this.getChildren())||null;},getFirstVisibleChild:function(){return qx.lang.Array.getFirst(this.getVisibleChildren())||null;},getFirstActiveChild:function(vIgnoreClasses){return qx.legacy.ui.core.Widget.getActiveSiblingHelper(null,this,1,vIgnoreClasses,"first")||null;},getLastChild:function(){return qx.lang.Array.getLast(this.getChildren())||null;},getLastVisibleChild:function(){return qx.lang.Array.getLast(this.getVisibleChildren())||null;},getLastActiveChild:function(vIgnoreClasses){return qx.legacy.ui.core.Widget.getActiveSiblingHelper(null,this,-1,vIgnoreClasses,"last")||null;},forEachChild:function(vFunc){var ch=this.getChildren(),chc,i=-1;if(!ch){return;}while(chc=ch[++i]){vFunc.call(chc,i);}},forEachVisibleChild:function(vFunc){var ch=this.getVisibleChildren(),chc,i=-1;if(!ch){return;}while(chc=ch[++i]){vFunc.call(chc,i);}},_beforeAppear:function(){this.base(arguments);this.forEachVisibleChild(function(){if(this.isAppearRelevant()){this._beforeAppear();}});},_afterAppear:function(){this.base(arguments);this.forEachVisibleChild(function(){if(this.isAppearRelevant()){this._afterAppear();}});},_beforeDisappear:function(){this.base(arguments);this.forEachVisibleChild(function(){if(this.isAppearRelevant()){this._beforeDisappear();}});},_afterDisappear:function(){this.base(arguments);this.forEachVisibleChild(function(){if(this.isAppearRelevant()){this._afterDisappear();}});},_beforeInsertDom:function(){this.base(arguments);this.forEachVisibleChild(function(){if(this.isAppearRelevant()){this._beforeInsertDom();}});},_afterInsertDom:function(){this.base(arguments);this.forEachVisibleChild(function(){if(this.isAppearRelevant()){this._afterInsertDom();}});},_beforeRemoveDom:function(){this.base(arguments);this.forEachVisibleChild(function(){if(this.isAppearRelevant()){this._beforeRemoveDom();}});},_afterRemoveDom:function(){this.base(arguments);this.forEachVisibleChild(function(){if(this.isAppearRelevant()){this._afterRemoveDom();}});},_handleDisplayableCustom:function(vDisplayable,vParent,vHint){this.forEachChild(function(){this._handleDisplayable();});},_addChildrenToStateQueue:function(){this.forEachVisibleChild(function(){this.addToStateQueue();});},recursiveAddToStateQueue:function(){this.addToStateQueue();this.forEachVisibleChild(function(){this.recursiveAddToStateQueue();});},_recursiveAppearanceThemeUpdate:function(vNewAppearanceTheme,vOldAppearanceTheme){this.base(arguments,vNewAppearanceTheme,vOldAppearanceTheme);this.forEachVisibleChild(function(){this._recursiveAppearanceThemeUpdate(vNewAppearanceTheme,vOldAppearanceTheme);});},_addChildToChildrenQueue:function(vChild){if(!vChild._isInParentChildrenQueue&&!vChild._isDisplayable){this.warn("Ignoring invisible child: "+vChild);return;}if(!vChild._isInParentChildrenQueue&&vChild._isDisplayable){qx.legacy.ui.core.Widget.addToGlobalLayoutQueue(this);if(!this._childrenQueue){this._childrenQueue={};}this._childrenQueue[vChild.toHashCode()]=vChild;}},_removeChildFromChildrenQueue:function(vChild){if(this._childrenQueue&&vChild._isInParentChildrenQueue){delete this._childrenQueue[vChild.toHashCode()];if(qx.lang.Object.isEmpty(this._childrenQueue)){qx.legacy.ui.core.Widget.removeFromGlobalLayoutQueue(this);}}},_flushChildrenQueue:function(){if(!qx.lang.Object.isEmpty(this._childrenQueue)){this.getLayoutImpl().flushChildrenQueue(this._childrenQueue);delete this._childrenQueue;}},_addChildrenToLayoutQueue:function(p){this.forEachChild(function(){this.addToLayoutChanges(p);});},_layoutChild:function(vChild){if(!vChild._isDisplayable){return ;}var vChanges=vChild._layoutChanges;try{if(vChild.renderBorder){if(vChanges.borderTop||vChanges.borderRight||vChanges.borderBottom||vChanges.borderLeft){vChild.renderBorder(vChanges);}}}catch(ex){this.error("Could not apply border to child "+vChild,ex);}try{if(vChild.renderPadding){if(vChanges.paddingLeft||vChanges.paddingRight||vChanges.paddingTop||vChanges.paddingBottom){vChild.renderPadding(vChanges);}}}catch(ex){this.error("Could not apply padding to child "+vChild,ex);}try{this.getLayoutImpl().layoutChild(vChild,vChanges);}catch(ex){this.error("Could not layout child "+vChild+" through layout handler",ex);}try{vChild._layoutPost(vChanges);}catch(ex){this.error("Could not post layout child "+vChild,ex);}try{if(vChanges.initial){vChild._initialLayoutDone=true;qx.legacy.ui.core.Widget.addToGlobalDisplayQueue(vChild);}}catch(ex){this.error("Could not handle display updates from layout flush for child "+vChild,ex);}vChild._layoutChanges={};delete vChild._isInParentLayoutQueue;delete this._childrenQueue[vChild.toHashCode()];},_layoutPost:qx.lang.Function.returnTrue,_computePreferredInnerWidth:function(){return this.getLayoutImpl().computeChildrenNeededWidth();},_computePreferredInnerHeight:function(){return this.getLayoutImpl().computeChildrenNeededHeight();},_changeInnerWidth:function(vNew,vOld){var vLayout=this.getLayoutImpl();if(vLayout.invalidateChildrenFlexWidth){vLayout.invalidateChildrenFlexWidth();}this.forEachVisibleChild(function(){if(vLayout.updateChildOnInnerWidthChange(this)&&this._recomputeBoxWidth()){this._recomputeOuterWidth();this._recomputeInnerWidth();}});},_changeInnerHeight:function(vNew,vOld){var vLayout=this.getLayoutImpl();if(vLayout.invalidateChildrenFlexHeight){vLayout.invalidateChildrenFlexHeight();}this.forEachVisibleChild(function(){if(vLayout.updateChildOnInnerHeightChange(this)&&this._recomputeBoxHeight()){this._recomputeOuterHeight();this._recomputeInnerHeight();}});},getInnerWidthForChild:function(vChild){return this.getInnerWidth();},getInnerHeightForChild:function(vChild){return this.getInnerHeight();},_remappingChildTable:["add","remove","addAt","addAtBegin","addAtEnd","removeAt","addBefore","addAfter","removeAll"],_remapStart:"return this._remappingChildTarget.",_remapStop:".apply(this._remappingChildTarget, arguments)",remapChildrenHandlingTo:function(vTarget){var t=this._remappingChildTable;this._remappingChildTarget=vTarget;for(var i=0,l=t.length,s;i<l;i++){s=t[i];this[s]=new Function(qx.legacy.ui.core.Parent.prototype._remapStart+s+qx.legacy.ui.core.Parent.prototype._remapStop);}}},defer:function(statics,members,properties){qx.legacy.core.Property.addCachedProperty({name:"visibleChildren",defaultValue:null},members);if(qx.core.Variant.isSet("qx.client","opera")){members._layoutChildOrig=members._layoutChild;members._layoutChild=function(vChild){if(!vChild._initialLayoutDone||!vChild._layoutChanges.border){return this._layoutChildOrig(vChild);}var vStyle=vChild.getElement().style;var vOldDisplay=vStyle.display;vStyle.display="none";var vRet=this._layoutChildOrig(vChild);vStyle.display=vOldDisplay;return vRet;};}},destruct:function(){this._disposeArray("_children");this._disposeObjects("_layoutImpl","_focusHandler");this._disposeFields("_childrenQueue","_childrenQueue","_remappingChildTable","_remappingChildTarget","_cachedVisibleChildren");}});qx.Class.define("qx.test.Property",{extend:qx.dev.unit.TestCase,members:{testBasic:function(){this.debug("Exec: testBasic");this.assertNotUndefined(qx.core.Property);var inst=new qx.test.PropertyHelper;this.assertNotUndefined(inst,"instance");this.assertFunction(inst.setPublicProp,"public setter");this.assertFunction(inst.getPublicProp,"public getter");this.assertFunction(inst.resetPublicProp,"public reset");this.assertUndefined(inst.togglePublicProp,"public toggler");this.assertUndefined(inst.setThemedPublicProp,"public themed");this.assertFunction(inst.toggleBooleanProp,"boolean toggler");this.debug("Done: testBasic");},testBuiltinTypes:function(){this.debug("Exec: testBuiltinTypes");this.assertNotUndefined(qx.core.Property);var inst=new qx.test.PropertyHelper;this.assertNotUndefined(inst,"instance");this.assertIdentical("Hello",inst.setStringProp("Hello"),"string property, set");this.assertIdentical("Hello",inst.getStringProp(),"string property, get");this.assertIdentical(true,inst.setBooleanProp(true),"boolean property, set");this.assertIdentical(true,inst.getBooleanProp(),"boolean property, get");this.assertIdentical(false,inst.setBooleanProp(false),"boolean property, set");this.assertIdentical(false,inst.getBooleanProp(),"boolean property, get");this.assertIdentical(3,inst.setNumberProp(3),"number property, set");this.assertIdentical(3,inst.getNumberProp(),"number property, get");this.assertIdentical(3.14,inst.setNumberProp(3.14),"number property, set");this.assertIdentical(3.14,inst.getNumberProp(),"number property, get");var obj={};this.assertIdentical(obj,inst.setObjectProp(obj),"object property, set");this.assertIdentical(obj,inst.getObjectProp(),"object property, get");var obj=new Object;this.assertIdentical(obj,inst.setObjectProp(obj),"object property, set");this.assertIdentical(obj,inst.getObjectProp(),"object property, get");var arr=[];this.assertIdentical(arr,inst.setArrayProp(arr),"array property, set");this.assertIdentical(arr,inst.getArrayProp(),"array property, get");var arr=new Array;this.assertIdentical(arr,inst.setArrayProp(arr),"array property, set");this.assertIdentical(arr,inst.getArrayProp(),"array property, get");this.debug("Done: testBuiltinTypes");},testInheritance:function(){this.debug("Exec: testInheritance");this.assertNotUndefined(qx.core.Property);var pa=new qx.test.Layout;var ch1=new qx.test.Layout;var ch2=new qx.test.Layout;var ch3=new qx.test.Layout;var chh1=new qx.test.Layout;var chh2=new qx.test.Layout;var chh3=new qx.test.Layout;pa.add(ch1,ch2,ch3);ch2.add(chh1,chh2,chh3);this.assertTrue(pa.setEnabled_(true),"a1");this.assertTrue(pa.getEnabled_(),"a2");this.assertTrue(ch1.getEnabled_(),"a3");this.assertTrue(ch2.getEnabled_(),"a4");this.assertTrue(ch3.getEnabled_(),"a5");this.assertTrue(chh1.getEnabled_(),"a6");this.assertTrue(chh2.getEnabled_(),"a7");this.assertTrue(chh3.getEnabled_(),"a8");this.assertFalse(ch2.setEnabled_(false),"b1");this.assertFalse(ch2.getEnabled_(),"b2");this.assertFalse(chh1.getEnabled_(),"b3");this.assertFalse(chh2.getEnabled_(),"b4");this.assertFalse(chh3.getEnabled_(),"b5");this.assertUndefined(ch2.resetEnabled_(),"c1");this.assertTrue(ch2.getEnabled_(),"c2");this.assertTrue(chh1.getEnabled_(),"c3");this.assertTrue(chh2.getEnabled_(),"c4");this.assertTrue(chh3.getEnabled_(),"c5");this.debug("Done: testInheritance");},testParent:function(){var pa=new qx.test.Layout;var ch1=new qx.test.Layout;var ch2=new qx.test.Layout;var ch3=new qx.test.Layout;this.assertIdentical(pa.getEnabled_(),null,"d1");this.assertIdentical(ch1.getEnabled_(),null,"d2");this.assertIdentical(ch2.getEnabled_(),null,"d3");this.assertIdentical(ch3.getEnabled_(),null,"d4");ch1.setParent(pa);this.assertTrue(pa.setEnabled_(true),"a1");this.assertFalse(ch3.setEnabled_(false),"a2");this.assertTrue(pa.getEnabled_(),"b1");this.assertTrue(ch1.getEnabled_(),"b2");this.assertIdentical(ch2.getEnabled_(),null,"b3");this.assertFalse(ch3.getEnabled_(),"b4");ch2.setParent(pa);ch3.setParent(pa);this.assertTrue(pa.getEnabled_(),"c1");this.assertTrue(ch1.getEnabled_(),"c2");this.assertTrue(ch2.getEnabled_(),"c3");this.assertFalse(ch3.getEnabled_(),"c4");},testMultiValues:function(){this.debug("Exec: testMultiValues");this.assertNotUndefined(qx.core.Property);var inst=new qx.test.PropertyHelper;this.assertNotUndefined(inst,"instance");this.assertIdentical(inst.getInitProp(),"foo","a1");this.assertIdentical(inst.setInitProp("hello"),"hello","a2");this.assertIdentical(inst.getInitProp(),"hello","a3");this.assertIdentical(inst.resetInitProp(),undefined,"a4");this.assertIdentical(inst.getInitProp(),"foo","a5");this.assertIdentical(inst.getNullProp(),"bar","b1");this.assertIdentical(inst.setNullProp("hello"),"hello","b2");this.assertIdentical(inst.getNullProp(),"hello","b3");this.assertIdentical(inst.setNullProp(null),null,"b4");this.assertIdentical(inst.getNullProp(),null,"b5");this.assertIdentical(inst.resetNullProp(),undefined,"b6");this.assertIdentical(inst.getNullProp(),"bar","b7");this.assertIdentical(inst.setThemedAppearanceProp("black"),"black","c1");this.assertIdentical(inst.getAppearanceProp(),"black","c2");this.assertIdentical(inst.setAppearanceProp("white"),"white","c3");this.assertIdentical(inst.getAppearanceProp(),"white","c4");this.assertIdentical(inst.resetAppearanceProp(),undefined,"c5");this.assertIdentical(inst.getAppearanceProp(),"black","c6");this.assertIdentical(inst.getNoProp(),null,"c1");this.debug("Done: testMultiValues");},testInitApply:function(){var inst=new qx.test.PropertyHelper;this.assertNotUndefined(inst,"instance");this.assertUndefined(inst.lastApply);inst.setInitApplyProp1("juhu");this.assertJsonEquals(["juhu",null],inst.lastApply);inst.lastApply=undefined;inst.setInitApplyProp1("juhu");this.assertUndefined(inst.lastApply);inst.lastApply=undefined;inst.setInitApplyProp1("kinners");this.assertJsonEquals(["kinners","juhu"],inst.lastApply);inst.lastApply=undefined;this.assertUndefined(inst.lastApply);inst.setInitApplyProp2(null);this.assertJsonEquals([null,null],inst.lastApply);inst.lastApply=undefined;},testInit:function(){var self=this;var inst=new qx.test.PropertyHelper(function(inst){inst.initInitApplyProp1();self.assertJsonEquals(["juhu",null],inst.lastApply);inst.lastApply=undefined;inst.initInitApplyProp2();self.assertJsonEquals([null,null],inst.lastApply);inst.lastApply=undefined;});this.assertNotUndefined(inst,"instance");}}});qx.Class.define("qx.test.PropertyHelper",{extend:qx.core.Object,construct:function(delegate){this.base(arguments);if(delegate){delegate(this);}},properties:{publicProp:{nullable:true},stringProp:{check:"String",nullable:true},booleanProp:{check:"Boolean",nullable:true},numberProp:{check:"Number",nullable:true},objectProp:{check:"Object",nullable:true},arrayProp:{check:"Array",nullable:true},mapProp:{check:"Map",nullable:true},noProp:{check:"String",nullable:true},initProp:{init:"foo"},initApplyProp1:{check:"String",init:"juhu",apply:"_applyInitApplyProp"},initApplyProp2:{check:"String",init:null,nullable:true,apply:"_applyInitApplyProp"},nullProp:{init:"bar",nullable:true},appearanceProp:{themeable:true,nullable:true},fullProp:{init:100,themeable:true}},members:{_applyInitApplyProp:function(value,old){this.lastApply=[value,old];}}});qx.Class.define("qx.test.Layout",{extend:qx.legacy.ui.core.Parent,properties:{enabled_:{inheritable:true},width_:{inheritable:true,themeable:true},height_:{inheritable:true,themeable:true},left_:{inheritable:true,themeable:true},top_:{inheritable:true,themeable:true}}});qx.Class.define("qx.legacy.event.WidgetBubbling",{extend:qx.event.dispatch.AbstractBubbling,statics:{PRIORITY:qx.event.Registration.PRIORITY_NORMAL},members:{_getParent:function(target){return target.getParent();},canDispatchEvent:function(target,event,type){return target instanceof qx.legacy.ui.core.Widget&&event.getBubbles();}},defer:function(statics){qx.event.Registration.addDispatcher(statics);}});qx.Class.define("qx.legacy.html.Dimension",{statics:{getOuterWidth:function(el){return qx.legacy.html.Dimension.getBoxWidth(el)+qx.legacy.html.Style.getMarginLeft(el)+qx.legacy.html.Style.getMarginRight(el);},getOuterHeight:function(el){return qx.legacy.html.Dimension.getBoxHeight(el)+qx.legacy.html.Style.getMarginTop(el)+qx.legacy.html.Style.getMarginBottom(el);},getBoxWidthForZeroHeight:function(el){var h=el.offsetHeight;if(h==0){var o=el.style.height;el.style.height="1px";}var v=el.offsetWidth;if(h==0){el.style.height=o;}return v;},getBoxHeightForZeroWidth:function(el){var w=el.offsetWidth;if(w==0){var o=el.style.width;el.style.width="1px";}var v=el.offsetHeight;if(w==0){el.style.width=o;}return v;},getBoxWidth:function(el){return el.offsetWidth;},getBoxHeight:function(el){return el.offsetHeight;},getAreaWidth:qx.core.Variant.select("qx.client",{"gecko":function(el){if(el.clientWidth!=0&&el.clientWidth!=(qx.legacy.html.Style.getBorderLeft(el)+qx.legacy.html.Style.getBorderRight(el))){return el.clientWidth;}else{return qx.legacy.html.Dimension.getBoxWidth(el)-qx.legacy.html.Dimension.getInsetLeft(el)-qx.legacy.html.Dimension.getInsetRight(el);}},"default":function(el){return el.clientWidth!=0?el.clientWidth:(qx.legacy.html.Dimension.getBoxWidth(el)-qx.legacy.html.Dimension.getInsetLeft(el)-qx.legacy.html.Dimension.getInsetRight(el));}}),getAreaHeight:qx.core.Variant.select("qx.client",{"gecko":function(el){if(el.clientHeight!=0&&el.clientHeight!=(qx.legacy.html.Style.getBorderTop(el)+qx.legacy.html.Style.getBorderBottom(el))){return el.clientHeight;}else{return qx.legacy.html.Dimension.getBoxHeight(el)-qx.legacy.html.Dimension.getInsetTop(el)-qx.legacy.html.Dimension.getInsetBottom(el);}},"default":function(el){return el.clientHeight!=0?el.clientHeight:(qx.legacy.html.Dimension.getBoxHeight(el)-qx.legacy.html.Dimension.getInsetTop(el)-qx.legacy.html.Dimension.getInsetBottom(el));}}),getInnerWidth:function(el){return qx.legacy.html.Dimension.getAreaWidth(el)-qx.legacy.html.Style.getPaddingLeft(el)-qx.legacy.html.Style.getPaddingRight(el);},getInnerHeight:function(el){return qx.legacy.html.Dimension.getAreaHeight(el)-qx.legacy.html.Style.getPaddingTop(el)-qx.legacy.html.Style.getPaddingBottom(el);},getInsetLeft:qx.core.Variant.select("qx.client",{"mshtml":function(el){return el.clientLeft;},"default":function(el){return qx.legacy.html.Style.getBorderLeft(el);}}),getInsetTop:qx.core.Variant.select("qx.client",{"mshtml":function(el){return el.clientTop;},"default":function(el){return qx.legacy.html.Style.getBorderTop(el);}}),getInsetRight:qx.core.Variant.select("qx.client",{"mshtml":function(el){if(qx.legacy.html.Style.getStyleProperty(el,"overflowY")=="hidden"||el.clientWidth==0){return qx.legacy.html.Style.getBorderRight(el);}return Math.max(0,el.offsetWidth-el.clientLeft-el.clientWidth);},"default":function(el){if(el.clientWidth==0){var ov=qx.legacy.html.Style.getStyleProperty(el,"overflow");var sbv=ov=="scroll"||ov=="-moz-scrollbars-vertical"?16:0;return Math.max(0,qx.legacy.html.Style.getBorderRight(el)+sbv);}return Math.max(0,el.offsetWidth-el.clientWidth-qx.legacy.html.Style.getBorderLeft(el));}}),getInsetBottom:qx.core.Variant.select("qx.client",{"mshtml":function(el){if(qx.legacy.html.Style.getStyleProperty(el,"overflowX")=="hidden"||el.clientHeight==0){return qx.legacy.html.Style.getBorderBottom(el);}return Math.max(0,el.offsetHeight-el.clientTop-el.clientHeight);},"default":function(el){if(el.clientHeight==0){var ov=qx.legacy.html.Style.getStyleProperty(el,"overflow");var sbv=ov=="scroll"||ov=="-moz-scrollbars-horizontal"?16:0;return Math.max(0,qx.legacy.html.Style.getBorderBottom(el)+sbv);}return Math.max(0,el.offsetHeight-el.clientHeight-qx.legacy.html.Style.getBorderTop(el));}}),getScrollBarSizeLeft:function(el){return 0;},getScrollBarSizeTop:function(el){return 0;},getScrollBarSizeRight:function(el){return qx.legacy.html.Dimension.getInsetRight(el)-qx.legacy.html.Style.getBorderRight(el);},getScrollBarSizeBottom:function(el){return qx.legacy.html.Dimension.getInsetBottom(el)-qx.legacy.html.Style.getBorderBottom(el);},getScrollBarVisibleX:function(el){return qx.legacy.html.Dimension.getScrollBarSizeRight(el)>0;},getScrollBarVisibleY:function(el){return qx.legacy.html.Dimension.getScrollBarSizeBottom(el)>0;}}});qx.Class.define("qx.legacy.html.Style",{statics:{getStylePropertySure:qx.lang.Object.select((document.defaultView&&document.defaultView.getComputedStyle)?"hasComputed":"noComputed",{"hasComputed":function(el,prop){return !el?null:el.ownerDocument?el.ownerDocument.defaultView.getComputedStyle(el,"")[prop]:el.style[prop];},"noComputed":qx.core.Variant.select("qx.client",{"mshtml":function(el,prop){try{if(!el){return null;}if(el.parentNode&&el.currentStyle){return el.currentStyle[prop];}else{var v1=el.runtimeStyle[prop];if(v1!=null&&typeof v1!="undefined"&&v1!=""){return v1;}return el.style[prop];}}catch(ex){throw new Error("Could not evaluate computed style: "+el+"["+prop+"]: "+ex);}},"default":function(el,prop){return !el?null:el.style[prop];}})}),getStyleProperty:qx.lang.Object.select((document.defaultView&&document.defaultView.getComputedStyle)?"hasComputed":"noComputed",{"hasComputed":function(el,prop){try{return el.ownerDocument.defaultView.getComputedStyle(el,"")[prop];}catch(ex){throw new Error("Could not evaluate computed style: "+el+"["+prop+"]: "+ex);}},"noComputed":qx.core.Variant.select("qx.client",{"mshtml":function(el,prop){try{return el.currentStyle[prop];}catch(ex){throw new Error("Could not evaluate computed style: "+el+"["+prop+"]: "+ex);}},"default":function(el,prop){try{return el.style[prop];}catch(ex){throw new Error("Could not evaluate computed style: "+el+"["+prop+"]");}}})}),getStyleSize:function(vElement,propertyName){return parseInt(qx.legacy.html.Style.getStyleProperty(vElement,propertyName))||0;},getMarginLeft:function(vElement){return qx.legacy.html.Style.getStyleSize(vElement,"marginLeft");},getMarginTop:function(vElement){return qx.legacy.html.Style.getStyleSize(vElement,"marginTop");},getMarginRight:function(vElement){return qx.legacy.html.Style.getStyleSize(vElement,"marginRight");},getMarginBottom:function(vElement){return qx.legacy.html.Style.getStyleSize(vElement,"marginBottom");},getPaddingLeft:function(vElement){return qx.legacy.html.Style.getStyleSize(vElement,"paddingLeft");},getPaddingTop:function(vElement){return qx.legacy.html.Style.getStyleSize(vElement,"paddingTop");},getPaddingRight:function(vElement){return qx.legacy.html.Style.getStyleSize(vElement,"paddingRight");},getPaddingBottom:function(vElement){return qx.legacy.html.Style.getStyleSize(vElement,"paddingBottom");},getBorderLeft:function(vElement){return qx.legacy.html.Style.getStyleProperty(vElement,"borderLeftStyle")=="none"?0:qx.legacy.html.Style.getStyleSize(vElement,"borderLeftWidth");},getBorderTop:function(vElement){return qx.legacy.html.Style.getStyleProperty(vElement,"borderTopStyle")=="none"?0:qx.legacy.html.Style.getStyleSize(vElement,"borderTopWidth");},getBorderRight:function(vElement){return qx.legacy.html.Style.getStyleProperty(vElement,"borderRightStyle")=="none"?0:qx.legacy.html.Style.getStyleSize(vElement,"borderRightWidth");},getBorderBottom:function(vElement){return qx.legacy.html.Style.getStyleProperty(vElement,"borderBottomStyle")=="none"?0:qx.legacy.html.Style.getStyleSize(vElement,"borderBottomWidth");}}});qx.Class.define("qx.legacy.ui.layout.CanvasLayout",{extend:qx.legacy.ui.core.Parent,construct:function(){this.base(arguments);},members:{_createLayoutImpl:function(){return new qx.legacy.ui.layout.impl.CanvasLayoutImpl(this);}}});qx.Class.define("qx.legacy.ui.core.ClientDocument",{type:"singleton",extend:qx.legacy.ui.layout.CanvasLayout,construct:function(){this.base(arguments);if(qx.core.Setting.get("qx.boxModelCorrection")){var boxSizingAttr=qx.legacy.core.Client.getInstance().getEngineBoxSizingAttributes();var borderBoxCss=boxSizingAttr.join(":border-box;")+":border-box;";var contentBoxCss=boxSizingAttr.join(":content-box;")+":content-box;";qx.bom.Stylesheet.createElement("html,body { margin:0;border:0;padding:0; } "+"html { border:0 none; } "+"*{"+borderBoxCss+"} "+"img{"+contentBoxCss+"}");}if(qx.core.Setting.get("qx.enableApplicationLayout")){qx.bom.Stylesheet.createElement("html,body{width:100%;height:100%;overflow:hidden;}");}this._window=window;this._document=window.document;this.setElement(this._document.body);this._document.body.style.position="";try{document.execCommand("BackgroundImageCache",false,true);}catch(err){}this._cachedInnerWidth=this._document.body.offsetWidth;this._cachedInnerHeight=this._document.body.offsetHeight;this.addListener("windowresize",this._onwindowresize);this._modalWidgets=[];this._modalNativeWindow=null;this.activateFocusRoot();this.initHideFocus();this.initSelectable();qx.legacy.event.handler.EventHandler.getInstance().setFocusRoot(this);},events:{"focus":"qx.event.type.Event","windowblur":"qx.event.type.Event","windowfocus":"qx.event.type.Event","windowresize":"qx.event.type.Event"},properties:{appearance:{refine:true,init:"client-document"},enableElementFocus:{refine:true,init:false},enabled:{refine:true,init:true},selectable:{refine:true,init:false},hideFocus:{refine:true,init:true},globalCursor:{check:"String",nullable:true,themeable:true,apply:"_applyGlobalCursor",event:"changeGlobalCursor"}},members:{_applyParent:qx.lang.Function.returnTrue,getTopLevelWidget:qx.lang.Function.returnThis,getWindowElement:function(){return this._window;},getDocumentElement:function(){return this._document;},getParent:qx.lang.Function.returnNull,getToolTip:qx.lang.Function.returnNull,isMaterialized:qx.lang.Function.returnTrue,isSeeable:qx.lang.Function.returnTrue,_isDisplayable:true,_hasParent:false,_initialLayoutDone:true,_getBlocker:function(){if(!this._blocker){this._blocker=new qx.legacy.ui.core.ClientDocumentBlocker;this._blocker.addListener("mousedown",this.blockHelper,this);this._blocker.addListener("mouseup",this.blockHelper,this);this.add(this._blocker);}return this._blocker;},blockHelper:function(e){if(this._modalNativeWindow){if(!this._modalNativeWindow.isClosed()){this._modalNativeWindow.focus();}else{this.debug("Window seems to be closed already! => Releasing Blocker");this.release(this._modalNativeWindow);}}},block:function(vActiveChild){this._getBlocker().show();if(qx.Class.isDefined("qx.legacy.ui.window.Window")&&vActiveChild instanceof qx.legacy.ui.window.Window){this._modalWidgets.push(vActiveChild);var vOrigIndex=vActiveChild.getZIndex();this._getBlocker().setZIndex(vOrigIndex);vActiveChild.setZIndex(vOrigIndex+1);}else if(qx.Class.isDefined("qx.legacy.util.NativeWindow")&&vActiveChild instanceof qx.legacy.util.NativeWindow){this._modalNativeWindow=vActiveChild;this._getBlocker().setZIndex(1e7);}},release:function(vActiveChild){if(vActiveChild){if(qx.Class.isDefined("qx.legacy.util.NativeWindow")&&vActiveChild instanceof qx.legacy.util.NativeWindow){this._modalNativeWindow=null;}else{qx.lang.Array.remove(this._modalWidgets,vActiveChild);}}var l=this._modalWidgets.length;if(l==0){this._getBlocker().hide();}else{var oldActiveChild=this._modalWidgets[l-1];var o=oldActiveChild.getZIndex();this._getBlocker().setZIndex(o);oldActiveChild.setZIndex(o+1);}},createStyleElement:function(vCssText){return qx.bom.Stylesheet.createElement(vCssText);},addCssRule:function(vSheet,vSelector,vStyle){return qx.bom.Stylesheet.addRule(vSheet,vSelector,vStyle);},removeCssRule:function(vSheet,vSelector){return qx.bom.Stylesheet.removeRule(vSheet,vSelector);},removeAllCssRules:function(vSheet){return qx.bom.Stylesheet.removeAllRules(vSheet);},_applyGlobalCursor:qx.core.Variant.select("qx.client",{"mshtml":function(value,old){if(value=="pointer"){value="hand";}if(old=="pointer"){old="hand";}var elem,current;var list=this._cursorElements;if(list){for(var i=0,l=list.length;i<l;i++){elem=list[i];if(elem.style.cursor==old){elem.style.cursor=elem._oldCursor;elem._oldCursor=null;}}}var all=document.all;var list=this._cursorElements=[];if(value!=null&&value!=""&&value!="auto"){for(var i=0,l=all.length;i<l;i++){elem=all[i];current=elem.style.cursor;if(current!=null&&current!=""&&current!="auto"){elem._oldCursor=current;elem.style.cursor=value;list.push(elem);}}document.body.style.cursor=value;}else{document.body.style.cursor="";}},"default":function(value,old){if(!this._globalCursorStyleSheet){this._globalCursorStyleSheet=this.createStyleElement();}this.removeCssRule(this._globalCursorStyleSheet,"*");if(value){this.addCssRule(this._globalCursorStyleSheet,"*","cursor:"+value+" !important");}}}),_onwindowresize:function(e){if(qx.Class.isDefined("qx.legacy.ui.popup.PopupManager")){qx.legacy.ui.popup.PopupManager.getInstance().update();}this._recomputeInnerWidth();this._recomputeInnerHeight();qx.legacy.ui.core.Widget.flushGlobalQueues();},_computeInnerWidth:function(){return this._document.body.offsetWidth;},_computeInnerHeight:function(){return this._document.body.offsetHeight;}},settings:{"qx.enableApplicationLayout":true,"qx.boxModelCorrection":true},destruct:function(){this._disposeObjects("_blocker");this._disposeFields("_window","_document","_modalWidgets","_modalNativeWindow","_globalCursorStyleSheet");}});qx.Class.define("qx.legacy.ui.layout.impl.LayoutImpl",{extend:qx.core.Object,construct:function(vWidget){this.base(arguments);this._widget=vWidget;},members:{getWidget:function(){return this._widget;},computeChildBoxWidth:function(vChild){return vChild.getWidthValue()||vChild._computeBoxWidthFallback();},computeChildBoxHeight:function(vChild){return vChild.getHeightValue()||vChild._computeBoxHeightFallback();},computeChildNeededWidth:function(vChild){var vMinBox=vChild._computedMinWidthTypePercent?null:vChild.getMinWidthValue();var vMaxBox=vChild._computedMaxWidthTypePercent?null:vChild.getMaxWidthValue();var vBox=(vChild._computedWidthTypePercent||vChild._computedWidthTypeFlex?null:vChild.getWidthValue())||vChild.getPreferredBoxWidth()||0;return qx.lang.Number.limit(vBox,vMinBox,vMaxBox)+vChild.getMarginLeft()+vChild.getMarginRight();},computeChildNeededHeight:function(vChild){var vMinBox=vChild._computedMinHeightTypePercent?null:vChild.getMinHeightValue();var vMaxBox=vChild._computedMaxHeightTypePercent?null:vChild.getMaxHeightValue();var vBox=(vChild._computedHeightTypePercent||vChild._computedHeightTypeFlex?null:vChild.getHeightValue())||vChild.getPreferredBoxHeight()||0;return qx.lang.Number.limit(vBox,vMinBox,vMaxBox)+vChild.getMarginTop()+vChild.getMarginBottom();},computeChildrenNeededWidth_max:function(){for(var i=0,ch=this.getWidget().getVisibleChildren(),chl=ch.length,maxv=0;i<chl;i++){maxv=Math.max(maxv,ch[i].getNeededWidth());}return maxv;},computeChildrenNeededHeight_max:function(){for(var i=0,ch=this.getWidget().getVisibleChildren(),chl=ch.length,maxv=0;i<chl;i++){maxv=Math.max(maxv,ch[i].getNeededHeight());}return maxv;},computeChildrenNeededWidth_sum:function(){for(var i=0,ch=this.getWidget().getVisibleChildren(),chl=ch.length,sumv=0;i<chl;i++){sumv+=ch[i].getNeededWidth();}return sumv;},computeChildrenNeededHeight_sum:function(){for(var i=0,ch=this.getWidget().getVisibleChildren(),chl=ch.length,sumv=0;i<chl;i++){sumv+=ch[i].getNeededHeight();}return sumv;},computeChildrenNeededWidth:null,computeChildrenNeededHeight:null,updateSelfOnChildOuterWidthChange:function(vChild){},updateSelfOnChildOuterHeightChange:function(vChild){},updateChildOnInnerWidthChange:function(vChild){},updateChildOnInnerHeightChange:function(vChild){},updateSelfOnJobQueueFlush:function(vJobQueue){},updateChildrenOnJobQueueFlush:function(vJobQueue){},updateChildrenOnAddChild:function(vChild,vIndex){},updateChildrenOnRemoveChild:function(vChild,vIndex){},updateChildrenOnMoveChild:function(vChild,vIndex,vOldIndex){},flushChildrenQueue:function(vChildrenQueue){var vWidget=this.getWidget();for(var vHashCode in vChildrenQueue){vWidget._layoutChild(vChildrenQueue[vHashCode]);}},layoutChild:function(vChild,vJobs){},layoutChild_sizeLimitX:qx.core.Variant.select("qx.client",{"mshtml":qx.lang.Function.returnTrue,"default":function(vChild,vJobs){if(vJobs.minWidth){vChild._computedMinWidthTypeNull?vChild._resetRuntimeMinWidth():vChild._renderRuntimeMinWidth(vChild.getMinWidthValue());}else if(vJobs.initial&&!vChild._computedMinWidthTypeNull){vChild._renderRuntimeMinWidth(vChild.getMinWidthValue());}if(vJobs.maxWidth){vChild._computedMaxWidthTypeNull?vChild._resetRuntimeMaxWidth():vChild._renderRuntimeMaxWidth(vChild.getMaxWidthValue());}else if(vJobs.initial&&!vChild._computedMaxWidthTypeNull){vChild._renderRuntimeMaxWidth(vChild.getMaxWidthValue());}}}),layoutChild_sizeLimitY:qx.core.Variant.select("qx.client",{"mshtml":qx.lang.Function.returnTrue,"default":function(vChild,vJobs){if(vJobs.minHeight){vChild._computedMinHeightTypeNull?vChild._resetRuntimeMinHeight():vChild._renderRuntimeMinHeight(vChild.getMinHeightValue());}else if(vJobs.initial&&!vChild._computedMinHeightTypeNull){vChild._renderRuntimeMinHeight(vChild.getMinHeightValue());}if(vJobs.maxHeight){vChild._computedMaxHeightTypeNull?vChild._resetRuntimeMaxHeight():vChild._renderRuntimeMaxHeight(vChild.getMaxHeightValue());}else if(vJobs.initial&&!vChild._computedMaxHeightTypeNull){vChild._renderRuntimeMaxHeight(vChild.getMaxHeightValue());}}}),layoutChild_marginX:function(vChild,vJobs){if(vJobs.marginLeft||vJobs.initial){var vValueLeft=vChild.getMarginLeft();vValueLeft!=null?vChild._renderRuntimeMarginLeft(vValueLeft):vChild._resetRuntimeMarginLeft();}if(vJobs.marginRight||vJobs.initial){var vValueRight=vChild.getMarginRight();vValueRight!=null?vChild._renderRuntimeMarginRight(vValueRight):vChild._resetRuntimeMarginRight();}},layoutChild_marginY:function(vChild,vJobs){if(vJobs.marginTop||vJobs.initial){var vValueTop=vChild.getMarginTop();vValueTop!=null?vChild._renderRuntimeMarginTop(vValueTop):vChild._resetRuntimeMarginTop();}if(vJobs.marginBottom||vJobs.initial){var vValueBottom=vChild.getMarginBottom();vValueBottom!=null?vChild._renderRuntimeMarginBottom(vValueBottom):vChild._resetRuntimeMarginBottom();}},layoutChild_sizeX_essentialWrapper:function(vChild,vJobs){return vChild._isWidthEssential()?this.layoutChild_sizeX(vChild,vJobs):vChild._resetRuntimeWidth();},layoutChild_sizeY_essentialWrapper:function(vChild,vJobs){return vChild._isHeightEssential()?this.layoutChild_sizeY(vChild,vJobs):vChild._resetRuntimeHeight();}},defer:function(statics,members){members.computeChildrenNeededWidth=members.computeChildrenNeededWidth_max;members.computeChildrenNeededHeight=members.computeChildrenNeededHeight_max;},destruct:function(){this._disposeFields("_widget");}});qx.Class.define("qx.legacy.ui.layout.impl.CanvasLayoutImpl",{extend:qx.legacy.ui.layout.impl.LayoutImpl,construct:function(vWidget){this.base(arguments,vWidget);},members:{computeChildBoxWidth:function(vChild){var vValue=null;if(vChild._computedLeftTypeNull||vChild._computedRightTypeNull){vValue=vChild.getWidthValue();}else if(vChild._hasParent){vValue=this.getWidget().getInnerWidth()-vChild.getLeftValue()-vChild.getRightValue();}return vValue||vChild._computeBoxWidthFallback();},computeChildBoxHeight:function(vChild){var vValue=null;if(vChild._computedTopTypeNull||vChild._computedBottomTypeNull){vValue=vChild.getHeightValue();}else if(vChild._hasParent){vValue=this.getWidget().getInnerHeight()-vChild.getTopValue()-vChild.getBottomValue();}return vValue||vChild._computeBoxHeightFallback();},computeChildNeededWidth:function(vChild){var vLeft=vChild._computedLeftTypePercent?null:vChild.getLeftValue();var vRight=vChild._computedRightTypePercent?null:vChild.getRightValue();var vMinBox=vChild._computedMinWidthTypePercent?null:vChild.getMinWidthValue();var vMaxBox=vChild._computedMaxWidthTypePercent?null:vChild.getMaxWidthValue();if(vLeft!=null&&vRight!=null){var vBox=vChild.getPreferredBoxWidth()||0;}else{var vBox=(vChild._computedWidthTypePercent?null:vChild.getWidthValue())||vChild.getPreferredBoxWidth()||0;}return qx.lang.Number.limit(vBox,vMinBox,vMaxBox)+vLeft+vRight+vChild.getMarginLeft()+vChild.getMarginRight();},computeChildNeededHeight:function(vChild){var vTop=vChild._computedTopTypePercent?null:vChild.getTopValue();var vBottom=vChild._computedBottomTypePercent?null:vChild.getBottomValue();var vMinBox=vChild._computedMinHeightTypePercent?null:vChild.getMinHeightValue();var vMaxBox=vChild._computedMaxHeightTypePercent?null:vChild.getMaxHeightValue();if(vTop!=null&&vBottom!=null){var vBox=vChild.getPreferredBoxHeight()||0;}else{var vBox=(vChild._computedHeightTypePercent?null:vChild.getHeightValue())||vChild.getPreferredBoxHeight()||0;}return qx.lang.Number.limit(vBox,vMinBox,vMaxBox)+vTop+vBottom+vChild.getMarginTop()+vChild.getMarginBottom();},updateChildOnInnerWidthChange:function(vChild){var vUpdatePercent=vChild._recomputePercentX();var vUpdateRange=vChild._recomputeRangeX();return vUpdatePercent||vUpdateRange;},updateChildOnInnerHeightChange:function(vChild){var vUpdatePercent=vChild._recomputePercentY();var vUpdateRange=vChild._recomputeRangeY();return vUpdatePercent||vUpdateRange;},layoutChild:function(vChild,vJobs){this.layoutChild_sizeX_essentialWrapper(vChild,vJobs);this.layoutChild_sizeY_essentialWrapper(vChild,vJobs);this.layoutChild_sizeLimitX(vChild,vJobs);this.layoutChild_sizeLimitY(vChild,vJobs);this.layoutChild_locationX(vChild,vJobs);this.layoutChild_locationY(vChild,vJobs);this.layoutChild_marginX(vChild,vJobs);this.layoutChild_marginY(vChild,vJobs);},layoutChild_sizeX:qx.core.Variant.select("qx.client",{"mshtml|opera|webkit":function(vChild,vJobs){if(vJobs.initial||vJobs.width||vJobs.minWidth||vJobs.maxWidth||vJobs.left||vJobs.right){if(vChild._computedMinWidthTypeNull&&vChild._computedWidthTypeNull&&vChild._computedMaxWidthTypeNull&&!(!vChild._computedLeftTypeNull&&!vChild._computedRightTypeNull)){vChild._resetRuntimeWidth();}else{vChild._renderRuntimeWidth(vChild.getBoxWidth());}}},"default":function(vChild,vJobs){if(vJobs.initial||vJobs.width){vChild._computedWidthTypeNull?vChild._resetRuntimeWidth():vChild._renderRuntimeWidth(vChild.getWidthValue());}}}),layoutChild_sizeY:qx.core.Variant.select("qx.client",{"mshtml|opera|webkit":function(vChild,vJobs){if(vJobs.initial||vJobs.height||vJobs.minHeight||vJobs.maxHeight||vJobs.top||vJobs.bottom){if(vChild._computedMinHeightTypeNull&&vChild._computedHeightTypeNull&&vChild._computedMaxHeightTypeNull&&!(!vChild._computedTopTypeNull&&!vChild._computedBottomTypeNull)){vChild._resetRuntimeHeight();}else{vChild._renderRuntimeHeight(vChild.getBoxHeight());}}},"default":function(vChild,vJobs){if(vJobs.initial||vJobs.height){vChild._computedHeightTypeNull?vChild._resetRuntimeHeight():vChild._renderRuntimeHeight(vChild.getHeightValue());}}}),layoutChild_locationX:function(vChild,vJobs){var vWidget=this.getWidget();if(vJobs.initial||vJobs.left||vJobs.parentPaddingLeft){vChild._computedLeftTypeNull?vChild._computedRightTypeNull&&vWidget.getPaddingLeft()>0?vChild._renderRuntimeLeft(vWidget.getPaddingLeft()):vChild._resetRuntimeLeft():vChild._renderRuntimeLeft(vChild.getLeftValue()+vWidget.getPaddingLeft());}if(vJobs.initial||vJobs.right||vJobs.parentPaddingRight){vChild._computedRightTypeNull?vChild._computedLeftTypeNull&&vWidget.getPaddingRight()>0?vChild._renderRuntimeRight(vWidget.getPaddingRight()):vChild._resetRuntimeRight():vChild._renderRuntimeRight(vChild.getRightValue()+vWidget.getPaddingRight());}},layoutChild_locationY:function(vChild,vJobs){var vWidget=this.getWidget();if(vJobs.initial||vJobs.top||vJobs.parentPaddingTop){vChild._computedTopTypeNull?vChild._computedBottomTypeNull&&vWidget.getPaddingTop()>0?vChild._renderRuntimeTop(vWidget.getPaddingTop()):vChild._resetRuntimeTop():vChild._renderRuntimeTop(vChild.getTopValue()+vWidget.getPaddingTop());}if(vJobs.initial||vJobs.bottom||vJobs.parentPaddingBottom){vChild._computedBottomTypeNull?vChild._computedTopTypeNull&&vWidget.getPaddingBottom()>0?vChild._renderRuntimeBottom(vWidget.getPaddingBottom()):vChild._resetRuntimeBottom():vChild._renderRuntimeBottom(vChild.getBottomValue()+vWidget.getPaddingBottom());}}}});qx.Class.define("qx.legacy.event.handler.EventHandler",{type:"singleton",extend:qx.core.Object,construct:function(){this.base(arguments);this.__onmouseevent=qx.lang.Function.bind(this._onmouseevent,this);this.__ondragevent=qx.lang.Function.bind(this._ondragevent,this);this.__onselectevent=qx.lang.Function.bind(this._onselectevent,this);this.__onwindowblur=qx.lang.Function.bind(this._onwindowblur,this);this.__onwindowfocus=qx.lang.Function.bind(this._onwindowfocus,this);this.__onwindowresize=qx.lang.Function.bind(this._onwindowresize,this);this._commands={};},events:{"error":"qx.event.type.Data"},statics:{mouseEventTypes:["mouseover","mousemove","mouseout","mousedown","mouseup","click","dblclick","contextmenu",qx.core.Variant.isSet("qx.client","gecko")?"DOMMouseScroll":"mousewheel"],keyEventTypes:["keydown","keypress","keyup"],dragEventTypes:qx.core.Variant.select("qx.client",{"gecko":["dragdrop","dragover","dragenter","dragexit","draggesture"],"mshtml":["dragend","dragover","dragstart","drag","dragenter","dragleave"],"default":["dragstart","dragdrop","dragover","drag","dragleave","dragenter","dragexit","draggesture"]}),getDomTarget:qx.core.Variant.select("qx.client",{"mshtml":function(vDomEvent){return vDomEvent.target||vDomEvent.srcElement;},"webkit":function(vDomEvent){var vNode=vDomEvent.target||vDomEvent.srcElement;if(vNode&&(vNode.nodeType==qx.dom.Node.TEXT)){vNode=vNode.parentNode;}return vNode;},"default":function(vDomEvent){return vDomEvent.target;}}),stopDomEvent:function(vDomEvent){if(vDomEvent.preventDefault){vDomEvent.preventDefault();}vDomEvent.returnValue=false;},getOriginalTargetObject:function(vNode){if(vNode==document.documentElement){vNode=document.body;}while(vNode!=null&&vNode.qx_Widget==null){try{vNode=vNode.parentNode;}catch(vDomEvent){vNode=null;}}return vNode?vNode.qx_Widget:null;},getOriginalTargetObjectFromEvent:function(vDomEvent,vWindow){var vNode=qx.legacy.event.handler.EventHandler.getDomTarget(vDomEvent);if(vWindow){var vDocument=vWindow.document;if(vNode==vWindow||vNode==vDocument||vNode==vDocument.documentElement||vNode==vDocument.body){return vDocument.body.qx_Widget;}}return qx.legacy.event.handler.EventHandler.getOriginalTargetObject(vNode);},getRelatedOriginalTargetObjectFromEvent:function(vDomEvent){return qx.legacy.event.handler.EventHandler.getOriginalTargetObject(vDomEvent.relatedTarget||(vDomEvent.type=="mouseover"?vDomEvent.fromElement:vDomEvent.toElement));},getTargetObject:function(vNode,vObject,allowDisabled){if(!vObject){var vObject=qx.legacy.event.handler.EventHandler.getOriginalTargetObject(vNode);if(!vObject){return null;}}while(vObject){if(!allowDisabled&&!vObject.getEnabled()){return null;}if(!vObject.getAnonymous()){break;}vObject=vObject.getParent();}return vObject;},getTargetObjectFromEvent:function(vDomEvent){return qx.legacy.event.handler.EventHandler.getTargetObject(qx.legacy.event.handler.EventHandler.getDomTarget(vDomEvent));},getRelatedTargetObjectFromEvent:function(vDomEvent){var target=vDomEvent.relatedTarget;if(!target){if(vDomEvent.type=="mouseover"){target=vDomEvent.fromElement;}else{target=vDomEvent.toElement;}}return qx.legacy.event.handler.EventHandler.getTargetObject(target);}},properties:{allowClientContextMenu:{check:"Boolean",init:false},allowClientSelectAll:{check:"Boolean",init:false},captureWidget:{check:"qx.legacy.ui.core.Widget",nullable:true,apply:"_applyCaptureWidget"},focusRoot:{check:"qx.legacy.ui.core.Parent",nullable:true,apply:"_applyFocusRoot"}},members:{_lastMouseEventType:null,_lastMouseDown:false,_lastMouseEventDate:0,_applyCaptureWidget:function(value,old){if(old){old.setCapture(false);}if(value){value.setCapture(true);}},_applyFocusRoot:function(value,old){if(old){old.setFocusedChild(null);}if(value&&value.getFocusedChild()==null){value.setFocusedChild(value);}},addCommand:function(vCommand){this._commands[vCommand.toHashCode()]=vCommand;},removeCommand:function(vCommand){delete this._commands[vCommand.toHashCode()];},_checkKeyEventMatch:function(e){var vCommand;for(var vHash in this._commands){vCommand=this._commands[vHash];if(vCommand.getEnabled()&&vCommand.matchesKeyEvent(e)){if(!vCommand.execute(e.getTarget())){e.preventDefault();}break;}}},attachEvents:function(){this.attachEventTypes(qx.legacy.event.handler.EventHandler.mouseEventTypes,this.__onmouseevent);this.attachEventTypes(qx.legacy.event.handler.EventHandler.dragEventTypes,this.__ondragevent);qx.legacy.event.handler.KeyEventHandler.getInstance()._attachEvents();qx.legacy.html.EventRegistration.addListener(window,"blur",this.__onwindowblur);qx.legacy.html.EventRegistration.addListener(window,"focus",this.__onwindowfocus);qx.legacy.html.EventRegistration.addListener(window,"resize",this.__onwindowresize);document.body.onselect=document.onselectstart=document.onselectionchange=this.__onselectevent;},detachEvents:function(){this.detachEventTypes(qx.legacy.event.handler.EventHandler.mouseEventTypes,this.__onmouseevent);this.detachEventTypes(qx.legacy.event.handler.EventHandler.dragEventTypes,this.__ondragevent);qx.legacy.event.handler.KeyEventHandler.getInstance()._detachEvents();qx.legacy.html.EventRegistration.removeListener(window,"blur",this.__onwindowblur);qx.legacy.html.EventRegistration.removeListener(window,"focus",this.__onwindowfocus);qx.legacy.html.EventRegistration.removeListener(window,"resize",this.__onwindowresize);document.body.onselect=document.onselectstart=document.onselectionchange=null;},attachEventTypes:function(vEventTypes,vFunctionPointer){try{var el=qx.core.Variant.isSet("qx.client","gecko")?window:document.body;for(var i=0,l=vEventTypes.length;i<l;i++){qx.legacy.html.EventRegistration.addListener(el,vEventTypes[i],vFunctionPointer);}}catch(ex){throw new Error("qx.legacy.event.handler.EventHandler: Failed to attach window event types: "+vEventTypes+": "+ex);}},detachEventTypes:function(vEventTypes,vFunctionPointer){try{var el=qx.core.Variant.isSet("qx.client","gecko")?window:document.body;for(var i=0,l=vEventTypes.length;i<l;i++){qx.legacy.html.EventRegistration.removeListener(el,vEventTypes[i],vFunctionPointer);}}catch(ex){throw new Error("qx.legacy.event.handler.EventHandler: Failed to detach window event types: "+vEventTypes+": "+ex);}},_onkeyevent_post:function(vDomEvent,vType,vKeyCode,vCharCode,vKeyIdentifier){var vDomTarget=qx.legacy.event.handler.EventHandler.getDomTarget(vDomEvent);var vFocusRoot=this.getFocusRoot();var vTarget=this.getCaptureWidget()||(vFocusRoot==null?null:vFocusRoot.getActiveChild());var vKeyEventObject=new qx.legacy.event.type.KeyEvent(vType,vDomEvent,vDomTarget,vTarget,null,vKeyCode,vCharCode,vKeyIdentifier);if(vType=="keydown"){this._checkKeyEventMatch(vKeyEventObject);}if(vTarget!=null&&vTarget.getEnabled()){switch(vKeyIdentifier){case "Escape":case "Tab":if(qx.Class.isDefined("qx.legacy.ui.menu.Manager")){qx.legacy.ui.menu.Manager.getInstance().update(vTarget,vType);}break;}if(!this.getAllowClientSelectAll()){if(vDomEvent.ctrlKey&&vKeyIdentifier=="A"){switch(vDomTarget.tagName.toLowerCase()){case "input":case "textarea":case "iframe":break;default:qx.legacy.event.handler.EventHandler.stopDomEvent(vDomEvent);}}}try{vTarget.dispatchEvent(vKeyEventObject);if(qx.Class.isDefined("qx.legacy.event.handler.DragAndDropHandler")){qx.legacy.event.handler.DragAndDropHandler.getInstance().handleKeyEvent(vKeyEventObject);}}catch(ex){this.error("Failed to dispatch key event",ex);this.fireDataEvent("error",ex);}}vKeyEventObject.dispose();},_onmouseevent:qx.core.Variant.select("qx.client",{"mshtml":function(vDomEvent){if(!vDomEvent){vDomEvent=window.event;}var vDomTarget=qx.legacy.event.handler.EventHandler.getDomTarget(vDomEvent);var vType=vDomEvent.type;if(vType=="mousemove"){if(this._mouseIsDown&&vDomEvent.button==0){this._onmouseevent_post(vDomEvent,"mouseup");this._mouseIsDown=false;}}else{if(vType=="mousedown"){this._mouseIsDown=true;}else if(vType=="mouseup"){this._mouseIsDown=false;}if(vType=="mouseup"&&!this._lastMouseDown&&((new Date).valueOf()-this._lastMouseEventDate)<250){this._onmouseevent_post(vDomEvent,"mousedown");}else if(vType=="dblclick"&&this._lastMouseEventType=="mouseup"&&((new Date).valueOf()-this._lastMouseEventDate)<250){this._onmouseevent_post(vDomEvent,"click");}switch(vType){case "mousedown":case "mouseup":case "click":case "dblclick":case "contextmenu":this._lastMouseEventType=vType;this._lastMouseEventDate=(new Date).valueOf();this._lastMouseDown=vType=="mousedown";}}this._onmouseevent_post(vDomEvent,vType,vDomTarget);},"default":function(vDomEvent){var vDomTarget=qx.legacy.event.handler.EventHandler.getDomTarget(vDomEvent);var vType=vDomEvent.type;switch(vType){case "DOMMouseScroll":vType="mousewheel";break;case "click":case "dblclick":if(vDomEvent.which!==1){return;}}this._onmouseevent_post(vDomEvent,vType,vDomTarget);}}),_onmouseevent_click_fix:qx.core.Variant.select("qx.client",{"gecko":function(vDomTarget,vType,vDispatchTarget){var vReturn=false;switch(vType){case "mousedown":this._lastMouseDownDomTarget=vDomTarget;this._lastMouseDownDispatchTarget=vDispatchTarget;break;case "mouseup":if(this._lastMouseDownDispatchTarget===vDispatchTarget&&vDomTarget!==this._lastMouseDownDomTarget){vReturn=true;}else{this._lastMouseDownDomTarget=null;this._lastMouseDownDispatchTarget=null;}}return vReturn;},"default":null}),_onmouseevent_post:function(vDomEvent,vType,vDomTarget){var vEventObject,vCaptureTarget,vDispatchTarget,vTarget,vOriginalTarget,vRelatedTarget,vFixClick,vTargetIsEnabled;vCaptureTarget=this.getCaptureWidget();vOriginalTarget=qx.legacy.event.handler.EventHandler.getOriginalTargetObject(vDomTarget);if(!vCaptureTarget){vDispatchTarget=vTarget=qx.legacy.event.handler.EventHandler.getTargetObject(null,vOriginalTarget,true);}else{vDispatchTarget=vCaptureTarget;vTarget=qx.legacy.event.handler.EventHandler.getTargetObject(null,vOriginalTarget,true);}if(!vTarget){return;}vTargetIsEnabled=vTarget.getEnabled();if(qx.core.Variant.isSet("qx.client","gecko")){vFixClick=this._onmouseevent_click_fix(vDomTarget,vType,vDispatchTarget);}if(vType=="contextmenu"&&!this.getAllowClientContextMenu()){qx.legacy.event.handler.EventHandler.stopDomEvent(vDomEvent);}if(vTargetIsEnabled&&vType=="mousedown"){qx.legacy.event.handler.FocusHandler.mouseFocus=true;var vRoot=vTarget.getFocusRoot();if(vRoot){this.setFocusRoot(vRoot);var vFocusTarget=vTarget;while(!vFocusTarget.isFocusable()&&vFocusTarget!=vRoot){vFocusTarget=vFocusTarget.getParent();}vRoot.setFocusedChild(vFocusTarget);vRoot.setActiveChild(vTarget);}}switch(vType){case "mouseover":case "mouseout":vRelatedTarget=qx.legacy.event.handler.EventHandler.getRelatedTargetObjectFromEvent(vDomEvent);if(vRelatedTarget==vTarget){return;}}vEventObject=new qx.legacy.event.type.MouseEvent(vType,vDomEvent,vDomTarget,vTarget,vOriginalTarget,vRelatedTarget);qx.legacy.event.type.MouseEvent.storeEventState(vEventObject);if(vTargetIsEnabled){var vEventWasProcessed=false;vEventWasProcessed=vDispatchTarget?vDispatchTarget.dispatchEvent(vEventObject):true;this._onmouseevent_special_post(vType,vTarget,vOriginalTarget,vDispatchTarget,vEventWasProcessed,vEventObject,vDomEvent);}else{if(vType=="mouseover"){if(qx.Class.isDefined("qx.legacy.ui.popup.ToolTipManager")){qx.legacy.ui.popup.ToolTipManager.getInstance().handleMouseOver(vEventObject);}}}vEventObject.dispose();vEventObject=null;if(vFixClick){this._onmouseevent_post(vDomEvent,"click",this._lastMouseDownDomTarget);this._lastMouseDownDomTarget=null;this._lastMouseDownDispatchTarget=null;}},_onmouseevent_special_post:function(vType,vTarget,vOriginalTarget,vDispatchTarget,vEventWasProcessed,vEventObject,vDomEvent){switch(vType){case "mousedown":if(qx.Class.isDefined("qx.legacy.ui.popup.PopupManager")){qx.legacy.ui.popup.PopupManager.getInstance().update(vTarget);}if(qx.Class.isDefined("qx.legacy.ui.menu.Manager")){qx.legacy.ui.menu.Manager.getInstance().update(vTarget,vType);}if(qx.Class.isDefined("qx.legacy.ui.embed.IframeManager")){qx.legacy.ui.embed.IframeManager.getInstance().handleMouseDown(vEventObject);}break;case "mouseup":if(qx.Class.isDefined("qx.legacy.ui.menu.Manager")){qx.legacy.ui.menu.Manager.getInstance().update(vTarget,vType);}if(qx.Class.isDefined("qx.legacy.ui.embed.IframeManager")){qx.legacy.ui.embed.IframeManager.getInstance().handleMouseUp(vEventObject);}break;case "mouseover":if(qx.Class.isDefined("qx.legacy.ui.popup.ToolTipManager")){qx.legacy.ui.popup.ToolTipManager.getInstance().handleMouseOver(vEventObject);}break;case "mouseout":if(qx.Class.isDefined("qx.legacy.ui.popup.ToolTipManager")){qx.legacy.ui.popup.ToolTipManager.getInstance().handleMouseOut(vEventObject);}break;}this._ignoreWindowBlur=vType==="mousedown";if(qx.Class.isDefined("qx.legacy.event.handler.DragAndDropHandler")&&vTarget){qx.legacy.event.handler.DragAndDropHandler.getInstance().handleMouseEvent(vEventObject);}},_ondragevent:function(vEvent){if(!vEvent){vEvent=window.event;}qx.legacy.event.handler.EventHandler.stopDomEvent(vEvent);},_onselectevent:function(e){if(!e){e=window.event;}var target=qx.legacy.event.handler.EventHandler.getOriginalTargetObjectFromEvent(e);while(target){if(target.getSelectable()!=null){if(!target.getSelectable()){qx.legacy.event.handler.EventHandler.stopDomEvent(e);}break;}target=target.getParent();}},_focused:false,_onwindowblur:function(e){if(!this._focused||this._ignoreWindowBlur){return;}this._focused=false;this.setCaptureWidget(null);if(qx.Class.isDefined("qx.legacy.ui.popup.PopupManager")){qx.legacy.ui.popup.PopupManager.getInstance().update();}if(qx.Class.isDefined("qx.legacy.ui.menu.Manager")){qx.legacy.ui.menu.Manager.getInstance().update();}if(qx.Class.isDefined("qx.legacy.event.handler.DragAndDropHandler")){qx.legacy.event.handler.DragAndDropHandler.getInstance().globalCancelDrag();}qx.legacy.ui.core.ClientDocument.getInstance().fireEvent("windowblur");},_onwindowfocus:function(e){if(this._focused){return;}this._focused=true;qx.legacy.ui.core.ClientDocument.getInstance().fireEvent("windowfocus");},_onwindowresize:function(e){qx.legacy.ui.core.ClientDocument.getInstance().fireEvent("windowresize");}},destruct:function(){this.detachEvents();this._disposeMap("_commands");this._disposeFields("__onmouseevent","__ondragevent","__onselectevent","__onwindowblur","__onwindowfocus","__onwindowresize");this._disposeFields("_lastMouseEventType","_lastMouseDown","_lastMouseEventDate","_lastMouseDownDomTarget","_lastMouseDownDispatchTarget");}});qx.Class.define("qx.legacy.event.handler.KeyEventHandler",{type:"singleton",extend:qx.core.Object,construct:function(){this.base(arguments);this._lastUpDownType={};this.__onKeyPress=qx.lang.Function.bind(this._onKeyPress,this);this.__onkeyupdown=qx.lang.Function.bind(this._onkeyupdown,this);},members:{_attachEvents:function(){var el=qx.core.Variant.isSet("qx.client","gecko")?window:document.body;qx.legacy.html.EventRegistration.addListener(el,"keypress",this.__onKeyPress);qx.legacy.html.EventRegistration.addListener(el,"keyup",this.__onkeyupdown);qx.legacy.html.EventRegistration.addListener(el,"keydown",this.__onkeyupdown);},_detachEvents:function(){var el=qx.core.Variant.isSet("qx.client","gecko")?window:document.body;qx.legacy.html.EventRegistration.removeListener(el,"keypress",this.__onKeyPress);qx.legacy.html.EventRegistration.removeListener(el,"keyup",this.__onkeyupdown);qx.legacy.html.EventRegistration.removeListener(el,"keydown",this.__onkeyupdown);},_onkeyupdown:qx.core.Variant.select("qx.client",{"mshtml":function(domEvent){domEvent=window.event||domEvent;var keyCode=domEvent.keyCode;var charCode=0;var type=domEvent.type;if(!(this._lastUpDownType[keyCode]=="keydown"&&type=="keydown")){this._idealKeyHandler(keyCode,charCode,type,domEvent);}if(type=="keydown"){if(this._isNonPrintableKeyCode(keyCode)||keyCode==8||keyCode==9){this._idealKeyHandler(keyCode,charCode,"keypress",domEvent);}}this._lastUpDownType[keyCode]=type;},"gecko":function(domEvent){var keyCode=this._keyCodeFix[domEvent.keyCode]||domEvent.keyCode;var charCode=domEvent.charCode;var type=domEvent.type;if(qx.legacy.core.Client.getInstance().runsOnWindows()){var keyIdentifier=keyCode?this._keyCodeToIdentifier(keyCode):this._charCodeToIdentifier(charCode);if(!(this._lastUpDownType[keyIdentifier]=="keypress"&&type=="keydown")){this._idealKeyHandler(keyCode,charCode,type,domEvent);}this._lastUpDownType[keyIdentifier]=type;}else{this._idealKeyHandler(keyCode,charCode,type,domEvent);}},"webkit":function(domEvent){var charCode=0;var type=domEvent.type;if(qx.bom.client.Engine.VERSION<525.13){var keyCode=0;if(qx.legacy.core.Client.getInstance().getVersion()<420){if(!this._lastCharCodeForType){this._lastCharCodeForType={};}var isSafariSpecialKey=this._lastCharCodeForType[type]>63000;if(isSafariSpecialKey){this._lastCharCodeForType[type]=null;return;}this._lastCharCodeForType[type]=domEvent.charCode;}if(type=="keyup"||type=="keydown"){keyCode=this._charCode2KeyCode[domEvent.charCode]||domEvent.keyCode;}else{if(this._charCode2KeyCode[domEvent.charCode]){keyCode=this._charCode2KeyCode[domEvent.charCode];}else{charCode=domEvent.charCode;}}this._idealKeyHandler(keyCode,charCode,type,domEvent);}else{var keyCode=domEvent.keyCode;if(!(this._lastUpDownType[keyCode]=="keydown"&&type=="keydown")){this._idealKeyHandler(keyCode,charCode,type,domEvent);}if(type=="keydown"){if(this._isNonPrintableKeyCode(keyCode)||keyCode==8||keyCode==9){this._idealKeyHandler(keyCode,charCode,"keypress",domEvent);}}this._lastUpDownType[keyCode]=type;}},"opera":function(domEvent){this._idealKeyHandler(domEvent.keyCode,0,domEvent.type,domEvent);},"default":function(){throw new Error("Unsupported browser for key event handler!");}}),_onKeyPress:qx.core.Variant.select("qx.client",{"mshtml":function(domEvent){var domEvent=window.event||domEvent;if(this._charCode2KeyCode[domEvent.keyCode]){this._idealKeyHandler(this._charCode2KeyCode[domEvent.keyCode],0,domEvent.type,domEvent);}else{this._idealKeyHandler(0,domEvent.keyCode,domEvent.type,domEvent);}},"gecko":function(domEvent){var keyCode=this._keyCodeFix[domEvent.keyCode]||domEvent.keyCode;var charCode=domEvent.charCode;var type=domEvent.type;if(qx.legacy.core.Client.getInstance().runsOnWindows()){var keyIdentifier=keyCode?this._keyCodeToIdentifier(keyCode):this._charCodeToIdentifier(charCode);if(!(this._lastUpDownType[keyIdentifier]=="keypress"&&type=="keydown")){this._idealKeyHandler(keyCode,charCode,type,domEvent);}this._lastUpDownType[keyIdentifier]=type;}else{this._idealKeyHandler(keyCode,charCode,type,domEvent);}},"webkit":function(domEvent){if(qx.bom.client.Engine.VERSION<525.13){var keyCode=0;var charCode=0;var type=domEvent.type;if(qx.legacy.core.Client.getInstance().getVersion()<420){if(!this._lastCharCodeForType){this._lastCharCodeForType={};}var isSafariSpecialKey=this._lastCharCodeForType[type]>63000;if(isSafariSpecialKey){this._lastCharCodeForType[type]=null;return;}this._lastCharCodeForType[type]=domEvent.charCode;}if(type=="keyup"||type=="keydown"){keyCode=this._charCode2KeyCode[domEvent.charCode]||domEvent.keyCode;}else{if(this._charCode2KeyCode[domEvent.charCode]){keyCode=this._charCode2KeyCode[domEvent.charCode];}else{charCode=domEvent.charCode;}}this._idealKeyHandler(keyCode,charCode,type,domEvent);}else{if(this._charCode2KeyCode[domEvent.keyCode]){this._idealKeyHandler(this._charCode2KeyCode[domEvent.keyCode],0,domEvent.type,domEvent);}else{this._idealKeyHandler(0,domEvent.keyCode,domEvent.type,domEvent);}}},"opera":function(domEvent){if(this._keyCodeToIdentifierMap[domEvent.keyCode]){this._idealKeyHandler(domEvent.keyCode,0,domEvent.type,domEvent);}else{this._idealKeyHandler(0,domEvent.keyCode,domEvent.type,domEvent);}},"default":function(){throw new Error("Unsupported browser for key event handler!");}}),_specialCharCodeMap:{8:"Backspace",9:"Tab",13:"Enter",27:"Escape",32:"Space"},_keyCodeToIdentifierMap:{16:"Shift",17:"Control",18:"Alt",20:"CapsLock",224:"Meta",37:"Left",38:"Up",39:"Right",40:"Down",33:"PageUp",34:"PageDown",35:"End",36:"Home",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",44:"PrintScreen",145:"Scroll",19:"Pause",91:"Win",93:"Apps"},_numpadToCharCode:{96:"0".charCodeAt(0),97:"1".charCodeAt(0),98:"2".charCodeAt(0),99:"3".charCodeAt(0),100:"4".charCodeAt(0),101:"5".charCodeAt(0),102:"6".charCodeAt(0),103:"7".charCodeAt(0),104:"8".charCodeAt(0),105:"9".charCodeAt(0),106:"*".charCodeAt(0),107:"+".charCodeAt(0),109:"-".charCodeAt(0),110:",".charCodeAt(0),111:"/".charCodeAt(0)},_charCodeA:"A".charCodeAt(0),_charCodeZ:"Z".charCodeAt(0),_charCode0:"0".charCodeAt(0),_charCode9:"9".charCodeAt(0),_isNonPrintableKeyCode:function(keyCode){return this._keyCodeToIdentifierMap[keyCode]?true:false;},_isIdentifiableKeyCode:function(keyCode){if(keyCode>=this._charCodeA&&keyCode<=this._charCodeZ){return true;}if(keyCode>=this._charCode0&&keyCode<=this._charCode9){return true;}if(this._specialCharCodeMap[keyCode]){return true;}if(this._numpadToCharCode[keyCode]){return true;}if(this._isNonPrintableKeyCode(keyCode)){return true;}return false;},isValidKeyIdentifier:function(keyIdentifier){if(this._identifierToKeyCodeMap[keyIdentifier]){return true;}if(keyIdentifier.length!=1){return false;}if(keyIdentifier>="0"&&keyIdentifier<="9"){return true;}if(keyIdentifier>="A"&&keyIdentifier<="Z"){return true;}switch(keyIdentifier){case "+":case "-":case "*":case "/":return true;default:return false;}},_keyCodeToIdentifier:function(keyCode){if(this._isIdentifiableKeyCode(keyCode)){var numPadKeyCode=this._numpadToCharCode[keyCode];if(numPadKeyCode){return String.fromCharCode(numPadKeyCode);}return (this._keyCodeToIdentifierMap[keyCode]||this._specialCharCodeMap[keyCode]||String.fromCharCode(keyCode));}else{return "Unidentified";}},_charCodeToIdentifier:function(charCode){return this._specialCharCodeMap[charCode]||String.fromCharCode(charCode).toUpperCase();},_identifierToKeyCode:function(keyIdentifier){return this._identifierToKeyCodeMap[keyIdentifier]||keyIdentifier.charCodeAt(0);},_idealKeyHandler:function(keyCode,charCode,eventType,domEvent){if(!keyCode&&!charCode){return;}var keyIdentifier;if(keyCode){keyIdentifier=this._keyCodeToIdentifier(keyCode);qx.legacy.event.handler.EventHandler.getInstance()._onkeyevent_post(domEvent,eventType,keyCode,charCode,keyIdentifier);}else{keyIdentifier=this._charCodeToIdentifier(charCode);qx.legacy.event.handler.EventHandler.getInstance()._onkeyevent_post(domEvent,"keypress",keyCode,charCode,keyIdentifier);qx.legacy.event.handler.EventHandler.getInstance()._onkeyevent_post(domEvent,"keyinput",keyCode,charCode,keyIdentifier);}}},defer:function(statics,members,properties){if(!members._identifierToKeyCodeMap){members._identifierToKeyCodeMap={};for(var key in members._keyCodeToIdentifierMap){members._identifierToKeyCodeMap[members._keyCodeToIdentifierMap[key]]=parseInt(key);}for(var key in members._specialCharCodeMap){members._identifierToKeyCodeMap[members._specialCharCodeMap[key]]=parseInt(key);}}if(qx.core.Variant.isSet("qx.client","mshtml")){members._charCode2KeyCode={13:13,27:27};}else if(qx.core.Variant.isSet("qx.client","gecko")){members._keyCodeFix={12:members._identifierToKeyCode("NumLock")};}else if(qx.core.Variant.isSet("qx.client","webkit")){if(qx.bom.client.Engine.VERSION<525.13){members._charCode2KeyCode={63289:members._identifierToKeyCode("NumLock"),63276:members._identifierToKeyCode("PageUp"),63277:members._identifierToKeyCode("PageDown"),63275:members._identifierToKeyCode("End"),63273:members._identifierToKeyCode("Home"),63234:members._identifierToKeyCode("Left"),63232:members._identifierToKeyCode("Up"),63235:members._identifierToKeyCode("Right"),63233:members._identifierToKeyCode("Down"),63272:members._identifierToKeyCode("Delete"),63302:members._identifierToKeyCode("Insert"),63236:members._identifierToKeyCode("F1"),63237:members._identifierToKeyCode("F2"),63238:members._identifierToKeyCode("F3"),63239:members._identifierToKeyCode("F4"),63240:members._identifierToKeyCode("F5"),63241:members._identifierToKeyCode("F6"),63242:members._identifierToKeyCode("F7"),63243:members._identifierToKeyCode("F8"),63244:members._identifierToKeyCode("F9"),63245:members._identifierToKeyCode("F10"),63246:members._identifierToKeyCode("F11"),63247:members._identifierToKeyCode("F12"),63248:members._identifierToKeyCode("PrintScreen"),3:members._identifierToKeyCode("Enter"),12:members._identifierToKeyCode("NumLock"),13:members._identifierToKeyCode("Enter")};}else{members._charCode2KeyCode={13:13,27:27};}}},destruct:function(){this._detachEvents();this._disposeFields("_lastUpDownType");}});qx.Class.define("qx.legacy.html.EventRegistration",{statics:{addListener:qx.core.Variant.select("qx.client",{"mshtml":function(vElement,vType,vFunction){vElement.attachEvent("on"+vType,vFunction);},"default":function(vElement,vType,vFunction){vElement.addEventListener(vType,vFunction,false);}}),removeListener:qx.core.Variant.select("qx.client",{"mshtml":function(vElement,vType,vFunction){vElement.detachEvent("on"+vType,vFunction);},"default":function(vElement,vType,vFunction){vElement.removeEventListener(vType,vFunction,false);}})}});qx.Class.define("qx.legacy.event.type.DomEvent",{extend:qx.event.type.Event,construct:function(vType,vDomEvent,vDomTarget,vTarget,vOriginalTarget){this.base(arguments);this.init(true,true);this.setType(vType);this.setDomEvent(vDomEvent);this.setDomTarget(vDomTarget);this.setTarget(vTarget);this.setOriginalTarget(vOriginalTarget);},statics:{SHIFT_MASK:1,CTRL_MASK:2,ALT_MASK:4,META_MASK:8},members:{_computeModifiers:function(){var mask=0;var evt=this.getDomEvent();if(evt.shiftKey)mask|=qx.legacy.event.type.DomEvent.SHIFT_MASK;if(evt.ctrlKey)mask|=qx.legacy.event.type.DomEvent.CTRL_MASK;if(evt.altKey)mask|=qx.legacy.event.type.DomEvent.ALT_MASK;if(evt.metaKey)mask|=qx.legacy.event.type.DomEvent.META_MASK;return mask;},isCtrlPressed:function(){return this.getDomEvent().ctrlKey;},isShiftPressed:function(){return this.getDomEvent().shiftKey;},isAltPressed:function(){return this.getDomEvent().altKey;},isMetaPressed:function(){return this.getDomEvent().metaKey;},isCtrlOrCommandPressed:function(){if(qx.legacy.core.Client.getInstance().runsOnMacintosh()){return this.getDomEvent().metaKey;}else{return this.getDomEvent().ctrlKey;}},setDefaultPrevented:qx.core.Variant.select("qx.client",{"mshtml":function(vValue){if(!vValue){return this.error("It is not possible to set preventDefault to false if it was true before!","setDefaultPrevented");}this.getDomEvent().returnValue=false;},"default":function(vValue){if(!vValue){return this.error("It is not possible to set preventDefault to false if it was true before!","setDefaultPrevented");}this.getDomEvent().preventDefault();this.getDomEvent().returnValue=false;}}),preventDefault:function(){this.setDefaultPrevented(true);}},defer:function(statics,members){qx.legacy.core.Property.addCachedProperty({name:"modifiers",defaultValue:null},members);qx.legacy.core.Property.addFastProperty({name:"bubbles",defaultValue:true,noCompute:true},members);qx.legacy.core.Property.addFastProperty({name:"domEvent",defaultValue:null,noCompute:true,setOnlyOnce:true},members);qx.legacy.core.Property.addFastProperty({name:"domTarget",defaultValue:null,noCompute:true,setOnlyOnce:true},members);qx.legacy.core.Property.addFastProperty({name:"originalTarget",defaultValue:null,setOnlyOnce:true},members);qx.legacy.core.Property.addFastProperty({name:"relatedTarget",defaultValue:null,setOnlyOnce:true},members);},destruct:function(){this._disposeFields("_valueDomEvent","_valueDomTarget","_valueOriginalTarget","_valueRelatedTarget");}});qx.Class.define("qx.legacy.event.type.KeyEvent",{extend:qx.legacy.event.type.DomEvent,construct:function(vType,vDomEvent,vDomTarget,vTarget,vOriginalTarget,vKeyCode,vCharCode,vKeyIdentifier){this.base(arguments,vType,vDomEvent,vDomTarget,vTarget,vOriginalTarget);this._keyCode=vKeyCode;this.setCharCode(vCharCode);this.setKeyIdentifier(vKeyIdentifier);},statics:{keys:{esc:27,enter:13,tab:9,space:32,up:38,down:40,left:37,right:39,shift:16,ctrl:17,alt:18,f1:112,f2:113,f3:114,f4:115,f5:116,f6:117,f7:118,f8:119,f9:120,f10:121,f11:122,f12:123,print:124,del:46,backspace:8,insert:45,home:36,end:35,pageup:33,pagedown:34,numlock:144,numpad_0:96,numpad_1:97,numpad_2:98,numpad_3:99,numpad_4:100,numpad_5:101,numpad_6:102,numpad_7:103,numpad_8:104,numpad_9:105,numpad_divide:111,numpad_multiply:106,numpad_minus:109,numpad_plus:107},codes:{}},members:{getKeyCode:function(){this.warn("Deprecated: please use getKeyIdentifier() instead.");this.trace();return this._keyCode;}},defer:function(statics,members){for(var i in statics.keys){statics.codes[statics.keys[i]]=i;}qx.legacy.core.Property.addFastProperty({name:"charCode",defaultValue:null,setOnlyOnce:true,noCompute:true},members);qx.legacy.core.Property.addFastProperty({name:"keyIdentifier",defaultValue:null,setOnlyOnce:true,noCompute:true},members);}});qx.Class.define("qx.legacy.event.type.MouseEvent",{extend:qx.legacy.event.type.DomEvent,construct:function(vType,vDomEvent,vDomTarget,vTarget,vOriginalTarget,vRelatedTarget){this.base(arguments,vType,vDomEvent,vDomTarget,vTarget,vOriginalTarget);if(vRelatedTarget){this.setRelatedTarget(vRelatedTarget);}},statics:{C_BUTTON_LEFT:"left",C_BUTTON_MIDDLE:"middle",C_BUTTON_RIGHT:"right",C_BUTTON_NONE:"none",_screenX:0,_screenY:0,_clientX:0,_clientY:0,_pageX:0,_pageY:0,_button:null,buttons:qx.core.Variant.select("qx.client",{"mshtml":{left:1,right:2,middle:4},"default":{left:0,right:2,middle:1}}),storeEventState:function(e){this._screenX=e.getScreenX();this._screenY=e.getScreenY();this._clientX=e.getClientX();this._clientY=e.getClientY();this._pageX=e.getPageX();this._pageY=e.getPageY();this._button=e.getButton();},getScreenX:function(){return this._screenX;},getScreenY:function(){return this._screenY;},getClientX:function(){return this._clientX;},getClientY:function(){return this._clientY;},getPageX:function(){return this._pageX;},getPageY:function(){return this._pageY;},getButton:function(){return this._button;}},defer:function(statics,members){qx.legacy.core.Property.addFastProperty({name:"button",readOnly:true},members);qx.legacy.core.Property.addFastProperty({name:"wheelDelta",readOnly:true},members);},members:{getPageX:qx.core.Variant.select("qx.client",{"mshtml":function(){return this.getDomEvent().clientX+qx.bom.Viewport.getScrollLeft(window);},"default":function(){return this.getDomEvent().pageX;}}),getPageY:qx.core.Variant.select("qx.client",{"mshtml":function(){return this.getDomEvent().clientY+qx.bom.Viewport.getScrollTop(window);},"default":function(){return this.getDomEvent().pageY;}}),getClientX:function(){return this.getDomEvent().clientX;},getClientY:function(){return this.getDomEvent().clientY;},getScreenX:function(){return this.getDomEvent().screenX;},getScreenY:function(){return this.getDomEvent().screenY;},isLeftButtonPressed:qx.core.Variant.select("qx.client",{"mshtml":function(){if(this.getType()=="click"){return true;}else{return this.getButton()===qx.legacy.event.type.MouseEvent.C_BUTTON_LEFT;}},"default":function(){return this.getButton()===qx.legacy.event.type.MouseEvent.C_BUTTON_LEFT;}}),isMiddleButtonPressed:function(){return this.getButton()===qx.legacy.event.type.MouseEvent.C_BUTTON_MIDDLE;},isRightButtonPressed:function(){return this.getButton()===qx.legacy.event.type.MouseEvent.C_BUTTON_RIGHT;},__buttons:qx.core.Variant.select("qx.client",{"mshtml":{1:"left",2:"right",4:"middle"},"default":{0:"left",2:"right",1:"middle"}}),getButton:function(){switch(this.getDomEvent().type){case "click":case "dblclick":return "left";case "contextmenu":return "right";default:return this.__buttons[this.getDomEvent().button]||"none";}},_computeWheelDelta:qx.core.Variant.select("qx.client",{"default":function(){return this.getDomEvent().wheelDelta/120;},"gecko":function(){return -(this.getDomEvent().detail/3);}})}});qx.Class.define("qx.legacy.util.ObjectManager",{extend:qx.core.Object,construct:function(){this.base(arguments);this._objects={};},members:{add:function(vObject){if(this.isDisposed()){return;}var hash=qx.core.ObjectRegistry.toHashCode(vObject);this._objects[hash]=vObject;return hash;},remove:function(vObject){if(this.isDisposed()){return false;}var hash=qx.core.ObjectRegistry.toHashCode(vObject);delete this._objects[hash];},has:function(vObject){var hash=qx.core.ObjectRegistry.toHashCode(vObject);return this._objects[hash]!==undefined;},get:function(vObject){var hash=qx.core.ObjectRegistry.toHashCode(vObject);return this._objects[hash];},getByHash:function(hash){return this._objects[hash];},getAll:function(){return this._objects;},enableAll:function(){for(var vHashCode in this._objects){this._objects[vHashCode].setEnabled(true);}},disableAll:function(){for(var vHashCode in this._objects){this._objects[vHashCode].setEnabled(false);}}},destruct:function(){this._disposeMap("_objects");}});qx.Class.define("qx.legacy.ui.embed.IframeManager",{type:"singleton",extend:qx.legacy.util.ObjectManager,construct:function(){this.base(arguments);this._blocked={};},members:{handleMouseDown:function(evt){var iframeMap=this._blockData=qx.lang.Object.copy(this.getAll());for(var key in iframeMap){iframeMap[key].block();}},handleMouseUp:function(evt){var iframeMap=this._blockData;for(var key in iframeMap){iframeMap[key].release();}}}});qx.Class.define("qx.legacy.ui.basic.Terminator",{extend:qx.legacy.ui.core.Widget,members:{renderPadding:function(changes){if(changes.paddingLeft){this._renderRuntimePaddingLeft(this.getPaddingLeft());}if(changes.paddingRight){this._renderRuntimePaddingRight(this.getPaddingRight());}if(changes.paddingTop){this._renderRuntimePaddingTop(this.getPaddingTop());}if(changes.paddingBottom){this._renderRuntimePaddingBottom(this.getPaddingBottom());}},_renderContent:function(){if(this._computedWidthTypePixel){this._cachedPreferredInnerWidth=null;}else{this._invalidatePreferredInnerWidth();}if(this._computedHeightTypePixel){this._cachedPreferredInnerHeight=null;}else{this._invalidatePreferredInnerHeight();}if(this._initialLayoutDone){this.addToJobQueue("load");}},_layoutPost:function(changes){if(changes.initial||changes.load||changes.width||changes.height){this._postApply();}},_postApply:qx.lang.Function.returnTrue,_computeBoxWidthFallback:function(){return this.getPreferredBoxWidth();},_computeBoxHeightFallback:function(){return this.getPreferredBoxHeight();},_computePreferredInnerWidth:qx.lang.Function.returnZero,_computePreferredInnerHeight:qx.lang.Function.returnZero,_isWidthEssential:function(){if(!this._computedLeftTypeNull&&!this._computedRightTypeNull){return true;}if(!this._computedWidthTypeNull&&!this._computedWidthTypeAuto){return true;}if(!this._computedMinWidthTypeNull&&!this._computedMinWidthTypeAuto){return true;}if(!this._computedMaxWidthTypeNull&&!this._computedMaxWidthTypeAuto){return true;}if(this._borderElement){return true;}return false;},_isHeightEssential:function(){if(!this._computedTopTypeNull&&!this._computedBottomTypeNull){return true;}if(!this._computedHeightTypeNull&&!this._computedHeightTypeAuto){return true;}if(!this._computedMinHeightTypeNull&&!this._computedMinHeightTypeAuto){return true;}if(!this._computedMaxHeightTypeNull&&!this._computedMaxHeightTypeAuto){return true;}if(this._borderElement){return true;}return false;}}});qx.Class.define("qx.legacy.ui.core.ClientDocumentBlocker",{extend:qx.legacy.ui.basic.Terminator,construct:function(){this.base(arguments);this.initTop();this.initLeft();this.initWidth();this.initHeight();this.initZIndex();},properties:{appearance:{refine:true,init:"client-document-blocker"},zIndex:{refine:true,init:1e8},top:{refine:true,init:0},left:{refine:true,init:0},width:{refine:true,init:"100%"},height:{refine:true,init:"100%"},display:{refine:true,init:false}},members:{getFocusRoot:function(){return null;}}});qx.Class.define("qx.legacy.theme.manager.Appearance",{type:"singleton",extend:qx.core.Object,construct:function(){this.base(arguments);this.__cache={};this.__stateMap={};this.__stateMapLength=1;},properties:{appearanceTheme:{check:"Theme",nullable:true,apply:"_applyAppearanceTheme",event:"changeAppearanceTheme"}},members:{_applyAppearanceTheme:function(value,old){this._currentTheme=value;this._oldTheme=old;if(qx.legacy.theme.manager.Meta.getInstance().getAutoSync()){this.syncAppearanceTheme();}},syncAppearanceTheme:function(){if(!this._currentTheme&&!this._oldTheme){return;}if(this._currentTheme){this.__cache[this._currentTheme.name]={};}if(qx.legacy.ui.core.Widget.$$uiReady){qx.legacy.ui.core.ClientDocument.getInstance()._recursiveAppearanceThemeUpdate(this._currentTheme,this._oldTheme);}if(this._oldTheme){delete this.__cache[this._oldTheme.name];}delete this._currentTheme;delete this._oldTheme;},styleFrom:function(id,states){var theme=this.getAppearanceTheme();if(!theme){return;}return this.styleFromTheme(theme,id,states);},styleFromTheme:function(theme,id,states){var entry=theme.appearances[id];if(!entry){{};return null;}if(!entry.style){if(entry.include){return this.styleFromTheme(theme,entry.include,states);}else{return null;}}var map=this.__stateMap;var helper=[id];for(var state in states){if(!map[state]){map[state]=this.__stateMapLength++;}helper[map[state]]=true;}var unique=helper.join();var cache=this.__cache[theme.name];if(cache&&cache[unique]!==undefined){return cache[unique];}var result;if(entry.include||entry.base){var local=entry.style(states);var incl;if(entry.include){incl=this.styleFromTheme(theme,entry.include,states);}result={};if(entry.base){var base=this.styleFromTheme(entry.base,id,states);if(entry.include){for(var key in base){if(incl[key]===undefined&&local[key]===undefined){result[key]=base[key];}}}else{for(var key in base){if(local[key]===undefined){result[key]=base[key];}}}}if(entry.include){for(var key in incl){if(local[key]===undefined){result[key]=incl[key];}}}for(var key in local){result[key]=local[key];}}else{result=entry.style(states);}if(cache){cache[unique]=result||null;}return result||null;}},destruct:function(){this._disposeFields("__cache","__stateMap");}});qx.Class.define("qx.legacy.theme.manager.Meta",{type:"singleton",extend:qx.core.Object,properties:{theme:{check:"Theme",nullable:true,apply:"_applyTheme",event:"changeTheme"},autoSync:{check:"Boolean",init:true,apply:"_applyAutoSync"}},members:{_applyTheme:function(value,old){var color=null;var border=null;var font=null;var widget=null;var icon=null;var appearance=null;if(value){color=value.meta.color||null;border=value.meta.border||null;font=value.meta.font||null;widget=value.meta.widget||null;icon=value.meta.icon||null;appearance=value.meta.appearance||null;}if(old){this.setAutoSync(false);}var colorMgr=qx.legacy.theme.manager.Color.getInstance();var borderMgr=qx.legacy.theme.manager.Border.getInstance();var fontMgr=qx.legacy.theme.manager.Font.getInstance();var iconMgr=qx.legacy.theme.manager.Icon.getInstance();var widgetMgr=qx.legacy.theme.manager.Widget.getInstance();var appearanceMgr=qx.legacy.theme.manager.Appearance.getInstance();colorMgr.setColorTheme(color);borderMgr.setBorderTheme(border);fontMgr.setFontTheme(font);widgetMgr.setWidgetTheme(widget);iconMgr.setIconTheme(icon);appearanceMgr.setAppearanceTheme(appearance);if(old){this.setAutoSync(true);}},_applyAutoSync:function(value,old){if(value){qx.legacy.theme.manager.Appearance.getInstance().syncAppearanceTheme();qx.legacy.theme.manager.Icon.getInstance().syncIconTheme();qx.legacy.theme.manager.Widget.getInstance().syncWidgetTheme();qx.legacy.theme.manager.Font.getInstance().syncFontTheme();qx.legacy.theme.manager.Border.getInstance().syncBorderTheme();qx.legacy.theme.manager.Color.getInstance().syncColorTheme();}},initialize:function(){var setting=qx.core.Setting;var theme,obj;theme=setting.get("qx.legacy.theme");if(theme){obj=qx.Theme.getByName(theme);if(!obj){throw new Error("The meta theme to use is not available: "+theme);}this.setTheme(obj);}theme=setting.get("qx.legacy.colorTheme");if(theme){obj=qx.Theme.getByName(theme);if(!obj){throw new Error("The color theme to use is not available: "+theme);}qx.legacy.theme.manager.Color.getInstance().setColorTheme(obj);}theme=setting.get("qx.legacy.borderTheme");if(theme){obj=qx.Theme.getByName(theme);if(!obj){throw new Error("The border theme to use is not available: "+theme);}qx.legacy.theme.manager.Border.getInstance().setBorderTheme(obj);}theme=setting.get("qx.legacy.fontTheme");if(theme){obj=qx.Theme.getByName(theme);if(!obj){throw new Error("The font theme to use is not available: "+theme);}qx.legacy.theme.manager.Font.getInstance().setFontTheme(obj);}theme=setting.get("qx.legacy.widgetTheme");if(theme){obj=qx.Theme.getByName(theme);if(!obj){throw new Error("The widget theme to use is not available: "+theme);}qx.legacy.theme.manager.Widget.getInstance().setWidgetTheme(obj);}theme=setting.get("qx.legacy.iconTheme");if(theme){obj=qx.Theme.getByName(theme);if(!obj){throw new Error("The icon theme to use is not available: "+theme);}qx.legacy.theme.manager.Icon.getInstance().setIconTheme(obj);}theme=setting.get("qx.legacy.appearanceTheme");if(theme){obj=qx.Theme.getByName(theme);if(!obj){throw new Error("The appearance theme to use is not available: "+theme);}qx.legacy.theme.manager.Appearance.getInstance().setAppearanceTheme(obj);}},__queryThemes:function(key){var reg=qx.Theme.getAll();var theme;var list=[];for(var name in reg){theme=reg[name];if(theme[key]){list.push(theme);}}return list;},getMetaThemes:function(){return this.__queryThemes("meta");},getColorThemes:function(){return this.__queryThemes("colors");},getBorderThemes:function(){return this.__queryThemes("borders");},getFontThemes:function(){return this.__queryThemes("fonts");},getWidgetThemes:function(){return this.__queryThemes("widgets");},getIconThemes:function(){return this.__queryThemes("icons");},getAppearanceThemes:function(){return this.__queryThemes("appearances");}},settings:{"qx.legacy.theme":"qx.legacy.theme.ClassicRoyale","qx.legacy.colorTheme":null,"qx.legacy.borderTheme":null,"qx.legacy.fontTheme":null,"qx.legacy.widgetTheme":null,"qx.legacy.appearanceTheme":null,"qx.legacy.iconTheme":null}});qx.Class.define("qx.legacy.util.ValueManager",{type:"abstract",extend:qx.core.Object,construct:function(){this.base(arguments);qx.legacy.util.ValueManager.register(this);this._registry={};this._dynamic={};},statics:{__managers:{},disconnect:function(obj){var all=this.__managers;for(var hc in all){all[hc].disconnectObject(obj);}},register:function(mgr){this.__managers[mgr.$$hash]=mgr;},unregister:function(mgr){delete this.__managers[mgr.$$hash];}},members:{connect:function(callback,obj,value){{};if(value!==null&&this._preprocess){value=this._preprocess(value);}var objectKey=obj.toHashCode();var callbackKey=qx.core.ObjectRegistry.toHashCode(callback);var objectToValue=this._registry;if(this.isDynamic(value)){if(!objectToValue[objectKey]){objectToValue[objectKey]={};}objectToValue[objectKey][callbackKey]={callback:callback,object:obj,value:value};value=this.resolveDynamic(value);}else if(objectToValue[objectKey]&&objectToValue[objectKey][callbackKey]){delete objectToValue[objectKey][callbackKey];}callback.call(obj,value);},disconnectObject:function(obj){var reg=this._registry;if(reg&&reg[obj.$$hash]){delete reg[obj.$$hash];}},resolveDynamic:function(value){return this._dynamic[value];},isDynamic:function(value){return !!this._dynamic[value];},updateUsersOf:function(value){var reg=this._registry;var callbacks,entry;for(var objectKey in reg){callbacks=reg[objectKey];for(var callbackKey in callbacks){entry=callbacks[callbackKey];if(entry.value==value){entry.callback.call(entry.object,this.resolveDynamic(entry.value));}}}},updateAll:function(){var reg=this._registry;var callbacks,entry;for(var objectKey in reg){callbacks=reg[objectKey];for(var callbackKey in callbacks){entry=callbacks[callbackKey];entry.callback.call(entry.object,this.resolveDynamic(entry.value));}}}},destruct:function(){this._disposeFields("_registry","_dynamic");qx.legacy.util.ValueManager.unregister(this);}});qx.Class.define("qx.legacy.theme.manager.Color",{type:"singleton",extend:qx.legacy.util.ValueManager,properties:{colorTheme:{check:"Theme",nullable:true,apply:"_applyColorTheme",event:"changeColorTheme"}},members:{_applyColorTheme:function(value){var dest=this._dynamic={};if(value){var source=value.colors;var util=qx.util.ColorUtil;var temp;for(var key in source){temp=source[key];if(typeof temp==="string"){if(!util.isCssString(temp)){throw new Error("Could not parse color: "+temp);}}else if(temp instanceof Array){temp=util.rgbToRgbString(temp);}else{throw new Error("Could not parse color: "+temp);}dest[key]=temp;}}if(qx.legacy.theme.manager.Meta.getInstance().getAutoSync()){this.syncColorTheme();}},syncColorTheme:function(){this.updateAll();}}});qx.Class.define("qx.legacy.theme.manager.Border",{type:"singleton",extend:qx.legacy.util.ValueManager,properties:{borderTheme:{check:"Theme",nullable:true,apply:"_applyBorderTheme",event:"changeBorderTheme"}},members:{resolveDynamic:function(value){return value instanceof qx.legacy.ui.core.Border?value:this._dynamic[value];},isDynamic:function(value){return value&&(value instanceof qx.legacy.ui.core.Border||this._dynamic[value]!==undefined);},syncBorderTheme:function(){this.updateAll();},_applyBorderTheme:function(value){var dest=this._dynamic;for(var key in dest){if(dest[key].themed){dest[key].dispose();delete dest[key];}}if(value){var source=value.borders;var border=qx.legacy.ui.core.Border;for(var key in source){dest[key]=(new border).set(source[key]);dest[key].themed=true;}}if(qx.legacy.theme.manager.Meta.getInstance().getAutoSync()){this.syncBorderTheme();}}}});qx.Class.define("qx.legacy.ui.core.Border",{extend:qx.core.Object,construct:function(width,style,color){this.base(arguments);if(width!==undefined){this.setWidth(width);}if(style!==undefined){this.setStyle(style);}if(color!==undefined){this.setColor(color);}},statics:{fromString:function(str){var border=new qx.legacy.ui.core.Border;var parts=str.split(/\s+/);var part,temp;for(var i=0,l=parts.length;i<l;i++){part=parts[i];switch(part){case "groove":case "ridge":case "inset":case "outset":case "solid":case "dotted":case "dashed":case "double":case "none":border.setStyle(part);break;default:temp=parseInt(part);if(temp===part||qx.lang.String.contains(part,"px")){border.setWidth(temp);}else{border.setColor(part);}break;}}return border;},fromConfig:function(config){var border=new qx.legacy.ui.core.Border;border.set(config);return border;},resetTop:qx.core.Variant.select("qx.client",{"gecko":function(widget){var style=widget._style;if(style){style.borderTopWidth=style.borderTopStyle=style.borderTopColor=style.MozBorderTopColors="";}},"default":function(widget){var style=widget._style;if(style){style.borderTopWidth=style.borderTopStyle=style.borderTopColor="";}style=widget._innerStyle;if(style){style.borderTopWidth=style.borderTopStyle=style.borderTopColor="";}}}),resetRight:qx.core.Variant.select("qx.client",{"gecko":function(widget){var style=widget._style;if(style){style.borderRightWidth=style.borderRightStyle=style.borderRightColor=style.MozBorderRightColors="";}},"default":function(widget){var style=widget._style;if(style){style.borderRightWidth=style.borderRightStyle=style.borderRightColor="";}style=widget._innerStyle;if(style){style.borderRightWidth=style.borderRightStyle=style.borderRightColor="";}}}),resetBottom:qx.core.Variant.select("qx.client",{"gecko":function(widget){var style=widget._style;if(style){style.borderBottomWidth=style.borderBottomStyle=style.borderBottomColor=style.MozBorderBottomColors="";}},"default":function(widget){var style=widget._style;if(style){style.borderBottomWidth=style.borderBottomStyle=style.borderBottomColor="";}style=widget._innerStyle;if(style){style.borderBottomWidth=style.borderBottomStyle=style.borderBottomColor="";}}}),resetLeft:qx.core.Variant.select("qx.client",{"gecko":function(widget){var style=widget._style;if(style){style.borderLeftWidth=style.borderLeftStyle=style.borderLeftColor=style.MozBorderLeftColors="";}},"default":function(widget){var style=widget._style;if(style){style.borderLeftWidth=style.borderLeftStyle=style.borderLeftColor="";}style=widget._innerStyle;if(style){style.borderLeftWidth=style.borderLeftStyle=style.borderLeftColor="";}}})},properties:{widthTop:{check:"Number",init:0,apply:"_applyWidthTop"},widthRight:{check:"Number",init:0,apply:"_applyWidthRight"},widthBottom:{check:"Number",init:0,apply:"_applyWidthBottom"},widthLeft:{check:"Number",init:0,apply:"_applyWidthLeft"},styleTop:{nullable:true,check:["solid","dotted","dashed","double","outset","inset","ridge","groove"],init:"solid",apply:"_applyStyleTop"},styleRight:{nullable:true,check:["solid","dotted","dashed","double","outset","inset","ridge","groove"],init:"solid",apply:"_applyStyleRight"},styleBottom:{nullable:true,check:["solid","dotted","dashed","double","outset","inset","ridge","groove"],init:"solid",apply:"_applyStyleBottom"},styleLeft:{nullable:true,check:["solid","dotted","dashed","double","outset","inset","ridge","groove"],init:"solid",apply:"_applyStyleLeft"},colorTop:{nullable:true,apply:"_applyColorTop"},colorRight:{nullable:true,apply:"_applyColorRight"},colorBottom:{nullable:true,apply:"_applyColorBottom"},colorLeft:{nullable:true,apply:"_applyColorLeft"},colorInnerTop:{nullable:true,apply:"_applyColorInnerTop"},colorInnerRight:{nullable:true,apply:"_applyColorInnerRight"},colorInnerBottom:{nullable:true,apply:"_applyColorInnerBottom"},colorInnerLeft:{nullable:true,apply:"_applyColorInnerLeft"},left:{group:["widthLeft","styleLeft","colorLeft"]},right:{group:["widthRight","styleRight","colorRight"]},top:{group:["widthTop","styleTop","colorTop"]},bottom:{group:["widthBottom","styleBottom","colorBottom"]},width:{group:["widthTop","widthRight","widthBottom","widthLeft"],mode:"shorthand"},style:{group:["styleTop","styleRight","styleBottom","styleLeft"],mode:"shorthand"},color:{group:["colorTop","colorRight","colorBottom","colorLeft"],mode:"shorthand"},innerColor:{group:["colorInnerTop","colorInnerRight","colorInnerBottom","colorInnerLeft"],mode:"shorthand"}},members:{_applyWidthTop:function(value,old){this.__widthTop=value==null?"0px":value+"px";this.__computeComplexTop();this.__informManager("top");},_applyWidthRight:function(value,old){this.__widthRight=value==null?"0px":value+"px";this.__computeComplexRight();this.__informManager("right");},_applyWidthBottom:function(value,old){this.__widthBottom=value==null?"0px":value+"px";this.__computeComplexBottom();this.__informManager("bottom");},_applyWidthLeft:function(value,old){this.__widthLeft=value==null?"0px":value+"px";this.__computeComplexLeft();this.__informManager("left");},_applyColorTop:function(value,old){qx.legacy.theme.manager.Color.getInstance().connect(this._changeColorTop,this,value);},_applyColorRight:function(value,old){qx.legacy.theme.manager.Color.getInstance().connect(this._changeColorRight,this,value);},_applyColorBottom:function(value,old){qx.legacy.theme.manager.Color.getInstance().connect(this._changeColorBottom,this,value);},_applyColorLeft:function(value,old){qx.legacy.theme.manager.Color.getInstance().connect(this._changeColorLeft,this,value);},_applyColorInnerTop:function(value,old){qx.legacy.theme.manager.Color.getInstance().connect(this._changeColorInnerTop,this,value);},_applyColorInnerRight:function(value,old){qx.legacy.theme.manager.Color.getInstance().connect(this._changeColorInnerRight,this,value);},_applyColorInnerBottom:function(value,old){qx.legacy.theme.manager.Color.getInstance().connect(this._changeColorInnerBottom,this,value);},_applyColorInnerLeft:function(value,old){qx.legacy.theme.manager.Color.getInstance().connect(this._changeColorInnerLeft,this,value);},_applyStyleTop:function(){this.__informManager("top");},_applyStyleRight:function(){this.__informManager("right");},_applyStyleBottom:function(){this.__informManager("bottom");},_applyStyleLeft:function(){this.__informManager("left");},_changeColorTop:function(value){this.__colorTop=value;this.__computeComplexTop();this.__informManager("top");},_changeColorInnerTop:function(value){this.__colorInnerTop=value;this.__computeComplexTop();this.__informManager("top");},_changeColorRight:function(value){this.__colorRight=value;this.__computeComplexRight();this.__informManager("right");},_changeColorInnerRight:function(value){this.__colorInnerRight=value;this.__computeComplexRight();this.__informManager("right");},_changeColorBottom:function(value){this.__colorBottom=value;this.__computeComplexBottom();this.__informManager("bottom");},_changeColorInnerBottom:function(value){this.__colorInnerBottom=value;this.__computeComplexBottom();this.__informManager("bottom");},_changeColorLeft:function(value){this.__colorLeft=value;this.__computeComplexLeft();this.__informManager("left");},_changeColorInnerLeft:function(value){this.__colorInnerLeft=value;this.__computeComplexLeft();this.__informManager("left");},__computeComplexTop:function(){this.__complexTop=this.getWidthTop()===2&&this.__colorInnerTop!=null&&this.__colorTop!=this.__colorInnerTop;},__computeComplexRight:function(){this.__complexRight=this.getWidthRight()===2&&this.__colorInnerRight!=null&&this.__colorRight!=this.__colorInnerRight;},__computeComplexBottom:function(){this.__complexBottom=this.getWidthBottom()===2&&this.__colorInnerBottom!=null&&this.__colorBottom!=this.__colorInnerBottom;},__computeComplexLeft:function(){this.__complexLeft=this.getWidthLeft()===2&&this.__colorInnerLeft!=null&&this.__colorLeft!=this.__colorInnerLeft;},__informManager:function(edge){qx.legacy.theme.manager.Border.getInstance().updateUsersOf(this);},renderTop:qx.core.Variant.select("qx.client",{"gecko":function(obj){var style=obj._style;style.borderTopWidth=this.__widthTop||"0px";style.borderTopColor=this.__colorTop||"";if(this.__complexTop){style.borderTopStyle="solid";style.MozBorderTopColors=this.__colorTop+" "+this.__colorInnerTop;}else{style.borderTopStyle=this.getStyleTop()||"none";style.MozBorderTopColors="";}},"default":function(obj){var outer=obj._style;var inner=obj._innerStyle;if(this.__complexTop){if(!inner){obj.prepareEnhancedBorder();inner=obj._innerStyle;}outer.borderTopWidth=inner.borderTopWidth="1px";outer.borderTopStyle=inner.borderTopStyle="solid";outer.borderTopColor=this.__colorTop;inner.borderTopColor=this.__colorInnerTop;}else{outer.borderTopWidth=this.__widthTop||"0px";outer.borderTopStyle=this.getStyleTop()||"none";outer.borderTopColor=this.__colorTop||"";if(inner){inner.borderTopWidth=inner.borderTopStyle=inner.borderTopColor="";}}}}),renderRight:qx.core.Variant.select("qx.client",{"gecko":function(obj){var style=obj._style;style.borderRightWidth=this.__widthRight||"0px";style.borderRightColor=this.__colorRight||"";if(this.__complexRight){style.borderRightStyle="solid";style.MozBorderRightColors=this.__colorRight+" "+this.__colorInnerRight;}else{style.borderRightStyle=this.getStyleRight()||"none";style.MozBorderRightColors="";}},"default":function(obj){var outer=obj._style;var inner=obj._innerStyle;if(this.__complexRight){if(!inner){obj.prepareEnhancedBorder();inner=obj._innerStyle;}outer.borderRightWidth=inner.borderRightWidth="1px";outer.borderRightStyle=inner.borderRightStyle="solid";outer.borderRightColor=this.__colorRight;inner.borderRightColor=this.__colorInnerRight;}else{outer.borderRightWidth=this.__widthRight||"0px";outer.borderRightStyle=this.getStyleRight()||"none";outer.borderRightColor=this.__colorRight||"";if(inner){inner.borderRightWidth=inner.borderRightStyle=inner.borderRightColor="";}}}}),renderBottom:qx.core.Variant.select("qx.client",{"gecko":function(obj){var style=obj._style;style.borderBottomWidth=this.__widthBottom||"0px";style.borderBottomColor=this.__colorBottom||"";if(this.__complexBottom){style.borderBottomStyle="solid";style.MozBorderBottomColors=this.__colorBottom+" "+this.__colorInnerBottom;}else{style.borderBottomStyle=this.getStyleBottom()||"none";style.MozBorderBottomColors="";}},"default":function(obj){var outer=obj._style;var inner=obj._innerStyle;if(this.__complexBottom){if(!inner){obj.prepareEnhancedBorder();inner=obj._innerStyle;}outer.borderBottomWidth=inner.borderBottomWidth="1px";outer.borderBottomStyle=inner.borderBottomStyle="solid";outer.borderBottomColor=this.__colorBottom;inner.borderBottomColor=this.__colorInnerBottom;}else{outer.borderBottomWidth=this.__widthBottom||"0px";outer.borderBottomStyle=this.getStyleBottom()||"none";outer.borderBottomColor=this.__colorBottom||"";if(inner){inner.borderBottomWidth=inner.borderBottomStyle=inner.borderBottomColor="";}}}}),renderLeft:qx.core.Variant.select("qx.client",{"gecko":function(obj){var style=obj._style;style.borderLeftWidth=this.__widthLeft||"0px";style.borderLeftColor=this.__colorLeft||"";if(this.__complexLeft){style.borderLeftStyle="solid";style.MozBorderLeftColors=this.__colorLeft+" "+this.__colorInnerLeft;}else{style.borderLeftStyle=this.getStyleLeft()||"none";style.MozBorderLeftColors="";}},"default":function(obj){var outer=obj._style;var inner=obj._innerStyle;if(this.__complexLeft){if(!inner){obj.prepareEnhancedBorder();inner=obj._innerStyle;}outer.borderLeftWidth=inner.borderLeftWidth="1px";outer.borderLeftStyle=inner.borderLeftStyle="solid";outer.borderLeftColor=this.__colorLeft;inner.borderLeftColor=this.__colorInnerLeft;}else{outer.borderLeftWidth=this.__widthLeft||"0px";outer.borderLeftStyle=this.getStyleLeft()||"none";outer.borderLeftColor=this.__colorLeft||"";if(inner){inner.borderLeftWidth=inner.borderLeftStyle=inner.borderLeftColor="";}}}})}});qx.Class.define("qx.legacy.theme.manager.Font",{type:"singleton",extend:qx.legacy.util.ValueManager,properties:{fontTheme:{check:"Theme",nullable:true,apply:"_applyFontTheme",event:"changeFontTheme"}},members:{resolveDynamic:function(value){return value instanceof qx.legacy.ui.core.Font?value:this._dynamic[value];},isDynamic:function(value){return value&&(value instanceof qx.legacy.ui.core.Font||this._dynamic[value]!==undefined);},syncFontTheme:function(){this.updateAll();},_applyFontTheme:function(value){var dest=this._dynamic;for(var key in dest){if(dest[key].themed){dest[key].dispose();delete dest[key];}}if(value){var source=value.fonts;var font=qx.legacy.ui.core.Font;for(var key in source){dest[key]=(new font).set(source[key]);dest[key].themed=true;}}if(qx.legacy.theme.manager.Meta.getInstance().getAutoSync()){this.syncFontTheme();}}}});qx.Class.define("qx.legacy.ui.core.Font",{extend:qx.core.Object,construct:function(size,family){this.base(arguments);if(size!==undefined){this.setSize(size);}if(family!==undefined){this.setFamily(family);}},statics:{fromString:function(str){var font=new qx.legacy.ui.core.Font;var parts=str.split(/\s+/);var name=[];var part;for(var i=0;i<parts.length;i++){switch(part=parts[i]){case "bold":font.setBold(true);break;case "italic":font.setItalic(true);break;case "underline":font.setDecoration("underline");break;default:var temp=parseInt(part);if(temp==part||qx.lang.String.contains(part,"px")){font.setSize(temp);}else{name.push(part);}break;}}if(name.length>0){font.setFamily(name);}return font;},fromConfig:function(config){var font=new qx.legacy.ui.core.Font;font.set(config);return font;},reset:function(widget){widget.removeStyleProperty("fontFamily");widget.removeStyleProperty("fontSize");widget.removeStyleProperty("fontWeight");widget.removeStyleProperty("fontStyle");widget.removeStyleProperty("textDecoration");},resetElement:function(element){var style=element.style;style.fontFamily="";style.fontSize="";style.fontWeight="";style.fontStyle="";style.textDecoration="";},resetStyle:function(style){style.fontFamily="";style.fontSize="";style.fontWeight="";style.fontStyle="";style.textDecoration="";}},properties:{size:{check:"Integer",nullable:true,apply:"_applySize"},family:{check:"Array",nullable:true,apply:"_applyFamily"},bold:{check:"Boolean",nullable:true,apply:"_applyBold"},italic:{check:"Boolean",nullable:true,apply:"_applyItalic"},decoration:{check:["underline","line-through","overline"],nullable:true,apply:"_applyDecoration"}},members:{__size:null,__family:null,__bold:null,__italic:null,__decoration:null,_applySize:function(value,old){this.__size=value===null?null:value+"px";},_applyFamily:function(value,old){var family="";for(var i=0,l=value.length;i<l;i++){if(value[i].indexOf(" ")>0){family+='"'+value[i]+'"';}else{family+=value[i];}if(i!=l-1){family+=",";}}this.__family=family;},_applyBold:function(value,old){this.__bold=value===null?null:value?"bold":"normal";},_applyItalic:function(value,old){this.__italic=value===null?null:value?"italic":"normal";},_applyDecoration:function(value,old){this.__decoration=value===null?null:value;},render:function(widget){widget.setStyleProperty("fontFamily",this.__family);widget.setStyleProperty("fontSize",this.__size);widget.setStyleProperty("fontWeight",this.__bold);widget.setStyleProperty("fontStyle",this.__italic);widget.setStyleProperty("textDecoration",this.__decoration);},renderStyle:function(style){style.fontFamily=this.__family||"";style.fontSize=this.__size||"";style.fontWeight=this.__bold||"";style.fontStyle=this.__italic||"";style.textDecoration=this.__decoration||"";},renderElement:function(element){var style=element.style;style.fontFamily=this.__family||"";style.fontSize=this.__size||"";style.fontWeight=this.__bold||"";style.fontStyle=this.__italic||"";style.textDecoration=this.__decoration||"";},generateStyle:function(){return (this.__family?"font-family:"+this.__family.replace(/\"/g,"'")+";":"")+(this.__size?"font-size:"+this.__size+";":"")+(this.__weight?"font-weight:"+this.__weight+";":"")+(this.__style?"font-style:"+this.__style+";":"")+(this.__decoration?"text-decoration:"+this.__decoration+";":"");}}});qx.Class.define("qx.legacy.theme.manager.Icon",{type:"singleton",extend:qx.core.Object,properties:{iconTheme:{check:"Theme",nullable:true,apply:"_applyIconTheme",event:"changeIconTheme"}},members:{_applyIconTheme:function(value,old){if(qx.legacy.theme.manager.Meta.getInstance().getAutoSync()){this.syncIconTheme();}},syncIconTheme:function(){var value=this.getIconTheme();var alias=qx.legacy.util.AliasManager.getInstance();value?alias.add("icon",value.resource):alias.remove("icon");}}});qx.Class.define("qx.legacy.util.AliasManager",{type:"singleton",extend:qx.legacy.util.ValueManager,construct:function(){this.base(arguments);this._aliases={};this.add("static","qx/static");},members:{_preprocess:function(value){var dynamics=this._dynamic;if(dynamics[value]===false){return value;}else if(dynamics[value]===undefined){if(value.charAt(0)==="/"||value.charAt(0)==="."||value.indexOf("http://")===0||value.indexOf("https://")==="0"||value.indexOf("file://")===0){dynamics[value]=false;return value;}var alias=value.substring(0,value.indexOf("/"));var resolved=this._aliases[alias];if(resolved!==undefined){dynamics[value]=resolved+value.substring(alias.length);}}return value;},add:function(alias,base){this._aliases[alias]=base;var dynamics=this._dynamic;var paths={};for(var path in dynamics){if(path.substring(0,path.indexOf("/"))===alias){dynamics[path]=base+path.substring(alias.length);paths[path]=true;}}},remove:function(alias){delete this._aliases[alias];},resolve:function(path){if(path!==null){path=this._preprocess(path);}return this._dynamic[path]||path;}},destruct:function(){this._disposeFields("_aliases");}});qx.Class.define("qx.legacy.theme.manager.Widget",{type:"singleton",extend:qx.core.Object,properties:{widgetTheme:{check:"Theme",nullable:true,apply:"_applyWidgetTheme",event:"changeWidgetTheme"}},members:{_applyWidgetTheme:function(value,old){if(qx.legacy.theme.manager.Meta.getInstance().getAutoSync()){this.syncWidgetTheme();}},syncWidgetTheme:function(){var value=this.getWidgetTheme();var alias=qx.legacy.util.AliasManager.getInstance();value?alias.add("widget",value.resource):alias.remove("widget");}}});qx.Class.define("qx.legacy.event.handler.FocusHandler",{extend:qx.core.Object,construct:function(widget){this.base(arguments);if(widget!=null){this._attachedWidget=widget;}},statics:{mouseFocus:false},members:{getAttachedWidget:function(){return this._attachedWidget;},_onkeyevent:function(container,ev){if(ev.getKeyIdentifier()!="Tab"){return;}ev.stopPropagation();ev.preventDefault();qx.legacy.event.handler.FocusHandler.mouseFocus=false;var vCurrent=this.getAttachedWidget().getFocusedChild();if(!ev.isShiftPressed()){var vNext=vCurrent?this.getWidgetAfter(container,vCurrent):this.getFirstWidget(container);}else{var vNext=vCurrent?this.getWidgetBefore(container,vCurrent):this.getLastWidget(container);}if(vNext){vNext.setFocused(true);vNext._ontabfocus();}},compareTabOrder:function(c1,c2){if(c1==c2){return 0;}var t1=c1.getTabIndex();var t2=c2.getTabIndex();if(t1!=t2){return t1-t2;}var y1=qx.bom.element.Location.getTop(c1.getElement());var y2=qx.bom.element.Location.getTop(c2.getElement());if(y1!=y2){return y1-y2;}var x1=qx.bom.element.Location.getLeft(c1.getElement());var x2=qx.bom.element.Location.getLeft(c2.getElement());if(x1!=x2){return x1-x2;}var z1=c1.getZIndex();var z2=c2.getZIndex();if(z1!=z2){return z1-z2;}return 0;},getFirstWidget:function(parentContainer){return this._getFirst(parentContainer,null);},getLastWidget:function(parentContainer){return this._getLast(parentContainer,null);},getWidgetAfter:function(parentContainer,widget){if(parentContainer==widget){return this.getFirstWidget(parentContainer);}if(widget.getAnonymous()){widget=widget.getParent();}if(widget==null){return [];}var vAll=[];this._getAllAfter(parentContainer,widget,vAll);vAll.sort(this.compareTabOrder);return vAll.length>0?vAll[0]:this.getFirstWidget(parentContainer);},getWidgetBefore:function(parentContainer,widget){if(parentContainer==widget){return this.getLastWidget(parentContainer);}if(widget.getAnonymous()){widget=widget.getParent();}if(widget==null){return [];}var vAll=[];this._getAllBefore(parentContainer,widget,vAll);vAll.sort(this.compareTabOrder);var len=vAll.length;return len>0?vAll[len-1]:this.getLastWidget(parentContainer);},_getAllAfter:function(parent,widget,arr){var children=parent.getChildren();var child;var len=children.length;for(var i=0;i<len;i++){child=children[i];if(!(child instanceof qx.legacy.ui.core.Parent)&&!(child instanceof qx.legacy.ui.basic.Terminator)){continue;}if(child.isFocusable()&&child.getTabIndex()>0&&this.compareTabOrder(widget,child)<0){arr.push(children[i]);}if(!child.isFocusRoot()&&child instanceof qx.legacy.ui.core.Parent){this._getAllAfter(child,widget,arr);}}},_getAllBefore:function(parent,widget,arr){var children=parent.getChildren();var child;var len=children.length;for(var i=0;i<len;i++){child=children[i];if(!(child instanceof qx.legacy.ui.core.Parent)&&!(child instanceof qx.legacy.ui.basic.Terminator)){continue;}if(child.isFocusable()&&child.getTabIndex()>0&&this.compareTabOrder(widget,child)>0){arr.push(child);}if(!child.isFocusRoot()&&child instanceof qx.legacy.ui.core.Parent){this._getAllBefore(child,widget,arr);}}},_getFirst:function(parent,firstWidget){var children=parent.getChildren();var child;var len=children.length;for(var i=0;i<len;i++){child=children[i];if(!(child instanceof qx.legacy.ui.core.Parent)&&!(child instanceof qx.legacy.ui.basic.Terminator)){continue;}if(child.isFocusable()&&child.getTabIndex()>0){if(firstWidget==null||this.compareTabOrder(child,firstWidget)<0){firstWidget=child;}}if(!child.isFocusRoot()&&child instanceof qx.legacy.ui.core.Parent){firstWidget=this._getFirst(child,firstWidget);}}return firstWidget;},_getLast:function(parent,lastWidget){var children=parent.getChildren();var child;var len=children.length;for(var i=0;i<len;i++){child=children[i];if(!(child instanceof qx.legacy.ui.core.Parent)&&!(child instanceof qx.legacy.ui.basic.Terminator)){continue;}if(child.isFocusable()&&child.getTabIndex()>0){if(lastWidget==null||this.compareTabOrder(child,lastWidget)>0){lastWidget=child;}}if(!child.isFocusRoot()&&child instanceof qx.legacy.ui.core.Parent){lastWidget=this._getLast(child,lastWidget);}}return lastWidget;}},destruct:function(){this._disposeFields("_attachedWidget");}});qx.Class.define("qx.legacy.io.image.Manager",{type:"singleton",extend:qx.core.Object,construct:function(){this.base(arguments);this.__visible={};this.__all={};},members:{add:function(source){var data=this.__all;if(data[source]===undefined){data[source]=1;}else{data[source]++;}},remove:function(source){var data=this.__all;if(data[source]!==undefined){data[source]--;}if(data[source]<=0){delete data[source];}},show:function(source){var data=this.__visible;if(data[source]===undefined){data[source]=1;}else{data[source]++;}},hide:function(source){var data=this.__visible;if(data[source]!==undefined){data[source]--;}if(data[source]<=0){delete data[source];}},getVisibleImages:function(){var visible=this.__visible;var list={};for(var source in visible){if(visible[source]>0){list[source]=true;}}return list;},getHiddenImages:function(){var visible=this.__visible;var all=this.__all;var list={};for(var source in all){if(visible[source]===undefined){list[source]=true;}}return list;}},destruct:function(){this._disposeFields("__all","__visible");}});qx.Class.define("qx.legacy.html.Offset",{statics:{getLeft:qx.core.Variant.select("qx.client",{"gecko":function(el){var val=el.offsetLeft;var pa=el.parentNode;var pose=qx.legacy.html.Style.getStyleProperty(el,"position");var posp=qx.legacy.html.Style.getStyleProperty(pa,"position");if(pose!="absolute"&&pose!="fixed"){val-=qx.legacy.html.Style.getBorderLeft(pa);}if(posp!="absolute"&&posp!="fixed"){while(pa){pa=pa.parentNode;if(!pa||typeof pa.tagName!=="string"){break;}var posi=qx.legacy.html.Style.getStyleProperty(pa,"position");if(posi=="absolute"||posi=="fixed"){val-=qx.legacy.html.Style.getBorderLeft(pa)+qx.legacy.html.Style.getPaddingLeft(pa);break;}}}return val;},"default":function(el){return el.offsetLeft;}}),getTop:qx.core.Variant.select("qx.client",{"gecko":function(el){var val=el.offsetTop;var pa=el.parentNode;var pose=qx.legacy.html.Style.getStyleProperty(el,"position");var posp=qx.legacy.html.Style.getStyleProperty(pa,"position");if(pose!="absolute"&&pose!="fixed"){val-=qx.legacy.html.Style.getBorderTop(pa);}if(posp!="absolute"&&posp!="fixed"){while(pa){pa=pa.parentNode;if(!pa||typeof pa.tagName!=="string"){break;}var posi=qx.legacy.html.Style.getStyleProperty(pa,"position");if(posi=="absolute"||posi=="fixed"){val-=qx.legacy.html.Style.getBorderTop(pa)+qx.legacy.html.Style.getPaddingTop(pa);break;}}}return val;},"default":function(el){return el.offsetTop;}})}});qx.Class.define("qx.legacy.html.ScrollIntoView",{statics:{scrollX:function(vElement,vAlignLeft){var vParentWidth,vParentScrollLeft,vWidth,vHasScroll;var vParent=vElement.parentNode;var vOffset=vElement.offsetLeft;var vWidth=vElement.offsetWidth;while(vParent){switch(qx.legacy.html.Style.getStyleProperty(vParent,"overflow")){case "scroll":case "auto":case "-moz-scrollbars-horizontal":vHasScroll=true;break;default:switch(qx.legacy.html.Style.getStyleProperty(vParent,"overflowX")){case "scroll":case "auto":vHasScroll=true;break;default:vHasScroll=false;}}if(vHasScroll){vParentWidth=vParent.clientWidth;vParentScrollLeft=vParent.scrollLeft;if(vAlignLeft){vParent.scrollLeft=vOffset;}else if(vAlignLeft==false){vParent.scrollLeft=vOffset+vWidth-vParentWidth;}else if(vWidth>vParentWidth||vOffset<vParentScrollLeft){vParent.scrollLeft=vOffset;}else if((vOffset+vWidth)>(vParentScrollLeft+vParentWidth)){vParent.scrollLeft=vOffset+vWidth-vParentWidth;}vOffset=vParent.offsetLeft;vWidth=vParent.offsetWidth;}else{vOffset+=vParent.offsetLeft;}if(vParent.tagName.toLowerCase()=="body"){break;}vParent=vParent.offsetParent;}return true;},scrollY:function(vElement,vAlignTop){var vParentHeight,vParentScrollTop,vHeight,vHasScroll;var vParent=vElement.parentNode;var vOffset=vElement.offsetTop;var vHeight=vElement.offsetHeight;while(vParent){switch(qx.legacy.html.Style.getStyleProperty(vParent,"overflow")){case "scroll":case "auto":case "-moz-scrollbars-vertical":vHasScroll=true;break;default:switch(qx.legacy.html.Style.getStyleProperty(vParent,"overflowY")){case "scroll":case "auto":vHasScroll=true;break;default:vHasScroll=false;}}if(vHasScroll){vParentHeight=vParent.clientHeight;vParentScrollTop=vParent.scrollTop;if(vAlignTop){vParent.scrollTop=vOffset;}else if(vAlignTop==false){vParent.scrollTop=vOffset+vHeight-vParentHeight;}else if(vHeight>vParentHeight||vOffset<vParentScrollTop){vParent.scrollTop=vOffset;}else if((vOffset+vHeight)>(vParentScrollTop+vParentHeight)){vParent.scrollTop=vOffset+vHeight-vParentHeight;}vOffset=vParent.offsetTop;vHeight=vParent.offsetHeight;}else{vOffset+=vParent.offsetTop;}if(vParent.tagName.toLowerCase()=="body"){break;}vParent=vParent.offsetParent;}return true;}}});qx.Class.define("qx.legacy.event.type.FocusEvent",{extend:qx.event.type.Event,properties:{relatedTarget:{}},members:{}});qx.Class.define("qx.test.lang.String",{extend:qx.dev.unit.TestCase,members:{testString:function(){this.assertNotUndefined(qx.lang.String);},testFormat:function(){this.assertNotUndefined(qx.lang.String.format);var Str=qx.lang.String;this.assertEquals("1-2",Str.format("%1-%2",[1,2]));this.assertEquals("2-1",Str.format("%2-%1",[1,2]));this.assertEquals("1-2",Str.format("%1-%2",["1","2"]));this.assertEquals("2-1",Str.format("%2-%1",["1","2"]));},testPad:function(){this.assertNotUndefined(qx.lang.String.pad);var Str=qx.lang.String;this.assertEquals("------",Str.pad("",6,'-'));this.assertEquals("---123",Str.pad("123",6,'-'));this.assertEquals("----123",Str.pad("123",7,'-'));this.assertEquals("    123",Str.pad("123",7,' '));this.assertEquals("0000123",Str.pad("123",7));this.assertEquals("123",Str.pad("123",2,'-'));this.assertEquals("123",Str.pad("123",3,'-'));},testAppend:function(){this.assertNotUndefined(qx.lang.Array.append);var a=[1,2,3];qx.lang.Array.append(a,[4,5,6]);this.assertJsonEquals(a,[1,2,3,4,5,6]);var error=false;try{qx.lang.Array.append(a,1);}catch(ex){error=true;}this.assert(error);},testEscape:function(){this.assertEquals("\n",qx.bom.String.escape("\n"));this.assertEquals("Hello",qx.bom.String.escape("Hello"));this.assertEquals("juhu &lt;&gt;",qx.bom.String.escape("juhu <>"));this.assertEquals("&lt;div id='1'&gt;&amp;nbsp; &euro;&lt;/div&gt;",qx.bom.String.escape("<div id='1'>&nbsp; €</div>"));this.assertEquals("&lt;div id='1'&gt;<br> &nbsp;&amp;nbsp; &euro;&lt;/div&gt;",qx.bom.String.fromText("<div id='1'>\n  &nbsp; €</div>"));this.assertEquals("<div id='1'>\n \u00A0&nbsp; €</div>",qx.bom.String.toText("&lt;div id='1'&gt;<br> &nbsp;&amp;nbsp;  \n   &euro;&lt;/div&gt;"));this.assertEquals("\n",qx.bom.String.unescape("\n"));this.assertEquals("Hello",qx.bom.String.unescape("Hello"));this.assertEquals("juhu <>",qx.bom.String.unescape("juhu &lt;&gt;"));this.assertEquals("<div id='1'>&nbsp; €</div>",qx.bom.String.unescape("&lt;div id='1'&gt;&amp;nbsp; &euro;&lt;/div&gt;"));this.assertEquals(">&zzzz;x",qx.bom.String.unescape("&gt;&zzzz;x"));this.assertEquals("€",qx.bom.String.unescape("&#x20AC;"));this.assertEquals("€",qx.bom.String.unescape("&#X20AC;"));this.assertEquals("\n",qx.xml.String.escape("\n"));this.assertEquals("Hello",qx.xml.String.escape("Hello"));this.assertEquals("juhu &lt;&gt;",qx.xml.String.escape("juhu <>"));this.assertEquals("&lt;div id=&apos;1&apos;&gt;&amp;nbsp; &#8364;&lt;/div&gt;",qx.xml.String.escape("<div id='1'>&nbsp; €</div>"));this.assertEquals("&quot;bread&quot; &amp; &quot;butter&quot;",qx.xml.String.escape('"bread" & "butter"'));this.assertEquals("\n",qx.xml.String.unescape("\n"));this.assertEquals("Hello",qx.xml.String.unescape("Hello"));this.assertEquals("juhu <>",qx.xml.String.unescape("juhu &lt;&gt;"));this.assertEquals("<div id='1'>&nbsp; €</div>",qx.xml.String.unescape("&lt;div id=&apos;1&apos;&gt;&amp;nbsp; &#8364;&lt;/div&gt;"));this.assertEquals('"bread" & "butter"',qx.xml.String.unescape("&quot;bread&quot; &amp; &quot;butter&quot;"));},testStringExtend:function(){qx.Class.define("qx.String",{extend:qx.core.BaseString,members:{bold:function(){return "<b>"+this.toString()+"</b>";},setText:function(txt){this._txt=txt;}}});var s=new qx.String("Juhu");this.assertEquals("<b>Juhu</b>",s.bold());this.assertEquals("JUHU",s.toUpperCase());this.assertEquals(1,s.indexOf("u"));this.assertEquals("__Juhu__",["__",s+"__"].join(""));s.setText("Kinners");this.assertEquals("Kinners",s);}}});qx.Class.define("qx.test.util.DateFormat",{extend:qx.dev.unit.TestCase,members:{testDateParse:function(){var date=new Date(2006,2,14);var formatStr="EEEE dd. MMM yyyy";this.debug("Format string:"+formatStr.toString());var dateFmt=new qx.util.format.DateFormat(formatStr,"de_DE");dateStr=dateFmt.format(date);this.debug("Formatted Date: "+dateStr);var parsedDate=dateFmt.parse(dateStr);this.debug(date+" "+parsedDate);this.assertEquals(date.getTime(),parsedDate.getTime());var formatStr="EEE dd. MM yyyy";this.debug("Format string:"+formatStr.toString());var dateFmt=new qx.util.format.DateFormat(formatStr,"de_DE");dateStr=dateFmt.format(date);this.debug("Formatted Date: "+dateStr);var parsedDate=dateFmt.parse(dateStr);this.debug(date+" "+parsedDate);this.assertEquals(date.getTime(),parsedDate.getTime());var formatStr="EE dd. M yyyy";this.debug("Format string:"+formatStr.toString());var dateFmt=new qx.util.format.DateFormat(formatStr,"de_DE");dateStr=dateFmt.format(date);this.debug("Formatted Date: "+dateStr);var parsedDate=dateFmt.parse(dateStr);this.debug(date+" "+parsedDate);this.assertEquals(date.getTime(),parsedDate.getTime());var formatStr="EEEE dd. MMM yyyy";this.debug("Format string:"+formatStr.toString());var dateFmt=new qx.util.format.DateFormat(formatStr,"fr_FR");dateStr=dateFmt.format(date);this.debug("Formatted Date: "+dateStr);var parsedDate=dateFmt.parse(dateStr);this.assertEquals(date.getTime(),parsedDate.getTime());var formatStr=qx.locale.Date.getDateFormat("medium","fr_FR");this.debug("Format string 'fr_FR' 'medium':"+formatStr.toString());var dateFmt=new qx.util.format.DateFormat(formatStr,"fr_FR");dateStr=dateFmt.format(date);this.debug("Formatted Date: "+dateStr);var parsedDate=dateFmt.parse(dateStr);this.debug(date+" "+parsedDate);this.assertEquals(date.getTime(),parsedDate.getTime());var date=new Date(2007,3,14);this.debug('testing date format size on date '+date);var formatStr=qx.locale.Date.getDateFormat("short","fr_FR");this.debug("Format string 'fr_FR' 'short':"+formatStr.toString());var dateFmt=new qx.util.format.DateFormat(formatStr,"fr_FR");dateStr=dateFmt.format(date);this.debug("Formatted Date: "+dateStr);var parsedDate=dateFmt.parse(dateStr);this.debug(date+" "+parsedDate);this.assertEquals(date.getTime(),parsedDate.getTime());var formatStr=qx.locale.Date.getDateFormat("medium","fr_FR");this.debug("Format string 'fr_FR' 'medium':"+formatStr.toString());var dateFmt=new qx.util.format.DateFormat(formatStr,"fr_FR");dateStr=dateFmt.format(date);this.debug("Formatted Date: "+dateStr);var parsedDate=dateFmt.parse(dateStr);this.debug(date+" "+parsedDate);this.assertEquals(date.getTime(),parsedDate.getTime());var formatStr=qx.locale.Date.getDateFormat("long","fr_FR");this.debug("Format string: 'fr_FR' 'long'"+formatStr.toString());var dateFmt=new qx.util.format.DateFormat(formatStr,"fr_FR");dateStr=dateFmt.format(date);this.debug("Formatted Date: "+dateStr);var parsedDate=dateFmt.parse(dateStr);this.debug(date+" "+parsedDate);this.assertEquals(date.getTime(),parsedDate.getTime());var formatStr=qx.locale.Date.getDateFormat("full","fr_FR");this.debug("Format string: 'fr_FR' 'full'"+formatStr.toString());var dateFmt=new qx.util.format.DateFormat(formatStr,"fr_FR");dateStr=dateFmt.format(date);this.debug("Formatted Date: "+dateStr);var parsedDate=dateFmt.parse(dateStr);this.debug(date+" "+parsedDate);this.assertEquals(date.getTime(),parsedDate.getTime());var formatStr=qx.locale.Date.getDateFormat("short","de_DE");this.debug("Format string: 'de_DE' 'short'"+formatStr.toString());var dateFmt=new qx.util.format.DateFormat(formatStr,"de_DE");dateStr=dateFmt.format(date);this.debug("Formatted Date: "+dateStr);var parsedDate=dateFmt.parse(dateStr);this.debug(date+" "+parsedDate);this.assertEquals(date.getTime(),parsedDate.getTime());var formatStr=qx.locale.Date.getDateFormat("medium","de_DE");this.debug("Format string: 'de_DE' 'medium'"+formatStr.toString());var dateFmt=new qx.util.format.DateFormat(formatStr,"de_DE");dateStr=dateFmt.format(date);this.debug("Formatted Date: "+dateStr);var parsedDate=dateFmt.parse(dateStr);this.debug(date+" "+parsedDate);this.assertEquals(date.getTime(),parsedDate.getTime());var formatStr=qx.locale.Date.getDateFormat("long","de_DE");this.debug("Format string: 'de_DE' 'long'"+formatStr.toString());var dateFmt=new qx.util.format.DateFormat(formatStr,"de_DE");dateStr=dateFmt.format(date);this.debug("Formatted Date: "+dateStr);var parsedDate=dateFmt.parse(dateStr);this.debug(date+" "+parsedDate);this.assertEquals(date.getTime(),parsedDate.getTime());var formatStr=qx.locale.Date.getDateFormat("full","de_DE");this.debug("Format string: 'de_DE' 'full'"+formatStr.toString());var dateFmt=new qx.util.format.DateFormat(formatStr,"de_DE");dateStr=dateFmt.format(date);this.debug("Formatted Date: "+dateStr);var parsedDate=dateFmt.parse(dateStr);this.debug(date+" "+parsedDate);this.assertEquals(date.getTime(),parsedDate.getTime());}}});qx.Class.define("qx.test.Class",{extend:qx.dev.unit.TestCase,members:{testEmptyClass:function(){qx.Class.define("qx.Empty",{extend:Object,construct:function(){}});var empty=new qx.Empty();this.assertEquals("object",typeof (empty));this.assertTrue(empty instanceof qx.Empty);},testSuperClassCall:function(){qx.Class.define("qx.Car",{extend:qx.core.Object,construct:function(name){this._name=name;},members:{startEngine:function(){return "start";},stopEngine:function(){return "stop";},getName:function(){return this._name;}}});var car=new qx.Car("Audi");this.assertEquals("start",car.startEngine());this.assertEquals("stop",car.stopEngine());this.assertEquals("Audi",car.getName());qx.Class.define("qx.Bmw",{extend:qx.Car,construct:function(name,prize){this.base(arguments,name);},members:{startEngine:function(){var ret=this.base(arguments);return "brrr "+ret;},stopEngine:function(){var ret=arguments.callee.base.call();return "brrr "+ret;},getWheels:function(){return this.self(arguments).WHEELS;}},statics:{WHEELS:4}});var bmw=new qx.Bmw("bmw",44000);this.assertEquals("bmw",bmw.getName());this.assertEquals("brrr start",bmw.startEngine());this.assertEquals("brrr stop",bmw.stopEngine());this.assertEquals(4,bmw.getWheels());},testAbstract:function(){qx.Class.define("qx.AbstractCar",{extend:Object,type:"abstract",construct:function(color){this._color=color;},members:{startEngine:function(){}}});if(this.isDebugOn()){this.assertException(function(){var car=new qx.AbstractCar("blue");},Error,new RegExp("The class .* is abstract"));}qx.Class.define("qx.ConcreteCar",{extend:qx.AbstractCar,construct:function(color){arguments.callee.base.apply(this,arguments);}});var car=new qx.ConcreteCar("red");this.assertNotUndefined(car);this.assertEquals("red",car._color);},testSingleton:function(){qx.Class.define("qx.Single1",{extend:Object,type:"singleton",construct:function(name){this._name=name;this._date=new Date().toString();}});this.assertEquals(qx.Single1.getInstance()._date,qx.Single1.getInstance()._date,"getInstance sould always return the same object!");if(this.isDebugOn()){this.assertException(function(){new qx.Single1();},Error,new RegExp("The class .* is a singleton"));}},testSetting:function(){qx.Class.define("qx.Setting1",{settings:{"qx.juhu":"kinners"}});this.assertEquals("kinners",qx.core.Setting.get("qx.juhu"));},testVariant:function(){qx.Class.define("qx.Variant1",{variants:{"qx.juhu":{allowedValues:["kinners","juhu"],defaultValue:"kinners"}}});this.assertEquals("kinners",qx.core.Variant.get("qx.juhu"));if(this.isDebugOn()){this.assertException(function(){qx.Class.define("qx.Variant2",{variants:{"foo.juhu":{allowedValues:["kinners","juhu"],defaultValue:"kinners"}}});},Error,"Forbidden variant");}},testDefer:function(){qx.Class.define("qx.Defer",{extend:qx.core.Object,defer:function(statics,prot,properties){statics.FOO=12;statics.sayHello=function(){return "Hello";};prot.sayJuhu=function(){return "Juhu";};properties.add("color",{});}});this.assertEquals(12,qx.Defer.FOO);this.assertEquals("Hello",qx.Defer.sayHello());var defer=new qx.Defer();this.assertEquals("Juhu",defer.sayJuhu());defer.setColor("red");this.assertEquals("red",defer.getColor());},testGetFunctionName:function(){var self=this;qx.Class.define("qx.FuncName",{extend:qx.core.Object,construct:function(){this.base(arguments);self.assertEquals("construct",qx.dev.Debug.getFunctionName(arguments.callee));},members:{__foo:function(){if(self.isDebugOn()){self.assertEquals("__foo",qx.dev.Debug.getFunctionName(arguments.callee));}},_bar:function(){self.assertEquals("_bar",qx.dev.Debug.getFunctionName(arguments.callee));},sayFooBar:function(){self.assertEquals("sayFooBar",qx.dev.Debug.getFunctionName(arguments.callee));this.__foo();this._bar();}}});var funcName=new qx.FuncName();funcName.sayFooBar();this.assertNull(qx.dev.Debug.getFunctionName(function(){}));},testSubClassOf:function(){this.assertTrue(qx.Class.isSubClassOf(qx.legacy.ui.core.Widget,qx.core.Object));this.assertTrue(qx.Class.isSubClassOf(qx.legacy.ui.basic.Terminator,qx.core.Object));this.assertFalse(qx.Class.isSubClassOf(qx.legacy.ui.basic.Terminator,qx.legacy.ui.core.Parent));}}});qx.Class.define("qx.dev.Debug",{statics:{debugObject:function(obj,initialMessage,maxLevel){if(!maxLevel){maxLevel=10;}var message="";var displayObj=function(obj,level,maxLevel){var indentStr="";for(var i=0;i<level;i++){indentStr+="  ";}if(level>maxLevel){message+=indentStr+"*** TOO MUCH RECURSION: not displaying ***\n";return;}if(typeof (obj)!="object"){message+=indentStr+obj+"\n";return;}for(var prop in obj){if(typeof (obj[prop])=="object"){if(obj[prop] instanceof Array){message+=indentStr+prop+": "+"Array"+"\n";}else{message+=indentStr+prop+": "+"Object"+"\n";}displayObj(obj[prop],level+1,maxLevel);}else{message+=indentStr+prop+": "+obj[prop]+"\n";}}};if(initialMessage){message+=initialMessage+"\n";}if(obj instanceof Array){message+="Array, length="+obj.length+":\n";}else if(typeof (obj)=="object"){var count=0;for(var prop in obj){count++;}message+="Object, count="+count+":\n";}message+="------------------------------------------------------------\n";try{displayObj(obj,0,maxLevel);}catch(ex){message+="*** EXCEPTION ("+ex+") ***\n";}message+="============================================================\n";qx.log.Logger.debug(this,message);},getFunctionName:function(func,functionType){var clazz=func.self;if(!clazz){return null;}while(func.wrapper){func=func.wrapper;}switch(functionType){case "construct":return func==clazz?"construct":null;case "members":return qx.lang.Object.getKeyFromValue(clazz,func);case "statics":return qx.lang.Object.getKeyFromValue(clazz.prototype,func);default:if(func==clazz){return "construct";}return (qx.lang.Object.getKeyFromValue(clazz.prototype,func)||qx.lang.Object.getKeyFromValue(clazz,func)||null);}}}});qx.Class.define("qx.test.locale.Date",{extend:qx.dev.unit.TestCase,members:{setUp:function(){qx.locale.Manager.getInstance().setLocale("C");},testDayNames:function(){var Date=qx.locale.Date;var abbrDays=["Sun","Mon","Tue","Wed","Thu","Fri","Sat"];this.assertJsonEquals(abbrDays,Date.getDayNames("abbreviated").map(function(v){return v+"";}));for(var i=0;i<7;i++){this.assertEquals(abbrDays[i],Date.getDayName("abbreviated",i));}var narrowDays=["S","M","T","W","T","F","S"];this.assertJsonEquals(narrowDays,Date.getDayNames("narrow").map(function(v){return v+"";}));for(var i=0;i<7;i++){this.assertEquals(narrowDays[i],Date.getDayName("narrow",i));}var wideDays=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"];this.assertJsonEquals(wideDays,Date.getDayNames("wide").map(function(v){return v+"";}));for(var i=0;i<7;i++){this.assertEquals(wideDays[i],Date.getDayName("wide",i));}qx.locale.Manager.getInstance().setLocale("de_DE");var abbrDays=["So.","Mo.","Di.","Mi.","Do.","Fr.","Sa."];this.assertJsonEquals(abbrDays,Date.getDayNames("abbreviated").map(function(v){return v+"";}));for(var i=0;i<7;i++){this.assertEquals(abbrDays[i],Date.getDayName("abbreviated",i));}var narrowDays=["S","M","D","M","D","F","S"];this.assertJsonEquals(narrowDays,Date.getDayNames("narrow").map(function(v){return v+"";}));for(var i=0;i<7;i++){this.assertEquals(narrowDays[i],Date.getDayName("narrow",i));}var wideDays=["Sonntag","Montag","Dienstag","Mittwoch","Donnerstag","Freitag","Samstag"];this.assertJsonEquals(wideDays,Date.getDayNames("wide").map(function(v){return v+"";}));for(var i=0;i<7;i++){this.assertEquals(wideDays[i],Date.getDayName("wide",i));}if(this.isDebugOn()){this.assertException(function(){Date.getDayNames("verylong");},Error);this.assertException(function(){Date.getDayName("wide",-1);},Error);this.assertException(function(){Date.getDayName("wide",8);},Error);}},testDateFormat:function(){var Date=qx.locale.Date;this.assertEquals("AM",Date.getAmMarker("C"));this.assertEquals("PM",Date.getPmMarker("C"));}}});qx.Class.define("qx.test.Io",{extend:qx.dev.unit.TestCase,members:{testIO:function(){this.assertNotUndefined(qx.io);},testJson:function(){this.assertEquals('{"test":123}',qx.util.Json.stringify({test:123},false));}}});qx.Class.define("qx.test.ui.Layout",{extend:qx.dev.unit.TestCase,members:{testFlex:function(){var numRuns=500;for(var run=0;run<numRuns;run++){var len=Math.round(Math.random()*20)+1;var sumMin=0;var sumMax=0;var sumValue=0;var flexibles={};for(var j=0;j<len;j++){var min=Math.round(Math.random()*20);var max=min+Math.round(Math.random()*50)+1;var value=min+Math.round(Math.random()*(max-min));sumMax+=max;sumMin+=min;sumValue+=value;flexibles[j]={min:min,value:value,max:max,flex:Math.ceil(Math.random()*5)};}var availWidth=Math.round(Math.random()*500);var result=qx.ui.layout.Util.computeFlexOffsets(flexibles,availWidth,sumValue);var sum=0;for(var i in result){var newSize=flexibles[i].value+result[i].offset;sum+=newSize;this.assert(flexibles[i].min<=newSize);this.assert(flexibles[i].max>=newSize);}if(availWidth!==sum){this.assert(sum==sumMin||sum==sumMax);}else{this.assertEquals(availWidth,sum);}}},testFlexFairness:function(){var numRuns=500;for(var run=0;run<numRuns;run++){var len=Math.round(Math.random()*20)+1;var sumMin=0;var sumMax=0;var sumValue=0;var sumWeights=0;var flexibles={};for(var j=0;j<len;j++){var min=0;var max=32000;var value=Math.round(Math.random()*20);sumMax+=max;sumMin+=min;sumValue+=value;flexibles[j]={min:min,value:value,max:max,flex:1+Math.ceil(Math.random()*5)};sumWeights+=flexibles[j].flex;}var availWidth=sumValue+Math.round(Math.random()*100);var result=qx.ui.layout.Util.computeFlexOffsets(flexibles,availWidth,sumValue);var offsets=0;for(var i in result){offsets+=result[i].offset;}if(sumWeights>0){var unit=offsets/sumWeights;for(var j in result){var error=result[j].offset-(unit*flexibles[j].flex);this.assertTrue(Math.abs(error)<=1,"The error must be at most one pixel!");}}}}}});qx.Class.define("qx.test.ui.Destroy",{extend:qx.test.ui.LayoutTestCase,members:{assertLayoutDispose:function(clazz,args,layoutArgsArr){this.assertDestroy(function(){var argStr=[];for(var i=0;i<args.length;i++){argStr.push("args["+i+"]");}var layout;var str="var layout = new clazz("+argStr.join(", ")+");";eval(str);var widget=new qx.ui.container.Composite();widget.setLayout(layout);for(var i=0;i<layoutArgsArr.length;i++){widget.add(new qx.ui.core.Widget(),layoutArgsArr[i]);}this.getRoot().add(widget);qx.ui.core.queue.Manager.flush();widget.destroy();},this);},testLayouts:function(){var layouts=[[qx.ui.layout.Basic,[],[{left:10},{top:10},{left:10,top:10}]],[qx.ui.layout.Canvas,[],[{left:10},{top:10},{right:10,top:"10%"}]],[qx.ui.layout.Dock,[],[{edge:"north"},{edge:"south"},{edge:"west"},{edge:"east"}]],[qx.ui.layout.Grow,[],[{}]],[qx.ui.layout.HBox,[],[{flex:1},{},{}]],[qx.ui.layout.VBox,[],[{flex:1},{},{}]],[qx.ui.layout.Grid,[],[{row:0,column:0},{row:4,column:3},{row:2,column:0,colSpan:3}]]];for(var i=0;i<layouts.length;i++){this.assertLayoutDispose(layouts[1][0],layouts[1][1],layouts[1][2]);}},testForms:function(){var forms=[[qx.ui.form.Button,["Juhu"]],[qx.ui.form.ComboBox,[]],[qx.ui.form.CheckBox,["Juhu"]],[qx.ui.form.PasswordField,[]],[qx.ui.form.RadioButton,[]],[qx.ui.form.SelectBox,[]],[qx.ui.form.Slider,[]],[qx.ui.form.Spinner,[]],[qx.ui.form.SplitButton,[]],[qx.ui.form.TextArea,[]],[qx.ui.form.TextField,[]],[qx.ui.form.ToggleButton,[]]];for(var i=0;i<forms.length;i++){this.assertWidgetDispose(forms[i][0],forms[i][1],"Disposing "+forms[i][0].classname);}this.assertDestroy(function(){var widget=new qx.ui.form.MenuButton();widget.setMenu(this.__createMenu());this.getRoot().add(widget);qx.ui.core.queue.Manager.flush();widget.destroy();},this,"Dispose menu button");},testBasic:function(){var forms=[[qx.ui.basic.Atom,["Juhu"]],[qx.ui.basic.Label,["Juhu"]],[qx.ui.basic.Image,[]]];for(var i=0;i<forms.length;i++){this.assertWidgetDispose(forms[i][0],forms[i][1],"Disposing "+forms[i][0].classname);}},testContainer:function(){var forms=[[qx.ui.container.Composite,[]],[qx.ui.container.Resizer,[]],[qx.ui.container.Scroll,[]],[qx.ui.container.SlideBar,[]],[qx.ui.container.Stack,[]]];for(var i=0;i<forms.length;i++){this.assertWidgetDispose(forms[i][0],forms[i][1],"Disposing "+forms[i][0].classname);}},testControls:function(){var forms=[[qx.ui.control.ColorSelector,[]],[qx.ui.control.DateChooser,[]]];for(var i=0;i<forms.length;i++){this.assertWidgetDispose(forms[i][0],forms[i][1],"Disposing "+forms[i][0].classname);}this.assertDestroy(function(){var widget=new qx.ui.control.ColorPopup();widget.show();qx.ui.core.queue.Manager.flush();widget.destroy();},this,"Dispose color popup");},testCore:function(){var forms=[[qx.ui.core.ScrollBar,[]],[qx.ui.core.ScrollPane,[]],[qx.ui.core.ScrollSlider,[]],[qx.ui.core.Widget,[]]];for(var i=0;i<forms.length;i++){this.assertWidgetDispose(forms[i][0],forms[i][1],"Disposing "+forms[i][0].classname);}},testEmbeds:function(){var forms=[[qx.ui.embed.Html,["Juhu <b>Kinners</b>"]],[qx.ui.embed.Canvas,[]],[qx.ui.embed.Iframe,[]]];for(var i=0;i<forms.length;i++){this.assertWidgetDispose(forms[i][0],forms[i][1],"Disposing "+forms[i][0].classname);}},testGroupBox:function(){var forms=[[qx.ui.groupbox.CheckGroupBox,[]],[qx.ui.groupbox.GroupBox,[]],[qx.ui.groupbox.RadioGroupBox,[]]];for(var i=0;i<forms.length;i++){this.assertWidgetDispose(forms[i][0],forms[i][1],"Disposing "+forms[i][0].classname);}},testMenu:function(){this.assertDestroy(function(){var menu=new qx.ui.menu.Menu();var btn=new qx.ui.menu.Button("Juhu");menu.add(btn);menu.add(new qx.ui.menu.CheckBox("Juhu"));menu.add(new qx.ui.menu.RadioButton("Juhu"));menu.add(new qx.ui.menu.Separator("Juhu"));var subMenu=new qx.ui.menu.Menu();subMenu.add(new qx.ui.menu.Button("Juhu"));btn.setMenu(subMenu);menu.setOpener(this.getRoot());menu.open();qx.ui.core.queue.Manager.flush();menu.destroy();},this,"Dispose configured menu");},testPopup:function(){this.assertDestroy(function(){var widget=new qx.ui.popup.Popup();widget.show();qx.ui.core.queue.Manager.flush();widget.destroy();},this,"Dispose configured menu");},testProgressive:function(){},testSplitPane:function(){this.assertDestroy(function(){var widget=new qx.ui.splitpane.Pane();widget.add(new qx.ui.core.Widget(),1);widget.add(new qx.ui.core.Widget());this.getRoot().add(widget);qx.ui.core.queue.Manager.flush();widget.destroy();},this,"Dispose split pane");},testTabView:function(){this.assertDestroy(function(){var widget=new qx.ui.tabview.TabView();widget.add(new qx.ui.tabview.Page("Juhu"));widget.add(new qx.ui.tabview.Page("Kinners"));this.getRoot().add(widget);qx.ui.core.queue.Manager.flush();widget.destroy();},this,"Dispose tabview");},testToolbar:function(){var forms=[[qx.ui.toolbar.Button,["Juhu"]],[qx.ui.toolbar.CheckBox,["Juhu"]],[qx.ui.toolbar.Part,[]],[qx.ui.toolbar.PartContainer,[]],[qx.ui.toolbar.RadioButton,["Juhu"]],[qx.ui.toolbar.Separator,[]],[qx.ui.toolbar.ToolBar,[]]];for(var i=0;i<forms.length;i++){this.assertWidgetDispose(forms[i][0],forms[i][1],"Disposing "+forms[i][0].classname);}this.assertDestroy(function(){var widget=new qx.ui.toolbar.MenuButton("juhu");widget.setMenu(this.__createMenu());this.getRoot().add(widget);qx.ui.core.queue.Manager.flush();widget.destroy();},this,"Dispose toolbar menu button");this.assertDestroy(function(){var widget=new qx.ui.toolbar.SplitButton("Juhu");widget.setMenu(this.__createMenu());this.getRoot().add(widget);qx.ui.core.queue.Manager.flush();widget.destroy();},this,"Dispose toolbar split button");this.assertDestroy(function(){var widget=new qx.ui.toolbar.ToolBar();widget.add(new qx.ui.toolbar.Button("juhu"));var part=new qx.ui.toolbar.Part();part.add(new qx.ui.toolbar.RadioButton());widget.add(part);this.getRoot().add(widget);qx.ui.core.queue.Manager.flush();widget.destroy();},this,"Dispose configured toolbar");},testTooltip:function(){this.assertDestroy(function(){var widget=new qx.ui.tooltip.ToolTip();widget.show();qx.ui.core.queue.Manager.flush();widget.destroy();},this,"Dispose tool tip");},testTree:function(){this.assertDestroy(function(){var widget=new qx.ui.tree.Tree();var root=new qx.ui.tree.TreeFolder("folder");root.setOpen(true);root.add(new qx.ui.tree.TreeFile("file"));widget.setRoot(root);widget.show();qx.ui.core.queue.Manager.flush();widget.destroy();},this,"Dispose tool tip");},testTreeVirtual:function(){},testWindow:function(){this.assertDestroy(function(){var widget=new qx.ui.window.Window();widget.show();qx.ui.core.queue.Manager.flush();widget.destroy();},this,"Dispose tool tip");},__createMenu:function(){var menu=new qx.ui.menu.Menu();menu.add(new qx.ui.menu.Button("Juhu"));menu.add(new qx.ui.menu.CheckBox("Juhu"));menu.add(new qx.ui.menu.RadioButton("Juhu"));menu.add(new qx.ui.menu.Separator("Juhu"));return menu;}}});qx.Class.define("qx.ui.layout.Dock",{extend:qx.ui.layout.Abstract,construct:function(spacingX,spacingY,separatorX,separatorY){this.base(arguments);if(spacingX){this.setSpacingX(spacingX);}if(spacingY){this.setSpacingY(spacingY);}if(separatorX){this.setSeparatorX(separatorX);}if(separatorY){this.setSeparatorY(separatorY);}},properties:{sort:{check:["auto","y","x"],init:"auto",apply:"_applySort"},separatorX:{check:"Decorator",nullable:true,apply:"_applyLayoutChange"},separatorY:{check:"Decorator",nullable:true,apply:"_applyLayoutChange"},connectSeparators:{check:"Boolean",init:false,apply:"_applyLayoutChange"},spacingX:{check:"Integer",init:0,apply:"_applyLayoutChange"},spacingY:{check:"Integer",init:0,apply:"_applyLayoutChange"}},members:{__children:null,__edges:null,verifyLayoutProperty:null,_applySort:function(){this._invalidChildrenCache=true;this._applyLayoutChange();},__edgeMap:{north:1,south:2,west:3,east:4,center:5},__alignMap:{1:"top",2:"bottom",3:"left",4:"right"},__rebuildCache:function(){var all=this._getLayoutChildren();var child,center;var length=all.length;var high=[];var low=[];var edge=[];var yfirst=this.getSort()==="y";var xfirst=this.getSort()==="x";for(var i=0;i<length;i++){child=all[i];edge=child.getLayoutProperties().edge;if(edge==="center"){if(center){throw new Error("It is not allowed to have more than one child aligned to 'center'!");}center=child;}else if(xfirst||yfirst){if(edge==="north"||edge==="south"){yfirst?high.push(child):low.push(child);}else if(edge==="west"||edge==="east"){yfirst?low.push(child):high.push(child);}}else{high.push(child);}}var result=high.concat(low);if(center){result.push(center);}this.__children=result;var edges=[];for(var i=0;i<length;i++){edge=result[i].getLayoutProperties().edge;edges[i]=this.__edgeMap[edge]||5;}this.__edges=edges;delete this._invalidChildrenCache;},renderLayout:function(availWidth,availHeight){if(this._invalidChildrenCache){this.__rebuildCache();}var util=qx.ui.layout.Util;var children=this.__children;var edges=this.__edges;var length=children.length;var flexibles,child,hint,props,flex,grow,width,height,offset;var widths=[];var heights=[];var separatorWidths=this._getSeparatorWidths();var spacingX=this.getSpacingX();var spacingY=this.getSpacingY();var allocatedWidth=-spacingX;var allocatedHeight=-spacingY;if(separatorWidths.x){allocatedWidth-=separatorWidths.x+spacingX;}if(separatorWidths.y){allocatedHeight-=separatorWidths.y+spacingY;}for(var i=0;i<length;i++){child=children[i];props=child.getLayoutProperties();hint=child.getSizeHint();width=hint.width;height=hint.height;if(props.width!=null){width=Math.floor(availWidth*parseFloat(props.width)/100);if(width<hint.minWidth){width=hint.minWidth;}else if(width>hint.maxWidth){width=hint.maxWidth;}}if(props.height!=null){height=Math.floor(availHeight*parseFloat(props.height)/100);if(height<hint.minHeight){height=hint.minHeight;}else if(height>hint.maxHeight){height=hint.maxHeight;}}widths[i]=width;heights[i]=height;switch(edges[i]){case 1:case 2:allocatedHeight+=height+child.getMarginTop()+child.getMarginBottom()+spacingY;if(separatorWidths.y){allocatedHeight+=separatorWidths.y+spacingY;}break;case 3:case 4:allocatedWidth+=width+child.getMarginLeft()+child.getMarginRight()+spacingX;if(separatorWidths.x){allocatedWidth+=separatorWidths.x+spacingX;}break;default:allocatedWidth+=width+child.getMarginLeft()+child.getMarginRight()+spacingX;allocatedHeight+=height+child.getMarginTop()+child.getMarginBottom()+spacingY;if(separatorWidths.x){allocatedWidth+=separatorWidths.x+spacingX;}if(separatorWidths.y){allocatedHeight+=separatorWidths.y+spacingY;}}}if(allocatedWidth!=availWidth){flexibles={};grow=allocatedWidth<availWidth;for(var i=0;i<length;i++){child=children[i];switch(edges[i]){case 3:case 4:case 5:flex=child.getLayoutProperties().flex;if(flex==null&&edges[i]==5){flex=1;}if(flex>0){hint=child.getSizeHint();flexibles[i]={min:hint.minWidth,value:widths[i],max:hint.maxWidth,flex:flex};}}}var result=util.computeFlexOffsets(flexibles,availWidth,allocatedWidth);for(var i in result){offset=result[i].offset;widths[i]+=offset;allocatedWidth+=offset;}}if(allocatedHeight!=availHeight){flexibles=[];grow=allocatedHeight<availHeight;for(var i=0;i<length;i++){child=children[i];switch(edges[i]){case 1:case 2:case 5:flex=child.getLayoutProperties().flex;if(flex==null&&edges[i]==5){flex=1;}if(flex>0){hint=child.getSizeHint();flexibles[i]={min:hint.minHeight,value:heights[i],max:hint.maxHeight,flex:flex};}}}var result=util.computeFlexOffsets(flexibles,availHeight,allocatedHeight);for(var i in result){offset=result[i].offset;heights[i]+=offset;allocatedHeight+=offset;}}this._clearSeparators();var separatorX=this.getSeparatorX(),separatorY=this.getSeparatorY();var connectSeparators=this.getConnectSeparators();var nextTop=0,nextLeft=0;var left,top,width,height,used,edge;var separatorLeft,separatorTop,separatorWidth,separatorHeight;var marginTop,marginBottom,marginLeft,marginRight;var alignMap=this.__alignMap;for(var i=0;i<length;i++){child=children[i];edge=edges[i];hint=child.getSizeHint();marginTop=child.getMarginTop();marginBottom=child.getMarginBottom();marginLeft=child.getMarginLeft();marginRight=child.getMarginRight();switch(edge){case 1:case 2:width=availWidth-marginLeft-marginRight;if(width<hint.minWidth){width=hint.minWidth;}else if(width>hint.maxWidth){width=hint.maxWidth;}height=heights[i];top=nextTop+util.computeVerticalAlignOffset(alignMap[edge],height,availHeight,marginTop,marginBottom);left=nextLeft+util.computeHorizontalAlignOffset(child.getAlignX()||"left",width,availWidth,marginLeft,marginRight);if(separatorWidths.y){if(edge==1){separatorTop=nextTop+height+marginTop+spacingY+marginBottom;}else{separatorTop=nextTop+availHeight-height-marginTop-spacingY-marginBottom-separatorWidths.y;}separatorLeft=left;separatorWidth=availWidth;if(connectSeparators&&separatorLeft>0){separatorLeft-=spacingX+marginLeft;separatorWidth+=(spacingX)*2;}else{separatorLeft-=marginLeft;}this._renderSeparator(separatorY,{left:separatorLeft,top:separatorTop,width:separatorWidth,height:separatorWidths.y});}used=height+marginTop+marginBottom+spacingY;if(separatorWidths.y){used+=separatorWidths.y+spacingY;}availHeight-=used;if(edge==1){nextTop+=used;}break;case 3:case 4:height=availHeight-marginTop-marginBottom;if(height<hint.minHeight){height=hint.minHeight;}else if(height>hint.maxHeight){height=hint.maxHeight;}width=widths[i];left=nextLeft+util.computeHorizontalAlignOffset(alignMap[edge],width,availWidth,marginLeft,marginRight);top=nextTop+util.computeVerticalAlignOffset(child.getAlignY()||"top",height,availHeight,marginTop,marginBottom);if(separatorWidths.x){if(edge==3){separatorLeft=nextLeft+width+marginLeft+spacingX+marginRight;}else{separatorLeft=nextLeft+availWidth-width-marginLeft-spacingX-marginRight-separatorWidths.x;}separatorTop=top;separatorHeight=availHeight;if(connectSeparators&&separatorTop>0){separatorTop-=spacingY+marginTop;separatorHeight+=(spacingY)*2;}else{separatorTop-=marginTop;}this._renderSeparator(separatorX,{left:separatorLeft,top:separatorTop,width:separatorWidths.x,height:separatorHeight});}used=width+marginLeft+marginRight+spacingX;if(separatorWidths.x){used+=separatorWidths.x+spacingX;}availWidth-=used;if(edge==3){nextLeft+=used;}break;default:width=availWidth-marginLeft-marginRight;height=availHeight-marginTop-marginBottom;if(width<hint.minWidth){width=hint.minWidth;}else if(width>hint.maxWidth){width=hint.maxWidth;}if(height<hint.minHeight){height=hint.minHeight;}else if(height>hint.maxHeight){height=hint.maxHeight;}left=nextLeft+util.computeHorizontalAlignOffset(child.getAlignX()||"left",width,availWidth,marginLeft,marginRight);top=nextTop+util.computeVerticalAlignOffset(child.getAlignY()||"top",height,availHeight,marginTop,marginBottom);}child.renderLayout(left,top,width,height);}},_getSeparatorWidths:function(){var separatorX=this.getSeparatorX(),separatorY=this.getSeparatorY();if(separatorX||separatorY){var decorationManager=qx.theme.manager.Decoration.getInstance();}if(separatorX){var separatorInstanceX=decorationManager.resolve(separatorX);var separatorInsetsX=separatorInstanceX.getInsets();var separatorWidthX=separatorInsetsX.left+separatorInsetsX.right;}if(separatorY){var separatorInstanceY=decorationManager.resolve(separatorY);var separatorInsetsY=separatorInstanceY.getInsets();var separatorWidthY=separatorInsetsY.top+separatorInsetsY.bottom;}return {x:separatorWidthX||0,y:separatorWidthY||0};},_computeSizeHint:function(){if(this._invalidChildrenCache){this.__rebuildCache();}var children=this.__children;var edges=this.__edges;var length=children.length;var hint,child;var marginX,marginY;var widthX=0,minWidthX=0;var heightX=0,minHeightX=0;var widthY=0,minWidthY=0;var heightY=0,minHeightY=0;var separatorWidths=this._getSeparatorWidths();var spacingX=this.getSpacingX(),spacingY=this.getSpacingY();var spacingSumX=-spacingX,spacingSumY=-spacingY;if(separatorWidths.x){spacingSumX-=separatorWidths.x+spacingX;}if(separatorWidths.y){spacingSumY-=separatorWidths.y+spacingY;}for(var i=0;i<length;i++){child=children[i];hint=child.getSizeHint();marginX=child.getMarginLeft()+child.getMarginRight();marginY=child.getMarginTop()+child.getMarginBottom();switch(edges[i]){case 1:case 2:widthY=Math.max(widthY,hint.width+widthX+marginX);minWidthY=Math.max(minWidthY,hint.minWidth+minWidthX+marginX);heightY+=hint.height+marginY;minHeightY+=hint.minHeight+marginY;spacingSumY+=spacingY;if(separatorWidths.y){spacingSumY+=separatorWidths.y+spacingY;}break;case 3:case 4:heightX=Math.max(heightX,hint.height+heightY+marginY);minHeightX=Math.max(minHeightX,hint.minHeight+minHeightY+marginY);widthX+=hint.width+marginX;minWidthX+=hint.minWidth+marginX;spacingSumX+=spacingX;if(separatorWidths.x){spacingSumX+=separatorWidths.x+spacingX;}break;default:widthX+=hint.width+marginX;minWidthX+=hint.minWidth+marginX;heightY+=hint.height+marginY;minHeightY+=hint.minHeight+marginY;spacingSumX+=spacingX;if(separatorWidths.x){spacingSumX+=separatorWidths.x+spacingX;}spacingSumY+=spacingY;if(separatorWidths.y){spacingSumY+=separatorWidths.y+spacingY;}}}var minWidth=Math.max(minWidthX,minWidthY)+spacingSumX;var width=Math.max(widthX,widthY)+spacingSumX;var minHeight=Math.max(minHeightX,minHeightY)+spacingSumY;var height=Math.max(heightX,heightY)+spacingSumY;return {minWidth:minWidth,width:width,minHeight:minHeight,height:height};}},destruct:function(){this._disposeFields("__edges","__children");}});qx.Class.define("qx.ui.form.AbstractSelectBox",{extend:qx.ui.core.Widget,include:qx.ui.core.MRemoteChildrenHandling,type:"abstract",construct:function(){this.base(arguments);var layout=new qx.ui.layout.HBox();this._setLayout(layout);layout.setAlignY("middle");this.addListener("keypress",this._onKeyPress);this.addListener("blur",this.close,this);this.addListener("resize",this._onResize,this);},properties:{focusable:{refine:true,init:true},width:{refine:true,init:120},name:{check:"String",nullable:true,event:"changeName"},maxListHeight:{check:"Number",apply:"_applyMaxListHeight",nullable:true,init:200}},events:{"changeValue":"qx.event.type.Data"},members:{_createChildControlImpl:function(id){var control;switch(id){case "list":control=new qx.ui.form.List().set({focusable:false,keepFocus:true,height:null,width:null,maxHeight:this.getMaxListHeight(),selectionMode:"one",quickSelection:true});control.addListener("changeSelection",this._onListChangeSelection,this);control.addListener("mousedown",this._onListMouseDown,this);break;case "popup":control=new qx.ui.popup.Popup(new qx.ui.layout.VBox);control.setAutoHide(false);control.setKeepActive(true);control.addListener("mouseup",this.close,this);control.add(this._getChildControl("list"));control.addListener("changeVisibility",this._onPopupChangeVisibility,this);break;}return control||this.base(arguments,id);},_applyMaxListHeight:function(value,old){this._getChildControl("list").setMaxHeight(value);},getChildrenContainer:function(){return this._getChildControl("list");},open:function(){var popup=this._getChildControl("popup");popup.placeToWidget(this);popup.show();},close:function(){this._getChildControl("popup").hide();},toggle:function(){var isListOpen=this._getChildControl("popup").isVisible();if(isListOpen){this.close();}else{this.open();}},_onKeyPress:function(e){var identifier=e.getKeyIdentifier();var listPopup=this._getChildControl("popup");if(listPopup.isHidden()&&(identifier=="PageDown"||identifier=="PageUp")){e.stopPropagation();}else if(!listPopup.isHidden()&&identifier=="Escape"){this.close();e.stop();}else{this._getChildControl("list").handleKeyPress(e);}},_onResize:function(e){this._getChildControl("popup").setMinWidth(e.getData().width);},_onListChangeSelection:function(e){throw new Error("Abstract method: _onListChangeSelection()");},_onListMouseDown:function(e){throw new Error("Abstract method: _onListMouseDown()");},_onPopupChangeVisibility:function(e){throw new Error("Abstract method: _onPopupChangeVisibility()");}}});qx.Class.define("qx.ui.form.ComboBox",{extend:qx.ui.form.AbstractSelectBox,implement:qx.ui.form.IFormElement,construct:function(){this.base(arguments);this._createChildControl("textfield");this._createChildControl("button");this.addListener("click",this._onClick);this.addListener("keydown",this._onKeyDown);},properties:{appearance:{refine:true,init:"combobox"}},events:{"input":"qx.event.type.Data","changeValue":"qx.event.type.Data"},members:{__preSelectedItem:null,_createChildControlImpl:function(id){var control;switch(id){case "textfield":control=new qx.ui.form.TextField();control.setFocusable(false);control.addState("inner");control.addListener("changeValue",this._onTextFieldChangeValue,this);control.addListener("input",this._onTextFieldInput,this);control.addListener("blur",this.close,this);this._add(control,{flex:1});break;case "button":control=new qx.ui.form.Button();control.setFocusable(false);control.setKeepActive(true);control.addState("inner");this._add(control);break;}return control||this.base(arguments,id);},_forwardStates:{focused:true},tabFocus:function(){var field=this._getChildControl("textfield");field.getFocusElement().focus();field.selectAll();},setValue:function(value){var textfield=this._getChildControl("textfield");if(textfield.getValue()==value){return;}textfield.setValue(value);var list=this._getChildControl("list");var item=list.findItem(value);if(item){list.select(item);}else{list.clearSelection();}},getValue:function(){return this._getChildControl("textfield").getValue();},_onKeyDown:function(e){if(e.isAltPressed()){this._getChildControl("button").addState("selected");this.focus();}},_onKeyPress:function(e){var popup=this._getChildControl("popup");var iden=e.getKeyIdentifier();if(iden=="Down"&&e.isAltPressed()){this.toggle();e.stopPropagation();}else if(iden=="Enter"){if(popup.isVisible()){this.close();e.stop();}}else if(popup.isVisible()){this.base(arguments,e);}},_onClick:function(e){var target=e.getTarget();if(target==this._getChildControl("button")){this.toggle();}else{this.close();}},_onListMouseDown:function(e){if(this.__preSelectedItem){this.setValue(this.__preSelectedItem.getLabel());this.__preSelectedItem=null;}},_onListChangeSelection:function(e){if(this.__initialAfterOpen){delete this.__initialAfterOpen;return;}var current=e.getData();if(current.length>0){var list=this._getChildControl("list");if(list.getSelectionContext()=="quick"){this.__preSelectedItem=current[0];}else{this.setValue(current[0].getLabel());this.__preSelectedItem=null;}}},_onPopupChangeVisibility:function(e){var popup=this._getChildControl("popup");if(popup.isVisible()){this.__initialAfterOpen=true;var list=this._getChildControl("list");list.setValue(this.getValue());}else{this.tabFocus();}this._getChildControl("button").removeState("selected");},_onTextFieldInput:function(e){this.fireDataEvent("input",e.getData());},_onTextFieldChangeValue:function(e){var value=e.getData();var list=this._getChildControl("list");var item=list.findItem(value);if(item){list.select(item);}else{list.clearSelection();}this.fireDataEvent("changeValue",value);},getSelection:function(){return this._getChildControl("textfield").getSelection();},getSelectionLength:function(){return this._getChildControl("textfield").getSelectionLength();},setSelection:function(start,end){this._getChildControl("textfield").setSelection(start,end);},clearSelection:function(){this._getChildControl("textfield").clearSelection();},selectAll:function(){this._getChildControl("textfield").selectAll();}}});qx.Class.define("qx.ui.core.AbstractScrollArea",{extend:qx.ui.core.Widget,type:"abstract",construct:function(){this.base(arguments);var grid=new qx.ui.layout.Grid();grid.setColumnFlex(0,1);grid.setRowFlex(0,1);this._setLayout(grid);this.addListener("mousewheel",this._onMouseWheel,this);},properties:{appearance:{refine:true,init:"scrollarea"},width:{refine:true,init:100},height:{refine:true,init:200},scrollbarX:{check:["auto","on","off"],init:"auto",apply:"_computeScrollbars"},scrollbarY:{check:["auto","on","off"],init:"auto",apply:"_computeScrollbars"},scrollbar:{group:["scrollbarX","scrollbarY"]}},members:{_createChildControlImpl:function(id){var control;switch(id){case "pane":control=new qx.ui.core.ScrollPane();control.addListener("update",this._computeScrollbars,this);control.addListener("scrollX",this._onScrollPaneX,this);control.addListener("scrollY",this._onScrollPaneY,this);this._add(control,{row:0,column:0});break;case "scrollbar-x":control=new qx.ui.core.ScrollBar("horizontal");control.exclude();control.addListener("scroll",this._onScrollBarX,this);control.addListener("changeVisibility",this._onChangeScrollbarXVisibility,this);this._add(control,{row:1,column:0});break;case "scrollbar-y":control=new qx.ui.core.ScrollBar("vertical");control.exclude();control.addListener("scroll",this._onScrollBarY,this);control.addListener("changeVisibility",this._onChangeScrollbarYVisibility,this);this._add(control,{row:0,column:1});break;case "corner":control=new qx.ui.core.Widget();control.setWidth(0);control.setHeight(0);control.exclude();this._add(control,{row:1,column:1});break;}return control||this.base(arguments,id);},getPaneSize:function(){return this._getChildControl("pane").getBounds();},getItemTop:function(item){return this._getChildControl("pane").getItemTop(item);},getItemBottom:function(item){return this._getChildControl("pane").getItemBottom(item);},getItemLeft:function(item){return this._getChildControl("pane").getItemLeft(item);},getItemRight:function(item){return this._getChildControl("pane").getItemRight(item);},scrollToX:function(value){this._getChildControl("scrollbar-x").scrollTo(value);},scrollByX:function(value){this._getChildControl("scrollbar-x").scrollBy(value);},getScrollX:function(){var scrollbar=this._getChildControl("scrollbar-x",true);return scrollbar?scrollbar.getPosition():0;},scrollToY:function(value){this._getChildControl("scrollbar-y").scrollTo(value);},scrollByY:function(value){this._getChildControl("scrollbar-y").scrollBy(value);},getScrollY:function(){var scrollbar=this._getChildControl("scrollbar-y",true);return scrollbar?scrollbar.getPosition():0;},_onScrollBarX:function(e){this._getChildControl("pane").scrollToX(e.getData());},_onScrollBarY:function(e){this._getChildControl("pane").scrollToY(e.getData());},_onScrollPaneX:function(e){this.scrollToX(e.getData());},_onScrollPaneY:function(e){this.scrollToY(e.getData());},_onMouseWheel:function(e){var scrollbar=this._getChildControl("scrollbar-y",true);if(scrollbar){scrollbar.scrollBySteps(e.getWheelDelta());}e.stop();},_onChangeScrollbarXVisibility:function(e){var showX=this._isChildControlVisible("scrollbar-x");var showY=this._isChildControlVisible("scrollbar-y");if(!showX){this.scrollToX(0);}showX&&showY?this._showChildControl("corner"):this._excludeChildControl("corner");},_onChangeScrollbarYVisibility:function(e){var showX=this._isChildControlVisible("scrollbar-x");var showY=this._isChildControlVisible("scrollbar-y");if(!showY){this.scrollToY(0);}showX&&showY?this._showChildControl("corner"):this._excludeChildControl("corner");},_computeScrollbars:function(){var pane=this._getChildControl("pane");var content=pane.getChild();if(!content){this._excludeChildControl("scrollbar-x");this._excludeChildControl("scrollbar-y");return;}var innerSize=this.getInnerSize();var paneSize=pane.getBounds();var scrollSize=pane.getScrollSize();if(!paneSize||!scrollSize){return;}var scrollbarX=this.getScrollbarX();var scrollbarY=this.getScrollbarY();if(scrollbarX==="auto"&&scrollbarY==="auto"){var showX=scrollSize.width>innerSize.width;var showY=scrollSize.height>innerSize.height;if((showX||showY)&&!(showX&&showY)){if(showX){showY=scrollSize.height>paneSize.height;}else if(showY){showX=scrollSize.width>paneSize.width;}}}else{var showX=scrollbarX==="on";var showY=scrollbarY==="on";if(scrollSize.width>(showX?paneSize.width:innerSize.width)&&scrollbarX==="auto"){showX=true;}if(scrollSize.height>(showX?paneSize.height:innerSize.height)&&scrollbarY==="auto"){showY=true;}}if(showX){var barX=this._getChildControl("scrollbar-x");barX.show();barX.setMaximum(Math.max(0,scrollSize.width-paneSize.width));barX.setKnobFactor(paneSize.width/scrollSize.width);}else{this._excludeChildControl("scrollbar-x");}if(showY){var barY=this._getChildControl("scrollbar-y");barY.show();barY.setMaximum(Math.max(0,scrollSize.height-paneSize.height));barY.setKnobFactor(paneSize.height/scrollSize.height);}else{this._excludeChildControl("scrollbar-y");}}}});qx.Mixin.define("qx.ui.core.MSelectionHandling",{construct:function(){var clazz=this.SELECTION_MANAGER;var manager=this.__manager=new clazz(this);this.addListener("mousedown",manager.handleMouseDown,manager);this.addListener("mouseup",manager.handleMouseUp,manager);this.addListener("mouseover",manager.handleMouseOver,manager);this.addListener("mousemove",manager.handleMouseMove,manager);this.addListener("losecapture",manager.handleLoseCapture,manager);this.addListener("keypress",manager.handleKeyPress,manager);this.addListener("addItem",manager.handleAddItem,manager);this.addListener("removeItem",manager.handleRemoveItem,manager);manager.addListener("changeSelection",this._onSelectionChange,this);},events:{"changeSelection":"qx.event.type.Data"},properties:{selectionMode:{check:["single","multi","additive","one"],init:"single",apply:"_applySelectionMode"},dragSelection:{check:"Boolean",init:false,apply:"_applyDragSelection"},quickSelection:{check:"Boolean",init:false,apply:"_applyQuickSelection"}},members:{__manager:null,selectAll:function(){this.__manager.selectAll();},select:function(item){this.__manager.selectItem(item);},isSelected:function(item){this.__manager.isSelected(item);},addToSelection:function(item){this.__manager.addItem(item);},removeFromSelection:function(item){this.__manager.removeItem(item);},selectRange:function(begin,end){this.__manager.selectItemRange(begin,end);},clearSelection:function(){this.__manager.clearSelection();},replaceSelection:function(items){this.__manager.replaceSelection(items);},getSelectedItem:function(){return this.__manager.getSelectedItem();},getSelection:function(){return this.__manager.getSelection();},getSortedSelection:function(){return this.__manager.getSortedSelection();},isSelectionEmpty:function(){return this.__manager.isSelectionEmpty();},getSelectionContext:function(){return this.__manager.getSelectionContext();},_getManager:function(){return this.__manager;},_applySelectionMode:function(value,old){this.__manager.setMode(value);},_applyDragSelection:function(value,old){this.__manager.setDrag(value);},_applyQuickSelection:function(value,old){this.__manager.setQuick(value);},_onSelectionChange:function(e){this.fireDataEvent("changeSelection",e.getData());}},destruct:function(){this._disposeObjects("__manager");}});qx.Class.define("qx.ui.core.selection.Abstract",{type:"abstract",extend:qx.core.Object,construct:function(){this.base(arguments);this.__selection={};},events:{"changeSelection":"qx.event.type.Data"},properties:{mode:{check:["single","multi","additive","one"],init:"single",apply:"_applyMode"},drag:{check:"Boolean",init:false},quick:{check:"Boolean",init:false}},members:{__scrollStepX:0,__scrollStepY:0,__scrollTimer:null,__frameScroll:null,__lastRelX:null,__lastRelY:null,__frameLocation:null,__dragStartX:null,__dragStartY:null,__inCapture:null,__mouseX:null,__mouseY:null,__moveDirectionX:null,__moveDirectionY:null,__selectionModified:null,__selectionContext:null,__leadItem:null,__selection:null,__anchorItem:null,__mouseDownOnSelected:null,getSelectionContext:function(){return this.__selectionContext;},selectAll:function(){this._selectAllItems();this._fireChange();},selectItem:function(item){this._setSelectedItem(item);var mode=this.getMode();if(mode!=="single"&&mode!=="one"){this._setLeadItem(item);this._setAnchorItem(item);}this._scrollItemIntoView(item);this._fireChange();},addItem:function(item){var mode=this.getMode();if(mode==="single"||mode==="one"){this._setSelectedItem(item);}else{if(!this._getAnchorItem()){this._setAnchorItem(item);}this._setLeadItem(item);this._addToSelection(item);}this._scrollItemIntoView(item);this._fireChange();},removeItem:function(item){this._removeFromSelection(item);if(this.getMode()==="one"&&this.isSelectionEmpty()){var first=this._getFirstSelectable();if(first){this.addItem(first);}}if(this._getLeadItem()==item){this._setLeadItem(null);}if(this._getAnchorItem()==item){this._setAnchorItem(null);}this._fireChange();},selectItemRange:function(begin,end){this._selectItemRange(begin,end);this._setAnchorItem(begin);this._setLeadItem(end);this._scrollItemIntoView(end);this._fireChange();},clearSelection:function(){if(this.getMode()=="one"){return;}this._clearSelection();this._setLeadItem(null);this._setAnchorItem(null);this._fireChange();},replaceSelection:function(items){this._clearSelection();this._setLeadItem(null);this._setAnchorItem(null);for(var i=0,l=items.length;i<l;i++){this._addToSelection(items[i]);}if(l>0){this._scrollItemIntoView(items[l-1]);}else if(this.getMode()=="one"){var firstItem=this._getFirstSelectable();if(firstItem){this._addToSelection(firstItem);}}this._fireChange();},getSelectedItem:function(){var mode=this.getMode();if(mode==="single"||mode==="one"){return this._getSelectedItem()||null;}throw new Error("The method getSelectedItem() is only supported in 'single' and 'one' selection mode!");},getSelection:function(){return qx.lang.Object.getValues(this.__selection);},getSortedSelection:function(){var children=this._getSelectables();var sel=qx.lang.Object.getValues(this.__selection);sel.sort(function(a,b){return children.indexOf(a)-children.indexOf(b);});return sel;},isItemSelected:function(item){var hash=this._selectableToHashCode(item);return !!this.__selection[hash];},isSelectionEmpty:function(){return qx.lang.Object.isEmpty(this.__selection);},_setLeadItem:function(value){var old=this.__leadItem;if(old){this._styleSelectable(old,"lead",false);}if(value){this._styleSelectable(value,"lead",true);}this.__leadItem=value;},_getLeadItem:function(){return this.__leadItem||null;},_setAnchorItem:function(value){var old=this.__anchorItem;if(old){this._styleSelectable(old,"anchor",false);}if(value){this._styleSelectable(value,"anchor",true);}this.__anchorItem=value;},_getAnchorItem:function(){return this.__anchorItem||null;},_isSelectable:function(item){throw new Error("Abstract method call: _isSelectable()");},_getSelectableFromTarget:function(target){return this._isSelectable(target)?target:null;},_selectableToHashCode:function(item){throw new Error("Abstract method call: _selectableToHashCode()");},_styleSelectable:function(item,type,enabled){throw new Error("Abstract method call: _styleSelectable()");},_capture:function(){throw new Error("Abstract method call: _capture()");},_releaseCapture:function(){throw new Error("Abstract method call: _releaseCapture()");},_getLocation:function(){throw new Error("Abstract method call: _getLocation()");},_getDimension:function(){throw new Error("Abstract method call: _getDimension()");},_getSelectableLocationX:function(item){throw new Error("Abstract method call: _getSelectableLocationX()");},_getSelectableLocationY:function(item){throw new Error("Abstract method call: _getSelectableLocationY()");},_getScroll:function(){throw new Error("Abstract method call: _getScroll()");},_scrollBy:function(xoff,yoff){throw new Error("Abstract method call: _scrollBy()");},_scrollItemIntoView:function(item){throw new Error("Abstract method call: _scrollItemIntoView()");},_getSelectables:function(){throw new Error("Abstract method call: _getSelectables()");},_getSelectableRange:function(item1,item2){throw new Error("Abstract method call: _getSelectableRange()");},_getFirstSelectable:function(){throw new Error("Abstract method call: _getFirstSelectable()");},_getLastSelectable:function(){throw new Error("Abstract method call: _getLastSelectable()");},_getRelatedSelectable:function(item,relation){throw new Error("Abstract method call: _getRelatedSelectable()");},_getPage:function(lead,up){throw new Error("Abstract method call: _getPage()");},_applyMode:function(value,old){this._setLeadItem(null);this._setAnchorItem(null);this._clearSelection();if(value==="one"){var first=this._getFirstSelectable();if(first){this._setSelectedItem(first);this._scrollItemIntoView(first);}}this._fireChange();},handleMouseOver:function(event){if(!this.getQuick()){return;}var mode=this.getMode();if(mode!=="one"&&mode!=="single"){return;}var item=this._getSelectableFromTarget(event.getTarget());if(!item){return;}this._setSelectedItem(item);this._fireChange("quick");},handleMouseDown:function(event){var item=this._getSelectableFromTarget(event.getTarget());if(!item){return;}var isCtrlPressed=event.isCtrlPressed()||(qx.bom.client.Platform.MAC&&event.isMetaPressed());var isShiftPressed=event.isShiftPressed();if(this.isItemSelected(item)&&!isShiftPressed&&!isCtrlPressed){this.__mouseDownOnSelected=item;return;}else{this.__mouseDownOnSelected=null;}this._scrollItemIntoView(item);switch(this.getMode()){case "single":case "one":this._setSelectedItem(item);break;case "additive":this._setLeadItem(item);this._setAnchorItem(item);this._toggleInSelection(item);break;case "multi":this._setLeadItem(item);if(isShiftPressed){var anchor=this._getAnchorItem();if(!anchor){this._setAnchorItem(anchor=this.getFirstItem());}this._selectItemRange(anchor,item,isCtrlPressed);}else if(isCtrlPressed){this._setAnchorItem(item);this._toggleInSelection(item);}else{this._setAnchorItem(item);this._setSelectedItem(item);}break;}var mode=this.getMode();if(this.getDrag()&&mode!=="single"&&mode!=="one"&&!isShiftPressed&&!isCtrlPressed){this.__frameLocation=this._getLocation();this.__frameScroll=this._getScroll();this.__dragStartX=event.getDocumentLeft()+this.__frameScroll.left;this.__dragStartY=event.getDocumentTop()+this.__frameScroll.top;this.__inCapture=true;this._capture();}this._fireChange("click");},handleMouseUp:function(event){var isCtrlPressed=event.isCtrlPressed()||(qx.bom.client.Platform.MAC&&event.isMetaPressed());var isShiftPressed=event.isShiftPressed();if(!isCtrlPressed&&!isShiftPressed&&this.__mouseDownOnSelected){var item=this._getSelectableFromTarget(event.getTarget());if(!item||!this.isItemSelected(item)){return;}var mode=this.getMode();if(mode==="additive"){this._removeFromSelection(item);}else{this._setSelectedItem(item);if(this.getMode()==="multi"){this._setLeadItem(item);this._setAnchorItem(item);}}}this._cleanup();},handleLoseCapture:function(event){this._cleanup();},handleMouseMove:function(event){if(!this.__inCapture){return;}this.__mouseX=event.getDocumentLeft();this.__mouseY=event.getDocumentTop();var dragX=this.__mouseX+this.__frameScroll.left;if(dragX>this.__dragStartX){this.__moveDirectionX=1;}else if(dragX<this.__dragStartX){this.__moveDirectionX=-1;}else{this.__moveDirectionX=0;}var dragY=this.__mouseY+this.__frameScroll.top;if(dragY>this.__dragStartY){this.__moveDirectionY=1;}else if(dragY<this.__dragStartY){this.__moveDirectionY=-1;}else{this.__moveDirectionY=0;}var location=this.__frameLocation;if(this.__mouseX<location.left){this.__scrollStepX=this.__mouseX-location.left;}else if(this.__mouseX>location.right){this.__scrollStepX=this.__mouseX-location.right;}else{this.__scrollStepX=0;}if(this.__mouseY<location.top){this.__scrollStepY=this.__mouseY-location.top;}else if(this.__mouseY>location.bottom){this.__scrollStepY=this.__mouseY-location.bottom;}else{this.__scrollStepY=0;}if(!this.__scrollTimer){this.__scrollTimer=new qx.event.Timer(100);this.__scrollTimer.addListener("interval",this._onInterval,this);}this.__scrollTimer.start();this._autoSelect();},handleAddItem:function(e){var item=e.getData();if(this.getMode()==="one"&&this.isSelectionEmpty()){this.addItem(item);}},handleRemoveItem:function(e){this.removeItem(e.getData());},_cleanup:function(){if(!this.getDrag()&&this.__inCapture){return;}delete this.__inCapture;delete this.__lastRelX;delete this.__lastRelY;this._releaseCapture();if(this.__scrollTimer){this.__scrollTimer.stop();}},_onInterval:function(e){this._scrollBy(this.__scrollStepX,this.__scrollStepY);this.__frameScroll=this._getScroll();this._autoSelect();},_autoSelect:function(){var inner=this._getDimension();var relX=Math.max(0,Math.min(this.__mouseX-this.__frameLocation.left,inner.width))+this.__frameScroll.left;var relY=Math.max(0,Math.min(this.__mouseY-this.__frameLocation.top,inner.height))+this.__frameScroll.top;if(this.__lastRelX===relX&&this.__lastRelY===relY){return;}this.__lastRelX=relX;this.__lastRelY=relY;var anchor=this._getAnchorItem();var moveX=this.__moveDirectionX,leadX=anchor;var nextX,locationX,countX=0;while(moveX!==0){nextX=moveX>0?this._getRelatedSelectable(leadX,"right"):this._getRelatedSelectable(leadX,"left");if(nextX){locationX=this._getSelectableLocationX(nextX);if((moveX>0&&locationX.left<=relX)||(moveX<0&&locationX.right>=relX)){leadX=nextX;countX++;continue;}}break;}var moveY=this.__moveDirectionY,leadY=anchor;var nextY,locationY,countY=0;while(moveY!==0){nextY=moveY>0?this._getRelatedSelectable(leadY,"under"):this._getRelatedSelectable(leadY,"above");if(nextY){locationY=this._getSelectableLocationY(nextY);if((moveY>0&&locationY.top<=relY)||(moveY<0&&locationY.bottom>=relY)){leadY=nextY;countY++;continue;}}break;}var lead=countX>countY?leadX:leadY;var mode=this.getMode();if(mode==="multi"){this._selectItemRange(anchor,lead);}else if(mode==="additive"){if(this.isItemSelected(anchor)){this._selectItemRange(anchor,lead,true);}else{this._deselectItemRange(anchor,lead);}this._setAnchorItem(lead);}this._fireChange("drag");},__navigationKeys:{Home:1,Down:1,Right:1,PageDown:1,End:1,Up:1,Left:1,PageUp:1},handleKeyPress:function(event){var current,next;var key=event.getKeyIdentifier();var mode=this.getMode();var isCtrlPressed=event.isCtrlPressed()||(qx.bom.client.Platform.MAC&&event.isMetaPressed());var isShiftPressed=event.isShiftPressed();var consumed=false;if(key==="A"&&isCtrlPressed){if(mode!=="single"&&mode!=="one"){this._selectAllItems();consumed=true;}}else if(key==="Escape"){if(mode!=="single"&&mode!=="one"){this._clearSelection();consumed=true;}}else if(key==="Space"){var lead=this._getLeadItem();if(lead&&!isShiftPressed){if(isCtrlPressed||mode==="additive"){this._toggleInSelection(lead);}else{this._setSelectedItem(lead);}consumed=true;}}else if(this.__navigationKeys[key]){consumed=true;if(mode==="single"||mode=="one"){current=this._getSelectedItem();}else{current=this._getLeadItem();}var first=this._getFirstSelectable();var last=this._getLastSelectable();if(current){switch(key){case "Home":next=first;break;case "End":next=last;break;case "Up":next=this._getRelatedSelectable(current,"above");break;case "Down":next=this._getRelatedSelectable(current,"under");break;case "Left":next=this._getRelatedSelectable(current,"left");break;case "Right":next=this._getRelatedSelectable(current,"right");break;case "PageUp":next=this._getPage(current,true);break;case "PageDown":next=this._getPage(current,false);break;}}else{switch(key){case "Home":case "Down":case "Right":case "PageDown":next=first;break;case "End":case "Up":case "Left":case "PageUp":next=last;break;}}if(next){switch(mode){case "single":case "one":this._setSelectedItem(next);break;case "additive":this._setLeadItem(next);break;case "multi":if(isShiftPressed){var anchor=this._getAnchorItem();if(!anchor){this._setAnchorItem(anchor=this._getFirstSelectable());}this._setLeadItem(next);this._selectItemRange(anchor,next,isCtrlPressed);}else{this._setAnchorItem(next);this._setLeadItem(next);if(!isCtrlPressed){this._setSelectedItem(next);}}break;}this._scrollItemIntoView(next);}}if(consumed){event.stop();this._fireChange("key");}},_selectAllItems:function(){var range=this._getSelectables();for(var i=0,l=range.length;i<l;i++){this._addToSelection(range[i]);}},_clearSelection:function(){var selection=this.__selection;for(var hash in selection){this._removeFromSelection(selection[hash]);}},_selectItemRange:function(item1,item2,extend){var range=this._getSelectableRange(item1,item2);if(!extend){var selected=this.__selection;var mapped=this.__rangeToMap(range);for(var hash in selected){if(!mapped[hash]){this._removeFromSelection(selected[hash]);}}}for(var i=0,l=range.length;i<l;i++){this._addToSelection(range[i]);}},_deselectItemRange:function(item1,item2){var range=this._getSelectableRange(item1,item2);for(var i=0,l=range.length;i<l;i++){this._removeFromSelection(range[i]);}},__rangeToMap:function(range){var mapped={};var item;for(var i=0,l=range.length;i<l;i++){item=range[i];mapped[this._selectableToHashCode(item)]=item;}return mapped;},_getSelectedItem:function(){for(var hash in this.__selection){return this.__selection[hash];}return null;},_setSelectedItem:function(item){this._clearSelection();this._addToSelection(item);},_addToSelection:function(item){var hash=this._selectableToHashCode(item);if(!this.__selection[hash]){this.__selection[hash]=item;this._styleSelectable(item,"selected",true);this.__selectionModified=true;}},_toggleInSelection:function(item){var hash=this._selectableToHashCode(item);if(!this.__selection[hash]){this.__selection[hash]=item;this._styleSelectable(item,"selected",true);}else{delete this.__selection[hash];this._styleSelectable(item,"selected",false);}this.__selectionModified=true;},_removeFromSelection:function(item){var hash=this._selectableToHashCode(item);if(this.__selection[hash]){delete this.__selection[hash];this._styleSelectable(item,"selected",false);this.__selectionModified=true;}},_fireChange:function(context){if(this.__selectionModified){this.__selectionContext=context||null;this.fireDataEvent("changeSelection",this.getSelection());delete this.__selectionModified;}}},destruct:function(){this._disposeObjects("__scrollTimer");this._disposeFields("__selection","__mouseDownOnSelected","__anchorItem","__leadItem");}});qx.Class.define("qx.ui.core.selection.Widget",{extend:qx.ui.core.selection.Abstract,construct:function(widget){this.base(arguments);this._widget=widget;},members:{_isSelectable:function(item){return item.isEnabled()&&item.getLayoutParent()===this._widget;},_selectableToHashCode:function(item){return item.$$hash;},_styleSelectable:function(item,type,enabled){enabled?item.addState(type):item.removeState(type);},_capture:function(){this._widget.capture();},_releaseCapture:function(){this._widget.releaseCapture();},_getLocation:function(){var elem=this._widget.getContentElement().getDomElement();return elem?qx.bom.element.Location.get(elem):null;},_getDimension:function(){return this._widget.getInnerSize();},_getSelectableLocationX:function(item){var computed=item.getBounds();if(computed){return {left:computed.left,right:computed.left+computed.width};}},_getSelectableLocationY:function(item){var computed=item.getBounds();if(computed){return {top:computed.top,bottom:computed.top+computed.height};}},_getScroll:function(){return {left:0,top:0};},_scrollBy:function(xoff,yoff){},_scrollItemIntoView:function(item){this._widget.scrollChildIntoView(item);},_getSelectables:function(){var children=this._widget.getChildren();var result=[];var child;for(var i=0,l=children.length;i<l;i++){child=children[i];if(child.isEnabled()){result.push(child);}}return result;},_getSelectableRange:function(item1,item2){if(item1===item2){return [item1];}var children=this._widget.getChildren();var result=[];var active=false;var child;for(var i=0,l=children.length;i<l;i++){child=children[i];if(child===item1||child===item2){if(active){result.push(child);break;}else{active=true;}}if(active&&child.isEnabled()){result.push(child);}}return result;},_getFirstSelectable:function(){var children=this._widget.getChildren();for(var i=0,l=children.length;i<l;i++){if(children[i].isEnabled()){return children[i];}}return null;},_getLastSelectable:function(){var children=this._widget.getChildren();for(var i=children.length-1;i>0;i--){if(children[i].isEnabled()){return children[i];}}return null;},_getRelatedSelectable:function(item,relation){var vertical=this._widget.getOrientation()==="vertical";var children=this._widget.getChildren();var index=children.indexOf(item);var sibling;if((vertical&&relation==="above")||(!vertical&&relation==="left")){for(var i=index-1;i>=0;i--){sibling=children[i];if(sibling.isEnabled()){return sibling;}}}else if((vertical&&relation==="under")||(!vertical&&relation==="right")){for(var i=index+1;i<children.length;i++){sibling=children[i];if(sibling.isEnabled()){return sibling;}}}return null;},_getPage:function(lead,up){if(up){return this._getFirstSelectable();}else{return this._getLastSelectable();}}},destruct:function(){this._disposeFields("_widget");}});qx.Class.define("qx.ui.core.selection.ScrollArea",{extend:qx.ui.core.selection.Widget,members:{_isSelectable:function(item){return item.isEnabled()&&item.getLayoutParent()===this._widget.getChildrenContainer();},_getDimension:function(){return this._widget.getPaneSize();},_getScroll:function(){var widget=this._widget;return {left:widget.getScrollX(),top:widget.getScrollY()};},_scrollBy:function(xoff,yoff){var widget=this._widget;widget.scrollByX(xoff);widget.scrollByY(yoff);},_getPage:function(lead,up){var selectables=this._getSelectables();var length=selectables.length;var start=selectables.indexOf(lead);if(start===-1){throw new Error("Invalid lead item: "+lead);}var widget=this._widget;var scrollTop=widget.getScrollY();var innerHeight=widget.getInnerSize().height;var top,bottom,found;if(up){var min=scrollTop;var i=start;while(1){for(;i>=0;i--){top=widget.getItemTop(selectables[i]);if(top<min){found=i+1;break;}}if(found==null){var first=this._getFirstSelectable();return first==lead?null:first;}if(found>=start){min-=innerHeight+scrollTop-widget.getItemBottom(lead);found=null;continue;}return selectables[found];}}else{var max=innerHeight+scrollTop;var i=start;while(1){for(;i<length;i++){bottom=widget.getItemBottom(selectables[i]);if(bottom>max){found=i-1;break;}}if(found==null){var last=this._getLastSelectable();return last==lead?null:last;}if(found<=start){max+=widget.getItemTop(lead)-scrollTop;found=null;continue;}return selectables[found];}}}}});qx.Class.define("qx.ui.form.List",{extend:qx.ui.core.AbstractScrollArea,implement:qx.ui.form.IFormElement,include:[qx.ui.core.MRemoteChildrenHandling,qx.ui.core.MSelectionHandling],construct:function(horizontal){this.base(arguments);this.__content=new qx.ui.container.Composite();this.__content.addListener("addChildWidget",this._onAddChild,this);this.__content.addListener("removeChildWidget",this._onRemoveChild,this);this._getChildControl("pane").add(this.__content);if(horizontal){this.setOrientation("horizontal");}else{this.initOrientation();}this.addListener("keypress",this._onKeyPress);this.addListener("keyinput",this._onKeyInput);this.addListener("changeSelection",this._onChangeSelection);this.__pressedString="";},events:{addItem:"qx.event.type.Data",removeItem:"qx.event.type.Data",changeValue:"qx.event.type.Data"},properties:{appearance:{refine:true,init:"list"},focusable:{refine:true,init:true},orientation:{check:["horizontal","vertical"],init:"vertical",apply:"_applyOrientation"},spacing:{check:"Integer",init:0,apply:"_applySpacing",themeable:true},enableInlineFind:{check:"Boolean",init:true},name:{check:"String",nullable:true,event:"changeName"}},members:{__pressedString:null,__lastKeyPress:null,__content:null,SELECTION_MANAGER:qx.ui.core.selection.ScrollArea,getChildrenContainer:function(){return this.__content;},_onAddChild:function(e){this.fireDataEvent("addItem",e.getData());},_onRemoveChild:function(e){this.fireDataEvent("removeItem",e.getData());},getValue:function(){var selected=this.getSelection();var result=[];var value;for(var i=0,l=selected.length;i<l;i++){value=selected[i].getValue();if(value==null){value=selected[i].getLabel();}result.push(value);}return result.join(",");},setValue:function(value){var splitted=value.split(",");var result=[];var item;for(var i=0,l=splitted.length;i<l;i++){item=this.findItem(splitted[i]);if(item){result.push(item);}}this.replaceSelection(result);},handleKeyPress:function(e){if(!this._onKeyPress(e)){this._getManager().handleKeyPress(e);}},_applyOrientation:function(value,old){var horizontal=value==="horizontal";var layout=horizontal?new qx.ui.layout.HBox():new qx.ui.layout.VBox();var content=this.__content;content.setLayout(layout);content.setAllowGrowX(!horizontal);content.setAllowGrowY(horizontal);this._applySpacing(this.getSpacing());},_applySpacing:function(value,old){this.__content.getLayout().setSpacing(value);},_onKeyPress:function(e){if(e.getKeyIdentifier()=="Enter"&&!e.isAltPressed()){var items=this.getSelection();for(var i=0;i<items.length;i++){items[i].fireEvent("action");}return true;}return false;},_onChangeSelection:function(){if(this.hasListener("changeValue")){this.fireDataEvent("changeValue",this.getValue());}},_onKeyInput:function(e){if(!this.getEnableInlineFind()){return;}var mode=this.getSelectionMode();if(!(mode==="single"||mode==="one")){return;}if(((new Date).valueOf()-this.__lastKeyPress)>1000){this.__pressedString="";}this.__pressedString+=e.getChar();var matchedItem=this.findItemByLabelFuzzy(this.__pressedString);if(matchedItem){this.select(matchedItem);}this.__lastKeyPress=(new Date).valueOf();e.preventDefault();},findItemByLabelFuzzy:function(search){search=search.toLowerCase();var items=this.getChildren();for(var i=0,l=items.length;i<l;i++){var currentLabel=items[i].getLabel();if(currentLabel&&currentLabel.toLowerCase().indexOf(search)==0){return items[i];}}return null;},findItem:function(search){search=search.toLowerCase();var items=this.getChildren();var item;for(var i=0,l=items.length;i<l;i++){item=items[i];if(item.getFormValue().toLowerCase()==search){return item;}}return null;}},destruct:function(){this._disposeObjects("__content");}});qx.Class.define("qx.ui.core.ScrollPane",{extend:qx.ui.core.Widget,construct:function(){this.base(arguments);this._setLayout(new qx.ui.layout.Grow());this.addListener("resize",this._onUpdate);var contentEl=this.getContentElement();contentEl.addListener("scroll",this._onScroll,this);contentEl.addListener("appear",this._onAppear,this);},events:{update:"qx.event.type.Event"},properties:{scrollX:{check:"typeof value=='number'&&value>=0&&value<=this.getScrollMaxX()",apply:"_applyScrollX",event:"scrollX",init:0},scrollY:{check:"typeof value=='number'&&value>=0&&value<=this.getScrollMaxY()",apply:"_applyScrollY",event:"scrollY",init:0}},members:{add:function(widget){var old=this._getChildren()[0];if(old){this._remove(old);old.removeListener("resize",this._onUpdate,this);}if(widget){this._add(widget);widget.addListener("resize",this._onUpdate,this);}},remove:function(widget){if(widget){this._remove(widget);widget.removeListener("resize",this._onUpdate,this);}},getChild:function(){return this._getChildren()[0]||null;},_onUpdate:function(e){this.fireEvent("update");},_onScroll:function(e){var contentEl=this.getContentElement();this.setScrollX(contentEl.getScrollX());this.setScrollY(contentEl.getScrollY());},_onAppear:function(e){var contentEl=this.getContentElement();var internalX=this.getScrollX();var domX=contentEl.getScrollX();if(internalX!=domX){contentEl.scrollToX(internalX);}var internalY=this.getScrollY();var domY=contentEl.getScrollY();if(internalY!=domY){contentEl.scrollToY(internalY);}},getItemTop:function(item){var top=0;do{top+=item.getBounds().top;item=item.getLayoutParent();}while(item&&item!==this);return top;},getItemBottom:function(item){return this.getItemTop(item)+item.getBounds().height;},getItemLeft:function(item){var left=0;var parent;do{left+=item.getBounds().left;parent=item.getLayoutParent();if(parent){left+=parent.getInsets().left;}item=parent;}while(item&&item!==this);return left;},getItemRight:function(item){return this.getItemLeft(item)+item.getBounds().width;},getScrollSize:function(){return this.getChild().getBounds();},getScrollMaxX:function(){var paneSize=this.getBounds();var scrollSize=this.getScrollSize();if(paneSize&&scrollSize){return Math.max(0,scrollSize.width-paneSize.width);}return 0;},getScrollMaxY:function(){var paneSize=this.getBounds();var scrollSize=this.getScrollSize();if(paneSize&&scrollSize){return Math.max(0,scrollSize.height-paneSize.height);}return 0;},scrollToX:function(value){var max=this.getScrollMaxX();if(value<0){value=0;}else if(value>max){value=max;}this.setScrollX(value);},scrollToY:function(value){var max=this.getScrollMaxY();if(value<0){value=0;}else if(value>max){value=max;}this.setScrollY(value);},scrollByX:function(x){this.scrollToX(this.getScrollX()+x);},scrollByY:function(y){this.scrollToY(this.getScrollY()+y);},_applyScrollX:function(value){this.getContentElement().scrollToX(value);},_applyScrollY:function(value){this.getContentElement().scrollToY(value);}}});qx.Class.define("qx.ui.form.ToggleButton",{extend:qx.ui.basic.Atom,implement:qx.ui.form.IFormElement,construct:function(label,icon){this.base(arguments,label,icon);this.addListener("mouseover",this._onMouseOver);this.addListener("mouseout",this._onMouseOut);this.addListener("mousedown",this._onMouseDown);this.addListener("mouseup",this._onMouseUp);this.addListener("keydown",this._onKeyDown);this.addListener("keyup",this._onKeyUp);},properties:{appearance:{refine:true,init:"button"},checked:{check:"Boolean",init:false,apply:"_applyChecked",event:"changeChecked"},focusable:{refine:true,init:true},name:{check:"String",nullable:true,event:"changeName"},value:{check:"String",nullable:true,event:"changeValue"}},members:{_applyChecked:function(value,old){value?this.addState("checked"):this.removeState("checked");},_onMouseOver:function(e){if(e.getTarget()!==this){return;}this.addState("hovered");if(this.hasState("abandoned")){this.removeState("abandoned");this.addState("pressed");}},_onMouseOut:function(e){if(e.getTarget()!==this){return;}this.removeState("hovered");if(this.hasState("pressed")){if(!this.getChecked()){this.removeState("pressed");}this.addState("abandoned");}},_onMouseDown:function(e){if(!e.isLeftPressed()){return;}this.capture();this.removeState("abandoned");this.addState("pressed");e.stopPropagation();},_onMouseUp:function(e){this.releaseCapture();if(this.hasState("abandoned")){this.removeState("abandoned");}else if(this.hasState("pressed")){this.toggleChecked();}this.removeState("pressed");e.stopPropagation();},_onKeyDown:function(e){switch(e.getKeyIdentifier()){case "Enter":case "Space":this.removeState("abandoned");this.addState("pressed");e.stopPropagation();}},_onKeyUp:function(e){if(!this.hasState("pressed")){return;}switch(e.getKeyIdentifier()){case "Enter":case "Space":this.removeState("abandoned");this.toggleChecked();e.stopPropagation();}}}});qx.Class.define("qx.ui.form.CheckBox",{extend:qx.ui.form.ToggleButton,construct:function(label){{};this.base(arguments,label);},properties:{appearance:{refine:true,init:"checkbox"},allowGrowX:{refine:true,init:false}}});qx.Class.define("qx.ui.form.PasswordField",{extend:qx.ui.form.TextField,members:{_createInputElement:function(){return new qx.html.Input("password");}}});qx.Interface.define("qx.ui.form.IRadioItem",{extend:qx.ui.form.IFormElement,events:{"changeChecked":"qx.event.type.Data"},members:{setChecked:function(value){this.assertType(value,"boolean");},getChecked:function(){},setGroup:function(value){this.assertInstance(value,qx.ui.form.RadioGroup);},getGroup:function(){}}});qx.Class.define("qx.ui.form.RadioButton",{extend:qx.ui.form.Button,implement:qx.ui.form.IRadioItem,construct:function(label){{};this.base(arguments,label);this.addListener("execute",this._onExecute);this.addListener("keypress",this._onKeyPress);},properties:{group:{check:"qx.ui.form.RadioGroup",nullable:true,apply:"_applyGroup"},checked:{check:"Boolean",init:false,apply:"_applyChecked",event:"changeChecked"},appearance:{refine:true,init:"radiobutton"},allowGrowX:{refine:true,init:false}},members:{isTabable:function(){return this.isFocusable()&&this.isChecked();},_applyChecked:function(value,old){value?this.addState("checked"):this.removeState("checked");if(value&&this.getFocusable()){this.focus();}},_applyGroup:function(value,old){if(old){old.remove(this);}if(value){value.add(this);}},_onExecute:function(e){this.setChecked(true);},_onKeyPress:function(e){var grp=this.getGroup();if(!grp){return;}switch(e.getKeyIdentifier()){case "Left":case "Up":grp.selectPrevious();break;case "Right":case "Down":grp.selectNext();break;}}}});qx.Class.define("qx.ui.form.RadioGroup",{extend:qx.core.Object,implement:qx.ui.form.IFormElement,construct:function(varargs){this.base(arguments);this.__items=[];if(varargs!=null){this.add.apply(this,arguments);}this.addListener("changeSelected",this._onChangeSelected);},properties:{enabled:{check:"Boolean",apply:"_applyEnabled",event:"changeEnabled"},selected:{nullable:true,apply:"_applySelected",event:"changeSelected",check:"qx.ui.form.IRadioItem"},name:{check:"String",nullable:true,apply:"_applyName",event:"changeName"},wrap:{check:"Boolean",init:true}},events:{"changeValue":"qx.event.type.Data"},members:{__items:null,getItems:function(){return this.__items;},select:function(item){this.setSelected(item);},setValue:function(value){var items=this.__items;var item;for(var i=0,l=items.length;i<l;i++){item=items[i];if(item.getValue()==value){this.setSelected(item);break;}}},getValue:function(){var selected=this.getSelected();return selected?selected.getValue():null;},add:function(varargs){var items=this.__items;var item;for(var i=0,l=arguments.length;i<l;i++){item=arguments[i];if(item.getGroup()===this){continue;}item.addListener("changeChecked",this._onItemChangeChecked,this);items.push(item);item.setGroup(this);if(item.getChecked()){this.setSelected(item);}}if(items.length>0&&!this.getSelected()){this.setSelected(items[0]);}},remove:function(item){if(item.getGroup()===this){qx.lang.Array.remove(this.__items,item);item.resetGroup();item.removeListener("changeChecked",this._onItemChangeChecked,this);if(item.getChecked()){this.resetSelected();}}},_onItemChangeChecked:function(e){var item=e.getTarget();if(item.getChecked()){this.setSelected(item);}else if(this.getSelected()==item){this.resetSelected();}},_onChangeSelected:function(e){var item=e.getData();var value=null;if(item){value=item.getValue();if(value==null){value=item.getLabel();}}this.fireDataEvent("changeValue",value);},_applySelected:function(value,old){if(old){old.setChecked(false);}if(value){value.setChecked(true);}var oldValue=old?old.getValue():null;var newValue=value?value.getValue():null;if(oldValue!=newValue){this.fireNonBubblingEvent("changeValue",qx.event.type.Data,[newValue,oldValue]);}},_applyEnabled:function(value,old){var items=this.__items;if(value==null){for(var i=0,l=items.length;i<l;i++){items[i].resetEnabled();}}else{for(var i=0,l=items.length;i<l;i++){items[i].setEnabled(true);}}},_applyName:function(value,old){var items=this.__items;if(value==null){for(var i=0,l=items.length;i<l;i++){items[i].resetName();}}else{for(var i=0,l=items.length;i<l;i++){items[i].setName(value);}}},selectNext:function(){var item=this.getSelected();var items=this.__items;var index=items.indexOf(item);if(index==-1){return;}var i=0;var length=items.length;if(this.getWrap()){index=(index+1)%length;}else{index=Math.min(index+1,length-1);}while(i<length&&!items[index].getEnabled()){index=(index+1)%length;i++;}this.setSelected(items[index]);},selectPrevious:function(){var item=this.getSelected();var items=this.__items;var index=items.indexOf(item);if(index==-1){return;}var i=0;var length=items.length;if(this.getWrap()){index=(index-1+length)%length;}else{index=Math.max(index-1,0);}while(i<length&&!items[index].getEnabled()){index=(index-1+length)%length;i++;}this.setSelected(items[index]);}},destruct:function(){this._disposeArray("__items");}});qx.Class.define("qx.ui.form.SelectBox",{extend:qx.ui.form.AbstractSelectBox,implement:qx.ui.form.IFormElement,construct:function(){this.base(arguments);this._createChildControl("atom");this._createChildControl("spacer");this._createChildControl("arrow");this.addListener("click",this._onClick,this);this.addListener("mousewheel",this._onMouseWheel,this);this.addListener("keyinput",this._onKeyInput,this);},properties:{appearance:{refine:true,init:"selectbox"},selected:{check:"qx.ui.form.ListItem",apply:"_applySelected"}},members:{__preSelectedItem:null,_createChildControlImpl:function(id){var control;switch(id){case "spacer":control=new qx.ui.core.Spacer();this._add(control,{flex:1});break;case "atom":control=new qx.ui.basic.Atom(" ");control.setCenter(false);this._add(control,{flex:1});break;case "arrow":control=new qx.ui.basic.Image();this._add(control);break;}return control||this.base(arguments,id);},_forwardStates:{focused:true},_applySelected:function(value,old){var list=this._getChildControl("list");if(list.getSelectedItem()!=value){list.select(value);}var atom=this._getChildControl("atom");var label=value.getLabel();label==null?atom.resetLabel():atom.setLabel(label);var icon=value.getIcon();icon==null?atom.resetIcon():atom.setIcon(icon);if(this.hasListener("changeValue")){this.fireDataEvent("changeValue",list.getValue());}},setValue:function(value){this._getChildControl("list").setValue(value);},getValue:function(){var item=this.getSelected();return item?item.getFormValue():null;},_onClick:function(e){this.toggle();},_onMouseWheel:function(e){if(this._getChildControl("popup").isVisible()){return;}var direction=e.getWheelDelta()>0?1:-1;var children=this.getChildren();var selected=this.getSelected();if(!selected){selected=children[0];}var index=children.indexOf(selected)+direction;var max=children.length-1;if(index<0){index=0;}else if(index>=max){index=max;}this.setSelected(children[index]);},_onKeyPress:function(e){var iden=e.getKeyIdentifier();if(iden=="Enter"||iden=="Space"){if(this.__preSelectedItem){this.setSelected(this.__preSelectedItem);this.__preSelectedItem=null;}this.toggle();}else{this.base(arguments,e);}},_onKeyInput:function(e){var clone=e.clone();clone.setTarget(this._list);clone.setBubbles(false);this._getChildControl("list").dispatchEvent(clone);},_onListMouseDown:function(e){if(this.__preSelectedItem){this.setSelected(this.__preSelectedItem);this.__preSelectedItem=null;}},_onListChangeSelection:function(e){var current=e.getData();if(current.length>0){var popup=this._getChildControl("popup");var list=this._getChildControl("list");var context=list.getSelectionContext();if(popup.isVisible()&&(context=="quick"||context=="key")){this.__preSelectedItem=current[0];}else{this.setSelected(current[0]);this.__preSelectedItem=null;}}},_onPopupChangeVisibility:function(e){var popup=this._getChildControl("popup");if(!popup.isVisible()){var list=this._getChildControl("list");list.select(this.getSelected());}}},destruct:function(){this._disposeFields("__preSelectedItem");}});qx.Class.define("qx.ui.form.Spinner",{extend:qx.ui.core.Widget,implement:qx.ui.form.IFormElement,include:[qx.ui.core.MContentPadding],construct:function(min,value,max){this.base(arguments);var layout=new qx.ui.layout.Grid();layout.setColumnFlex(0,1);layout.setRowFlex(0,1);layout.setRowFlex(1,1);this._setLayout(layout);this.addListener("keydown",this._onKeyDown,this);this.addListener("keyup",this._onKeyUp,this);this.addListener("mousewheel",this._onMouseWheel,this);this._createChildControl("textfield");this._createChildControl("upbutton");this._createChildControl("downbutton");if(min!=null){this.setMin(min);}if(max!=null){this.setMax(max);}if(value!=null){this.setValue(value);}else{this.initValue();}},properties:{appearance:{refine:true,init:"spinner"},focusable:{refine:true,init:true},singleStep:{check:"Number",init:1},pageStep:{check:"Number",init:10},min:{check:"Number",apply:"_applyMin",init:0},name:{check:"String",nullable:true,event:"changeName"},value:{check:"typeof value==='number'&&value>=this.getMin()&&value<=this.getMax()",apply:"_applyValue",init:0,event:"changeValue"},max:{check:"Number",apply:"_applyMax",init:100},wrap:{check:"Boolean",init:false,apply:"_applyWrap"},editable:{check:"Boolean",init:true,apply:"_applyEditable"},numberFormat:{check:"qx.util.format.NumberFormat",apply:"_applyNumberFormat",nullable:true},allowShrinkY:{refine:true,init:false}},members:{__lastValidValue:null,__pageUpMode:null,__pageDownMode:null,_createChildControlImpl:function(id){var control;switch(id){case "textfield":control=new qx.ui.form.TextField();control.addState("inner");control.setWidth(40);control.setFocusable(false);control.addListener("changeValue",this._onTextChange,this);this._add(control,{column:0,row:0,rowSpan:2});break;case "upbutton":control=new qx.ui.form.RepeatButton();control.addState("inner");control.setFocusable(false);control.addListener("execute",this.__countUp,this);this._add(control,{column:1,row:0});break;case "downbutton":control=new qx.ui.form.RepeatButton();control.addState("inner");control.setFocusable(false);control.addListener("execute",this.__countDown,this);this._add(control,{column:1,row:1});break;}return control||this.base(arguments,id);},_forwardStates:{focused:true},tabFocus:function(){var field=this._getChildControl("textfield");field.getFocusElement().focus();field.selectAll();},_applyMin:function(value,old){this.setMax(Math.max(this.getMax(),value));this.setValue(Math.max(this.getValue(),value));},_applyMax:function(value,old){this.setMin(Math.min(this.getMin(),value));this.setValue(Math.min(this.getValue(),value));},_applyValue:function(value,old){var upButton=this._getChildControl("upbutton");var downButton=this._getChildControl("downbutton");var textField=this._getChildControl("textfield");if(value<this.getMax()){if(this.getEnabled()){upButton.resetEnabled();}}else{if(!this.getWrap()){upButton.setEnabled(false);}}if(value>this.getMin()){if(this.getEnabled()){downButton.resetEnabled();}}else{if(!this.getWrap()){downButton.setEnabled(false);}}this.__lastValidValue=value;if(this.getNumberFormat()){textField.setValue(this.getNumberFormat().format(value));}else{textField.setValue(value+"");}},_applyEditable:function(value,old){var textField=this._getChildControl("textfield");if(textField){textField.setReadOnly(!value);}},_applyWrap:function(value,old){if(value){var upButton=this._getChildControl("upbutton");var downButton=this._getChildControl("downbutton");if(this.getEnabled()){upButton.setEnabled(true);downButton.setEnabled(true);}}},_applyNumberFormat:function(value,old){this._getChildControl("textfield").setValue(this.getNumberFormat().format(this.__lastValidValue));},_getContentPaddingTarget:function(){return this._getChildControl("textfield");},_onKeyDown:function(e){switch(e.getKeyIdentifier()){case "PageUp":this.__pageUpMode=true;case "Up":this._getChildControl("upbutton").press();break;case "PageDown":this.__pageDownMode=true;case "Down":this._getChildControl("downbutton").press();break;default:return ;}e.stopPropagation();e.preventDefault();},_onKeyUp:function(e){switch(e.getKeyIdentifier()){case "PageUp":this._getChildControl("upbutton").release();this.__pageUpMode=false;break;case "Up":this._getChildControl("upbutton").release();break;case "PageDown":this._getChildControl("downbutton").release();this.__pageDownMode=false;break;case "Down":this._getChildControl("downbutton").release();break;}},_onMouseWheel:function(e){if(e.getWheelDelta()>0){this.__countDown();}else{this.__countUp();}e.stopPropagation();},_onTextChange:function(e){var textField=this._getChildControl("textfield");if(this.getNumberFormat()){try{var value=this.getNumberFormat().parse(textField.getValue());this.gotoValue(value);return;}catch(e){}}var value=parseFloat(textField.getValue(),10);if(!isNaN(value)){if(value>this.getMax()){value=this.getMax();}else if(value<this.getMin()){value=this.getMin();}if(value==this.getValue()){textField.setValue(value+"");}else{this.setValue(value);}}else{textField.setValue(this.__lastValidValue+"");}},__countUp:function(){if(this.__pageUpMode){var newValue=this.getValue()+this.getPageStep();}else{var newValue=this.getValue()+this.getSingleStep();}if(this.getWrap()){if(newValue>this.getMax()){var diff=this.getMax()-newValue;newValue=this.getMin()+diff;}}this.gotoValue(newValue);},__countDown:function(){if(this.__pageDownMode){var newValue=this.getValue()-this.getPageStep();}else{var newValue=this.getValue()-this.getSingleStep();}if(this.getWrap()){if(newValue<this.getMin()){var diff=this.getMin()+newValue;newValue=this.getMax()-diff;}}this.gotoValue(newValue);},gotoValue:function(value){return this.setValue(Math.min(this.getMax(),Math.max(this.getMin(),value)));}}});qx.Class.define("qx.ui.form.SplitButton",{extend:qx.ui.core.Widget,include:qx.ui.core.MExecutable,implement:qx.ui.form.IFormElement,construct:function(label,icon,menu,command){this.base(arguments);this._setLayout(new qx.ui.layout.HBox);this._createChildControl("arrow");this.addListener("mouseover",this._onMouseOver,this,true);this.addListener("mouseout",this._onMouseOut,this,true);this.addListener("keydown",this._onKeyDown);this.addListener("keyup",this._onKeyUp);if(label!=null){this.setLabel(label);}if(icon!=null){this.setIcon(icon);}if(menu!=null){this.setMenu(menu);}if(command!=null){this.setCommand(null);}},properties:{appearance:{refine:true,init:"splitbutton"},name:{check:"String",nullable:true,event:"changeName"},value:{check:"String",nullable:true,event:"changeValue"},focusable:{refine:true,init:true},label:{apply:"_applyLabel",nullable:true,dispose:true,check:"String"},icon:{check:"String",apply:"_applyIcon",nullable:true,themeable:true},show:{init:"both",check:["both","label","icon"],themeable:true,inheritable:true,apply:"_applyShow",event:"changeShow"},menu:{check:"qx.ui.menu.Menu",nullable:true,apply:"_applyMenu",event:"changeMenu"}},members:{__cursorIsOut:null,_createChildControlImpl:function(id){var control;switch(id){case "button":control=new qx.ui.form.Button;control.addListener("execute",this._onButtonExecute,this);control.setFocusable(false);this._addAt(control,0);break;case "arrow":control=new qx.ui.form.MenuButton;control.setFocusable(false);this._addAt(control,1);break;}return control||this.base(arguments,id);},_forwardStates:{hovered:1,focused:1},_applyLabel:function(value,old){var button=this._getChildControl("button");value==null?button.resetLabel():button.setLabel(value);},_applyIcon:function(value,old){var button=this._getChildControl("button");value==null?button.resetIcon():button.setIcon(value);},_applyMenu:function(value,old){var arrow=this._getChildControl("arrow");arrow.setEnabled(!!value);if(value){arrow.setEnabled(true);arrow.setMenu(value);value.setOpener(this);value.addListener("changeVisibility",this._onChangeMenuVisibility,this);}else{arrow.setEnabled(false);arrow.resetMenu();}if(old){old.removeListener("changeVisibility",this._onChangeMenuVisibility,this);old.resetOpener();}},_applyShow:function(value,old){},_onMouseOver:function(e){e.stopPropagation();this.addState("hovered");delete this.__cursorIsOut;},_onMouseOut:function(e){e.stopPropagation();if(!this.hasState("hovered")){return;}var related=e.getRelatedTarget();if(qx.ui.core.Widget.contains(this,related)){return;}var menu=this.getMenu();if(menu&&menu.isVisible()){this.__cursorIsOut=true;return;}this.removeState("hovered");},_onKeyDown:function(e){var button=this._getChildControl("button");switch(e.getKeyIdentifier()){case "Enter":case "Space":button.removeState("abandoned");button.addState("pressed");}},_onKeyUp:function(e){var button=this._getChildControl("button");switch(e.getKeyIdentifier()){case "Enter":case "Space":if(button.hasState("pressed")){button.removeState("abandoned");button.removeState("pressed");button.execute();}}},_onButtonExecute:function(e){this.execute();},_onChangeMenuVisibility:function(e){if(!this.getMenu().isVisible()&&this.__cursorIsOut){this.removeState("hovered");}}}});qx.Class.define("qx.ui.form.TextArea",{extend:qx.ui.form.AbstractField,construct:function(value){this.base(arguments,value);this.initWrap();},properties:{wrap:{check:"Boolean",init:true,apply:"_applyWrap"},appearance:{refine:true,init:"textarea"}},members:{_createInputElement:function(){var input=new qx.html.Input("textarea");input.setStyle("overflow","hidden");return input;},_applyWrap:function(value,old){this.getContentElement().setWrap(value);},_getContentHint:function(){var hint=this.base(arguments);hint.height=hint.height*4;hint.width=this._textSize.width*20;return hint;}}});qx.Class.define("qx.ui.container.Resizer",{extend:qx.ui.container.Composite,include:qx.ui.core.MResizable,properties:{appearance:{refine:true,init:"resizer"}}});qx.Class.define("qx.ui.container.Scroll",{extend:qx.ui.core.AbstractScrollArea,include:[qx.ui.core.MContentPadding],construct:function(content){this.base(arguments);if(content){this.add(content);}},members:{add:function(widget){this._getChildControl("pane").add(widget);},remove:function(widget){this._getChildControl("pane").remove(widget);},getChild:function(){return this._getChildControl("pane").getChild();},_getContentPaddingTarget:function(){return this._getChildControl("pane");}}});qx.Class.define("qx.ui.container.SlideBar",{extend:qx.ui.core.Widget,include:[qx.ui.core.MRemoteChildrenHandling,qx.ui.core.MRemoteLayoutHandling],construct:function(orientation){this.base(arguments);var scrollPane=this._getChildControl("scrollpane");if(orientation!=null){this.setOrientation(orientation);}else{this.initOrientation();}this._add(scrollPane,{flex:1});},properties:{appearance:{refine:true,init:"slidebar"},orientation:{check:["horizontal","vertical"],init:"horizontal",apply:"_applyOrientation"}},members:{__isHorizontal:null,getChildrenContainer:function(){return this._getChildControl("content");},_createChildControlImpl:function(id){var control;switch(id){case "button-forward":control=new qx.ui.form.RepeatButton;control.addListener("execute",this._onExecuteForward,this);control.setFocusable(false);this._add(control);break;case "button-backward":control=new qx.ui.form.RepeatButton;control.addListener("execute",this._onExecuteBackward,this);control.setFocusable(false);this._addAt(control,0);break;case "content":control=new qx.ui.container.Composite();this._getChildControl("scrollpane").add(control);break;case "scrollpane":control=new qx.ui.core.ScrollPane();control.addListener("update",this._onResize,this);break;}return control||this.base(arguments,id);},_forwardStates:{barLeft:true,barTop:true,barRight:true,barBottom:true},scrollBy:function(offset){var pane=this._getChildControl("scrollpane");if(this.__isHorizontal){pane.scrollByX(offset);}else{pane.scrollByY(offset);}},scrollTo:function(value){var pane=this._getChildControl("scrollpane");if(this.__isHorizontal){pane.scrollToX(value);}else{pane.scrollToY(value);}},_applyOrientation:function(value,old){if(value=="horizontal"){this._setLayout(new qx.ui.layout.HBox());this.setLayout(new qx.ui.layout.HBox());this.__isHorizontal=true;}else{this._setLayout(new qx.ui.layout.VBox());this.setLayout(new qx.ui.layout.VBox());this.__isHorizontal=false;}},_onResize:function(e){var content=this._getChildControl("scrollpane").getChild();if(!content){return;}var innerSize=this.getInnerSize();var contentSize=content.getBounds();var overflow=this.__isHorizontal?contentSize.width>innerSize.width:contentSize.height>innerSize.height;overflow?this._showArrows():this._hideArrows();},_onExecuteBackward:function(){this.scrollBy(-20);},_onExecuteForward:function(){this.scrollBy(20);},_showArrows:function(){this._showChildControl("button-forward");this._showChildControl("button-backward");},_hideArrows:function(){this._excludeChildControl("button-forward");this._excludeChildControl("button-backward");this.scrollTo(0);}}});qx.Class.define("qx.ui.container.Stack",{extend:qx.ui.core.Widget,construct:function(){this.base(arguments);this._setLayout(new qx.ui.layout.Grow);},properties:{dynamic:{check:"Boolean",init:false,apply:"_applyDynamic"},selected:{check:"qx.ui.core.Widget",apply:"_applySelected",event:"change",nullable:true}},members:{_applyDynamic:function(value){var children=this._getChildren();var selected=this.getSelected();var child;for(var i=0,l=children.length;i<l;i++){child=children[i];if(child!=selected){if(value){children[i].exclude();}else{children[i].hide();}}}},_applySelected:function(value,old){if(old){if(this.isDynamic()){old.exclude();}else{old.hide();}}if(value){value.show();}},add:function(widget){this._add(widget);var selected=this.getSelected();if(!selected){this.setSelected(widget);}else if(selected!==widget){if(this.isDynamic()){widget.exclude();}else{widget.hide();}}},remove:function(widget){this._remove(widget);if(this.getSelected()===widget){var first=this._getChildren()[0];if(first){this.setSelected(first);}else{this.resetSelected();}}},indexOf:function(widget){return this._indexOf(widget);},getChildren:function(){return this._getChildren();},previous:function(){var selected=this.getSelected();var go=this._indexOf(selected)-1;var children=this._getChildren();if(go<0){go=children.length-1;}var prev=children[go];this.setSelected(prev);},next:function(){var selected=this.getSelected();var go=this._indexOf(selected)+1;var children=this._getChildren();var next=children[go]||children[0];this.setSelected(next);}}});qx.Class.define("qx.ui.control.ColorSelector",{extend:qx.ui.core.Widget,construct:function(){this.base(arguments);this._setLayout(new qx.ui.layout.VBox());this._createChildControl("control-bar");},events:{"dialogok":"qx.event.type.Event","dialogcancel":"qx.event.type.Event"},properties:{appearance:{refine:true,init:"colorselector"},red:{check:"Integer",init:255,apply:"_applyRed"},green:{check:"Integer",init:255,apply:"_applyGreen"},blue:{check:"Integer",init:255,apply:"_applyBlue"},hue:{check:"Number",init:0,apply:"_applyHue"},saturation:{check:"Number",init:0,apply:"_applySaturation"},brightness:{check:"Number",init:100,apply:"_applyBrightness"}},members:{__updateContext:null,__presetTable:["maroon","red","orange","yellow","olive","purple","fuchsia","lime","green","navy","blue","aqua","teal","black","#333","#666","#999","#BBB","#EEE","white"],__capture:"",__brightnessSubtract:0,__hueSaturationSubtractTop:0,__hueSaturationSubtractLeft:0,_createChildControlImpl:function(id){var control;switch(id){case "control-bar":control=new qx.ui.container.Composite(new qx.ui.layout.HBox(10));control.add(this._getChildControl("control-pane"));control.add(this._getChildControl("visual-pane"));this._add(control);break;case "visual-pane":control=new qx.ui.groupbox.GroupBox(this.tr("Visual"));control.setLayout(new qx.ui.layout.HBox(10));control.add(this._getChildControl("hue-saturation-pane"));control.add(this._getChildControl("brightness-pane"));break;case "control-pane":control=new qx.ui.container.Composite(new qx.ui.layout.VBox(12));control.add(this._getChildControl("preset-field-set"));control.add(this._getChildControl("input-field-set"));control.add(this._getChildControl("preview-field-set"),{flex:1});break;case "hue-saturation-pane":control=new qx.ui.container.Composite(new qx.ui.layout.Canvas());control.setAllowGrowY(false);control.addListener("mouseup",this._onHueSaturationPaneMouseWheel,this);control.add(this._getChildControl("hue-saturation-field"));control.add(this._getChildControl("hue-saturation-handle"),{left:0,top:256});break;case "hue-saturation-field":control=new qx.ui.basic.Image("decoration/colorselector/huesaturation-field.jpg");control.addListener("mousedown",this._onHueSaturationFieldMouseDown,this);break;case "hue-saturation-handle":control=new qx.ui.basic.Image("decoration/colorselector/huesaturation-handle.gif");control.addListener("mousedown",this._onHueSaturationHandleMouseDown,this);control.addListener("mouseup",this._onHueSaturationHandleMouseUp,this);control.addListener("mousemove",this._onHueSaturationHandleMouseMove,this);break;case "brightness-pane":control=new qx.ui.container.Composite(new qx.ui.layout.Canvas());control.setAllowGrowY(false);control.addListener("mousewheel",this._onBrightnessPaneMouseWheel,this);control.add(this._getChildControl("brightness-field"));control.add(this._getChildControl("brightness-handle"));break;case "brightness-field":control=new qx.ui.basic.Image("decoration/colorselector/brightness-field.png");control.addListener("mousedown",this._onBrightnessFieldMouseDown,this);break;case "brightness-handle":control=new qx.ui.basic.Image("decoration/colorselector/brightness-handle.gif");control.addListener("mousedown",this._onBrightnessHandleMouseDown,this);control.addListener("mouseup",this._onBrightnessHandleMouseUp,this);control.addListener("mousemove",this._onBrightnessHandleMouseMove,this);break;case "preset-field-set":control=new qx.ui.groupbox.GroupBox(this.tr("Presets"));control.setLayout(new qx.ui.layout.Grow());control.add(this._getChildControl("preset-grid"));break;case "preset-grid":controlLayout=new qx.ui.layout.Grid(3,3);control=new qx.ui.container.Composite(controlLayout);var colorField;for(var i=0;i<2;i++){for(var j=0;j<10;j++){colorField=new qx.ui.core.Widget();colorField.setAppearance("colorselector-colorbucket");colorField.setBackgroundColor(this.__presetTable[i*10+j]);colorField.addListener("mousedown",this._onColorFieldClick,this);control.add(colorField,{column:j,row:i});}}break;case "input-field-set":control=new qx.ui.groupbox.GroupBox(this.tr("Details"));var controlLayout=new qx.ui.layout.VBox();controlLayout.setSpacing(10);control.setLayout(controlLayout);control.add(this._getChildControl("hex-field-composite"));control.add(this._getChildControl("rgb-spinner-composite"));control.add(this._getChildControl("hsb-spinner-composite"));break;case "preview-field-set":control=new qx.ui.groupbox.GroupBox(this.tr("Preview (Old/New)"));var controlLayout=new qx.ui.layout.HBox(10);control.setLayout(controlLayout);control.add(this._getChildControl("preview-content-old"),{flex:1});control.add(this._getChildControl("preview-content-new"),{flex:1});break;case "hex-field-composite":var layout=new qx.ui.layout.HBox(4);layout.setAlignY("middle");control=new qx.ui.container.Composite(layout);var hexLabel=new qx.ui.basic.Label(this.tr("Hex"));control.add(hexLabel);var hexHelper=new qx.ui.basic.Label("#");control.add(hexHelper);control.add(this._getChildControl("hex-field"));break;case "hex-field":control=new qx.ui.form.TextField("FFFFFF");control.setWidth(55);control.addListener("changeValue",this._onHexFieldChange,this);break;case "rgb-spinner-composite":var layout=new qx.ui.layout.HBox(4);layout.setAlignY("middle");control=new qx.ui.container.Composite(layout);var rgbSpinLabel=new qx.ui.basic.Label(this.tr("RGB"));rgbSpinLabel.setWidth(25);control.add(rgbSpinLabel);control.add(this._getChildControl("rgb-spinner-red"));control.add(this._getChildControl("rgb-spinner-green"));control.add(this._getChildControl("rgb-spinner-blue"));break;case "rgb-spinner-red":control=new qx.ui.form.Spinner(0,255,255);control.setWidth(50);control.addListener("changeValue",this._setRedFromSpinner,this);break;case "rgb-spinner-green":control=new qx.ui.form.Spinner(0,255,255);control.setWidth(50);control.addListener("changeValue",this._setGreenFromSpinner,this);break;case "rgb-spinner-blue":control=new qx.ui.form.Spinner(0,255,255);control.setWidth(50);control.addListener("changeValue",this._setBlueFromSpinner,this);break;case "hsb-spinner-composite":var layout=new qx.ui.layout.HBox(4);layout.setAlignY("middle");control=new qx.ui.container.Composite(layout);var hsbSpinLabel=new qx.ui.basic.Label(this.tr("HSB"));hsbSpinLabel.setWidth(25);control.add(hsbSpinLabel);control.add(this._getChildControl("hsb-spinner-hue"));control.add(this._getChildControl("hsb-spinner-saturation"));control.add(this._getChildControl("hsb-spinner-brightness"));break;case "hsb-spinner-hue":control=new qx.ui.form.Spinner(0,0,360);control.setWidth(50);control.addListener("changeValue",this._setHueFromSpinner,this);break;case "hsb-spinner-saturation":control=new qx.ui.form.Spinner(0,0,100);control.setWidth(50);control.addListener("changeValue",this._setSaturationFromSpinner,this);break;case "hsb-spinner-brightness":control=new qx.ui.form.Spinner(0,100,100);control.setWidth(50);control.addListener("changeValue",this._setBrightnessFromSpinner,this);break;case "preview-content-old":control=new qx.ui.core.Widget();break;case "preview-content-new":control=new qx.ui.core.Widget();break;}return control||this.base(arguments,id);},_applyRed:function(value,old){if(this.__updateContext===null){this.__updateContext="redModifier";}if(this.__updateContext!=="rgbSpinner"){this._getChildControl("rgb-spinner-red").setValue(value);}if(this.__updateContext!=="hexField"){this._setHexFromRgb();}switch(this.__updateContext){case "rgbSpinner":case "hexField":case "redModifier":this._setHueFromRgb();}this._setPreviewFromRgb();if(this.__updateContext==="redModifier"){this.__updateContext=null;}},_applyGreen:function(value,old){if(this.__updateContext===null){this.__updateContext="greenModifier";}if(this.__updateContext!=="rgbSpinner"){this._getChildControl("rgb-spinner-green").setValue(value);}if(this.__updateContext!=="hexField"){this._setHexFromRgb();}switch(this.__updateContext){case "rgbSpinner":case "hexField":case "greenModifier":this._setHueFromRgb();}this._setPreviewFromRgb();if(this.__updateContext==="greenModifier"){this.__updateContext=null;}},_applyBlue:function(value,old){if(this.__updateContext===null){this.__updateContext="blueModifier";}if(this.__updateContext!=="rgbSpinner"){this._getChildControl("rgb-spinner-blue").setValue(value);}if(this.__updateContext!=="hexField"){this._setHexFromRgb();}switch(this.__updateContext){case "rgbSpinner":case "hexField":case "blueModifier":this._setHueFromRgb();}this._setPreviewFromRgb();if(this.__updateContext==="blueModifier"){this.__updateContext=null;}},_applyHue:function(value,old){if(this.__updateContext===null){this.__updateContext="hueModifier";}if(this.__updateContext!=="hsbSpinner"){this._getChildControl("hsb-spinner-hue").setValue(value);}if(this.__updateContext!=="hueSaturationField"){if(this._getChildControl("hue-saturation-handle").getBounds()){this._getChildControl("hue-saturation-handle").setDomLeft(Math.round(value/1.40625)+this._getChildControl("hue-saturation-pane").getPaddingLeft());}else{this._getChildControl("hue-saturation-handle").setLayoutProperties({left:Math.round(value/1.40625)});}}switch(this.__updateContext){case "hsbSpinner":case "hueSaturationField":case "hueModifier":this._setRgbFromHue();}if(this.__updateContext==="hueModifier"){this.__updateContext=null;}},_applySaturation:function(value,old){if(this.__updateContext===null){this.__updateContext="saturationModifier";}if(this.__updateContext!=="hsbSpinner"){this._getChildControl("hsb-spinner-saturation").setValue(value);}if(this.__updateContext!=="hueSaturationField"){if(this._getChildControl("hue-saturation-handle").getBounds()){this._getChildControl("hue-saturation-handle").setDomTop(256-Math.round(value*2.56)+this._getChildControl("hue-saturation-pane").getPaddingTop());}else{this._getChildControl("hue-saturation-handle").setLayoutProperties({top:256-Math.round(value*2.56)});}}switch(this.__updateContext){case "hsbSpinner":case "hueSaturationField":case "saturationModifier":this._setRgbFromHue();}if(this.__updateContext==="saturationModifier"){this.__updateContext=null;}},_applyBrightness:function(value,old){if(this.__updateContext===null){this.__updateContext="brightnessModifier";}if(this.__updateContext!=="hsbSpinner"){this._getChildControl("hsb-spinner-brightness").setValue(value);}if(this.__updateContext!=="brightnessField"){var topValue=256-Math.round(value*2.56);if(this._getChildControl("brightness-handle").getBounds()){this._getChildControl("brightness-handle").setDomTop(topValue+this._getChildControl("brightness-pane").getPaddingTop());}else{this._getChildControl("brightness-handle").setLayoutProperties({top:topValue});}}switch(this.__updateContext){case "hsbSpinner":case "brightnessField":case "brightnessModifier":this._setRgbFromHue();}if(this.__updateContext==="brightnessModifier"){this.__updateContext=null;}},_onBrightnessHandleMouseDown:function(e){this._getChildControl("brightness-handle").capture();this.__capture="brightness-handle";var locationBrightnessField=this._getChildControl("brightness-field").getContainerLocation();var locationBrightnessHandle=this._getChildControl("brightness-handle").getContainerLocation();var fieldBounds=this._getChildControl("brightness-field").getBounds();this.__brightnessSubtract=locationBrightnessField.top+(e.getDocumentTop()-locationBrightnessHandle.top)-fieldBounds.top;e.stopPropagation();},_onBrightnessHandleMouseUp:function(e){this._getChildControl("brightness-handle").releaseCapture();this.__capture=null;},_onBrightnessHandleMouseMove:function(e){if(this.__capture==="brightness-handle"){this._setBrightnessOnFieldEvent(e);}},_onBrightnessFieldMouseDown:function(e){var location=this._getChildControl("brightness-field").getContainerLocation();var bounds=this._getChildControl("brightness-handle").getBounds();this.__brightnessSubtract=location.top+(bounds.height/2);this._setBrightnessOnFieldEvent(e);this._getChildControl("brightness-handle").capture();this.__capture="brightness-handle";},_onBrightnessPaneMouseWheel:function(e){this.setBrightness(qx.lang.Number.limit(this.getBrightness()+e.getWheelDelta(),0,100));},_setBrightnessOnFieldEvent:function(e){var value=qx.lang.Number.limit(e.getDocumentTop()-this.__brightnessSubtract,0,256);this.__updateContext="brightnessField";if(this._getChildControl("brightness-handle").getBounds()){this._getChildControl("brightness-handle").setDomTop(value);}else{this._getChildControl("brightness-handle").setLayoutProperties({top:value});}this.setBrightness(100-Math.round(value/2.56));this.__updateContext=null;},_onHueSaturationHandleMouseDown:function(e){this._getChildControl("hue-saturation-handle").capture();this.__capture="hue-saturation-handle";e.stopPropagation();},_onHueSaturationHandleMouseUp:function(e){this._getChildControl("hue-saturation-handle").releaseCapture();this.__capture=null;},_onHueSaturationHandleMouseMove:function(e){if(this.__capture==="hue-saturation-handle"){this._setHueSaturationOnFieldEvent(e);}},_onHueSaturationFieldMouseDown:function(e){var location=this._getChildControl("hue-saturation-field").getContainerLocation();var handleBounds=this._getChildControl("hue-saturation-handle").getBounds();var fieldBounds=this._getChildControl("hue-saturation-field").getBounds();this.__hueSaturationSubtractTop=location.top+(handleBounds.height/2)-fieldBounds.top;this.__hueSaturationSubtractLeft=location.left+(handleBounds.width/2)-fieldBounds.left;this._setHueSaturationOnFieldEvent(e);this._getChildControl("hue-saturation-handle").capture();this.__capture="hue-saturation-handle";},_onHueSaturationPaneMouseWheel:function(e){this.setSaturation(qx.lang.Number.limit(this.getSaturation()+e.getWheelDelta(),0,100));},_setHueSaturationOnFieldEvent:function(e){var vTop=qx.lang.Number.limit(e.getDocumentTop()-this.__hueSaturationSubtractTop,0,256);var vLeft=qx.lang.Number.limit(e.getDocumentLeft()-this.__hueSaturationSubtractLeft,0,256);if(this._getChildControl("hue-saturation-handle").getBounds()){this._getChildControl("hue-saturation-handle").setDomPosition(vLeft,vTop);}else{this._getChildControl("hue-saturation-handle").setLayoutProperties({top:vTop,left:vLeft});}this.__updateContext="hueSaturationField";this.setSaturation(100-Math.round(vTop/2.56));this.setHue(Math.round(vLeft*1.40625));this.__updateContext=null;},_setRedFromSpinner:function(){if(this.__updateContext!==null){return;}this.__updateContext="rgbSpinner";this.setRed(this._getChildControl("rgb-spinner-red").getValue());this.__updateContext=null;},_setGreenFromSpinner:function(){if(this.__updateContext!==null){return;}this.__updateContext="rgbSpinner";this.setGreen(this._getChildControl("rgb-spinner-green").getValue());this.__updateContext=null;},_setBlueFromSpinner:function(){if(this.__updateContext!==null){return;}this.__updateContext="rgbSpinner";this.setBlue(this._getChildControl("rgb-spinner-blue").getValue());this.__updateContext=null;},_setHueFromSpinner:function(){if(this.__updateContext!==null){return;}this.__updateContext="hsbSpinner";this.setHue(this._getChildControl("hsb-spinner-hue").getValue());this.__updateContext=null;},_setSaturationFromSpinner:function(){if(this.__updateContext!==null){return;}this.__updateContext="hsbSpinner";this.setSaturation(this._getChildControl("hsb-spinner-saturation").getValue());this.__updateContext=null;},_setBrightnessFromSpinner:function(){if(this.__updateContext!==null){return;}this.__updateContext="hsbSpinner";this.setBrightness(this._getChildControl("hsb-spinner-brightness").getValue());this.__updateContext=null;},_onHexFieldChange:function(e){if(this.__updateContext!==null){return;}try{var rgb=qx.util.ColorUtil.hexStringToRgb("#"+this._hexField.getValue());}catch(ex){return;}this.__updateContext="hexField";this.setRed(rgb[0]);this.setGreen(rgb[1]);this.setBlue(rgb[2]);this.__updateContext=null;},_setHexFromRgb:function(){this._getChildControl("hex-field").setValue(qx.util.ColorUtil.rgbToHexString([this.getRed(),this.getGreen(),this.getBlue()]));},_onColorFieldClick:function(e){var vColor=e.getTarget().getBackgroundColor();if(!vColor){return this.error("Missing backgroundColor value for field: "+e.getTarget());}var rgb=qx.util.ColorUtil.stringToRgb(vColor);this.setRed(rgb[0]);this.setGreen(rgb[1]);this.setBlue(rgb[2]);},_setHueFromRgb:function(){switch(this.__updateContext){case "hsbSpinner":case "hueSaturationField":case "brightnessField":break;default:var hsb=qx.util.ColorUtil.rgbToHsb([this.getRed(),this.getGreen(),this.getBlue()]);this.setHue(hsb[0]);this.setSaturation(hsb[1]);this.setBrightness(hsb[2]);}},_setRgbFromHue:function(){switch(this.__updateContext){case "rgbSpinner":case "hexField":break;default:var vRgb=qx.util.ColorUtil.hsbToRgb([this.getHue(),this.getSaturation(),this.getBrightness()]);this.setRed(vRgb.red);this.setGreen(vRgb.green);this.setBlue(vRgb.blue);}},_setPreviewFromRgb:function(){var ColorUtil=qx.util.ColorUtil;var rgbString=ColorUtil.rgbToRgbString([this.getRed(),this.getGreen(),this.getBlue()]);this._getChildControl("preview-content-new").setBackgroundColor(rgbString);var helpRgb=ColorUtil.hsbToRgb([this.getHue(),this.getSaturation(),255]);var helpRgbString=ColorUtil.rgbToRgbString([helpRgb.red,helpRgb.green,helpRgb.blue]);this._getChildControl("brightness-field").setBackgroundColor(helpRgbString);},setPreviousColor:function(vRed,vGreen,vBlue){this._oldColorPreview.setBackgroundImage(null);this._oldColorPreview.setBackgroundColor(qx.util.ColorUtil.rgbToRgbString([vRed,vGreen,vBlue]));this.setRed(vRed);this.setGreen(vGreen);this.setBlue(vBlue);}}});qx.Class.define("qx.ui.groupbox.GroupBox",{extend:qx.ui.core.Widget,include:[qx.ui.core.MRemoteChildrenHandling,qx.ui.core.MRemoteLayoutHandling,qx.ui.core.MContentPadding],construct:function(legend,icon){this.base(arguments);this._setLayout(new qx.ui.layout.Canvas);this._createChildControl("frame");this._createChildControl("legend");if(legend!=null){this.setLegend(legend);}if(icon!=null){this.setIcon(icon);}},properties:{appearance:{refine:true,init:"groupbox"},legendPosition:{check:["top","middle"],init:"middle",apply:"_applyLegendPosition",themeable:true}},members:{_createChildControlImpl:function(id){var control;switch(id){case "frame":control=new qx.ui.container.Composite();this._add(control,{left:0,top:6,right:0,bottom:0});break;case "legend":control=new qx.ui.basic.Atom();control.addListener("resize",this._repositionFrame,this);this._add(control);break;}return control||this.base(arguments,id);},_getContentPaddingTarget:function(){return this._getChildControl("frame");},_applyLegendPosition:function(e){if(this._getChildControl("legend").getBounds()){this._repositionFrame();}},_repositionFrame:function(){var legend=this._getChildControl("legend");var frame=this._getChildControl("frame");var height=legend.getBounds().height;if(this.getLegendPosition()=="middle"){frame.setLayoutProperties({"top":Math.round(height/2)});}else if(this.getLegendPosition()=="top"){frame.setLayoutProperties({"top":height});}},getChildrenContainer:function(){return this._getChildControl("frame");},setLegend:function(legend){var control=this._getChildControl("legend");if(legend!==null){control.setLabel(legend);control.show();}else{control.exclude();}},getLegend:function(){return this._getChildControl("legend").getLabel();},setIcon:function(icon){this._getChildControl("legend").setIcon(icon);},getIcon:function(){this._getChildControl("legend").getIcon();}}});qx.Class.define("qx.ui.control.DateChooser",{extend:qx.ui.core.Widget,include:qx.ui.core.MExecutable,implement:qx.ui.form.IFormElement,construct:function(date){this.base(arguments);var layout=new qx.ui.layout.VBox();this._setLayout(layout);this._createChildControl("navigation-bar");this._createChildControl("date-pane");this.addListener("keypress",this._onKeyPress);var shownDate=(date!=null)?date:new Date();this.showMonth(shownDate.getMonth(),shownDate.getFullYear());if(qx.core.Variant.isSet("qx.dynamicLocaleSwitch","on")){qx.locale.Manager.getInstance().addListener("changeLocale",this._updateDatePane,this);}this.addListener("mousedown",this._onMouseUpDown,this);this.addListener("mouseup",this._onMouseUpDown,this);},statics:{MONTH_YEAR_FORMAT:qx.locale.Date.getDateTimeFormat("yyyyMMMM","MMMM yyyy")},events:{changeValue:"qx.event.type.Data"},properties:{appearance:{refine:true,init:"datechooser"},width:{refine:true,init:200},height:{refine:true,init:150},shownMonth:{check:"Integer",init:null,nullable:true,event:"changeShownMonth"},shownYear:{check:"Integer",init:null,nullable:true,event:"changeShownYear"},date:{check:"Date",init:null,nullable:true,apply:"_applyDate",event:"changeDate"},name:{check:"String",nullable:true,event:"changeName"}},members:{__weekdayLabelArr:null,__dayLabelArr:null,__weekLabelArr:null,setValue:function(value){{};this.setDate(new Date(value));return value;},getValue:function(){return this.getDate().toString();},_createChildControlImpl:function(id){var control;switch(id){case "navigation-bar":control=new qx.ui.container.Composite(new qx.ui.layout.HBox());control.add(this._getChildControl("last-year-button"));control.add(this._getChildControl("last-month-button"));control.add(this._getChildControl("month-year-label"),{flex:1});control.add(this._getChildControl("next-month-button"));control.add(this._getChildControl("next-year-button"));this._add(control);break;case "last-year-button-tooltip":control=new qx.ui.tooltip.ToolTip(this.tr("Last year"));break;case "last-year-button":control=new qx.ui.form.Button();control.addState("lastYear");control.setFocusable(false);control.setToolTip(this._getChildControl("last-year-button-tooltip"));control.addListener("click",this._onNavButtonClicked,this);break;case "last-month-button-tooltip":control=new qx.ui.tooltip.ToolTip(this.tr("Last month"));break;case "last-month-button":control=new qx.ui.toolbar.Button();control.addState("lastMonth");control.setFocusable(false);control.setToolTip(this._getChildControl("last-month-button-tooltip"));control.addListener("click",this._onNavButtonClicked,this);break;case "next-month-button-tooltip":control=new qx.ui.tooltip.ToolTip(this.tr("Next month"));break;case "next-month-button":control=new qx.ui.toolbar.Button();control.addState("nextMonth");control.setFocusable(false);control.setToolTip(this._getChildControl("next-month-button-tooltip"));control.addListener("click",this._onNavButtonClicked,this);break;case "next-year-button-tooltip":control=new qx.ui.tooltip.ToolTip(this.tr("Next year"));break;case "next-year-button":control=new qx.ui.toolbar.Button();control.addState("nextYear");control.setFocusable(false);control.setToolTip(this._getChildControl("next-year-button-tooltip"));control.addListener("click",this._onNavButtonClicked,this);break;case "month-year-label":control=new qx.ui.basic.Label();control.setAllowGrowX(true);control.setAnonymous(true);break;case "date-pane":var controlLayout=new qx.ui.layout.Grid();control=new qx.ui.container.Composite(controlLayout);for(var i=0;i<8;i++){controlLayout.setColumnFlex(i,1);}for(var i=0;i<7;i++){controlLayout.setRowFlex(i,1);}var label=new qx.ui.basic.Label();label.setAllowGrowX(true);label.setAppearance("datechooser-week");label.setAnonymous(true);label.addState("header");control.add(label,{column:0,row:0});this.__weekdayLabelArr=[];for(var i=0;i<7;i++){var label=new qx.ui.basic.Label();label.setAllowGrowX(true);label.setAllowGrowY(true);label.setAppearance("datechooser-weekday");label.setSelectable(false);label.setAnonymous(true);label.setCursor("default");control.add(label,{column:i+1,row:0});this.__weekdayLabelArr.push(label);}this.__dayLabelArr=[];this.__weekLabelArr=[];for(var y=0;y<6;y++){var label=new qx.ui.basic.Label();label.setAllowGrowX(true);label.setAllowGrowY(true);label.setAppearance("datechooser-week");label.setAnonymous(true);label.setCursor("default");control.add(label,{column:0,row:y+1});this.__weekLabelArr.push(label);for(var x=0;x<7;x++){var label=new qx.ui.basic.Label();label.setAllowGrowX(true);label.setAllowGrowY(true);label.setAppearance("datechooser-day");label.setCursor("default");label.addListener("mousedown",this._onDayClicked,this);label.addListener("dblclick",this._onDayDblClicked,this);control.add(label,{column:x+1,row:y+1});this.__dayLabelArr.push(label);}}this._add(control);break;}return control||this.base(arguments,id);},_applyDate:function(value,old){this.fireDataEvent("changeValue",value==null?"":value.toString());if((value!=null)&&(this.getShownMonth()!=value.getMonth()||this.getShownYear()!=value.getFullYear())){this.showMonth(value.getMonth(),value.getFullYear());}else{var newDay=(value==null)?-1:value.getDate();for(var i=0;i<6*7;i++){var dayLabel=this.__dayLabelArr[i];if(dayLabel.hasState("otherMonth")){if(dayLabel.hasState("selected")){dayLabel.removeState("selected");}}else{var day=parseInt(dayLabel.getContent());if(day==newDay){dayLabel.addState("selected");}else if(dayLabel.hasState("selected")){dayLabel.removeState("selected");}}}}},_onMouseUpDown:function(e){var target=e.getTarget();if(target==this._getChildControl("navigation-bar")||target==this._getChildControl("date-pane")){e.stopPropagation();return;}},_onNavButtonClicked:function(evt){var year=this.getShownYear();var month=this.getShownMonth();switch(evt.getCurrentTarget()){case this._getChildControl("last-year-button"):year--;break;case this._getChildControl("last-month-button"):month--;if(month<0){month=11;year--;}break;case this._getChildControl("next-month-button"):month++;if(month>=12){month=0;year++;}break;case this._getChildControl("next-year-button"):year++;break;}this.showMonth(month,year);},_onDayClicked:function(evt){var time=evt.getCurrentTarget().dateTime;this.setDate(new Date(time));},_onDayDblClicked:function(){this.execute();},_onKeyPress:function(evt){var dayIncrement=null;var monthIncrement=null;var yearIncrement=null;if(evt.getModifiers()==0){switch(evt.getKeyIdentifier()){case "Left":dayIncrement=-1;break;case "Right":dayIncrement=1;break;case "Up":dayIncrement=-7;break;case "Down":dayIncrement=7;break;case "PageUp":monthIncrement=-1;break;case "PageDown":monthIncrement=1;break;case "Escape":if(this.getDate()!=null){this.setDate(null);return true;}break;case "Enter":case "Space":if(this.getDate()!=null){this.execute();}return;}}else if(evt.isShiftPressed()){switch(evt.getKeyIdentifier()){case "PageUp":yearIncrement=-1;break;case "PageDown":yearIncrement=1;break;}}if(dayIncrement!=null||monthIncrement!=null||yearIncrement!=null){var date=this.getDate();if(date!=null){date=new Date(date.getTime());}if(date==null){date=new Date();}else{if(dayIncrement!=null){date.setDate(date.getDate()+dayIncrement);}if(monthIncrement!=null){date.setMonth(date.getMonth()+monthIncrement);}if(yearIncrement!=null){date.setFullYear(date.getFullYear()+yearIncrement);}}this.setDate(date);}},showMonth:function(month,year){if((month!=null&&month!=this.getShownMonth())||(year!=null&&year!=this.getShownYear())){if(month!=null){this.setShownMonth(month);}if(year!=null){this.setShownYear(year);}this._updateDatePane();}},handleKeyPress:function(e){this._onKeyPress(e);},_updateDatePane:function(){var DateChooser=qx.ui.control.DateChooser;var today=new Date();var todayYear=today.getFullYear();var todayMonth=today.getMonth();var todayDayOfMonth=today.getDate();var selDate=this.getDate();var selYear=(selDate==null)?-1:selDate.getFullYear();var selMonth=(selDate==null)?-1:selDate.getMonth();var selDayOfMonth=(selDate==null)?-1:selDate.getDate();var shownMonth=this.getShownMonth();var shownYear=this.getShownYear();var startOfWeek=qx.locale.Date.getWeekStart();var helpDate=new Date(this.getShownYear(),this.getShownMonth(),1);var monthYearFormat=new qx.util.format.DateFormat(DateChooser.MONTH_YEAR_FORMAT);this._getChildControl("month-year-label").setContent(monthYearFormat.format(helpDate));var firstDayOfWeek=helpDate.getDay();var firstSundayInMonth=(1+7-firstDayOfWeek)%7;var weekDayFormat=new qx.util.format.DateFormat("EE");for(var i=0;i<7;i++){var day=(i+startOfWeek)%7;var dayLabel=this.__weekdayLabelArr[i];helpDate.setDate(firstSundayInMonth+day);dayLabel.setContent(weekDayFormat.format(helpDate));if(qx.locale.Date.isWeekend(day)){dayLabel.addState("weekend");}else{dayLabel.removeState("weekend");}}helpDate=new Date(shownYear,shownMonth,1);var nrDaysOfLastMonth=(7+firstDayOfWeek-startOfWeek)%7;helpDate.setDate(helpDate.getDate()-nrDaysOfLastMonth);var weekFormat=new qx.util.format.DateFormat("ww");for(var week=0;week<6;week++){this.__weekLabelArr[week].setContent(weekFormat.format(helpDate));for(var i=0;i<7;i++){var dayLabel=this.__dayLabelArr[week*7+i];var year=helpDate.getFullYear();var month=helpDate.getMonth();var dayOfMonth=helpDate.getDate();var isSelectedDate=(selYear==year&&selMonth==month&&selDayOfMonth==dayOfMonth);if(isSelectedDate){dayLabel.addState("selected");}else{dayLabel.removeState("selected");}if(month!=shownMonth){dayLabel.addState("otherMonth");}else{dayLabel.removeState("otherMonth");}var isToday=(year==todayYear&&month==todayMonth&&dayOfMonth==todayDayOfMonth);if(isToday){dayLabel.addState("today");}else{dayLabel.removeState("today");}dayLabel.setContent(""+dayOfMonth);dayLabel.dateTime=helpDate.getTime();helpDate.setDate(helpDate.getDate()+1);}}monthYearFormat.dispose();weekDayFormat.dispose();weekFormat.dispose();}},destruct:function(){if(qx.core.Variant.isSet("qx.dynamicLocaleSwitch","on")){qx.locale.Manager.getInstance().removeListener("changeLocale",this._updateDatePane,this);}this._disposeArray("__weekdayLabelArr",1);this._disposeArray("__dayLabelArr",1);this._disposeArray("__weekLabelArr",1);}});qx.Class.define("qx.ui.toolbar.Button",{extend:qx.ui.form.Button,construct:function(label,icon,command){this.base(arguments,label,icon,command);this.removeListener("keydown",this._onKeyDown);this.removeListener("keyup",this._onKeyUp);},properties:{appearance:{refine:true,init:"toolbar-button"},show:{refine:true,init:"inherit"},focusable:{refine:true,init:false}}});qx.Class.define("qx.ui.control.ColorPopup",{extend:qx.ui.popup.Popup,construct:function(){this.base(arguments);this.setLayout(new qx.ui.layout.VBox(5));this._createChildControl("auto-button");this._createBoxes();this._createChildControl("preview-pane");this._createChildControl("selector-button");},properties:{appearance:{refine:true,init:"colorpopup"},value:{nullable:true,apply:"_applyValue",event:"changeValue"},red:{check:"Number",init:0,nullable:true,event:"changeRed"},green:{check:"Number",init:0,nullable:true,event:"changeGreen"},blue:{check:"Number",init:0,nullable:true,event:"changeBlue"}},members:{__minZIndex:1e5,__boxes:null,__colorSelectorWindow:null,__colorSelector:null,__recentTableId:"recent",__fieldNumber:12,_createChildControlImpl:function(id){var control;switch(id){case "auto-button":control=new qx.ui.form.Button(this.tr("Automatic"));control.setAllowStretchX(true);control.addListener("execute",this._onAutomaticBtnExecute,this);this.add(control);break;case "selector-button":control=new qx.ui.form.Button(this.tr("Open ColorSelector"));control.addListener("execute",this._onSelectorButtonExecute,this);this.add(control);break;case "preview-pane":control=new qx.ui.groupbox.GroupBox(this.tr("Preview (Old/New)"));control.setLayout(new qx.ui.layout.HBox);control.add(this._createChildControl("selected-preview",true),{flex:1});control.add(this._createChildControl("current-preview",true),{flex:1});this.add(control);break;case "selected-preview":control=new qx.ui.container.Composite(new qx.ui.layout.Basic);break;case "current-preview":control=new qx.ui.container.Composite(new qx.ui.layout.Basic);break;}return control||this.base(arguments,id);},_createBoxes:function(){this.__boxes={};var tables=this._tables;var table,box,field;for(var tableId in tables){table=tables[tableId];box=new qx.ui.groupbox.GroupBox(table.label);box.setLayout(new qx.ui.layout.HBox);this.__boxes[tableId]=box;this.add(box);for(var i=0;i<this.__fieldNumber;i++){field=new qx.ui.container.Composite(new qx.ui.layout.Basic);field.set({appearance:"colorpopup/field",backgroundColor:table.values[i]||"white"});field.addListener("mousedown",this._onFieldMouseDown,this);field.addListener("mouseover",this._onFieldMouseOver,this);box.add(field);}}},_createColorSelector:function(){if(this.__colorSelector){return;}var win=new qx.ui.window.Window(this.tr("Color Selector"));this.__colorSelectorWindow=win;win.setLayout(new qx.ui.layout.VBox(16));win.setResizable(false);win.moveTo(20,20);this.__colorSelector=new qx.ui.control.ColorSelector;win.add(this.__colorSelector);var buttonBar=new qx.ui.container.Composite(new qx.ui.layout.HBox(8,"right"));win.add(buttonBar);var btnCancel=new qx.ui.form.Button(this.tr("Cancel"),"icon/16/actions/dialog-cancel.png");btnCancel.addListener("execute",this._onColorSelectorCancel,this);var btnOk=new qx.ui.form.Button(this.tr("OK"),"icon/16/actions/dialog-ok.png");btnOk.addListener("execute",this._onColorSelectorOk,this);buttonBar.add(btnCancel);buttonBar.add(btnOk);},_applyValue:function(value,old){if(value===null){this.setRed(null);this.setGreen(null);this.setBlue(null);}else{var rgb=qx.util.ColorUtil.stringToRgb(value);this.setRed(rgb[0]);this.setGreen(rgb[1]);this.setBlue(rgb[2]);}this._getChildControl("selected-preview").setBackgroundColor(value);this._rotatePreviousColors();},_rotatePreviousColors:function(){if(!this._tables){return;}var vRecentTable=this._tables[this.__recentTableId].values;var vRecentBox=this.__boxes[this.__recentTableId];if(!vRecentTable){return;}var newValue=this.getValue();if(!newValue){return;}var vIndex=vRecentTable.indexOf(newValue);if(vIndex!=-1){qx.lang.Array.removeAt(vRecentTable,vIndex);}else if(vRecentTable.length==this.__fieldNumber){vRecentTable.shift();}vRecentTable.push(newValue);var vFields=vRecentBox.getChildren();for(var i=0;i<vFields.length;i++){vFields[i].setBackgroundColor(vRecentTable[i]||null);}},_onFieldMouseDown:function(e){var vValue=this._getChildControl("current-preview").getBackgroundColor();this.setValue(vValue);if(vValue){this.hide();}},_onFieldMouseOver:function(e){this._getChildControl("current-preview").setBackgroundColor(e.getTarget().getBackgroundColor());},_onAutomaticBtnExecute:function(e){this.setValue(null);this.hide();},_onSelectorButtonExecute:function(e){this._createColorSelector();this.exclude();this.__colorSelector.setRed(this.getRed());this.__colorSelector.setGreen(this.getGreen());this.__colorSelector.setBlue(this.getBlue());this.__colorSelectorWindow.open();},_onColorSelectorOk:function(e){var sel=this.__colorSelector;this.setValue(qx.util.ColorUtil.rgbToRgbString([sel.getRed(),sel.getGreen(),sel.getBlue()]));this.__colorSelectorWindow.close();},_onColorSelectorCancel:function(e){this.__colorSelectorWindow.close();},_tables:{core:{label:"Basic Colors",values:["#000","#333","#666","#999","#CCC","#FFF","red","green","blue","yellow","teal","maroon"]},recent:{label:"Recent Colors",values:[]}}},destruct:function(){this._disposeObjects("__colorSelectorWindow","__colorSelector");this._disposeFields("_tables","__boxes");}});qx.Mixin.define("qx.ui.core.MNativeOverflow",{properties:{overflowX:{check:["hidden","visible","scroll","auto"],nullable:true,apply:"_applyOverflowX"},overflowY:{check:["hidden","visible","scroll","auto"],nullable:true,apply:"_applyOverflowY"},overflow:{group:["overflowX","overflowY"]}},members:{_applyOverflowX:function(value){this.getContentElement().setStyle("overflowX",value);},_applyOverflowY:function(value){this.getContentElement().setStyle("overflowY",value);}}});qx.Class.define("qx.ui.embed.Html",{extend:qx.ui.core.Widget,include:[qx.ui.core.MNativeOverflow],construct:function(html){this.base(arguments);if(html!=null){this.setHtml(html);}},properties:{html:{check:"String",apply:"_applyHtml",event:"changeHtml",nullable:true},cssClass:{check:"String",init:"",apply:"_applyCssClass"},selectable:{refine:true,init:true},focusable:{refine:true,init:true}},members:{getFocusElement:function(){return this.getContentElement();},_applyHtml:function(value,old){var elem=this.getContentElement();elem.setAttribute("html",value||"");elem.setStyle("padding","0px");elem.setStyle("border","none");},_applyCssClass:function(value,old){this.getContentElement().setAttribute("class",value);},_applyFont:function(value,old){var styles=value?qx.theme.manager.Font.getInstance().resolve(value).getStyles():qx.bom.Font.getDefaultStyles();this.getContentElement().setStyles(styles);},_applyTextColor:function(value,old){if(value){this.getContentElement().setStyle("color",qx.theme.manager.Color.getInstance().resolve(value));}else{this.getContentElement().removeStyle("color");}}}});qx.Class.define("qx.ui.embed.Canvas",{extend:qx.ui.core.Widget,construct:function(canvasWidth,canvasHeight){this.base(arguments);this.__deferredDraw=new qx.util.DeferredCall(this.__redraw,this);this.addListener("resize",this._onResize,this);if(canvasWidth!==undefined){this.setCanvasWidth(canvasWidth);}if(canvasHeight!==undefined){this.setCanvasHeight(canvasHeight);}},events:{"redraw":"qx.event.type.Data"},properties:{syncDimension:{check:"Boolean",init:false},canvasWidth:{check:"Integer",init:300,apply:"_applyCanvasWidth"},canvasHeight:{check:"Integer",init:150,apply:"_applyCanvasHeight"}},members:{__deferredDraw:null,_createContentElement:function(){return new qx.html.Canvas();},__redraw:function(){var canvas=this.getContentElement();var height=canvas.getHeight();var width=canvas.getWidth();var context=canvas.getContext2d();this._draw(width,height,context);this.fireNonBubblingEvent("redraw",qx.event.type.Data,[{width:width,height:height,context:context}]);},_applyCanvasWidth:function(value,old){this.getContentElement().setWidth(value);this.__deferredDraw.schedule();},_applyCanvasHeight:function(value,old){this.getContentElement().setHeight(value);this.__deferredDraw.schedule();},update:function(){this.__deferredDraw.schedule();},_onResize:function(e){var data=e.getData();if(this.getSyncDimension()){this.setCanvasHeight(data.height);this.setCanvasWidth(data.width);}},getContext2d:function(){return this.getContentElement().getContext2d();},_draw:function(width,height,context){}},destruct:function(){this._disposeObjects("__deferredDraw");}});qx.Class.define("qx.html.Canvas",{extend:qx.html.Element,construct:function(){this.base(arguments,"canvas");this.__canvas=document.createElement("canvas");},members:{_createDomElement:function(){return this.__canvas;},getCanvas:function(){return this.__canvas;},setWidth:function(width){this.__canvas.width=width;},getWidth:function(){return this.__canvas.width;},setHeight:function(height){this.__canvas.height=height;},getHeight:function(){return this.__canvas.height;},getContext2d:function(){return this.__canvas.getContext("2d");}},destruct:function(){this._disposeFields("__canvas");}});qx.Class.define("qx.ui.embed.Iframe",{extend:qx.ui.core.Widget,include:qx.ui.core.MNativeOverflow,construct:function(source){if(source!=null){this.__source=source;}this.base(arguments);qx.event.Registration.addListener(document.body,"mousedown",this.block,this,true);qx.event.Registration.addListener(document.body,"mouseup",this.release,this,true);qx.event.Registration.addListener(document.body,"losecapture",this.release,this,true);this.__blockerElement=this._createBlockerElement();this.getContainerElement().add(this.__blockerElement);},events:{"load":"qx.event.type.Event"},properties:{appearance:{refine:true,init:"iframe"},source:{check:"String",apply:"_applySource",nullable:true},frameName:{check:"String",init:"",apply:"_applyFrameName"}},members:{__source:null,__blockerElement:null,renderLayout:function(left,top,width,height){this.base(arguments,left,top,width,height);var pixel="px";var insets=this.getInsets();this.__blockerElement.setStyle("left",insets.left+pixel);this.__blockerElement.setStyle("top",insets.top+pixel);this.__blockerElement.setStyle("width",(width-insets.left-insets.right)+pixel);this.__blockerElement.setStyle("height",(height-insets.top-insets.bottom)+pixel);},_createContentElement:function(){var iframe=new qx.html.Iframe(this.__source);iframe.addListener("load",this._onIframeLoad,this);return iframe;},_createBlockerElement:function(){var el=new qx.html.Element("div");el.setStyle("zIndex",20);el.setStyle("position","absolute");el.setStyle("display","none");if(qx.bom.client.Engine.MSHTML){el.setStyle("backgroundColor","white");el.setStyle("filter","Alpha(Opacity=0)");}return el;},_onIframeLoad:function(e){this.fireNonBubblingEvent("load");},getWindow:function(){return this.getContentElement().getWindow();},getDocument:function(){return this.getContentElement().getDocument();},getBody:function(){return this.getContentElement().getBody();},getName:function(){return this.getContentElement().getName();},block:function(){this.__blockerElement.setStyle("display","block");},release:function(){this.__blockerElement.setStyle("display","none");},reload:function(){this.getContentElement().reload();},_applySource:function(value,old){this.getContentElement().setSource(value);},_applyFrameName:function(value,old){this.getContentElement().setAttribute("name",value);}},destruct:function(){this._disposeObjects("__blockerElement");qx.event.Registration.removeListener(document.body,"mousedown",this.block,this,true);qx.event.Registration.removeListener(document.body,"mouseup",this.release,this,true);qx.event.Registration.removeListener(document.body,"losecapture",this.release,this,true);}});qx.Class.define("qx.html.Iframe",{extend:qx.html.Element,construct:function(){this.base(arguments,"iframe");},events:{"load":"qx.event.type.Event"},members:{_applyProperty:function(name,value){this.base(arguments,name,value);if(name=="source"){qx.bom.Iframe.setSource(this._element,value);}},_createDomElement:function(){return qx.bom.Iframe.create(this._content);},getWindow:function(){if(this._element){return qx.bom.Iframe.getWindow(this._element);}else{return null;}},getDocument:function(){if(this._element){return qx.bom.Iframe.getDocument(this._element);}else{return null;}},getBody:function(){if(this._element){return qx.bom.Iframe.getBody(this._element);}else{return null;}},setSource:function(source){this._setProperty("source",source);return this;},getSource:function(){return this._getProperty("source");},setName:function(name){this.setAttribute("name",name);return this;},getName:function(){return this.setAttribute("name");},reload:function(){if(this._element){var url=this.getSource();this.setSource(null);this.setSource(url);}}}});qx.Class.define("qx.ui.groupbox.CheckGroupBox",{extend:qx.ui.groupbox.GroupBox,properties:{appearance:{refine:true,init:"check-groupbox"}},events:{"changeChecked":"qx.event.type.Data","changeName":"qx.event.type.Data","changeValue":"qx.event.type.Data"},members:{_createChildControlImpl:function(id){var control;switch(id){case "legend":control=new qx.ui.form.CheckBox;control.setChecked(true);control.addListener("changeChecked",this._onRadioChangeChecked,this);control.addListener("changeName",this._onRadioChangeName,this);control.addListener("changeValue",this._onRadioChangeValue,this);control.addListener("resize",this._repositionFrame,this);this._add(control);}return control||this.base(arguments,id);},_onRadioChangeChecked:function(e){var checked=e.getData();this.getChildrenContainer().setEnabled(checked);this.fireDataEvent("changeChecked",checked);},_onRadioChangeName:function(e){this.fireDataEvent("changeName",e.getData());},_onRadioChangeValue:function(e){this.fireDataEvent("changeValue",e.getData());},getName:function(){return this._getChildControl("legend").getName();},setName:function(value){var legend=this._getChildControl("legend");return value?legend.setName(value):legend.resetName();},getValue:function(){return this._getChildControl("legend").getValue();},setValue:function(value){var legend=this._getChildControl("legend");return value?legend.setValue(value):legend.resetValue();},getChecked:function(){return this._getChildControl("legend").getChecked();},setChecked:function(value){var legend=this._getChildControl("legend");return value?legend.setChecked(value):legend.resetChecked();}}});qx.Class.define("qx.ui.groupbox.RadioGroupBox",{extend:qx.ui.groupbox.GroupBox,implement:qx.ui.form.IRadioItem,properties:{appearance:{refine:true,init:"radio-groupbox"}},events:{"changeChecked":"qx.event.type.Data","changeName":"qx.event.type.Data","changeValue":"qx.event.type.Data"},members:{_createChildControlImpl:function(id){var control;switch(id){case "legend":control=new qx.ui.form.RadioButton;control.setChecked(true);control.addListener("changeChecked",this._onRadioChangeChecked,this);control.addListener("changeName",this._onRadioChangeName,this);control.addListener("changeValue",this._onRadioChangeValue,this);control.addListener("resize",this._repositionFrame,this);this._add(control);}return control||this.base(arguments,id);},_onRadioChangeChecked:function(e){var checked=e.getData();this.getChildrenContainer().setEnabled(checked);this.fireDataEvent("changeChecked",checked);},_onRadioChangeName:function(e){this.fireDataEvent("changeName",e.getData());},_onRadioChangeValue:function(e){this.fireDataEvent("changeValue",e.getData());},getGroup:function(){return this._getChildControl("legend").getGroup();},setGroup:function(value){var legend=this._getChildControl("legend");return value?legend.setGroup(value):legend.resetGroup();},getName:function(){return this._getChildControl("legend").getName();},setName:function(value){var legend=this._getChildControl("legend");return value?legend.setName(value):legend.resetName();},getValue:function(){return this._getChildControl("legend").getValue();},setValue:function(value){var legend=this._getChildControl("legend");return value?legend.setValue(value):legend.resetValue();},getChecked:function(){return this._getChildControl("legend").getChecked();},setChecked:function(value){var legend=this._getChildControl("legend");return value?legend.setChecked(value):legend.resetChecked();},getLabel:function(){return this._getChildControl("legend").getLabel();}}});qx.Class.define("qx.ui.menu.RadioButton",{extend:qx.ui.menu.AbstractButton,implement:qx.ui.form.IRadioItem,construct:function(label,menu){this.base(arguments);if(label!=null){this.setLabel(label);}if(menu!=null){this.setMenu(menu);}},properties:{appearance:{refine:true,init:"menu-radiobutton"},value:{check:"String",nullable:true,event:"changeValue"},name:{check:"String",nullable:true,event:"changeName"},group:{check:"qx.ui.form.RadioGroup",nullable:true,apply:"_applyGroup"},checked:{check:"Boolean",init:false,apply:"_applyChecked",event:"changeChecked"}},members:{_applyChecked:function(value,old){value?this.addState("checked"):this.removeState("checked");},_applyGroup:function(value,old){if(old){old.remove(this);}if(value){value.add(this);}},_onMouseUp:function(e){if(e.isLeftPressed()){this.setChecked(true);}},_onKeyPress:function(e){this.setChecked(true);}}});qx.Class.define("qx.ui.splitpane.Pane",{extend:qx.ui.core.Widget,construct:function(orientation){this.base(arguments);if(orientation){this.setOrientation(orientation);}else{this.initOrientation();}this.addListener("mousedown",this._onMouseDown);this.addListener("mouseup",this._onMouseUp);this.addListener("mousemove",this._onMouseMove);this.addListener("mouseout",this._onMouseOut);this.addListener("losecapture",this._onMouseUp);},properties:{appearance:{refine:true,init:"splitpane"},orientation:{init:"horizontal",check:["horizontal","vertical"],apply:"_applyOrientation"}},members:{__splitterOffset:null,__activeDragSession:null,__lastMouseX:null,__lastMouseY:null,__isHorizontal:null,__beginSize:null,__endSize:null,_createChildControlImpl:function(id){var control;switch(id){case "slider":control=new qx.ui.splitpane.Slider(this);control.exclude();this._add(control,{type:id});break;case "splitter":control=new qx.ui.splitpane.Splitter(this);this._add(control,{type:id});control.addListener("move",this._onSplitterMove,this);break;}return control||this.base(arguments,id);},_applyOrientation:function(value,old){var slider=this._getChildControl("slider");var splitter=this._getChildControl("splitter");this.__isHorizontal=value==="horizontal";var oldLayout=this._getLayout();if(oldLayout){oldLayout.dispose();}var newLayout=value==="vertical"?new qx.ui.splitpane.VLayout:new qx.ui.splitpane.HLayout;this._setLayout(newLayout);splitter.replaceState(old,value);splitter._getChildControl("knob").replaceState(old,value);slider.replaceState(old,value);},add:function(widget,flex){if(flex==null){this._add(widget);}else{this._add(widget,{flex:flex});}},remove:function(widget){this._remove(widget);},_onMouseDown:function(e){if(!e.isLeftPressed()){return;}var splitter=this._getChildControl("splitter");if(!splitter.hasState("active")){return;}var splitterLocation=splitter.getContainerLocation();var paneLocation=this.getContentLocation();this.__splitterOffset=this.__isHorizontal?e.getDocumentLeft()-splitterLocation.left+paneLocation.left:e.getDocumentTop()-splitterLocation.top+paneLocation.top;var slider=this._getChildControl("slider");var splitterBounds=splitter.getBounds();slider.setUserBounds(splitterBounds.left,splitterBounds.top,splitterBounds.width,splitterBounds.height);slider.setZIndex(splitter.getZIndex()+1);slider.show();this.__activeDragSession=true;this.capture();},_onMouseMove:function(e){this.__lastMouseX=e.getDocumentLeft();this.__lastMouseY=e.getDocumentTop();if(this.__activeDragSession){this.__computeSizes();var slider=this._getChildControl("slider");var pos=this.__beginSize;if(this.__isHorizontal){slider.setDomLeft(pos);}else{slider.setDomTop(pos);}}else{this.__updateCursor();}},_onMouseOut:function(e){this.__lastMouseX=-1;this.__lastMouseY=-1;this.__updateCursor();},_onMouseUp:function(e){if(!this.__activeDragSession){return;}this.__finalizeSizes();var slider=this._getChildControl("slider");slider.exclude();delete this.__activeDragSession;this.releaseCapture();this.__updateCursor();},_onSplitterMove:function(){this.__updateCursor();},__finalizeSizes:function(){var beginSize=this.__beginSize;var endSize=this.__endSize;if(beginSize==null){return;}var children=this._getChildren();var firstWidget=children[2];var secondWidget=children[3];var firstFlexValue=firstWidget.getLayoutProperties().flex;var secondFlexValue=secondWidget.getLayoutProperties().flex;if((firstFlexValue!=0)&&(secondFlexValue!=0)){firstWidget.setLayoutProperties({flex:beginSize});secondWidget.setLayoutProperties({flex:endSize});}else{if(this.__isHorizontal){firstWidget.setWidth(beginSize);secondWidget.setWidth(endSize);}else{firstWidget.setHeight(beginSize);secondWidget.setHeight(endSize);}}},__isNear:function(){var splitter=this._getChildControl("splitter");var splitterBounds=splitter.getBounds();var splitterLocation=splitter.getContainerLocation();var min=6;if(!splitterLocation){return;}var mouse=this.__lastMouseX;var size=splitterBounds.width;var pos=splitterLocation.left;if(size<min){pos-=Math.floor((min-size)/2);size=min;}if(mouse<pos||mouse>(pos+size)){return false;}var mouse=this.__lastMouseY;var size=splitterBounds.height;var pos=splitterLocation.top;if(size<min){pos-=Math.floor((min-size)/2);size=min;}if(mouse<pos||mouse>(pos+size)){return false;}return true;},__updateCursor:function(){var splitter=this._getChildControl("splitter");var root=this.getApplicationRoot();if(this.__activeDragSession||this.__isNear()){var cursor=this.__isHorizontal?"col-resize":"row-resize";this.setCursor(cursor);root.setGlobalCursor(cursor);splitter.addState("active");}else if(splitter.hasState("active")){this.resetCursor();root.resetGlobalCursor();splitter.removeState("active");}},__computeSizes:function(){if(this.__isHorizontal){var min="minWidth",size="width",max="maxWidth",mouse=this.__lastMouseX;}else{var min="minHeight",size="height",max="maxHeight",mouse=this.__lastMouseY;}var children=this._getChildren();var beginHint=children[2].getSizeHint();var endHint=children[3].getSizeHint();var allocatedSize=children[2].getBounds()[size]+children[3].getBounds()[size];var beginSize=mouse-this.__splitterOffset;var endSize=allocatedSize-beginSize;if(beginSize<beginHint[min]){endSize-=beginHint[min]-beginSize;beginSize=beginHint[min];}else if(endSize<endHint[min]){beginSize-=endHint[min]-endSize;endSize=endHint[min];}if(beginSize>beginHint[max]){endSize+=beginSize-beginHint[max];beginSize=beginHint[max];}else if(endSize>endHint[max]){beginSize+=endSize-endHint[max];endSize=endHint[max];}this.__beginSize=beginSize;this.__endSize=endSize;}}});qx.Class.define("qx.ui.splitpane.Slider",{extend:qx.ui.core.Widget,properties:{allowShrinkX:{refine:true,init:false},allowShrinkY:{refine:true,init:false}}});qx.Class.define("qx.ui.splitpane.Splitter",{extend:qx.ui.core.Widget,construct:function(parentWidget){this.base(arguments);if(parentWidget.getOrientation()=="vertical"){this._setLayout(new qx.ui.layout.HBox(0,"center"));this._getLayout().setAlignY("middle");}else{this._setLayout(new qx.ui.layout.VBox(0,"middle"));this._getLayout().setAlignX("center");}this._createChildControl("knob");},properties:{allowShrinkX:{refine:true,init:false},allowShrinkY:{refine:true,init:false}},members:{_createChildControlImpl:function(id){var control;switch(id){case "knob":control=new qx.ui.basic.Image;this._add(control);break;}return control||this.base(arguments,id);}}});qx.Class.define("qx.ui.splitpane.VLayout",{extend:qx.ui.layout.Abstract,members:{verifyLayoutProperty:null,renderLayout:function(availWidth,availHeight){var children=this._getLayoutChildren();var length=children.length;var child,type;var begin,splitter,slider,end;for(var i=0;i<length;i++){child=children[i];type=child.getLayoutProperties().type;if(type==="splitter"){splitter=child;}else if(type==="slider"){slider=child;}else if(!begin){begin=child;}else{end=child;}}if(begin&&end){var beginFlex=begin.getLayoutProperties().flex;var endFlex=end.getLayoutProperties().flex;if(beginFlex==null){beginFlex=1;}if(endFlex==null){endFlex=1;}var beginHint=begin.getSizeHint();var splitterHint=splitter.getSizeHint();var endHint=end.getSizeHint();var beginHeight=beginHint.height;var splitterHeight=splitterHint.height;var endHeight=endHint.height;if(beginFlex>0&&endFlex>0){var flexSum=beginFlex+endFlex;var flexAvailable=availHeight-splitterHeight;var beginHeight=Math.round((flexAvailable/flexSum)*beginFlex);var endHeight=flexAvailable-beginHeight;var sizes=qx.ui.layout.Util.arrangeIdeals(beginHint.minHeight,beginHeight,beginHint.maxHeight,endHint.minHeight,endHeight,endHint.maxHeight);beginHeight=sizes.begin;endHeight=sizes.end;}else if(beginFlex>0){beginHeight=availHeight-splitterHeight-endHeight;if(beginHeight<beginHint.minHeight){beginHeight=beginHint.minHeight;}if(beginHeight>beginHint.maxHeight){beginHeight=beginHint.maxHeight;}}else if(endFlex>0){endHeight=availHeight-beginHeight-splitterHeight;if(endHeight<endHint.minHeight){endHeight=endHint.minHeight;}if(endHeight>endHint.maxHeight){endHeight=endHint.maxHeight;}}begin.renderLayout(0,0,availWidth,beginHeight);splitter.renderLayout(0,beginHeight,availWidth,splitterHeight);end.renderLayout(0,beginHeight+splitterHeight,availWidth,endHeight);}else{splitter.renderLayout(0,0,0,0);if(begin){begin.renderLayout(0,0,availWidth,availHeight);}else if(end){end.renderLayout(0,0,availWidth,availHeight);}}},_computeSizeHint:function(){var children=this._getLayoutChildren();var length=children.length;var child,hint,props;var minHeight=0,height=0,maxHeight=0;var minWidth=0,width=0,maxWidth=0;for(var i=0;i<length;i++){child=children[i];props=child.getLayoutProperties();if(props.type==="slider"){continue;}hint=child.getSizeHint();minHeight+=hint.minHeight;height+=hint.height;maxHeight+=hint.maxHeight;if(hint.minWidth>minWidth){minWidth=hint.minWidth;}if(hint.width>width){width=hint.width;}if(hint.maxWidth>maxWidth){maxWidth=hint.maxWidth;}}return {minHeight:minHeight,height:height,maxHeight:maxHeight,minWidth:minWidth,width:width,maxWidth:maxWidth};}}});qx.Class.define("qx.ui.splitpane.HLayout",{extend:qx.ui.layout.Abstract,members:{verifyLayoutProperty:null,renderLayout:function(availWidth,availHeight){var children=this._getLayoutChildren();var length=children.length;var child,type;var begin,splitter,slider,end;for(var i=0;i<length;i++){child=children[i];type=child.getLayoutProperties().type;if(type==="splitter"){splitter=child;}else if(type==="slider"){slider=child;}else if(!begin){begin=child;}else{end=child;}}if(begin&&end){var beginFlex=begin.getLayoutProperties().flex;var endFlex=end.getLayoutProperties().flex;if(beginFlex==null){beginFlex=1;}if(endFlex==null){endFlex=1;}var beginHint=begin.getSizeHint();var splitterHint=splitter.getSizeHint();var endHint=end.getSizeHint();var beginWidth=beginHint.width;var splitterWidth=splitterHint.width;var endWidth=endHint.width;if(beginFlex>0&&endFlex>0){var flexSum=beginFlex+endFlex;var flexAvailable=availWidth-splitterWidth;var beginWidth=Math.round((flexAvailable/flexSum)*beginFlex);var endWidth=flexAvailable-beginWidth;var sizes=qx.ui.layout.Util.arrangeIdeals(beginHint.minWidth,beginWidth,beginHint.maxWidth,endHint.minWidth,endWidth,endHint.maxWidth);beginWidth=sizes.begin;endWidth=sizes.end;}else if(beginFlex>0){beginWidth=availWidth-splitterWidth-endWidth;if(beginWidth<beginHint.minWidth){beginWidth=beginHint.minWidth;}if(beginWidth>beginHint.maxWidth){beginWidth=beginHint.maxWidth;}}else if(endFlex>0){endWidth=availWidth-beginWidth-splitterWidth;if(endWidth<endHint.minWidth){endWidth=endHint.minWidth;}if(endWidth>endHint.maxWidth){endWidth=endHint.maxWidth;}}begin.renderLayout(0,0,beginWidth,availHeight);splitter.renderLayout(beginWidth,0,splitterWidth,availHeight);end.renderLayout(beginWidth+splitterWidth,0,endWidth,availHeight);}else{splitter.renderLayout(0,0,0,0);if(begin){begin.renderLayout(0,0,availWidth,availHeight);}else if(end){end.renderLayout(0,0,availWidth,availHeight);}}},_computeSizeHint:function(){var children=this._getLayoutChildren();var length=children.length;var child,hint,props;var minWidth=0,width=0,maxWidth=0;var minHeight=0,height=0,maxHeight=0;for(var i=0;i<length;i++){child=children[i];props=child.getLayoutProperties();if(props.type==="slider"){continue;}hint=child.getSizeHint();minWidth+=hint.minWidth;width+=hint.width;maxWidth+=hint.maxWidth;if(hint.minHeight>minHeight){minHeight=hint.minHeight;}if(hint.height>height){height=hint.height;}if(hint.maxHeight>maxHeight){maxHeight=hint.maxHeight;}}return {minWidth:minWidth,width:width,maxWidth:maxWidth,minHeight:minHeight,height:height,maxHeight:maxHeight};}}});qx.Class.define("qx.ui.tabview.TabView",{extend:qx.ui.core.Widget,include:[qx.ui.core.MContentPadding],construct:function(barPosition){this.base(arguments);this._createChildControl("bar");this._createChildControl("pane");var mgr=this.__radioGroup=new qx.ui.form.RadioGroup;mgr.setWrap(false);mgr.addListener("changeValue",this._onRadioChangeValue,this);if(barPosition!=null){this.setBarPosition(barPosition);}else{this.initBarPosition();}},properties:{appearance:{refine:true,init:"tabview"},barPosition:{check:["left","right","top","bottom"],init:"top",apply:"_applyBarPosition"},selected:{check:"qx.ui.tabview.Page",apply:"_applySelected",event:"changeSelected",nullable:true}},members:{__radioGroup:null,_createChildControlImpl:function(id){var control;switch(id){case "bar":control=new qx.ui.container.SlideBar();control.setZIndex(10);this._add(control);break;case "pane":control=new qx.ui.container.Stack;control.setZIndex(5);this._add(control,{flex:1});break;}return control||this.base(arguments,id);},_getContentPaddingTarget:function(){return this._getChildControl("pane");},add:function(page){{};var button=page.getButton();var bar=this._getChildControl("bar");var pane=this._getChildControl("pane");page.exclude();this.__radioGroup.add(button);bar.add(button);pane.add(page);page.addState(this.__barPositionToState[this.getBarPosition()]);page.addState("lastTab");var children=this.getChildren();if(children[0]==page){page.addState("firstTab");}else{children[children.length-2].removeState("lastTab");}},remove:function(page){var pane=this._getChildControl("pane");var bar=this._getChildControl("bar");var button=page.getButton();var children=pane.getChildren();if(this.getSelected()==page){var index=children.indexOf(page);if(index==0){if(children[1]){this.setSelected(children[1]);}else{this.resetSelected();}}else{this.setSelected(children[index-1]);}}bar.remove(button);pane.remove(page);this.__radioGroup.remove(button);page.removeState(this.__barPositionToState[this.getBarPosition()]);if(page.hasState("firstTab")){page.removeState("firstTab");if(children[0]){children[0].addState("firstTab");}}if(page.hasState("lastTab")){page.removeState("lastTab");if(children.length>0){children[children.length-1].addState("lastTab");}}},getChildren:function(){return this._getChildControl("pane").getChildren();},indexOf:function(page){return this._getChildControl("pane").indexOf(page);},__barPositionToState:{top:"barTop",right:"barRight",bottom:"barBottom",left:"barLeft"},_applyBarPosition:function(value,old){var bar=this._getChildControl("bar");var horizontal=value=="left"||value=="right";var reversed=value=="right"||value=="bottom";var layoutClass=horizontal?qx.ui.layout.HBox:qx.ui.layout.VBox;var layout=this._getLayout();if(layout&&layout instanceof layoutClass){}else{this._setLayout(layout=new layoutClass);}layout.setReversed(reversed);bar.setOrientation(horizontal?"vertical":"horizontal");var children=this.getChildren();if(old){var oldState=this.__barPositionToState[old];bar.removeState(oldState);for(var i=0,l=children.length;i<l;i++){children[i].removeState(oldState);}}if(value){var newState=this.__barPositionToState[value];bar.addState(newState);for(var i=0,l=children.length;i<l;i++){children[i].addState(newState);}}},_applySelected:function(value,old){var pane=this._getChildControl("pane");var group=this.__radioGroup;if(value){var button=value.getButton();pane.setSelected(value);group.setSelected(button);button.focus();this.scrollChildIntoView(button,null,null,false);}else{pane.resetSelected();group.resetSelected();}},_onRadioChangeValue:function(e){this.setSelected(qx.core.ObjectRegistry.fromHashCode(e.getData()));}},destruct:function(){this._disposeObjects("__radioGroup");}});qx.Class.define("qx.ui.tabview.Page",{extend:qx.ui.container.Composite,construct:function(label,icon){this.base(arguments);this._createChildControl("button");if(label!=null){this.setLabel(label);}if(icon!=null){this.setIcon(icon);}},properties:{appearance:{refine:true,init:"tabview-page"},label:{check:"String",init:"",apply:"_applyLabel"},icon:{check:"String",init:"",apply:"_applyIcon"}},members:{_forwardStates:{barTop:1,barRight:1,barBottom:1,barLeft:1,firstTab:1,lastTab:1},_applyIcon:function(value,old){this._getChildControl("button").setIcon(value);},_applyLabel:function(value,old){this._getChildControl("button").setLabel(value);},_applyEnabled:function(value,old){this.base(arguments,value,old);var btn=this._getChildControl("button");value==null?btn.resetEnabled():btn.setEnabled(value);},_createChildControlImpl:function(id){var control;switch(id){case "button":control=new qx.ui.form.RadioButton;control.setAllowGrowX(true);control.setAllowGrowY(true);control.setValue(this.toHashCode());this._add(control);break;}return control||this.base(arguments,id);},getButton:function(){return this._getChildControl("button");}}});qx.Class.define("qx.ui.toolbar.CheckBox",{extend:qx.ui.form.ToggleButton,construct:function(label,icon){this.base(arguments,label,icon);this.removeListener("keydown",this._onKeyDown);this.removeListener("keyup",this._onKeyUp);},properties:{appearance:{refine:true,init:"toolbar-button"},show:{refine:true,init:"inherit"},focusable:{refine:true,init:false}}});qx.Class.define("qx.ui.toolbar.RadioButton",{extend:qx.ui.toolbar.CheckBox,implement:qx.ui.form.IRadioItem,properties:{group:{check:"qx.ui.form.RadioGroup",apply:"_applyGroup",nullable:true}},members:{_applyChecked:function(value,old){this.base(arguments,value,old);if(value){var grp=this.getGroup();if(grp){grp.select(this);}}},_applyGroup:function(value,old){if(old){old.remove(this);}if(value){value.add(this);}}}});qx.Class.define("qx.ui.toolbar.SplitButton",{extend:qx.ui.form.SplitButton,construct:function(label,icon,menu,command){this.base(arguments,label,icon,menu,command);this.removeListener("keydown",this._onKeyDown);this.removeListener("keyup",this._onKeyUp);},properties:{appearance:{refine:true,init:"toolbar-splitbutton"},focusable:{refine:true,init:false}},members:{_createChildControlImpl:function(id){var control;switch(id){case "button":control=new qx.ui.toolbar.Button;control.addListener("execute",this._onButtonExecute,this);this._addAt(control,0);break;case "arrow":control=new qx.ui.toolbar.MenuButton;this._addAt(control,1);break;}return control||this.base(arguments,id);}}});qx.Class.define("qx.ui.tree.SelectionManager",{extend:qx.ui.core.selection.ScrollArea,members:{_getSelectableLocationY:function(item){var computed=item.getBounds();if(computed){var top=this._widget.getItemOffset(item);return {top:top,bottom:top+computed.height};}},_isSelectable:function(item){return item instanceof qx.ui.tree.AbstractTreeItem;},_getSelectableFromTarget:function(target){return this._widget.getTreeItem(target);},_getSelectables:function(){return this._widget.getRoot().getItems(true,false,this._widget.getHideRoot());},_getSelectableRange:function(item1,item2){if(item1===item2){return [item1];}var selectables=this._getSelectables();var item1Index=selectables.indexOf(item1);var item2Index=selectables.indexOf(item2);if(item1Index<0||item2Index<0){return [];}if(item1Index<item2Index){return selectables.slice(item1Index,item2Index+1);}else{return selectables.slice(item2Index,item1Index+1);}},_getFirstSelectable:function(){return this._getSelectables()[0]||null;},_getLastSelectable:function(){var selectables=this._getSelectables();if(selectables.length>0){return selectables[selectables.length-1];}else{return null;}},_getRelatedSelectable:function(item,relation){switch(relation){case "above":return this._widget.getPreviousSiblingOf(item,false);case "under":return this._widget.getNextSiblingOf(item,false);case "left":if(item.isOpenable()&&item.isOpen()){item.setOpen(false);}break;case "right":if(item.isOpenable()&&!item.isOpen()){item.setOpen(true);}break;}return null;}}});qx.Class.define("qx.ui.tree.Tree",{extend:qx.ui.core.AbstractScrollArea,include:[qx.ui.core.MSelectionHandling,qx.ui.core.MContentPadding],construct:function(){this.base(arguments);this.__content=new qx.ui.container.Composite(new qx.ui.layout.VBox()).set({allowShrinkY:false,allowGrowX:true});this._getChildControl("pane").add(this.__content);this.initOpenMode();this.initRootOpenClose();},events:{addItem:"qx.event.type.Data",removeItem:"qx.event.type.Data"},properties:{openMode:{check:["click","dblclick","none"],init:"dblclick",apply:"_applyOpenMode",event:"changeOpenMode",themeable:true},root:{check:"qx.ui.tree.AbstractTreeItem",init:null,nullable:true,event:"changeRoot",apply:"_applyRoot"},hideRoot:{check:"Boolean",init:false,apply:"_applyHideRoot"},rootOpenClose:{check:"Boolean",init:false,apply:"_applyRootOpenClose"},appearance:{refine:true,init:"tree"},focusable:{refine:true,init:true}},members:{__content:null,SELECTION_MANAGER:qx.ui.tree.SelectionManager,getChildrenContainer:function(){return this.__content;},_applyRoot:function(value,old){var container=this.getChildrenContainer();if(old){container.remove(old);if(old.hasChildren()){container.remove(old.getChildrenContainer());}}if(value){container.add(value);if(value.hasChildren()){container.add(value.getChildrenContainer());}value.setVisibility(this.getHideRoot()?"excluded":"visible");value.recursiveAddToWidgetQueue();}},_applyHideRoot:function(value,old){var root=this.getRoot();if(!root){return;}root.setVisibility(value?"excluded":"visible");root.recursiveAddToWidgetQueue();},_applyRootOpenClose:function(value,old){var root=this.getRoot();if(!root){return;}root.recursiveAddToWidgetQueue();},_getContentPaddingTarget:function(){return this.__content;},getNextSiblingOf:function(treeItem,invisible){if((invisible!==false||treeItem.isOpen())&&treeItem.hasChildren()){return treeItem.getChildren()[0];}while(treeItem){var parent=treeItem.getParent();if(!parent){return null;}var parentChildren=parent.getChildren();var index=parentChildren.indexOf(treeItem);if(index>-1&&index<parentChildren.length-1){return parentChildren[index+1];}treeItem=parent;}return null;},getPreviousSiblingOf:function(treeItem,invisible){var parent=treeItem.getParent();if(!parent){return null;}if(this.getHideRoot()){if(parent==this.getRoot()){if(parent.getChildren()[0]==treeItem){return null;}}}else{if(treeItem==this.getRoot()){return null;}}var parentChildren=parent.getChildren();var index=parentChildren.indexOf(treeItem);if(index>0){var folder=parentChildren[index-1];while((invisible!==false||folder.isOpen())&&folder.hasChildren()){var children=folder.getChildren();folder=children[children.length-1];}return folder;}else{return parent;}},getItems:function(recursive,invisible){return this.getRoot().getItems(recursive,invisible,this.getHideRoot());},scrollChildIntoViewY:function(child,align,direct){if(!this.getNextSiblingOf(child,false)){this.scrollToY(1000000);}else{this.base(arguments,child,align,direct);}},getTreeItem:function(widget){while(widget){if(widget==this){return null;}if(widget instanceof qx.ui.tree.AbstractTreeItem){return widget;}widget=widget.getLayoutParent();}return null;},_applyOpenMode:function(value,old){if(old=="click"){this.removeListener("click",this._onOpen,this);}else if(old=="dblclick"){this.removeListener("dblclick",this._onOpen,this);}if(value=="click"){this.addListener("click",this._onOpen,this);}else if(value=="dblclick"){this.addListener("dblclick",this._onOpen,this);}},_onOpen:function(e){var treeItem=this.getTreeItem(e.getTarget());if(!treeItem||!treeItem.isOpenable()){return;}treeItem.setOpen(!treeItem.isOpen());e.stopPropagation();}},destruct:function(){this._disposeObjects("__content");}});qx.Class.define("qx.ui.tree.AbstractTreeItem",{extend:qx.ui.core.Widget,type:"abstract",construct:function(){this.base(arguments);this.__children=[];this._setLayout(new qx.ui.layout.HBox());this._addWidgets();this.initOpen();},properties:{open:{check:"Boolean",init:false,event:"changeOpen",apply:"_applyOpen"},openSymbolMode:{check:["always","never","auto"],init:"auto",event:"changeOpenSymbolMode",apply:"_applyOpenSymbolMode"},indent:{check:"Integer",init:19,apply:"_applyIndent",themeable:true},parent:{check:"qx.ui.tree.AbstractTreeItem",nullable:true},icon:{check:"String",apply:"_applyIcon",nullable:true,themeable:true},label:{check:"String",apply:"_applyLabel",init:"",dispose:true}},members:{__children:null,__childrenContainer:null,__labelAdded:null,__iconAdded:null,__spacer:null,_addWidgets:function(){throw new Error("Abstract method call.");},_createChildControlImpl:function(id){var control;switch(id){case "label":control=new qx.ui.basic.Label().set({appearance:this.getAppearance()+"-label",alignY:"middle"});break;case "icon":control=new qx.ui.basic.Image().set({appearance:this.getAppearance()+"-icon",alignY:"middle"});break;case "open":control=new qx.ui.tree.FolderOpenButton().set({alignY:"middle"});control.addListener("changeOpen",this._onChangeOpen,this);control.addListener("resize",this._updateIndent,this);break;}return control||this.base(arguments,id);},getTree:function(){var treeItem=this;while(treeItem.getParent()){treeItem=treeItem.getParent();}var tree=treeItem.getLayoutParent()?treeItem.getLayoutParent().getLayoutParent():0;if(tree&&tree instanceof qx.ui.core.ScrollPane){return tree.getLayoutParent();}return null;},addWidget:function(widget,options){this._add(widget,options);},addSpacer:function(){if(!this.__spacer){this.__spacer=new qx.ui.core.Spacer();}else{this._remove(this.__spacer);}this._add(this.__spacer);},addOpenButton:function(){this._add(this._getChildControl("open"));},_onChangeOpen:function(e){if(this.isOpenable()){this.setOpen(e.getData());}},addIcon:function(){var icon=this._getChildControl("icon");if(this.__iconAdded){this._remove(icon);}this._add(icon);this.__iconAdded=true;},addLabel:function(text){var label=this._getChildControl("label");if(this.__labelAdded){this._remove(label);}if(text){this.setLabel(text);}else{label.setContent(this.getLabel());}this._add(label);this.__labelAdded=true;},addState:function(state){this.base(arguments,state);var children=this._getChildren();for(var i=0,l=children.length;i<l;i++){var child=children[i];if(child.addState){children[i].addState(state);}}},removeState:function(state){this.base(arguments,state);var children=this._getChildren();for(var i=0,l=children.length;i<l;i++){var child=children[i];if(child.addState){children[i].removeState(state);}}},_applyIcon:function(value,old){this._getChildControl("icon").setSource(value);},_applyLabel:function(value,old){this._getChildControl("label").setContent(value);},_applyOpen:function(value,old){if(this.hasChildren()){this.getChildrenContainer().setVisibility(value?"visible":"excluded");}var open=this._getChildControl("open",true);if(open){open.setOpen(value);}value?this.addState("opened"):this.removeState("opened");},isOpenable:function(){var openMode=this.getOpenSymbolMode();return (openMode==="always"||openMode==="auto"&&this.hasChildren());},_shouldShowOpenSymbol:function(){var open=this._getChildControl("open",true);if(!open){return false;}var tree=this.getTree();if(!tree.getRootOpenClose()){if(tree.getHideRoot()){if(tree.getRoot()==this.getParent()){return false;}}else{if(tree.getRoot()==this){return false;}}}return this.isOpenable();},_applyOpenSymbolMode:function(value,old){this._updateIndent();},_updateIndent:function(){if(!this.getTree()){return;}var openWidth=0;var open=this._getChildControl("open",true);if(open){if(this._shouldShowOpenSymbol()){open.show();openWidth=open.getSizeHint().width;}else{open.exclude();}}this.__spacer.setWidth((this.getLevel()+1)*this.getIndent()-openWidth);},_applyIndent:function(value,old){this._updateIndent();},getLevel:function(){var tree=this.getTree();if(!tree){return;}var treeItem=this;var level=-1;while(treeItem){treeItem=treeItem.getParent();level+=1;}if(tree.getHideRoot()){level-=1;}if(!tree.getRootOpenClose()){level-=1;}return level;},syncWidget:function(){this._updateIndent();},getChildrenContainer:function(){if(!this.__childrenContainer){this.__childrenContainer=new qx.ui.container.Composite(new qx.ui.layout.VBox()).set({visibility:this.isOpen()?"visible":"excluded"});}return this.__childrenContainer;},getParentChildrenContainer:function(){if(this.getParent()){return this.getParent().getChildrenContainer();}else if(this.getLayoutParent()){return this.getLayoutParent();}else{return null;}},getChildren:function(){return this.__children;},hasChildren:function(){return this.__children?this.__children.length>0:false;},getItems:function(recursive,invisible,ignoreFirst){if(ignoreFirst!==false){var items=[];}else{var items=[this];}var addChildren=this.hasChildren()&&(invisible!==false||this.isOpen());if(addChildren){var children=this.getChildren();if(recursive===false){items=items.concat(children);}else{for(var i=0,chl=children.length;i<chl;i++){items=items.concat(children[i].getItems(recursive,invisible,false));}}}return items;},recursiveAddToWidgetQueue:function(){var children=this.getItems(true,true,false);for(var i=0,l=children.length;i<l;i++){qx.ui.core.queue.Widget.add(children[i]);}},__addChildrenToParent:function(){if(this.getParentChildrenContainer()){this.getParentChildrenContainer()._addAfter(this.getChildrenContainer(),this);}},add:function(varargs){var container=this.getChildrenContainer();var tree=this.getTree();for(var i=0,l=arguments.length;i<l;i++){var treeItem=arguments[i];var oldParent=treeItem.getParent();if(oldParent){oldParent.remove(treeItem);}treeItem.setParent(this);var hasChildren=this.hasChildren();container.add(treeItem);if(treeItem.hasChildren()){container.add(treeItem.getChildrenContainer());}this.__children.push(treeItem);if(!hasChildren){this.__addChildrenToParent();}if(tree){treeItem.recursiveAddToWidgetQueue();tree.fireNonBubblingEvent("addItem",qx.event.type.Data,[treeItem]);}}if(tree){qx.ui.core.queue.Widget.add(this);}},addAt:function(treeItem,index){{};if(index==this.__children.length){this.add(treeItem);return;}var oldParent=treeItem.getParent();if(oldParent){oldParent.remove(treeItem);}var container=this.getChildrenContainer();treeItem.setParent(this);var hasChildren=this.hasChildren();var nextItem=this.__children[index];container.addBefore(treeItem,nextItem);if(treeItem.hasChildren()){container.addAfter(treeItem.getChildrenContainer(),treeItem);}qx.lang.Array.insertAt(this.__children,treeItem,index);if(!hasChildren){this.__addChildrenToParent();}if(this.getTree()){treeItem.recursiveAddToWidgetQueue();qx.ui.core.queue.Widget.add(this);}},addBefore:function(treeItem,before){{};this.addAt(treeItem,this.__children.indexOf(before));},addAfter:function(treeItem,after){{};this.addAt(treeItem,this.__children.indexOf(after)+1);},addAtBegin:function(treeItem){this.addAt(treeItem,0);},remove:function(varargs){for(var i=0,l=arguments.length;i<l;i++){var treeItem=arguments[i];if(this.__children.indexOf(treeItem)==-1){this.warn("Cannot remove treeitem '"+treeItem+"'. It is not a child of this tree item.");return;}var container=this.getChildrenContainer();if(treeItem.hasChildren()){container.remove(treeItem.getChildrenContainer());}qx.lang.Array.remove(this.__children,treeItem);treeItem.setParent(null);container.remove(treeItem);}var tree=this.getTree();if(tree){tree.fireNonBubblingEvent("addItem",qx.event.type.Data,[treeItem]);}qx.ui.core.queue.Widget.add(this);},removeAt:function(index){var item=this.__children[index];if(item){this.remove(item);}},removeAll:function(){for(var i=this.__children.length-1;i>=0;i--){this.remove(this.__children[i]);}}},destruct:function(){this._disposeArray("__children");this._disposeObjects("__spacer","__childrenContainer");}});qx.Class.define("qx.ui.tree.FolderOpenButton",{extend:qx.ui.basic.Image,include:qx.ui.core.MExecutable,construct:function(){this.base(arguments);this.initOpen();this.addListener("keypress",this._onKeyPress);this.addListener("click",this._onClick);this.addListener("mousedown",this._stopPropagation,this);this.addListener("mouseup",this._stopPropagation,this);},properties:{open:{check:"Boolean",init:false,event:"changeOpen",apply:"_applyOpen"}},members:{_applyOpen:function(value,old){value?this.addState("opened"):this.removeState("opened");this.execute();},_onKeyPress:function(e){switch(e.getKeyIdentifier()){case "Enter":case "Space":this.toggleOpen();e.stopPropagation();}},_stopPropagation:function(e){e.stopPropagation();},_onClick:function(e){this.toggleOpen();e.stopPropagation();}}});qx.Class.define("qx.ui.tree.TreeFolder",{extend:qx.ui.tree.AbstractTreeItem,construct:function(label){this.base(arguments);if(label){this.setLabel(label);}},properties:{appearance:{refine:true,init:"tree-folder"}},members:{_addWidgets:function(){this.addSpacer();this.addOpenButton();this.addIcon();this.addLabel();}}});qx.Class.define("qx.ui.tree.TreeFile",{extend:qx.ui.tree.AbstractTreeItem,construct:function(label){this.base(arguments);if(label){this.setLabel(label);}},properties:{appearance:{refine:true,init:"tree-file"}},members:{_addWidgets:function(){this.addSpacer();this.addIcon();this.addLabel();}}});qx.Class.define("qx.test.util.NumberFormat",{extend:qx.dev.unit.TestCase,members:{testNumberFormat:function(){this.assertNotUndefined(qx.util.format.NumberFormat);qx.locale.Manager.getInstance().setLocale("de_DE");var nf=qx.util.format.NumberFormat.getInstance();this.assertEquals("1.000.000",nf.format(1000000));this.assertEquals("-1.000.000",nf.format(-1000000));this.assertEquals("-1.000.000",nf.format(-1000000));this.assertEquals("0",nf.format(0));this.assertEquals("0",nf.format(-0));this.assertEquals("12,12",nf.format(12.12));var ninfinity=-1/0;this.assertEquals("-Infinity",nf.format(ninfinity));var infinity=1/0;this.assertEquals("Infinity",nf.format(infinity));var nan=Math.sqrt(-1);this.assertEquals("NaN",nf.format(nan));},testNumberParse:function(){qx.locale.Manager.getInstance().setLocale("de_DE");var nf=qx.util.format.NumberFormat.getInstance();var goodNumbers={"1000":1000,"-1.000.000":-1000000,"+1.000,12":1000.12};for(var number in goodNumbers){this.assertEquals(nf.parse(number),goodNumbers[number]);}var badNumberStrings=["2hastalavista","2.3.4.5.6","12.10,10","10,1,12"];for(var i=0;i<badNumberStrings.length;i++){badNumberStr=badNumberStrings[i];this.assertException(function(){nf.format(nf.parse(badNumberStr));},Error,"does not match the number format","testing if parsing fails on string '"+badNumberStr+"'");}}}});